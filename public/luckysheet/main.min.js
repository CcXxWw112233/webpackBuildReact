!function(){function __firefox(){HTMLElement.prototype.__defineGetter__("runtimeStyle",__element_style),window.constructor.prototype.__defineGetter__("event",__window_event),Event.prototype.__defineGetter__("srcElement",__event_srcElement)}function __element_style(){return this.style}function __window_event(){return __window_event_constructor()}function __event_srcElement(){return this.target}function __window_event_constructor(){if(document.all)return window.event;for(var e=__window_event_constructor.caller;null!=e;){var t=e.arguments[0];if(t)if(-1!=t.constructor.toString().indexOf("Event"))return t;e=e.caller}return null}window.addEventListener&&(isFirefox=0<navigator.userAgent.indexOf("Firefox"))&&__firefox();var luckysheet={};function z(e){var t,l={times:1,num:0};if(t=e,Math.floor(t)===t)return l.num=e,l;var r=e+"",a=r.indexOf("."),s=r.substr(a+1).length,n=Math.pow(10,s),o=parseInt(e*n+.5,10);return l.times=n,l.num=o,l}function A(e,t,l){var r=z(e),a=z(t),s=r.num,n=a.num,o=r.times,c=a.times,u=c<o?o:c;switch(l){case"add":return(o===c?s+n:c<o?s+n*(o/c):s*(c/o)+n)/u;case"subtract":return(o===c?s-n:c<o?s-n*(o/c):s*(c/o)-n)/u;case"multiply":return s*n/(o*c);case"divide":return A(s/n,c/o,"multiply")}}luckysheet.floatTool={add:function(e,t){return A(e,t,"add")},subtract:function(e,t){return A(e,t,"subtract")},multiply:function(e,t){return A(e,t,"multiply")},divide:function(e,t){return A(e,t,"divide")}},luckysheet.isJsonString=function(e){try{if("object"==typeof JSON.parse(e))return!0}catch(e){}return!1},luckysheet.isRealNum=function(e){return""!==e&&null!=e&&!isNaN(e)};var defaultSetting={container:"luckysheet",column:15,row:30,allowCopy:!0,showtoolbar:!0,showinfobar:!0,showsheetbar:!0,showstatisticBar:!0,pointEdit:!1,pointEditUpdate:null,pointEditZoom:1,data:[{name:"Sheet1",color:"",status:"1",order:"0",data:[],config:{},index:0},{name:"Sheet2",color:"",status:"0",order:"1",data:[],config:{},index:1},{name:"Sheet3",color:"",status:"0",order:"2",data:[],config:{},index:2}],title:"Luckysheet Demo",userInfo:'<i style="font-size:16px;color:#ff6a00;" class="fa fa-taxi" aria-hidden="true"></i> rabbit',userMenuItem:[{url:"www.baidu.com",icon:'<i class="fa fa-folder" aria-hidden="true"></i>',name:"我的表格"},{url:"www.baidu.com",icon:'<i class="fa fa-sign-out" aria-hidden="true"></i>',name:"退出登陆"}],myFolderUrl:"www.baidu.com",config:{},fullscreenmode:!0,devicePixelRatio:window.devicePixelRatio,allowEdit:!0,loadUrl:"",loadSheetUrl:"",gridKey:"",updateUrl:"",updateImageUrl:"",allowUpdate:!1,functionButton:"",showConfigWindowResize:!0,enableAddRow:!0,enableAddCol:!0,enablePage:!1,autoFormatw:!1,accuracy:void 0,pageInfo:{queryExps:"",reportId:"",fields:"",mobile:"",frezon:"",currentPage:"",totalPage:10,pageUrl:""},editMode:!1,chartConfigChange:null,beforeCreateDom:null,fireMousedown:null,mode:"edit"},gridHTML='<div class="luckysheet"><canvas id="luckysheetTableContentF" style="display:none;" class="luckysheetTableContent"></canvas><div class="luckysheet-work-area luckysheet-noselected-text"><div class="luckysheet-share-logo" title="${logotitle}"></div><div id ="luckysheet_info_detail" class="luckysheet_info_detail"><div data-tips="返回" id="luckysheet_info_detail_title" class="luckysheet_info_detail_title"><i style="margin-left: -2px;" class="fa fa-chevron-left" aria-hidden="true"></i></div><div><input data-tips="表格重命名" id="luckysheet_info_detail_input" class="luckysheet_info_detail_input luckysheet-mousedown-cancel" value="无标题的电子表格" tabindex="0" dir="ltr" aria-label="重命名" style="visibility: visible; width: 149px;" data-tooltip="重命名"></div><div id="luckysheet_info_detail_update" class="luckysheet_info_detail_update"> 新打开 </div><div id="luckysheet_info_detail_save" class="luckysheet_info_detail_save"> 待更新 </div><div class="luckysheet_info_detail_user"> ${functionButton} <span id="luckysheet_info_detail_user"></span> </div></div><div id="luckysheet-wa-editor" class="luckysheet-wa-editor"> ${menu} </div><div id="luckysheet-wa-calculate" class="luckysheet-wa-calculate"><div class="luckysheet-wa-calculate-size" id="luckysheet-wa-calculate-size"></div><div class="luckysheet-wa-calculate-help"><div class="luckysheet-wa-calculate-help-box"><div spellcheck="false" aria-hidden="false" id="luckysheet-helpbox"><div id="luckysheet-helpbox-cell" class="luckysheet-helpbox-cell-input luckysheet-mousedown-cancel" tabindex="0" contenteditable="true" dir="ltr" aria-autocomplete="list"></div></div></div><div class="luckysheet-wa-calculate-help-tool"><i class="fa fa-caret-down" aria-hidden="true" style="margin-top: 7px;"></i></div></div><div id="luckysheet-wa-functionbox-cancel" class="luckysheet-wa-functionbox"><span><i class="fa fa-remove" aria-hidden="true"></i></span></div><div id="luckysheet-wa-functionbox-confirm" class="luckysheet-wa-functionbox"><span><i class="fa fa-check" aria-hidden="true"></i></span></div><div id="luckysheet-wa-functionbox-fx" class="luckysheet-wa-functionbox"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAQAAAD9CzEMAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAHdElNRQfdBg4KFCeL2MAqAAACOUlEQVRYw+3Wy2+MURjH8U9Hp0VLVTTRUupWqfs9xEpE3ULSsLK0qVg0rJAgiD/A2kpCQkJC0rhEJMJampBSFYle0BYNMUNKTY+F0bi10zFjIZnvuzrPe57fc3mfnPeQI0eO/5+8tHaPVW22cn1aNYlnO5nlzmgzIAiazcm2/FoPBEHMY+2uKcqufKlGQcIt29RYYl6azU3JLh8E99VkuzHfKHZekHDw38hT5Zmg17L0XSMj2jVXGTq9+lcBZilAp1j6AfKHfVtmh1IDauWjQoPPIp64IpF+qD+xSKfw23PV6GxV0KdFHJWKJLwQR0SbgezkT1SFSivcE3SrM9U005WlIzF8Bf1eokAUMQ89T9oLjdWfPOwixssT1/9niZFMUakJ+Kg3uV7olKtOm4kx6jU6qzqTRq33VnBHIahy0z0dgmPy7NGjx23ThnIeSQUTlKA7OZrjNNvtHNaoc8hFm+33MpMK9giCU4PJFGKrz7o8dVnF8M6pK4iYDLoGh/MT2jw32TuHU+WeOkC+KQi/CPXqwA2PUueXigIz8UnnT9b5ZmF68sNnFKBEFbq9/sFW7bioLxYpzjzAamV4pAtElahwQtQRb1WaZ4rtxqVUGZLv/7IDyfVGl1zXbpOJmgTnXXBXZfrCk9RabKmTYoIWc5P2o2La1RslYr8OPe5a9zeZ7/TGMx0Sgvf2Dt4hamyxMnmCFVllgxl/15oGcUHwRYt9mdyBhrrdlFtgtkIvNGvN3vmfI0eO/5Ov+PeiZHME+tcAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTYtMDktMTdUMTU6MTk6MDcrMDg6MDARPBuqAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDEzLTA2LTE0VDEwOjIwOjM5KzA4OjAw59f0jAAAAE10RVh0c29mdHdhcmUASW1hZ2VNYWdpY2sgNy4wLjEtNiBRMTYgeDg2XzY0IDIwMTYtMDktMTcgaHR0cDovL3d3dy5pbWFnZW1hZ2ljay5vcmfd2aVOAAAAGHRFWHRUaHVtYjo6RG9jdW1lbnQ6OlBhZ2VzADGn/7svAAAAF3RFWHRUaHVtYjo6SW1hZ2U6OkhlaWdodAA3Nkv1+ekAAAAWdEVYdFRodW1iOjpJbWFnZTo6V2lkdGgANzazWjlkAAAAGXRFWHRUaHVtYjo6TWltZXR5cGUAaW1hZ2UvcG5nP7JWTgAAABd0RVh0VGh1bWI6Ok1UaW1lADEzNzExNzY0MzntxStTAAAAEHRFWHRUaHVtYjo6U2l6ZQA5OTdClByG1AAAAF90RVh0VGh1bWI6OlVSSQBmaWxlOi8vL2hvbWUvd3d3cm9vdC9zaXRlL3d3dy5lYXN5aWNvbi5uZXQvY2RuLWltZy5lYXN5aWNvbi5jbi9zcmMvMTExNTkvMTExNTkzNy5wbmeOkn0GAAAAAElFTkSuQmCC" alt="" style="vertical-align:middle"/></div><div id="luckysheet-functionbox-container" class="luckysheet-mousedown-cancel"><div class="luckysheet-mousedown-cancel" dir="ltr"><div spellcheck="false" aria-hidden="false" id="luckysheet-functionbox"><div id="luckysheet-functionbox-cell" class="luckysheet-functionbox-cell-input luckysheet-mousedown-cancel" tabindex="0" contenteditable="true" dir="ltr" aria-autocomplete="list" aria-label="D4"></div></div></div></div></div></div><div class="luckysheet-grid-container luckysheet-scrollbars-enabled"><div class="luckysheet-grid-window"><div class="luckysheet-help-sub"></div><div class="luckysheet-grid-window-1" id="luckysheet-grid-window-1"><canvas id="luckysheetTableContent" class="luckysheetTableContent"></canvas><table class="luckysheet-grid-window-2" cellspacing="0" cellpadding="0" dir="ltr" tabindex="-1" ><tbody><tr><td valign="top" class="luckysheet-paneswrapper"><div class="luckysheet-left-top" id="luckysheet-left-top"> </div></td><td valign="top" class="luckysheet-paneswrapper"><div id="luckysheet-cols-h-c" class="luckysheet-cols-h-c"><div class="luckysheet-cols-change-size" id="luckysheet-cols-change-size"></div><div class="luckysheet-cols-menu-btn luckysheet-mousedown-cancel" id="luckysheet-cols-menu-btn"><i class="fa fa-caret-down luckysheet-mousedown-cancel" aria-hidden="true"></i></div><div class="luckysheet-cols-h-hover" id="luckysheet-cols-h-hover"></div><div id="luckysheet-cols-h-selected"></div><div class="luckysheet-grdusedrange"></div><div class="luckysheet-grdblkflowpush"></div>  ${columnHeader}</div></td></tr><tr><td valign="top" class="luckysheet-paneswrapper"><div class="luckysheet-rows-h" id="luckysheet-rows-h"><div class="luckysheet-rows-change-size" id="luckysheet-rows-change-size"></div><div class="luckysheet-rows-h-hover" id="luckysheet-rows-h-hover"></div><div id="luckysheet-rows-h-selected"></div><div class="luckysheet-grdusedrange"></div><div class="luckysheet-grdblkflowpush"></div> ${rowHeader}</div></td><td valign="top" class="luckysheet-paneswrapper"><div class="luckysheet-cell-loading" id="luckysheet-cell-loading"><div class="luckysheet-cell-loading-inner"><i class="fa fa-circle-o-notch fa-spin"></i><span></span></div></div><div class="luckysheet-cell-freezen"></div><div class="luckysheet-scrollbars luckysheet-scrollbar-ltr luckysheet-scrollbar-x" id="luckysheet-scrollbar-x"><div></div></div><div class="luckysheet-scrollbars luckysheet-scrollbar-ltr luckysheet-scrollbar-y" id="luckysheet-scrollbar-y"><div></div></div><div class="luckysheet-cell-main " id="luckysheet-cell-main"><div id="luckysheet-formula-functionrange"></div><div id="luckysheet-formula-functionrange-select" class="luckysheet-selection-copy luckysheet-formula-functionrange-select"><div class="luckysheet-selection-copy-top luckysheet-copy"></div><div class="luckysheet-selection-copy-right luckysheet-copy"></div><div class="luckysheet-selection-copy-bottom luckysheet-copy"></div><div class="luckysheet-selection-copy-left luckysheet-copy"></div><div class="luckysheet-selection-copy-hc"></div></div><div class="luckysheet-row-count-show luckysheet-count-show" id="luckysheet-row-count-show"></div><div class="luckysheet-column-count-show luckysheet-count-show" id="luckysheet-column-count-show"></div><div class="luckysheet-change-size-line" id="luckysheet-change-size-line"></div><div class="luckysheet-cell-selected-focus" id="luckysheet-cell-selected-focus"></div><div id="luckysheet-selection-copy"></div><div id="luckysheet-chart-rangeShow"></div><div class="luckysheet-cell-selected-extend" id="luckysheet-cell-selected-extend"></div><div class="luckysheet-cell-selected-move" id="luckysheet-cell-selected-move"></div><div id="luckysheet-cell-selected-boxs"><div id="luckysheet-cell-selected" class="luckysheet-cell-selected"><div class="luckysheet-cs-inner-border"></div><div class="luckysheet-cs-fillhandle"></div><div class="luckysheet-cs-inner-border"></div><div class="luckysheet-cs-draghandle-top luckysheet-cs-draghandle"></div><div class="luckysheet-cs-draghandle-bottom luckysheet-cs-draghandle"></div><div class="luckysheet-cs-draghandle-left luckysheet-cs-draghandle"></div><div class="luckysheet-cs-draghandle-right luckysheet-cs-draghandle"></div><div class="luckysheet-cs-touchhandle luckysheet-cs-touchhandle-lt"><div class="luckysheet-cs-touchhandle-btn"></div></div><div class="luckysheet-cs-touchhandle luckysheet-cs-touchhandle-rb"><div class="luckysheet-cs-touchhandle-btn"></div></div></div></div><div id="luckysheet-postil-showBoxs"></div><div id="luckysheet-multipleRange-show"></div><div id="luckysheet-dynamicArray-hightShow"></div><div class="luckysheet-cell-copy"></div><div class="luckysheet-grdblkflowpush"></div>  ${flow}</div></td></tr></tbody></table></div><div class="luckysheet-sheet-area luckysheet-noselected-text" id="luckysheet-sheet-area"><div id="luckysheet-sheets-add" class="btn btn-default luckysheet-sheets-add"><i class="fa fa-plus"></i></div><div id="luckysheet-sheets-m" class="btn btn-default luckysheet-sheets-m"><i class="fa fa-bars"></i></div><div class="luckysheet-sheet-container" id="luckysheet-sheet-container"><div class="docs-sheet-fade docs-sheet-fade-left" style="display: none;"><div class="docs-sheet-fade3"></div><div class="docs-sheet-fade2"></div><div class="docs-sheet-fade1"></div></div><div class="docs-sheet-fade docs-sheet-fade-right" style="display: none;"><div class="docs-sheet-fade1"></div><div class="docs-sheet-fade2"></div><div class="docs-sheet-fade3"></div></div><div class="luckysheet-sheet-container-c" id="luckysheet-sheet-container-c"></div></div><div id="luckysheet-sheets-leftscroll" class="btn btn-default luckysheet-sheets-scroll"><i class="fa fa-caret-left"></i></div><div id="luckysheet-sheets-rightscroll" class="btn btn-default luckysheet-sheets-scroll"><i class="fa fa-caret-right"></i></div></div></div><div class="luckysheet-stat-area"><div class="luckysheet-sta-c"><div class="luckysheet-sta-content" id="luckysheet-sta-content"></div><div class="luckysheet-bottom-content" id="luckysheet-bottom-content-show"></div></div></div></div><div id="luckysheet-copy-content" contenteditable="true"></div><input id="luckysheet-copy-btn" type="button" data-clipboard-target="luckysheet-copy-content"><div id="testdpidiv" style="height: 1in; left: -100%; position: absolute; top: -100%; width: 1in;"></div></div>',columeHeader_word=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],columeHeader_word_index={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25},flow='<div id="luckysheet-cell-flow_${index}" class="luckysheet-cell-flow luckysheetsheetchange" style="width:${width}px;"><div class="luckysheet-cell-flow-clip"><div class="luckysheet-grdblkpush"></div>${flow}</div></div>',colsmenuHTML="",rightclickHTML='<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel" id="luckysheet-rightclick-menu"><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel luckysheet-copy-btn" id="luckysheet-copy-btn" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">复制</div></div><div class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel" id="luckysheetcopyfor"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">复制为<span class="luckysheet-submenu-arrow" style="user-select: none;">►</span></div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" id="luckysheet-copy-paste"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">粘贴</div></div>            <div id="luckysheet-cols-rows-add"><div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div>    <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">向<span class="luckysheet-cols-rows-shift-left">左</span>增加<input type="text" class="luckysheet-mousedown-cancel" placeholder="数字" value="1" style="width:40px;height:18px;margin-left:5px;"/><span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">列</span><button id="luckysheet-add-lefttop" class="btn btn-primary luckysheet-copy-btn luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">确认</button></div></div>     <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">向<span class="luckysheet-cols-rows-shift-right">右</span>增加<input type="text" class="luckysheet-mousedown-cancel" placeholder="数字" value="1" style="width:40px;height:18px;margin-left:5px;"/><span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">列</span><button id="luckysheet-add-rightbottom" class="btn btn-primary luckysheet-copy-btn luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">确认</button></div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" id="luckysheet-del-selected"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">删除选中<span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">列</span></div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">列</span><span class="luckysheet-cols-rows-shift-size luckysheet-mousedown-cancel">宽</span><input type="number" class="luckysheet-mousedown-cancel rcsize" min="0" max="255" placeholder="数字" value="" style="width:40px;height:18px;margin-left:5px;">px<button id="luckysheet-rows-cols-changesize" class="btn btn-primary luckysheet-copy-btn luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">确认</button></div></div></div>       <div id="luckysheet-cols-rows-shift"> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div><div id="luckysheetorderbyasc" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">A-Z顺序排列</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" id="luckysheetorderbydesc"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">Z-A降序排列</div></div></div>                <div id="luckysheet-cols-rows-data"><div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div><div id="luckysheet-delete-text" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">清除内容</div></div><div id="luckysheetmatrix" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">矩阵操作选区<span class="luckysheet-submenu-arrow" style="user-select: none;">►</span></div></div><div id="luckysheetorderby" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">排序选区</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" id="luckysheetfilter"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">筛选选区</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" id="luckysheetdatavisual"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">图表生成</div></div></div>      </div> <div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel" id="luckysheetcopyfor_sub"><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">Json<button id="luckysheet-copy-json-head" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="btn btn-primary luckysheet-copy-btn luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">首行为标题</button><button id="luckysheet-copy-json-nohead" class="btn btn-primary luckysheet-copy-btn luckysheet-mousedown-cancel" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">无标题</button></div></div><div data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel" id="luckysheet-copy-array1"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">一维数组</div></div><div id="luckysheet-copy-array2" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">二维数组</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><div class="luckysheet-mousedown-cancel">多维数组</div><div><input type="number" min="1" class="luckysheet-mousedown-cancel"placeholder="行" style="width:40px;height:18px;" id="luckysheet-copy-arraymore-row"/>×<input type="number" min="1" class="luckysheet-mousedown-cancel" placeholder="列" style="width:40px;height:18px;" id="luckysheet-copy-arraymore-col"/><button id="luckysheet-copy-arraymore-confirm" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="btn btn-primary luckysheet-copy-btn luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">确认</button></div></div></div><div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div><div id="luckysheet-copy-diagonal" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">对角线</div></div><div data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" id="luckysheet-copy-antidiagonal" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">反对角线</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">对角偏移<input type="number" class="luckysheet-mousedown-cancel" placeholder="偏移量" id="luckysheet-copy-diagonaloffset-value" value="1" style="width:40px;height:18px;margin-left:5px;"/>列<button id="luckysheet-copy-diagonaloffset" class="btn btn-primary luckysheet-copy-btn luckysheet-mousedown-cancel" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">确认</button></div></div><div id="luckysheet-copy-boolvalue" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">布尔值</div></div></div><div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel" id="luckysheetmatrix_sub"><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">翻转<button class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;" id="luckysheet-matrix-turn-up">上下</button><button class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;" id="luckysheet-matrix-turn-left">左右</button></div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">翻转<button class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;" id="luckysheet-matrix-turn-cw">顺时针</button><button class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;" id="luckysheet-matrix-turn-anticw">逆时针</button></div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" id="luckysheet-matrix-turn-trans">转置</div></div><div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><div class="luckysheet-mousedown-cancel">矩阵计算</div><div  class="luckysheet-mousedown-cancel"><select class="luckysheet-mousedown-cancel" style="height:24px;" id="luckysheet-matrix-cal-type"><option value="plus">加</option><option value="minus">减</option><option value="multiply">乘</option><option value="divided">除</option><option value="power">次方</option><option value="root">次方根</option><option value="log">log</option></select><input type="number" id="luckysheet-matrix-cal-value" class="luckysheet-mousedown-cancel" placeholder="数值" value="2" style="width:40px;height:18px;margin-left:5px;"/><button id="luckysheet-matrix-cal-confirm" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">确定</button></div></div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">删除两端0值<button class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;" id="luckysheet-matrix-delezero-row">按行</button><button class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;" id="luckysheet-matrix-delezero-column">按列</button></div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">删除重复值<button class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;" id="luckysheet-matrix-delerpt-row">按行</button><button class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;" id="luckysheet-matrix-delerpt-column">按列</button></div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">生成新矩阵</div></div></div>',pivottableconfigHTML='<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel" id="luckysheet-pivotTable-config-option"> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">排序</span> <select class="luckysheet-mousedown-cancel" style="height:24px;" id="luckysheet-pivotTable-config-option-order"> <option selected="selected" value="default">无排序</option> <option value="asc">升序</option> <option value="desc">降序</option> </select> </div> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">排序依据</span> <select class="luckysheet-mousedown-cancel" style="height:24px;" id="luckysheet-pivotTable-config-option-orderby"> </select> </div> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">显示总计</span> <select class="luckysheet-mousedown-cancel" style="height:24px;" id="luckysheet-pivotTable-config-option-stastic"> <option  value="0">否</option> <option value="1" selected="selected">是</option> </select> </div> </div> </div> </div>',pivottablesumHTML='<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel" id="luckysheet-pivotTable-config-option-sumtype"> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="SUM"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">求和</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="COUNT"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">数值计数</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="COUNTA"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">计数</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="COUNTUNIQUE"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">去重计数</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="AVERAGE"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">平均值</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="MAX"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">最大值</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="MIN"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">最小值</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="MEDIAN"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">中位数</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="PRODUCT"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">乘积</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="STDEV"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">标准差</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="STDEVP"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">整体标准差</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="VAR"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">方差</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="VARP"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">整体方差</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> </div>',sheetHTML='<div style="${style}" id="luckysheet-sheets-item${index}" data-index="${index}" class="luckysheet-sheets-item ${active}"><span class="luckysheet-sheets-item-name" spellcheck ="false" contenteditable="false">${name}</span> <span class="luckysheet-sheets-item-menu luckysheet-mousedown-cancel"><i class="fa fa-sort-desc luckysheet-mousedown-cancel"></i></span>${colorset}</div>',columnHeaderHTML='<div class="luckysheet-cols-h-cells luckysheetsheetchange"  id="luckysheet-cols-h-cells_${index}" style="width:${width}px;"> <div class="luckysheet-cols-h-cells-c"> <div class="luckysheet-grdblkpush"></div>${column}</div></div>',sheetselectlistHTML='<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel" id="luckysheet-sheet-list">${item}</div>',sheetselectlistitemHTML='<div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"  id="luckysheet-sheet-btn${index}" data-index="${index}"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="${style}" ><span class="icon luckysheet-mousedown-cancel">${icon}</span>${name}</div></div>',inputHTML='<div dir="ltr"><div class="luckysheet-input-box-index" id="luckysheet-input-box-index"></div><div id="luckysheet-input-box" spellcheck="false" aria-hidden="false" class="luckysheet-input-box"><div class="luckysheet-cell-input editable" tabindex="0" role="combobox" contenteditable="true" id="luckysheet-rich-text-editor" dir="ltr" g_editable="true" aria-autocomplete="list"></div></div></div>',modelHTML='<div id="${id}" style="${style}" class="luckysheet-modal-dialog ${addclass}" tabindex="0" role="dialog" aria-labelledby=":41e" dir="ltr"> <div class="luckysheet-modal-dialog-title luckysheet-modal-dialog-title-draggable"> <span class="luckysheet-modal-dialog-title-text" role="heading">${title}</span>\t <span class="luckysheet-modal-dialog-title-close" role="button" tabindex="0" aria-label="关闭"><i class="fa fa-times" aria-hidden="true"></i></span> </div> <div class="luckysheet-modal-dialog-content">${content}</div> <div class="luckysheet-modal-dialog-buttons">\t ${botton} </div></div>',maskHTML='<div class="luckysheet-modal-dialog-mask" id="luckysheet-modal-dialog-mask"></div>',filtermenuHTML='<div class="luckysheet-cols-menu luckysheet-mousedown-cancel luckysheet-filter-menu" id="luckysheet-${menuid}-menu"><div id="luckysheet-${menuid}-orderby-asc" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">以A-Z升序排列</div></div><div id="luckysheet-${menuid}-orderby-desc" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><div style="width:205px;" class="luckysheet-mousedown-cancel">以Z-A降序排列</div></div></div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div><div id="luckysheet-${menuid}-orderby-color" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="position: relative;">按颜色筛选<span class="luckysheet-submenu-arrow" style="user-select: none;right: 0;">►</span></div></div><div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" id="luckysheet-${menuid}-bycondition" style="padding-top:0px;padding-bottom:0px;"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><i class="fa fa-caret-right" aria-hidden="true"></i> 按条件过滤</div></div> <div class="luckysheet-${menuid}-bycondition" style="display:none;"><div class="luckysheet-flat-menu-button luckysheet-mousedown-cancel" id="luckysheet-${menuid}-selected"><span class="luckysheet-mousedown-cancel" data-value="null" data-type="0">无</span><div class="luckysheet-mousedown-cancel"><i class="fa fa-sort" aria-hidden="true"></i></div></div><div class="luckysheet-${menuid}-selected-input"><input type="text" placeholder="输入筛选值" class="luckysheet-mousedown-cancel" /></div><div class="luckysheet-${menuid}-selected-input luckysheet-${menuid}-selected-input2"><span>从</span><input type="text" placeholder="范围开始" class="luckysheet-mousedown-cancel" /><span>到</span><input type="text" placeholder="范围结束" class="luckysheet-mousedown-cancel" /></div></div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" id="luckysheet-${menuid}-byvalue" style="padding-top:0px;padding-bottom:0px;"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><i class="fa fa-caret-right" aria-hidden="true"></i> 按值过滤</div></div> <div class="luckysheet-${menuid}-byvalue"><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel luckysheet-mousedown-${menuid}-byvalue-btn"><span id="luckysheet-${menuid}-byvalue-btn-all" class="luckysheet-mousedown-cancel">全选</span> - <span id="luckysheet-${menuid}-byvalue-btn-clear" class="luckysheet-mousedown-cancel">清除</span> - <span id="luckysheet-${menuid}-byvalue-btn-contra" class="luckysheet-mousedown-cancel">反选</span> <div><i class="fa fa-${menuid} luckysheet-mousedown-cancel" aria-hidden="true"></i></div></div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="padding-left:3px; padding-right:3px;"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><input type="text" placeholder="按照值进行筛选" class="luckysheet-mousedown-cancel" id="luckysheet-${menuid}-byvalue-input" /><div class="luckysheet-${menuid}-byvalue-input-icon luckysheet-mousedown-cancel"><i class="fa fa-search luckysheet-mousedown-cancel" aria-hidden="true"></i></div></div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div id="luckysheet-${menuid}-byvalue-select" class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"></div></div></div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><div class="btn btn-primary luckysheet-mousedown-cancel" id="luckysheet-${menuid}-confirm">确 认</div> <div class="btn btn-default luckysheet-mousedown-cancel" id="luckysheet-${menuid}-cancel">取 消</div> <div class="btn btn-danger luckysheet-mousedown-cancel" id="luckysheet-${menuid}-initial">清除筛选</div></div></div> </div>',filtersubmenuHTML='<div style="z-index:1004;overflow-y:auto;" class="luckysheet-filter-submenu luckysheet-cols-menu luckysheet-mousedown-cancel" id="luckysheet-${menuid}-submenu"><div data-value="null" data-type="0" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">无</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="cellnull"  data-type="0"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">单元格为空</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="cellnonull"  data-type="0"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">单元格有数据</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="textinclude"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">文本包含</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="textnotinclude"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">文本不包含</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="textstart"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">文本开头为</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="textend"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">文本结尾为</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="textequal"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">文本等于</div></div>  <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div>  <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="dateequal"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">日期等于</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="datelessthan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">日期早于</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="datemorethan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">日期晚于</div></div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="morethan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">大于</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="moreequalthan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">大于等于</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="lessthan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">小于</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="lessequalthan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">小于等于</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="equal"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">等于</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="noequal"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">不等于</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="include"  data-type="2"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">介于</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="noinclude" data-type="2"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">不在其中</div></div> </div>',sheetconfigHTML=' <div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel" id="luckysheet-rightclick-sheet-menu"> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" id="luckysheetsheetconfigdelete"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">删除</div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" id="luckysheetsheetconfigcopy"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">复制</div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" id="luckysheetsheetconfigrename"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">重命名</div> </div> <div class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel" id="luckysheetsheetconfigcolor"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> 更改颜色 <span class="luckysheet-submenu-arrow" style="user-select: none;">►</span> </div> </div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" id="luckysheetsheetconfighide"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">隐藏</div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" id="luckysheetsheetconfigshow"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">取消隐藏</div> </div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> <div id="luckysheetsheetconfigmoveleft" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">向左移</div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" id="luckysheetsheetconfigmoveright"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">向右移</div> </div> </div> <div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel" id="luckysheetsheetconfigcolor_sub"><div id="luckysheetsheetconfigcolorreset" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">重置颜色</div></div> <div class="luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <input type="text" id="luckysheetsheetconfigcolorur" /> </div> </div> </div>',luckysheetPivotTableHTML='<div id="luckysheet-modal-dialog-slider-pivot" class="luckysheet-modal-dialog-slider luckysheet-modal-dialog-slider-pivot"> <div class="luckysheet-modal-dialog-slider-title"> <span>数据透视表</span> <span id="luckysheet-modal-dialog-slider-close" title="关闭"><i class="fa fa-times" aria-hidden="true"></i></span> </div> <div class="luckysheet-modal-dialog-slider-content"> <div class="luckysheet-modal-dialog-slider-range"> <div id="luckysheet-dialog-pivotTable-range"></div> <div id="luckysheet-dialog-pivotTable-range-seleted">编辑范围</div> </div> <div class="luckysheet-modal-dialog-slider-list-title"> 选择需要添加到数据透视表的字段 <span title="清除所有已选字段" id="luckysheet-dialog-pivotTable-clearitem">清除</span></div> <div id="luckysheet-modal-dialog-pivotTable-list" class="luckysheet-modal-dialog-slider-list luckysheet-scrollbars"> </div> <div class="luckysheet-modal-dialog-slider-config-c"> <div class="luckysheet-modal-dialog-slider-config luckysheet-modal-dialog-config-filter"> <div> <span><i class="fa fa-filter luckysheet-mousedown-cancel" aria-hidden="true"></i> 筛选</span> </div> <div id="luckysheet-modal-dialog-config-filter" class="luckysheet-modal-dialog-slider-config-list luckysheet-scrollbars"> </div> </div> <div class="luckysheet-modal-dialog-slider-config luckysheet-modal-dialog-config-row"> <div> <span><i class="fa fa-list-alt" aria-hidden="true"></i> 行</span> </div> <div id="luckysheet-modal-dialog-config-row" class="luckysheet-modal-dialog-slider-config-list luckysheet-scrollbars"> </div> </div> <div class="luckysheet-modal-dialog-slider-config luckysheet-modal-dialog-config-column"> <div> <span><i class="fa fa-indent" aria-hidden="true"></i> 列</span> </div> <div id="luckysheet-modal-dialog-config-column" class="luckysheet-modal-dialog-slider-config-list luckysheet-scrollbars"> </div> </div> <div class="luckysheet-modal-dialog-slider-config luckysheet-modal-dialog-config-value"> <div> <span><i class="fa fa-cube" aria-hidden="true"></i> 数值</span> <span style="float: right;margin-right: 10px;display:none;" id="luckysheetpivottablevaluecolrowshow"><label style="padding:0px 5px;margin:0px;font-size:12px;height:15px;line-height:15px;" title="统计字段显示为列" for="luckysheetpivottablevaluecolrow">列</label> <input type="radio" checked="checked" value="1" name="luckysheetpivottablevaluecolrow" id="luckysheetpivottablevaluecolrow" /> <label style="padding:0px 5px;margin:0px;font-size:12px;height:15px;line-height:15px;" title="统计字段显示为行" for="luckysheetpivottablevaluecolrow1">行</label> <input type="radio" value="0" name="luckysheetpivottablevaluecolrow" id="luckysheetpivottablevaluecolrow1" /></span></div> <div id="luckysheet-modal-dialog-config-value" class="luckysheet-modal-dialog-slider-config-list luckysheet-scrollbars"> </div> </div> </div> </div> </div>',luckysheetAlternateformatHtml='<div id="luckysheet-modal-dialog-slider-alternateformat" class="luckysheet-modal-dialog-slider luckysheet-modal-dialog-slider-alternateformat" style="display: block;"><div class="luckysheet-modal-dialog-slider-title"><span>交替颜色</span><span class="luckysheet-model-close-btn" title="关闭"><i class="fa fa-times" aria-hidden="true"></i></span></div><div class="luckysheet-modal-dialog-slider-content"><div class="textTitle">应用范围</div><div id="luckysheet-alternateformat-range"><input class="formulaInputFocus" placeholder="请选择应用范围"/><i class="fa fa-table" aria-hidden="true"></i></div><div id="luckysheet-alternateformat-checkbox"><div class="cf"><input type="checkbox" id="luckysheet-alternateformat-rowHeader"/><label for="luckysheet-alternateformat-rowHeader">页眉</label></div><div class="cf"><input type="checkbox" id="luckysheet-alternateformat-rowFooter"/><label for="luckysheet-alternateformat-rowFooter">页脚</label></div></div><div class="textTitle">格式样式</div><div id="luckysheet-alternateformat-modelList" class="cf"></div><div class="textTitle">自定义</div><div id="luckysheet-alternateformat-modelCustom" class="cf"></div><div id="luckysheet-alternateformat-modelToning"><div class="toningbox header"><div class="toningShow"> 页眉 </div><div class="luckysheet-color-menu-button-indicator" title="点击选择文本颜色" style="border-bottom-color: #000;margin-right: 10px;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-text-color" style="user-select: none;"> </div> </div> </div><div class="luckysheet-color-menu-button-indicator" title="点击选择单元格颜色" style="border-bottom-color: #fff;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-cell-color" style="user-select: none;"> </div> </div> </div></div><div class="toningbox ctOne"><div class="toningShow"> 颜色1 </div><div class="luckysheet-color-menu-button-indicator" title="点击选择文本颜色" style="border-bottom-color: #000;margin-right: 10px;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-text-color" style="user-select: none;"> </div> </div> </div><div class="luckysheet-color-menu-button-indicator" title="点击选择单元格颜色" style="border-bottom-color: #fff;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-cell-color" style="user-select: none;"> </div> </div> </div></div><div class="toningbox ctTwo"><div class="toningShow"> 颜色2 </div><div class="luckysheet-color-menu-button-indicator" title="点击选择文本颜色" style="border-bottom-color: #000;margin-right: 10px;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-text-color" style="user-select: none;"> </div> </div> </div><div class="luckysheet-color-menu-button-indicator" title="点击选择单元格颜色" style="border-bottom-color: #fff;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-cell-color" style="user-select: none;"> </div> </div> </div></div><div class="toningbox footer"><div class="toningShow"> 页脚 </div><div class="luckysheet-color-menu-button-indicator" title="点击选择文本颜色" style="border-bottom-color: #000;margin-right: 10px;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-text-color" style="user-select: none;"> </div> </div> </div><div class="luckysheet-color-menu-button-indicator" title="点击选择单元格颜色" style="border-bottom-color: #fff;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-cell-color" style="user-select: none;"> </div> </div> </div></div></div><button id="luckysheet-alternateformat-remove" class="btn btn-default" style="margin: 10px;">移除交替颜色</button></div></div>',luckysheetchartpointconfigHTML='<div class="luckysheet-chart-point-config"> <div class="luckysheet-chart-point-config-set"> <div class="luckysheet-chart-point-config-left"> <div class="luckysheet-chart-point-config-left-top"> <div class="luckysheet-chart-point-searchcondition"> <div class="luckysheet-datavisual-content-row" style="margin-bottom: 0px;margin-top: 0px;height: 30px;"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">选择维度</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-tips="维度选择" name="luckysheetpointconfigsearchdim" id="luckysheetpointconfigsearchdim"> </select> </div> </div> <div class="luckysheet-datavisual-content-row" style="margin-bottom: 0px;margin-top: 3px;height: 30px;"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;">排序</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <label data-tips="无排序" for="luckysheetpointconfigsearchorderno">无排序</label> <input type="radio" checked="checked" value="0" name="luckysheetpointconfigsearchorder" id="luckysheetpointconfigsearchorderno"> <label data-tips="升序" for="luckysheetpointconfigsearchorderasc">升序</label> <input type="radio" value="1" name="luckysheetpointconfigsearchorder" id="luckysheetpointconfigsearchorderasc"> <label data-tips="降序" for="luckysheetpointconfigsearchorderdesc">降序</label> <input type="radio" value="2" name="luckysheetpointconfigsearchorder" id="luckysheetpointconfigsearchorderdesc"> </div> </div> <div class="luckysheet-datavisual-content-row" style="margin-bottom: 0px;margin-top: 5px;height: 30px;"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:90%;text-align: left;"> <select data-width="70" data-tips="按照什么方式查询" name="luckysheetpointconfigsearchtype" id="luckysheetpointconfigsearchtype"> <option value="0" selected="selected">按照名称</option> <option value="1">按排序前%</option> </select> <input data-tips="查询关于点的关键字" id="luckysheetpointconfigsearchcontent" type="text" class="luckysheet-datavisual-config-input-no" style="width:40%;" placeholder="查询内容" /> <button id="luckysheetpointconfigsearchcomfirm" class="btn btn-primary luckysheet-model-conform-btn">查询</button> </div> </div> </div> </div> <div class="luckysheet-chart-point-config-left-mid"> <span id="luckysheet-chart-point-btn-all" class="luckysheet-mousedown-cancel">全选</span> - <span id="luckysheet-chart-point-btn-clear" class="luckysheet-mousedown-cancel">清除</span> - <span id="luckysheet-chart-point-btn-contra" class="luckysheet-mousedown-cancel">反选</span><span style="text-decoration:none;color:#8D8D8D;float:right;margin-right:40px;cursor:default;" class="luckysheet-mousedown-cancel">可以直接框选数据点</span> </div> <div class="luckysheet-chart-point-config-left-bottom"> <div class="luckysheet-chart-point-searchitem-c luckysheet-noselected-text">  </div> </div> </div> <div class="luckysheet-chart-point-config-right"> <div class="luckysheet-chart-point-itemconfig"> <div class="luckysheet-datavisual-content-row" style="font-size: 16px;font-weight: bold;"> 数据点设置 </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">图形颜色</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <input data-tips="颜色" class="luckysheet-datavisual-config-colorOpacity" id="scattersingleitemstylecolor" type="text" data-bigclass="scattersingle" data-attr="itemstyle" data-func="color" /> </div> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">图形大小</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-sliderdiy="scattersingleallsymbolsizeslider" data-tips="点大小设置" name="scattersingleallsymbolsize" id="scattersingleallsymbolsize" data-width="50" data-bigclass="scattersingle" data-attr="all" data-func="symbolsize"> <option value="4" selected="selected">4px</option> <option value="6">6px</option> <option value="8">8px</option> <option value="10">10px</option> <option value="12">12px</option> <option value="14">14px</option> <option value="16">16px</option> <option value="diy">自定义</option> </select> </div> </div> <div class="luckysheet-datavisual-content-row" style="display:none;"> <div data-tips="滑动修改点大小" id="scattersingleallsymbolsizeslider" data-bigclass="scattersingle" data-attr="all" data-func="symbolsize" class="luckysheet-datavisual-config-slider" style="width:70%;" data-min="1" data-max="50" data-step="1"></div> <input data-tips="自定义点大小" data-sliderid="scattersingleallsymbolsizeslider" id="scattersingleallsymbolsizesliderdiy" type="text" class="luckysheet-datavisual-config-input" data-bigclass="scattersingle" data-attr="all" data-func="symbolsize" placeholder="请输入" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersingleallsymbolsizesliderdiy">px</label> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">图形形状</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-tips="点类型设置" data-width="70" name="scattersingleallsymboltype" id="scattersingleallsymboltype" data-bigclass="scattersingle" data-attr="all" data-func="symboltype"> <option value="emptyCircle" selected="selected">空心圆</option> <option value="circle">圆形</option> <option value="emptyRectangle">空心矩形</option> <option value="rect">矩形</option> <option value="roundRect">圆角矩形</option> <option value="emptyTriangle">空心三角</option> <option value="triangle">三角形</option> <option value="emptyDiamond">空心菱形</option> <option value="diamond">菱形</option> <option value="droplet">水滴</option> <option value="pin">标注</option> <option value="arrow">箭头</option> <option value="heart">心形</option> <option value="star">星星</option> </select> </div> </div> <div class="luckysheet-datavisual-content-rowsplit-sub"></div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">边框粗细</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-sliderdiy="scattersingleitemstyleborderwidthslider" data-tips="点边框粗细" name="scattersingleitemstyleborderwidth" id="scattersingleitemstyleborderwidth" data-width="50" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderwidth"><option value="0" selected="selected">无</option> <option value="1">1px</option> <option value="2">2px</option> <option value="3">3px</option> <option value="4">4px</option> <option value="5">5px</option> <option value="6">6px</option> <option value="7">7px</option> <option value="8">8px</option> <option value="diy">自定义</option> </select> </div> </div> <div class="luckysheet-datavisual-content-row" style="display:none;"> <div data-tips="滑动修改边框粗细" id="scattersingleitemstyleborderwidthslider" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderwidth" class="luckysheet-datavisual-config-slider" style="width:70%;" data-min="12" data-max="100" data-step="1"></div> <input data-tips="自定义边框粗细" data-sliderid="scattersingleitemstyleborderwidthslider" id="scattersingleitemstyleborderwidthsliderdiy" type="text" class="luckysheet-datavisual-config-input" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderwidth" placeholder="请输入" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersingleitemstyleborderwidthsliderdiy">%</label> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">边框样式</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-tips="点边框类型设置" data-width="50" name="scattersingleitemstyleborderlinetype" id="scattersingleitemstyleborderlinetype" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderlinetype"> <option value="solid" selected="selected">实线</option> <option value="dashed">虚线</option> <option value="dotted">点线</option> </select> </div> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">边框颜色</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <input data-tips="点边框颜色" class="luckysheet-datavisual-config-colorOpacity" id="scattersingleitemstyleborderlinecolor" type="text" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderlinecolor" /> </div> </div> <div class="luckysheet-datavisual-content-rowsplit-sub"></div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;"><i class="fa fa-th-large" aria-hidden="true"></i> 文字标签</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <label data-tips="显示数据点的标签" data-bigclass="scattersingle" data-attr="label" data-func="labelshow" for="scattersinglelabellabelshow">显示</label> <input type="radio" checked="checked" value="1" name="scattersinglelabellabelshow" id="scattersinglelabellabelshow" data-bigclass="scattersingle" data-attr="label" data-func="labelshow"> <label data-tips="隐藏数据点的标签" data-bigclass="scattersingle" data-attr="label" data-func="labelshow" for="scattersinglelabellabelshow1">隐藏</label> <input type="radio" value="0" name="scattersinglelabellabelshow" id="scattersinglelabellabelshow1" data-bigclass="scattersingle" data-attr="label" data-func="labelshow"> </div> </div> <div class="luckysheet-datavisual-content-row" style="height:auto;line-height: initial;margin-left:auto;" showfor="scattersinglelabellabelshow1" hidefor="scattersinglelabellabelshow"> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:40%;">数值比例</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:50%;"> <select data-tips="刻度数值放大比例" name="scattersinglelabelformatratio" id="scattersinglelabelformatratio" data-bigclass="scattersingle" data-attr="label" data-func="formatratio"> <option value="0.01">乘以100</option> <option value="0.1">乘以10</option> <option value="1" selected="selected">默认</option> <option value="10">除以10</option> <option value="100">除以100</option> <option value="1000">除以1000</option> <option value="10000">除以1万</option> <option value="100000">除以10万</option> <option value="1000000">除以一百万</option> <option value="10000000">除以一千万</option> <option value="100000000">除以一亿</option> <option value="1000000000">除以十亿</option> </select> </div> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:40%;white-space: nowrap;">小数位数</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:50%;"> <select data-tips="数值小数点位数" name="scattersinglelabelfloatlen" id="scattersinglelabelfloatlen" data-bigclass="scattersingle" data-attr="label" data-func="floatlen"> <option value="auto" selected="selected">自动显示</option> <option value="0">整数</option> <option value="1">1位小数</option> <option value="2">2位小数</option> <option value="3">3位小数</option> <option value="4">4位小数</option> <option value="5">5位小数</option> <option value="6">6位小数</option> <option value="7">7位小数</option> <option value="8">8位小数</option> </select> </div> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:20%;">标签格式</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:70%;"> <select data-sliderdiy="scattersinglelabelcontentformatslider" data-tips="标签显示格式" name="scattersinglelabelcontentformat" id="scattersinglelabelcontentformat" data-bigclass="scattersingle" data-attr="label" data-func="contentformat"> <option value="default" selected="selected">默认</option> <option value="1">仅数据名</option> <option value="2">数据名+2维数值</option> <option value="5">数据名+全部数值</option> <option value="diy">自定义</option> </select> </div> </div> <div style="display:none;"> <div class="luckysheet-datavisual-content-row" id="scattersinglelabelcontentformatslider"> <div style="text-align:center; width:60px; display:inline-block;">数据名称</div> <label data-tips="是否显示数据名" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelshow" for="scattersinglelabeldatalabelshow" style="font-weight:bold;"><i class="fa fa-eye" aria-hidden="true"></i></label> <input type="checkbox" checked="checked" name="scattersinglelabeldatalabelshow" id="scattersinglelabeldatalabelshow" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelshow"> <input data-tips="显示在数据名前部文字" placeholder="前缀" id="scattersinglelabeldatalabelprefix" type="text" class="luckysheet-datavisual-config-input" style="width:60px;height:19px;" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelprefix" /> <input data-tips="显示在数据名尾部文字" placeholder="后缀" id="scattersinglelabeldatalabelsuffix" type="text" class="luckysheet-datavisual-config-input" style="width:60px;height:19px;" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelsuffix" /> <label data-tips="是否在数据名后换行" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelline" for="scattersinglelabeldatalabelline" style="font-weight:bold;">换行</label> <input type="checkbox" checked="checked" name="scattersinglelabeldatalabelline" id="scattersinglelabeldatalabelline" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelline"> </div> </div> <div class="luckysheet-datavisual-content-row" > <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">标签位置</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-sliderdiy="scattersinglelabellabelplaceslider" data-tips="标签距离图形位置" data-width="70" name="scattersinglelabellabelplace" id="scattersinglelabellabelplace" data-bigclass="scattersingle" data-attr="label" data-func="labelplace"> <option value="top" selected="selected">顶端</option> <option value="left">左侧</option> <option value="right">右侧</option> <option value="bottom">底部</option> <option value="inside">内部居中</option> <option value="diy">自定义</option> <option value="insideLeft">内部左侧</option> <option value="insideRight">内部右侧</option> <option value="insideTop">内部顶端</option> <option value="insideBottom">内部底端</option> <option value="insideTopLeft">内部左上</option> <option value="insideBottomLeft">内部左下</option> <option value="insideTopRight">内部右上</option> <option value="insideBottomRight">内部右下</option> </select> </div> </div> <div class="luckysheet-datavisual-content-row" style="display:none;height:65px;"> <div data-tips="滑动修改点文本水平位置" id="scattersinglelabellabelplaceslider" data-bigclass="scattersingle" data-attr="label" data-func="labelplacediy" class="luckysheet-datavisual-config-slider" style="width:70%;" data-min="-100" data-max="100" data-step="1"></div> <input data-tips="自定义点文本水平位置" data-sliderid="scattersinglelabellabelplaceslider" id="scattersinglelabellabelplacesliderdiy" type="text" class="luckysheet-datavisual-config-input" data-bigclass="scattersingle" data-attr="label" data-func="labelplacediy" placeholder="请输入" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersinglelabellabelplacesliderdiy">px</label> <br /> <div data-tips="滑动修改点文本垂直位置" id="scattersinglelabellabelplaceslider1" data-bigclass="scattersingle" data-attr="label" data-func="labelplacediy" class="luckysheet-datavisual-config-slider" style="width:70%;" data-min="-100" data-max="100" data-step="1"></div> <input data-tips="自定义点文本垂直位置" data-sliderid="scattersinglelabellabelplaceslider1" id="scattersinglelabellabelplaceslider1diy" type="text" class="luckysheet-datavisual-config-input" data-bigclass="scattersingle" data-attr="label" data-func="labelplacediy" placeholder="请输入" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersinglelabellabelplaceslider1diy">px</label> </div> <div class="luckysheet-datavisual-content-row"> <label data-tips="加粗" data-bigclass="scattersingle" data-attr="label" data-func="labelbold" for="scattersinglelabellabelbold" style="font-weight:bold;"><i class="fa fa-bold" aria-hidden="true"></i></label> <input type="checkbox" name="scattersinglelabellabelbold" id="scattersinglelabellabelbold" data-bigclass="scattersingle" data-attr="label" data-func="labelbold"> <label data-tips="斜体" data-bigclass="scattersingle" data-attr="label" data-func="labelitalic" for="scattersinglelabellabelitalic" class="luckysheet-datavisual-content-column-italic"><i class="fa fa-italic" aria-hidden="true"></i></label> <input type="checkbox" name="scattersinglelabellabelitalic" id="scattersinglelabellabelitalic" data-bigclass="scattersingle" data-attr="label" data-func="labelitalic"> <select data-sliderdiy="scattersinglelabellabelfontsizeslider" data-width="50" data-tips="字体大小" name="scattersinglelabellabelfontsize" id="scattersinglelabellabelfontsize" data-bigclass="scattersingle" data-attr="label" data-func="labelfontsize"> <option value="12">12px</option> <option value="14">14px</option> <option value="16">16px</option> <option value="18">18px</option> <option value="20">20px</option> <option value="22">22px</option> <option value="24">24px</option> <option value="30">30px</option> <option value="36">36px</option> <option value="diy">自定义</option> </select> <input data-tips="字体颜色" class="luckysheet-datavisual-config-color" id="scattersinglelinelabelcolor" type="text" data-bigclass="scattersingle" data-attr="label" data-func="labelcolor" /> </div> <div class="luckysheet-datavisual-content-row" style="display:none;"> <div data-tips="滑动修改字体大小" id="scattersinglelabellabelfontsizeslider" data-bigclass="scattersingle" data-attr="label" data-func="labelfontsize" class="luckysheet-datavisual-config-slider" style="width:70%;" data-min="12" data-max="100" data-step="1"></div> <input data-tips="自定义字体大小" data-sliderid="scattersinglelabellabelfontsizeslider" id="scattersinglelabellabelfontsizesliderdiy" type="text" class="luckysheet-datavisual-config-input" data-bigclass="scattersingle" data-attr="label" data-func="labelfontsize" placeholder="请输入" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersinglelabellabelfontsizesliderdiy">px</label> </div> </div> </div> </div> </div> <div class="luckysheet-chart-point-config-chart"> <div id="luckysheet-chart-point-config-chart-c" class="luckysheet-chart-point-config-chart-c"> </div> </div> </div>',luckysheetToolHTML='<div id="luckysheet-tooltip-up" class="jfk-tooltip" role="tooltip" aria-hidden="true" style="left: 505px; top: 410px;"><div class="jfk-tooltip-contentId">组合图表</div><div class="jfk-tooltip-arrow jfk-tooltip-arrowup" style="left: 35.5px;"><div class="jfk-tooltip-arrowimplbefore"></div><div class="jfk-tooltip-arrowimplafter"></div></div></div>',menuToolBar='<div class="luckysheet-toolbar-left-theme"> </div> <div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="撤销 (Ctrl+Z)" id="luckysheet-icon-undo" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-undo" style="user-select: none;"> </div> </div> </div> </div> </div> <div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="重做 (Ctrl+Y)" id="luckysheet-icon-redo" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-redo" style="user-select: none;"> </div> </div> </div> </div> </div> <div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="格式刷" id="luckysheet-icon-paintformat" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-paintformat" style="user-select: none;"> </div> </div> </div> </div> </div> \x3c!--<div class="luckysheet-toolbar-separator luckysheet-inline-block" style="user-select: none;"> </div> <div class="luckysheet-toolbar-zoom-combobox luckysheet-toolbar-combo-button luckysheet-inline-block" data-tips="缩放" id="luckysheet-icon-zoom" style="user-select: none;"> <div class="luckysheet-toolbar-combo-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-combo-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div aria-posinset="4" aria-setsize="7" class="luckysheet-inline-block luckysheet-toolbar-combo-button-caption" style="user-select: none;"> <input aria-label="缩放比例" class="luckysheet-toolbar-combo-button-input luckysheet-toolbar-textinput luckysheet-mousedown-cancel" role="combobox" style="user-select: none;" tabindex="-1" type="text" value="100%"/> </div> <div class="luckysheet-toolbar-combo-button-dropdown luckysheet-inline-block " style="user-select: none;"> </div> </div> </div> </div> --\x3e <div class="luckysheet-toolbar-separator luckysheet-inline-block" style="user-select: none;"> </div> <div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="货币格式" id="luckysheet-icon-currency" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block" style="user-select: none;"> ¥ </div> </div> </div> <div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="百分比格式" id="luckysheet-icon-percent" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block" style="user-select: none;"> % </div> </div> </div> <div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="减少小数位数" id="luckysheet-icon-fmt-decimal-decrease" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-icon luckysheet-inline-block toolbar-decimal-icon" style="user-select: none;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-decimal-decrease" style="user-select: none;"> </div> </div> </div> </div> </div> <div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="增加小数位数" id="luckysheet-icon-fmt-decimal-increase" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-icon luckysheet-inline-block toolbar-decimal-icon" style="user-select: none;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-decimal-increase" style="user-select: none;"> </div> </div> </div> </div> </div> <div class="luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="更多格式" id="luckysheet-icon-fmt-other" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;"> 123 </div> <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="luckysheet-toolbar-separator luckysheet-inline-block" style="user-select: none;"> </div> <div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block" data-tooltip="字体样式" id="luckysheet-icon-font-family" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;"> 微软雅黑 </div> <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="luckysheet-toolbar-separator luckysheet-inline-block" style="user-select: none;"> </div> <div class="luckysheet-toolbar-zoom-combobox luckysheet-toolbar-combo-button luckysheet-inline-block" data-tips="字号大小" id="luckysheet-icon-font-size" style="user-select: none;"> <div class="luckysheet-toolbar-combo-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-combo-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div aria-posinset="4" aria-setsize="7" class="luckysheet-inline-block luckysheet-toolbar-combo-button-caption" style="user-select: none;"> <input aria-label="字号大小" class="luckysheet-toolbar-combo-button-input luckysheet-toolbar-textinput luckysheet-mousedown-cancel" role="combobox" style="user-select: none;" tabindex="-1" type="text" value="10"/> </div> <div class="luckysheet-toolbar-combo-button-dropdown luckysheet-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="luckysheet-toolbar-separator luckysheet-inline-block" style="user-select: none;"> </div> <div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="粗体 (Ctrl+B)" id="luckysheet-icon-bold" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-bold" style="user-select: none;"> </div> </div> </div> </div> </div> <div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="斜体 (Ctrl+I)" id="luckysheet-icon-italic" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-italic" style="user-select: none;"> </div> </div> </div> </div> </div> <div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="删除线 (Alt+Shift+5)" id="luckysheet-icon-strikethrough" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-strikethrough" style="user-select: none;"> </div> </div> </div> </div> </div> <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block" data-tips="文本颜色" id="luckysheet-icon-text-color" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-color-menu-button-indicator" style="border-bottom-color: rgb(0, 0, 0); user-select: none;"> <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-text-color" style="user-select: none;"> </div> </div> </div> </div> </div> </div> </div> <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="颜色选择..." id="luckysheet-icon-text-color-menu" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="luckysheet-toolbar-separator luckysheet-inline-block" style="user-select: none;"> </div> <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block" data-tips="单元格颜色" id="luckysheet-icon-cell-color" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-color-menu-button-indicator" style="border-bottom-color: rgb(255, 255, 255); user-select: none;"> <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-cell-color" style="user-select: none;"> </div> </div> </div> </div> </div> </div> </div> <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="颜色选择..." id="luckysheet-icon-cell-color-menu" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block" data-tips="边框" id="luckysheet-icon-border-all" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-all" style="user-select: none;"> </div> </div> </div> </div> </div> <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="边框类型..." id="luckysheet-icon-border-menu" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block" data-tips="合并单元格" id="luckysheet-icon-merge-button" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-merge" style="user-select: none;"> </div> </div> </div> </div> </div> <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="选择合并类型..." id="luckysheet-icon-merge-menu" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="luckysheet-toolbar-separator luckysheet-inline-block" style="user-select: none;"> </div> <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block" data-tips="水平对齐" id="luckysheet-icon-align" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-left" style="user-select: none;"> </div> </div> </div> </div> </div> </div> <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="对齐方式..." id="luckysheet-icon-align-menu" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block" data-tips="垂直对齐" id="luckysheet-icon-valign" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-bottom" style="user-select: none;"> </div> </div> </div> </div> </div> </div> <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="对齐方式..." id="luckysheet-icon-valign-menu" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block" data-tips="文本换行" id="luckysheet-icon-textwrap" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-overflow" style="user-select: none;"> </div> </div> </div> </div> </div> </div> <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="换行方式..." id="luckysheet-icon-textwrap-menu" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block" data-tips="文本旋转" id="luckysheet-icon-rotation" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none" style="user-select: none;"> </div> </div> </div> </div> </div> </div> <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="旋转方式..." id="luckysheet-icon-rotation-menu" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="luckysheet-toolbar-separator luckysheet-inline-block" style="user-select: none;"> </div> <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block" data-tips="冻结首行" id="luckysheet-freezen-btn-horizontal" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;"> <i class="fa fa-list-alt"> </i> 冻结首行 </div> </div> </div> </div> <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="更多选项..." id="luckysheet-icon-freezen-menu" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="luckysheet-toolbar-separator luckysheet-inline-block" style="user-select: none;"> </div> <div class="luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="排序和筛选" id="luckysheet-icon-autofilter" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-autofilter" style="user-select: none;"> </div> </div> <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block " style="user-select: none;margin-left: 0px;margin-right: 4px;"> </div> </div> </div> </div> <div class="luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="查找替换" id="luckysheet-icon-seachmore" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;font-size: 14px;"> <i class="fa fa-search" aria-hidden="true"></i> </div> <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block" style="user-select: none;margin-left: 0px;margin-right: 4px;"> </div> </div> </div> </div> <div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block" data-tips="自动求和" id="luckysheet-icon-function" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function" style="user-select: none;"> </div> </div> <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;"> 求和 </div> </div> </div> </div> <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="更多函数..." id="luckysheet-icon-function-menu" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block " style="user-select: none;"> </div> </div> </div> </div><div class="luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="条件格式" id="luckysheet-icon-conditionformat" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;"> 条件格式 </div> <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="批注" id="luckysheet-icon-postil" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;"> 批注 </div> <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="luckysheetfulltoolbar" id="luckysheet-pivot-btn-title"> <i aria-hidden="true" class="fa fa-cube"> </i> 数据透视表 </div> <div class="luckysheetfulltoolbar" id="luckysheet-chart-btn-title"> <i class="fa fa-pie-chart"> </i> 图表 </div> <div class="luckysheetfulltoolbar" id="luckysheet-chart-btn-screenshot"> <i class="fa fa-object-group"> </i> 截图 </div> <div class="luckysheetfulltoolbar" id="luckysheet-splitColumn-btn-title"> <i class="fa fa-gg"> </i> 分列 </div>',luckysheetlodingHTML='<div id="luckysheetloadingdata" style="width:100%;text-align:center;position:absolute;top:0px;height:100%;font-size: 16px;z-index:1000000000;background:#fff;"><div style="position:relative;top:45%;width:100%;"> <div class="luckysheetLoaderGif"></div>  <span>渲染中...</span></div></div>';luckysheet.jfcolor=["#c1232b","#27727b","#fcce10","#e87c25","#b5c334","#fe8463","#9bca63","#fad860","#f3a43b","#60c0dd","#d7504b","#c6e579","#f4e001","#f0805a","#26c0c0","#c12e34","#e6b600","#0098d9","#2b821d","#005eaa","#339ca8","#cda819","#32a487","#3fb1e3","#6be6c1","#626c91","#a0a7e6","#c4ebad","#96dee8"];var keycode={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,PAUSE:19,CAPSLOCK:20,ESC:27,SPACE:33,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,WIN:91,WIN_R:92,MENU:93,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLLLOCK:145},visibledatarow=[],visibledatacolumn=[],rowsplit=[],rowsplitlen=2e4,colsplit=[],colsplitlen=12e3,ch_width=0,rh_height=0,iscopyself=!0,toolbarHeight=35,infobarHeight=30,calculatebarHeight=30,rowHeaderWidth=46,columeHeaderHeight=20,cellMainSrollBarSize=12,sheetBarHeight=27,statisticBarHeight=23,copyType="normal",copysetting=[],luckysheetTableContentHW=[0,0],defaultcollen=73,defaultrowlen=19;luckysheet.defaultcollen=defaultcollen,luckysheet.defaultrowlen=defaultrowlen;var luckysheet_select_status=!1,luckysheet_select_save=[{row:[0,0],column:[0,0]}],luckysheet_selection_range=[],luckysheet_copy_save={},luckysheet_paste_iscut=!1,luckysheet_filter_save={row:[],column:[]},luckysheet_conditionformat_save=[],clearjfundo=!0,sourcechange=!0,config={},filterchage=!0,luckysheetCellUpdate=[],luckysheetRightHeadClickIs="column",luckysheet_sheet_move_status=!1,luckysheet_sheet_move_data=[],luckysheet_scroll_status=!1,luckysheetisrefreshdetail=!0,luckysheetisrefreshtheme=!0,luckysheetcurrentisPivotTable=!1,luckysheetautoadjust=null,luckysheetautoadjustmousedown=2,luckysheetautoscrollp=[0,0],devicePixelRatio=1,luckysheetdefaultstyle=null,luckysheet_shiftkeydown=!1;luckysheet.flowdata=null,luckysheet.currentSheetIndex=0,luckysheet.luckysheet_shiftpositon=null;var jfcountfuncTimeout=null,jfautoscrollTimeout=null;luckysheet.jfredo=[],luckysheet.jfundo=[],luckysheet.modelHTML=modelHTML;var luckysheet_CFiconsImg=new Image;luckysheet_CFiconsImg.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZoAAAGACAYAAACUS6SeAAAACXBIWXMAAC4jAAAuIwF4pT92AAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAHBbSURBVHja7J13mFxV+cc/M7OzLbvpjZBKQhISUgAhgAlVkADSRcDyky4iYAAhAmpQQtMIiqigYkV6FRHphgBBKSGBkB5IIb1sdrO72dmZ+f3xniGTzZR755a5s/t+nmefTGbuPec7Z8497ynveU9on5m3YJMuwNnAt4B9gA3A48CPgY0UyPxJUzN/MLMShxwDXAMcAmwGbgD+UlBKhzVn/+yqqwrVFwIuBL7tZnkyYwaK98yaNb/QW6uBk4DLgfHAduDfwI+ApYUmOnHiKC+0AowAfgh8EYgAvwF+AMTd1OlQ40nAtcB+QIMpzx8Cy70oT8U6YZvXn2x+tN8A44ByYE/gMmA18B9g7wB9v58AzwNfADoBA4A/m4c5KPwWuCdDef4X6KVVtF1yGPAx8IDpAFUBPYGvAguBucCRAdJ7CvAecA7QA+gKfB94DKgMiMargaeAQ0159gK+BrwNqLUoIUNzFPAw0C3L5+XmAXoZ6B+A7/ZNM3rJxDTgl2Y0UUwmAxdl+WwI8HOtou2OzwFP5+hERIAxwDPAhADoHQvcbxrvTB3PZ4HaImscDmSbmukO/F6rXWkYmgnAP4wxyUd/U/m6FPF7lQO35bnmMuCvQLSIOs/J8/npQIVW03bDPjaejWrgn8boFJPpRks2jgReKfLo+yygLMfnhwCDtPoF29CMMUam2ka6Y8wDVV2k73Uw0NvCdV9F1kOqiqQzX+WvQqfP2gsDkWlcO79nD/McFWuGoAJZk8nHAcBM8x2LwRAL1+ytVTC4hmawqeiFNHaHInPQkSJ8rxob156ILBp2LYLOkAu/kRJ8egEvFWgw+iPT0cXocJTnGSmkMxJ4zfxbDJ1WjKYSQEPTC3jBYW/qJODX+L8WMhuos3H9JDP876NVQnGZLsbIDHOQxt5mVqGTz9rrgTdtjtpmmhGOouQ1NF2MkRnmQh4XATf7/L02GyO3zcY944FZZhSnKG5QDfwLd9ZZJiBOBOU+f4evAAtsjt5eIVhec0oADU21qdDjXMxnKnCJz99tJuIpt97GPcOA14HRWjUUh5QDTyAL0W5xFPAn/J2OXoV4k75j455aZMr9ZK0GSiZDE0XWVQ7zIK+7kI2efvKO+S6f2LinnzFSB2v1UAokAvwNONaDtM82z5KfbDBG7lUb91Qi+2z+T6uDkm5oQsAfkSknrx6+P5kK6ycLkTWYj2zc0x14EYkqoCh2CCGbcL/sYR6XIDve/WQbsu/rKZvP/B+BKVotOjbpHiW/RNx9vZ5OeByZv32vwDQmG51DsOdJYne/TCdk09xXgUcdfN9DkE2urwGbXCjDLsDvEG+5rcCTSASENVqdA8HtwAU+5HOjGWn8psD7RxmDNRZ7TgZ2p+1CyMbjzkZzoR3izyGOSf8DVrrUFv0S2cvWgqyl3Qgs0SrsnaH5IfAdn/LsgrgTH2rzR031FC/ysXzKzSjsBex5sQGci2wa7ZXWIzzZ5vRDW6oR76NJ5v9VprE4wxie/2qVLirXIaFQ/OIu03l52OZ93wTuxd/NytOQdZv/2bzvGMRzNeWY1Aqch2y2djLqvK9Nx/prSKidc8wzprhI2PxoN/qcby/Tg7CzN+BbPhuZ9JHNWTbvmW4qcvr362xGH/sXqCOCrJ9NylKezwB9tUoXjfPM7+4nEdPg2pmOHoXE1itGRIyLbV7/VdNODGvTOXY6xf8rMs/e1AAPoc5Anhia64uU9zDsxSD6VhHL6ds2e2DX5RjNPYd9t/GQeThOymO8r9cqXTSKVfblyNRuZ4vXX4D/LtLpowarcdGGmPYhksXAPkhh671T8zzPVfi/HaNDGJo9LF77EWAlhvetNvK342s/oojlZGe387UWRnN2A4/ebNHQnqpVumhYfY5WIfu18vFzZO3ACt2QfWBW2KeIZVSB9ZhjV5A7MnQVst5rZ3PoNy0akckUL3xWuzU0b1h8OI5FNkLm4zc2jI2dDZUbi1hOG2xce6iFawYg61TdLVx7iemFWaGzVumi8YbFenQcsMLCtS8jrsxWz3tpKIHnCGCLxeusRK7ugkytWYl1dpIZIVmJUhLFXhgrxYKhud3Cw3GUMTZWuQ5ZuM/HEzbSfLqI5fSkjWuten+Nwto5GVNt5P2KVumike8EwTrEYeNDG2k+jkQZz8cyrHtxPlHEMnoLObfKTYPUC2ubYi/Cusfc+9jb6K1YMDTP5xhO1plh5GKb6SYRL7an8/Ss7Cye/gg5LMpvmhCPGatML9JvuQR/3GqVzLyU47dvBE6jMK/A35B9zS/1rH3X/GvV0DxVpDK6zsa1P8H61KHbsxdnaHV239CALGSex65TRNsQd793Ckw7bob+r2X5MU8E1tqsABOQHdfNPpbRbJvTDffZNExuPRyTsTfFp7jPDchO+LVtjMyZyFSYk9HS3VmesSuw546bRDaT3oi/02hbsrQF2XgT2SIQ91FjI/AldC+N66Rv2PwjcpLeoUjI/FkuVMTUD/d7Y1i24GyD4Xrg66bn3gfrIcwxUxDftZnfJxTmUn2jGdJf6sNvmBp16sMRDP6CuKEfjBzP/KbNDlWu+rsNcQqJIGGSbkKmo+wSM52hn5jnyM5xzIcj0+J2PNe2m05nzKbOvyPrML/24XdrQQKIvqVV2FtDkyrsVz1oCN0Ox7EDawuqIIt/PynAyHyALNyudtAwdMXbaAstZkrmHa3KgSJms/dudSRyHfamn6zMOnxq4/pTTaNvx8hsAk5w0ID/BnGaucnD3yuJzOg8o1XXG9r7oVoRJFyL3T0Os5BgnKtdqLxeOTHETfovazVWfOAi4BGbo5+V5jlyOkqYDvzCw+92HTKbo6ihsU3Kz/58m/c9jbhyb3FBQwvZ16mccpk+HIpP/BCJJmAnztl84PNY23tnhSke1fefYW/vn6KG5jO6IN50dsNU/AGZimpyUUtqnWqei2neSuHBFBXFKiHECcFuiKo3kVBJK13UkkQ2XLo5Q3A/cI3+zGpoCuVeYGIBw/ML8cbLpQ44GncW7H+Hu/P0ipKNb2Mv/BLIOscXsLa52y6tZobgPy6k9SIy9ZzUn1kNTaF80ca1CeByxDXVy0q3AZmSW+UgjaeRSAH6cCh+MNnm9X9CHAYaPdTUiERBn+sgjbdMGi36EwfT0Fhp4BIB+F5Wp75akLDgfp1YuBw4nsLOpXkDeyFJFMUp221ce5sZIbT6oKvOjJoKmSFYgkxlN+rPG1xDk8+luIlgbBq0Emaj3jT6D/msbR7i7tlo857j9eFoN6x04VnzAysRBJLIQv1Un0fahcwQrEK2LOjG5oAbmnxeH48he1yKzfQ8lWkdEjn6pSLpewtxVGix+HAcj/2D15Tg8mCekf/7uOs84kTnm3lmBL4G3FkkfXZmCOrMtUu1+vlPmc3r/4UsRl+Y5Ue/MiDfa7UZNfyT3Q9XW4as4RR7J/1LyE7k+5Aw722JmYf8Apyt6yjBYw4Su+8nGT7bioSxCQIJJAzVv9j9wL4G4HTEu7OYzEPWkv6BRDloS9xcc4mbxnvWrPmB+IEmThxVEhW+EGeAi82PNtf0aFYju4UPCtiQ9H/AOGT9ZRUyrfcY4tsflHAtTyIhzi/NUJ79kHAfi1HaIzchMdBmI7H7NpsRxEFmRBMU1iMenFORM6l2GM2HB8DIpD/rQ0x5vmnKcxMyA7M3sJ/RrJTIiAZkHva3WDsGoNisQTzKLg+wxjpjWH6t1bFDUY1sgEyav4TpfScCqLUJWey/LcDl2YRELnikBH77k5EDEsebkeG/KF50en8MzfxJU/WRd4MZM7QMFKschhy/nD6tW4XExTsL2U1/BR3wfKHUVFCxp6Y8nJK6po3BrgK+gawfTQIW6IimKI9kM4rSjvgcsh+qS5bPI8AYZOPjUbgYTXjixFFWGvAIsmbY3fzb9nWuz3Yga7h3k8VrzmEDPhwYbUYBb2L9VNFUg/4dY8hHmbZvCTKd/jNkbcxrRpL97K+eSJifw9XQKIrihH2AZ3MYmXSqEWeWI/HOA60PEl7mc0APYzScHAdebXrs1yBrjlchO/Cd0h/4K3BE2nv1yHTTneR3q+6OBJ8dl6Hhv96MJCfhvdPN2eSOF3cYMJBguLa7a2hGvVb8eHLtYvruqquCo0Wn8YLIQGTxvJeNe3oYw3SIB41gZyRK+TCPvu9Y4DkkUsA/HKTTAwlKO7jN+7XAz5HF/kvzGJvpGYxMOoMR54xvelwHBlu4ZkB7NDRhff4VxXN6Ie7s/Qvszb9s00BZ4bseGpkUEeTQw04O0rg+TwN9CRIMN9dIYYKFfD7nR8fewjWh9vgAhB1WgM3m73qUFF8CPkRCcSR9+ms1eZ6kxR84uhgj46RR39uMCjq5qOsMn75/byQieqGcbuGac5GTTbMZGysLvT20qgbP0HzJDDVTi4A3aSP3GX9GFhsjPuYZMXn+RYs/UFQjrqtjXEhrAuJEUO6StmE+lsP3HdxrdRR4DvBwlvKxEkm6m1bXYBma/mTe8zHDg+F9KfJQB81b2ZVyJObeIS6meRQSIdmNToyf+3VGOrjXztrUaYgXWUUBhqYC8UxTAmBouiCLk/2z9JAecrHHVapcgr1z2N3ieiRqg1J8IsDfkKCPbnM27kQb93OjipN1h6dsXn8iMs1Ynfae1dNydVTjEWU2H57780wDHImc7X2JawpnVgantKzv6TkTWcD1y+g+CNyi1TkQhJCoGV/2uDOzFvixgzQeBg70qUycbIb7MbKTfqCNe44xHeITkb02dgzNp1qFizuiuQsJVJmPb2H/VL72xuv4d3rf28D56GFoQeF2JBCq19zosEP3K5wdHmYHJxHdNxrDYfdY6FQsti42DI1Th4Awspb2JSRWoRuUIxs5601Z/AUY2l4NzVSblfpOZD7ZbWqR8A2fIHPMXnlxJUwet5k8C+F+vD9y+VO8P9FQsc51wNU+5neXGT0XOso4GtnJPx8JTPk8Mv39G2QH+/eQTZfFrl+LjOH42OZ9hyAef1an7pxMnU0GFiLBO59Gotmf5fB7p6ZgLwJqjCH8OhL9e3IpPRhWps5OQjY82SFqKuwhuBcpuRqYiQSi82P6YyCyw/lYJOJzIQ/brchu8G94NB1xGnqEQFA4r4DnxCkRZMf8RmSqtpDRwkU5Pu9sjE91AMp3ObJz/kUkFI1VDjDPoJeG5qtmpBFuMxL5i2k3nnbQkcg0BVuDxMo7gBKJjZZvRDMBeIDCvNN6Il43XVzSer1PRqYt43G2T+jCAhsBK+m+hRIUirWXrNw0Op1dTrcaibc2IUBlvBIJQ/NRAd/FK0OzN7JhNJylw/2AMZB2yTeLVF2Ejo0nhmYvdvfesMu+Zujnhjvm2UUsJyd5t5iRh5vxqm435aoEhz0sXrcKCf2Sj59j7QTWVAPpZiesCvH2mhTAcl6DTKPN8SDtQgzNVezuTt3WIDyNhOSxyiVkD76ZzomzZs0vD8ohbIUYmi7IoVxu7Is50WKh5WPPIpaT07zrkLUUNw6Gewbv134U+7xh4ZoNyJn1VmJZvWw6OHGL+Te49D1SI6QvBLisNyDrS28HwNAcYOGaLsiU3xAL156ETJmFLP5WnUrh4QhnEf847uxmTnENcra4E1YXsZzcyHsp4o3iZGH1Q1OOcZSgkc+9vM50uj60kebjwGUWrlsGvOfCdyhDXOWPd7ls6jwo783GGL7uYprdC7hnq8XremFt8+73sD4D9DbWPeoCZ2juxRuPsd/hbL73gSKWk1t5v2V6qYW4Im9Czm+vQwkiL5F9zrwRmT79bwHp/ibPCDaJBMh06t6e8nA6tYTKvM6MEP9TREPzQ6xPcbo9qju7VH6otoZmKvB/HuVVaXpo/Qu8fzrezMvmYw7uLro9jf2pr1bEjXUJSpC5wTw/a9sYmdQGXiejpbszvB9HTuL8h0PdISTK8lds3vc84tJbTBrMCOzfLqRVyNTZm/i3Zy69Tn2plNqDdEPzVdxZS8lFP2Nsqgss3MOQmGp+nNewAlmQPQz39xHcanqqVvku3niuKe7zF8Q1/jAzihmKHGDmlMuMwdkCbEPW6j6P83A0IVMXv2nzvv+Y0Y9fvfnO5rvOR6ahlwLvINNHM3FnDbdQ9+b7kdM7/aDFzGyUlMdpah/NocB9+HMWwoGIO+A5BfQC6pENcVdT+lyGnLORb+PVPVl6s0pwiSGHdblJ0oyE3XYE+Tn2Y+S9ifP1Rrsd4ieREFde4mTD5q+RdZhpHupLmtHTC6X2QKQMzSP4GwzzLMTdN/8I6rBm2ilxZI71NbI7XrwCXK7ttuIRl5vRsh3eMZ2jeh91nuaDkXFqaEDCAvVCTvz0gmvN6KnkCJthc78i5D0dCT7YkalD5pcz7e5fisyZt6Ao7lNlGkY7zAO+yK4OKVY2czvtLZ7uU5m40au9zCNjcCvw01KtbGG8jTJrZWTT0VlF5iCkV+LOvhtFycQEoKuN6z9C9q5savO+lViAOxxqHe5TmfzZhTRS01vPuKjLj7iJnhua85EFNj/3ZsRNnv+nzzsgXkM3ID75683rp7VYFA+xEyx2CRJBeUOBowCnbUvYpzL5lUvptJjZCDf2+PwT/73aXKcMCTXxlD53RWc6JRS7SCl5rG4c/QTZV5dt0/LLFkYcTj2kluB9nMMluOuq3Ygcq5JrDRYL5XYm7WD6vEyfN5eYMUPLQCklliFhUXKFmlllPs91FsxU05B+PsvnryOL2E54AjjDw7JIIjvy3R411CHR319DTiC2a/j89Ozz1tDMnzRVHzlF8Rcrh3j5sVfsXNMIDs6i8RjybwqsQ/YMnYl4h40w7y9FTvF8GDnfyQkPIftUDvGgDLYi3ndPelTGaxEvvVexvtdnFeJl127WaHVEoyj+86DpQWdbe3gfd6N952rQPocccfBlJGrHKmRT9XRkvdAKCfOdHvRIZxyZhrrNGLVo2mchcjs1VJM5uvJyxJPrYazHKyuUJcbYvEb+Y1NyeaKWrqEZ9dqtgRCiIyufuOqqYOnpmFOOc4AfAT/J0sP200lmE+LheGVQCidL2Pst5D6kzRMNEyeOcivJecg02jNkjorfYurFFW52MoJyhEDpjGhmVhY3//a7cVQpDjchi89XIgvdjUjssB8Ci7V42iX/RaYpT0M2dY4HtgP/An6A/aOqS2dEU8A9XZAd7d9CjkjdYIbaP0aOhu3YtF+DGEJO9fy2/u6uUI1ETE6avwQyRZTQonHEPsZYH2PK91dIWJigHK3RiETJLoWDC7+JbEAdbUa+T5myXG83IbuG5mTgj+waqmFPI+ZiYDZwgY89sj2Rk0ArkXnaKvOXel1ptKa/rmxzTRVyBvd7wJ3I/pXt+rzuxm/bTF2kfvcTkc1/urnUOocjYZ/Sp1CqkMC2ZyF7zK5AQhAp1jkN2dyY3tu7ARiFxFbc4VZGqSm1Yk9NuTi115Y7TR1M0Q85+fN4YCI215DsGJqjkIWzbDHRypGFupcR7xAvF7MipuE7H/cCgR4E/N00mBfizt6iEOLZc4Xpae1AFgSnYf9skqh5YHoCnwKLfOylTSb7/PgQJDDj17Wds8SBpm51yVG3xyBz+UfhfZTersjR4HYX2TtlaQuWIlGmH0GiTPvFOPP8VmQxQM8iUY/9iNE2wjyrDUgAUjunn1aZ9uJMk0YYcSZ4xDxnfpxHdVgbI5POIKPjTDsJWt1xOwHZvW4l8GZ/86N28bAgrjYjJy+iTfcCHjOF7dTI3IdEqh5rHuIa02i/bvRboQb4mTGAc5C9D/ONsbkO66fxOeGcPJ+fTu5z05Wd0zr/tPhsVJtrx3ioJ2Ke1QtN47hX2t8QMwOQ7S9bWzAUOdtmKd7ufWnLLXnq4FHI4XQ9PNTQ34xCFyDTys+b5/S7Fu/vaTqgtwD7me8TZed04DvAHj6UZb4D1U7B5hHSVgzNGGNk7JwhM8ZU4GqPHg6vPWQipnF32jh/M8dI8l5knSsX5UhI8KsyNE69ERfUe32oeIMs9MJ6qR3JW4bP2yynHuY56u+Rpq/gzd6UVKP5EOJp5TVVFvM50MwoeFGePUzaR7R5vxa4A1krytcxvhnYN8fnQ43B8ZoBFmZXbJVhPkMz2FT0QhqRQ5EjkN3uce9jGlk/pjic9B7yGZEQcoZFrgOTTgUOzpPOuRYqhlNCLtSljkxvMxItpIHrj0xHe2HIvT62OYwcVOg1lTbamX2AWbgfqPN6Mm98TXEpcrZUrufkIAv5HBSQOl1utyJko5fpTTux/ieZxtTNKa4ePhbmjx0aRCsN+C/JfubMEItpDEIJKl2MkRnmII29zaxCJ5e1DfXh++9rsR47YQty0qad0eVMZHrKLawcZXAhEiE6m1GMWUijWyk+BOEcD8cLDh+OFBfh7hHRW30sHyfHGFhdAAwBvyDzdGCTxTRqUYJINbJHwo11lgmIR6SbBxT6FRH4Uh/yOANxkLFKHyQszOEu5W+1Q/41xGkhmsVg5qN7ezE01aZCj3Mxn6mIa5wbzMe/0/2cjMRetHn9DHY/otpqQL1qlKBRjgSDdHMN5CjgT7g3Hb3Ip7I414c8PkEceN61cU9n0xH4kgv52/GyPZPMpxpbMTRd8McByFNDE0XWVQ7zIK+7yO/NYIUY8DufysdJ5NRbsO+K+FNjlFNY3c+jhiZYRJD9HF4shJ9tniU3eMyn8vBrF/M6JBjlf2zcU4V4iH3NYd52t0OcbO6psmlooASnz8Jteu9/RNZVvHr4/mR6ZU6ZhvinB9nQLEWm3pps3ncLO0/Ts7oPoUbb9sAQQhZ9vXTtvQR3vI8eR6aPvGaLj+W/DdlC8A8b95QBfyH7WqkVfoz9vYPHsatH76b2amjSN2z+EtmZ7PV0wuOm1/Geg3TqETfCVMTZHcYo1JmGvRHx5jrZhUrrhOcQn/MnbI46ppvfZpbF62td+F0OMRX4NRsVPt8Q/3dI5ICtSBj2nwBr2rmhuR3ZSOw1NyJ7q37jII2EeUamI8c0p/ah1LEzFE4lEoLECZsd3LsvEnVkLPacIexGPUmtldZQ2JryRuTsHrvehUcD/0aiU/s1ooki3qw9gTfMSNApnZGtFieZ+vOPdOOb+jF+SG43WzfpYgr2UPKfdZGLFjM9kYkfuWBkwJ1QNM+bwn/aprG5EXEtt4KTqbNzkfDrvdKM68kOe7rVpqJNSpueuMT08k/EflSEUuE6dl9n85K7TKfgYYedqcty/I5PFtHQnGdGh34G//0JslH2/QLuXcjO6CiDbdw30bQTj/hgaL6C7Ozvl9bGnWmjrcnWUX2CnbNVVYiH3anGgP43bH7MG31+IHshi3Be7A24HplacwO3Trd7yRS43fSO99jQTEeiF/Rq0zN5Eti/wDQjyDrfpCy/+zNA33ZoZM7D/6O4I8BfcWc6ui01pvE5xoW0Cpk6G10EIwOynODEcWk54slmtxM9AevbKQo1NNcgZwb1S3uvkzFwBzuog/dnqYM9U8972DTMxWAYEqrCTaYi4dfdws1jVF9F5o4bPGoU7HIMO9eCMo06n8O+e3sI2QF9Up5ORrHqnJcU6zuVA4+aDoKbsw7P457rbyGG5iKKd4zJN3G2Z2mFKbuPCpgJsEIhLs4HI+u/2fJ9jsLc8O8i93pkL+AHYazvfv8IcS3Oh52T1I50sXJcnaMgnUwruMlMY2zcds8uZI0m3znuvcwUgJ355pvJHxEBvN+RXgysPkersLb29nNkethqD3e8S9+juxmBu+mWXYih2aeIv2UFzjdBf4qsI8/1QF8hI5qryb1Bv5DOpdVtKyeHkcUgKw/HsViba/2NDWPjVkM+BXENdhsvjguYZYyNm1FYC5k6O9TCNQOQ9TQrPahL2NU1OxedaX9YeY42IJ5GKyxc+zLiymw1QrcbI+XeJt8DXC6bQgzNpiL/nm7kvx6ZUnrXZW3dPHre+yFLGr0tPu9WO/a9w4iXTL6H4yjsue5dh4Txz8cTLhT6Fab3ZwerD2+jR5X4ddPguGVsCjE0Vr2/Rpk/K70bq7THc1byPXR1iCPEhzbSfJzsC/XpLMOZF2dqRPYq7m7UdmJonijib/km7nhipQzWUbi7HaMQQ7PW4nXDkDiPVgyNVf4RRuZib87xcEzG/kFmScSL7ekc12zE+eLpZUhkVDvUYX0+vdHDyjzbjBK3upBWIWs004v0EC/B+hEJpcRLOcq0ETkTpRBvu9+QfS0t9ax9F2fhZAYaI2N3usrq81HI6OARZCG5GHzf5fTqgC8iWweKZWhuxr+QQ+ksBS5Pzdldj3jNpJ+SuA3ZA/JOgRnEzdD/tSyjpBNtWNlsFvUX2AsTU4csgltdpHM6tRdBDgSbgUwnXofENLsI2czZz7zvtAIUskZzH+5551llg+m4tNfTOG8A/q9NvW5E3EdfdjhaujvLM3YF9jYntmUIspPebjTj/2F902ghI5qkMc434e802mbTCXSbejOL8aILaRViaB5Fjhvx+3k/Dlid7tXxR8RN7VDkZL1ZOD8LvhGJI/R7Y1i24M7GvQvMg2fXyBxnHpBzLN7jZI0mjIT4ONmHH7RQ9+YbkUV/P4IepkbHS2jf/AVx705tiHvTYYcqffS+DXG2iCCOJTfh7ATO4abhs3vMxCzzPFsdmRY6ao8BPzAdoj7YC2VzpBkNRm3csx3nRz53ZvcNsFvTOpNuhOMp1L35DvO8f9+H5yDV9i+B3d0HW3A/JEUdsoPfLQ4yFciOkalH9qTMtjkCcDJ19nWfjIwTQ5NqwLribVSIFtM7fYeOQczFaZL0Hv515J5Gs0NPJEK7XSPzimlAttto8JyGoIkjXlxWOcN0RO0YmU3IXjcnhjuMxC87wuP65eSolOvM836Jx8/7yellWYqHVV2PPf/6BmNk3iigYXZiaM7zsUycxDpLGq1Pe6QtbtJ/GSVI/ABZm7HDv81IJjXSt7qfw89YZ99GNiXaOVr8E2R3/lsO8z7NByPjZEST3rl80CNtqfbkxbYWuNSws/em0fRSZhU4AnCyRrOfj2VS5UIP5GwPeuGpSn2/tuuB4xSb1z+NbMRN73wFzdDcaEYydsLofwB8HljgQv6n+/Q9dzi8P46sJb7ggbZrMz3vpWhorM5xNpqRzEwHIwAnazRVPpbJHBfSSM2pznNR1604C/qoeEc/G9c+ikx/txTQs64HWj3+LqmI2XYjWs9CYpOtdknHCJ9+u/tcSKPFdDbecvl5z7ifsRQNjZWGsNH0vv7j0Ag4MTQrfSwTt85lr0MWMd1YsP8d7q0nKO5jdc3jfsRDMlOUAiuGxg+PscsRT067I7RjXR5thXz67e52KZ1UZ9yNzuX9uZ73UjQ0v87zeZOx1C/luMbK5rbN2Ntc15YXfSqPjTiLvNqWDeYBXOUgjaeRxcYkSlCxcujZH5AplmwbnK0cK+3HtJndEzL/gKynNLmsww+Pyg+Aj11Mb7MxNssdpPFPZF0m6ZahsdJwJHwYNv4xxzD9FPLPPf6N3HsPms0D5sQZ4Kd4u+ET0wCcj/uBOpebyldIb/QN7IVOUYrD9DwN1m+QUO+5fkcr0y7/8+G71Nn83hd6VD+9jmaQwJu9MKkQY4Xsb3sL2SeWMy6fXUOTL0ZTE95vxkuaxvUbSCiXTUbXn5AF+OctNtCnGGPyH2Og4ubBuxeJYup0V/Ji0+Bu9qgc3jaVwytvsXnYP9pgnjFQjSi5WOnCs+aUTchRDq9m6KxdieytytexvN70sLOxDH+OILHSwCeQKbYbPBxpP4Q3mz1TMxdnWmzfCh2NfcGm0V5iRpN5n3e7YbjvJ/d+i8dw7hFh1dj81fw56R38xfx5xdPIPoXhyL6FSmR9qFva667m39TrSsQrLv11F/N5Ajnk6gfY21dQKG8ha13PWpgmWWWMTB1KPh4Evpejo/c+7jpl5PrNjjT1c7QZGb9pY4S8EdnXdoVpBEchHl9LTFvwM9wJsZSPBxC35mwRp1tMx/QhH2YYjkcOEjyMXffxhMwznY1OWZ6xpUhkiEdwP5p8W+aa5/1f5PfMTdUdSwMLu4bmX8gi74VZpluu7LBNx8ysznCNuOMVZl3HYc1upvgScirffWRe/I2ZxukCnK3r7MpVVwXr950xw83U5iCnwP4kw2dbzUjbTxaZv0JoQryNbi3irxNHNmlmOlOlHjmW4iWftGzBvmNCoFoyxMPw76aDm+l5fxuZVbL8vBdysNDFSNjrS4CRxqI9ZR6cjZ59fXcbT8UeTyI7wr9qfn//fvf2y03I0b9XImfJNJppkR9iP4itIiP8CWZ09Q1gr7R26n0tHls8i5xDdZYZKY5GplqfMbMptiNbF2JoUmeJJNv0KIo1YvAH7w3dMchRq4cg6zo34O20nl3qEI+/Xwf8IQmZEfe3kWjEG5Bw+z8OoEF8BOvnxLvCxImjaMf4Prpqx+XZgMSodOUUZLuG5mTE4yt9CmVPZPf3xchC2AXaI7PNT4xhSdEJ+DMSWdfdxdTUFFD7Ndy/bTN1kaqfJ5oer6vOKu284VZKnKDUTzuG5ihkITrbonA5sgD2sumVr/JB/56mMU5fVK80hjD9db5F+Bpkb82diNtzg4+/wTfbGJl0piEB9K7A2z0pIeBck88+iEPHayZ/u2eoRJFF4Z5mOmMR/rk6Tyb7/PgQ5IC8r2vzo42jEkxDM8E0wFY2aPVH5vgm4Z0HUgj4pZkecWvT6UHIAthGMyp7yofyL0c8VHJxGRJT6lxkIc6LsrzPGLx0YzEZmc67xOLwucYYpgvYdRFxPXJu0G0+GJx8xz+cbvTt0EdfUfzDSiM9xhgZO6HoxxhjU+2R7suREzy9iGzQE3HNPMyH8j8Ya+dzfxVZZ/Aifto5bYxM247IvcgZKPkM5gvIZrK2niq9kU1y9/pQnoPyfF6FnMehKEqADM1gYzAKeTgPRfzbIy5rDgFXe1wuEWQPgNfYCe9/IhKmvavLGr5lobx/bQx7Nk41RjMX52L/7JNC6oYbnStFUXwyNL1ML7W/g/RPMo2Um8HmhjrUZJUDgT08zmM29qYXJyFuxn1c1GDlnPjUVOXlWT4fYjGNQfrIKYoamhRdjJEZ5kIeFwE3u6i5t4/l82OP099sjLGdHb/jkfDmg13SYNXxIYSstWTalGs1OGGtPnKKooYGZF3laWCci/lMxb2jQ/3cC3GWD3nMRDz61tu4ZxgS5220C/nbjTI9g92nLq3GNqvWR05R1NBEkXUVLxbC70KCTDplCf6ccZHqxfvBO6bMP7FxTz9jpA52mPct2PcO/KnpPKSwem6PGhpF6eCGJoRsxjzJo7wiSITloxymk0A25fmBn1GIFyJrMB/ZuKe7GZEc4yDfpWbkZvdsjlvYedCR1am/Gn3kFKXjkb6P5pfkjszsBuWIm+6RWDt8LBs3mxHApAAbmsmmPIcAFTbui9rMpxMSg+iryJG7hfAccmzCEzZHHdNNHZpl8fpaF+rPIcjG29dcGtl2QQLFnogEtHwSidSwRpsHRXHX0PyQ3O6rbtIFcdM9lMJPpGtEjhz+MuIyu8O8V4ccWrYdWRM6zaHWQsJyh9g9DIrXlJvR4gsUvkn2eTOafdqmsbkR6yd8Opk6OxfZ9Nkr7bc5md3PU7FDNbJHLNVhqTL15gxjeP6rTYSiuGNozsOfw4nS6YUcOXAohceeiiE7+TPxfReMDFhfe0jnWxQnTHgnZArsHgdpvIQcdvZPm0bheI8NzXR2P4+8sxl9HIVE6bVLBFmPnJSlfj4DjAXWajOhKM4II6fkFYNhuBQZtA3fwz136kKmzr5VxN/z2y6k8Soy7edFvLdC1miOyWBk0kfHz2HfDT8E/Irc65G9ivhsKEq7MzRWNyV+BMy3cJ2dEN1Huvx9pgC3u5heIYZmRBF/z5EupTPTGJt6l/UVskYz1cLo+GXsbeK92WKH4FRtIhTFHUPzhoXrViHn02+2cO1vbBgbN48mvQKJzusmhegr5pknbobAn2WMjZuBUQuZOjvEwjUDkHW/7hauvcSC8UrRWZsIRXHH0OQbAWxA5sHthP2/DmsuyE+49D2+A9zhQfkUskbzdBF/zyddTu914DgXjU0hhsaq99co8+d0hJTOK9pEKIo7huZ5sq9p1Jlerd2DzJKm8X86T89/ugvf4RLENTtkU58VCpk6+xHwcRF+yyYkTL/bzDaj2a0upFXIGs30Ij0bS5AjBRRFcUjKvfl682C1dR89Bdm1XghxJBLAc+zu2bMB+BLOPXouBO62aWTqTONlZS2nEEOzATm/ZwbiJuvXUZazKXzaLoIcFzAe8ebbhriJN6S9vhXZpOkkWkIhazT3IVNj03x8LjaYDtYGbSIUxT1DAxIV4H7E5bgrMkfvdL2h0RiU3yP7Erbg3oa48xBXXrtGZjLW5vJTxrYQ1iMnOV6ARFq2c5LpZcB3beb3CYW7VIeR83dO9qG+FerefKPpAF3qg8ZUHVmizYOiuG9oAFpwtgEu24P7ZZfT/Bqym9uOkalH9nu8ifWYa9sd6twBrLB4bcgYYLtG5gNkHWV1gRq/7pORcWJoUga4K95Gr2hB9l+9o02DonhnaEqB/YE/YO8Aq+3GyLxhs8HzK9ZZxIzOzrd53yxkL8gWhyNDv3AS6yxptNbiTTy+uEn/ZW0WFMVdSvG0weuQkCtWaTRGZlYBPWs/DE0VEv/NrpF5Glmk3+Iw//18/O2cHkXdYkajr3mg7TJk6lhRFDU0tgJpNiJrQzPbvN/J4v3bPP4uXdgZY8wOf0CmeJpc0FDl4283x4U0Uut+81zUdSuy/0tRFDU0toxEI+I1l2kvhNWNeNs9/i73AhNt3jMd8baLu6RhpY+/3QyX0qlDgqq6sWD/O7KHuFEUpYMamrkWrmk2Pf4XsnxudW3Ka0PzRRvXJoDLgRuwvg/ICi/69LttxHqUZytsQKYOVzlI42lkH1ZSmwJFCY6hsfJAJjzWfFeez1uQGFX/znGNlbNwNgMfevxdrE59tSD7XO7yQMNP8X4tKo6sQbkdqHM5sv5WyLk0byDrPXFtBhQlWIYmn6tuE95vcnsAme7IRIMxMs/lSeNhcoe/aQb+z4cG2EoInpRb9kMeaVhsGtzNHqX/thl5eBWaZx5ytEGjzXuOx98TVBWlw2LXvfl+cu9jeAzZO+I1FyFuqJcAo02D8Qqyc32BxR72Gch+nHMRl+lOyHrF86aX78eGvelGR68sn68zjajX+zqeRnbfDwd6ItEMqpCTLFOvu5p/U68rEe+99NddzOcJY8x/AHzqQzm+hThUPEt+j8RVxsjU6eOvKME0NP8yo4kLs0xjXOm6wplZI7g8aP4KJQH8xfxZ03FYc/bPnypo0/pqTr47ddBYW2OzDPgiT11q3+AdVlB5NOKOV1ixeAn4ChKypluGz2PIZt0LcLauo3jMxRdfHBgt99xzj/4gRTA0ABcjJxpegpx/sgF4CgkmuVGL1CZPXfo/Tr57HHIq6KlAD9Mz/w5PXaqnO9rjSTOy/aqpp57Xz1JpFLXxVkrF0NQg0zhHIsEX+yLOAT2R6Z8DTI/4FdNDbyjSd2qrcwgypQMyXbI8cDqfurStzkmm0fROZ67RWWlTB/za/BWDPZCp3QPwbo9SEzKdei+FxwwsFZ19kaC/JyKH25UhzjG5PEIbzAg2E0l2j0QeQyKuP4Ksm6oXYhEMzTDgWmTBONselt7mb4LpSW5HFu1vw8Jax/xJU934Lp7rdIlS0VlcZswoRdWnIFOxtT7k9SXgKiRW3VPtVOcYxP2+d5v3y8m9FtetAJ0HA2eZTt2ZqKOIq+TyOqtEdkx/iMxrd7KRbidzz4emcfQyVL7qVILAvsiaYa2PedYi3oj7tkOd5WZ00dvn3/EE3NtYrOQxNEORhdNrsRdXLFNlucakNcwD/apTCQo/ACqKkG+Fybu96TzJPDfF4EJkmk7x0NDsjxzhO97FfMYjQS33dzFN1emuTsUZRxUx7yPboc4Di6gzQqG+m0pG2q7RDEM2O/byIK8+Ju1Dcb7OoDrd1ak4p6edi+NlYbb0q6KuTyVNtVGSYQgloKo+Rpd1zXT7tIlIq+UgG7280llR1srofqsZ0WctvWrqiYQTxBNhNjTUsnBdXz78dE92tJZ5odPW1F6nUIgxkQj7lpWxRzhMp1CIeDJJXTLJikSCD1pbmR+P2wlb0kWrtDeGpgp41KNGMb2iPYYsvBUaeVh1uqtT8ZGWqggrxnRl3dBaEpHdz+3bQhWfjuhMOJ6kz9J6Bs7bSnmT/1FyOlc1ccK+7/P5oUuIRjLnf8TwBcTiEV5fOox/fjCObU1VvuvsFApxXHk5R0ajRNt+GArRExgaiXBkNMrmZJJnW1qYFYupW5nPpE+dTQPG+ZDnWJyd/6463dWp+MSGwZ14++T+rBneOaORSScRCbFmeGfePrk/GwZ38lXngYOWc9NJj3PE8IVZjUyKaCTOEcMXctNJj3PgoOW+6hwdiXBjdTXHZjIyGegeCvG1igqmVFXRORTSClkEQzMUmOJjvlMobDFbdbqrU/GJT8Z1Y8HE3sTL7IUXjJeFWTCxN5+M6+aLzi+NncP5E2dSUdZq676KslbOnziTk8bO8ccYlpXxnaoqagswGCMiEa6tqqKbGhvfDc1UsNQpcIuoydMuqtNdnYoPrN6nCyvGdHWUxooxXVm9j7fLBl8YOZ8Tx7xPoc1vCDhhzPt8YeR8N+RkXfjZOxLhm5WVjs446RkOc1lVVS4XUJ1dc9nQ1CKbB/3mLOwt+KlOd3UqPrC9WznL93NnNLJ8v25s71buic7+3TZz6n7uxG49db93GNDNcTDwjPOFFaEQ51VWFhQ7qy17hsOcWpHV03ub1l53Dc3x2Ns86BadTN5WUZ3u6lR8YNkB3UmG3ZmiSYZDLDuguyc6v7z/25SF3TlKqiyc4Iz93/ZE59HRKN1dnPI6IhqldzisFdUHQ3N0EfM/2qNrVadSdBq6l7O1r7ueWFv7VtHQ3d1RzYBumxnZd42raY7su8aNUc1ujdWR0Wjg01Qyl/PYIuY/1qNrVadSdDYMqimJdA8c7I23mNvpDotEPPEW26+sTCurD4ZmaBHzH+rRtapTKTp1fSpLIt29e6/zRKfb6Q6NRDzR2S0Uood6oHluaDoXMf/OHl2rOpWi01xbVhLp9q71Zt3b7XR7e2gMdJ3Ge0OjKIoHxMq96YHHKtxNt1N5iyc6O1U4OtV9t8WtMg8NTYa0m7UGu2toiunGt82ja1WnUnQicW+2YkRa3U23Je6NQWxpdTTy2s3jwctAPK3J3cp0h9Zgdw3N0iLmv9Sja1WnUnQqtreWRLqbt3vjje92uhsTCc9+q01J3Z/ptaGZW8T853p0repUik7N5h0lke6KzT080el2usvj3oxp6pNJNnhoxBQxNC8VMf+XPLpWdSpFp8dKb04D7rHK3XTnrBroic73Vw1wNb2F8TjbPRh5zGlt1XgzPhiaZ5Ez6f2m0eRtFdXprk7Fa0OzqtH1EP/lTXHXDdjcVQPY2lTtappbm6p532UD1grMisVcTTMJvOpymkpmQ1OPnCHuNw+YvC2PcFWnqzoVjwklkgx6f4uraQ56fwuhhLv979ZEmGfmunuixTNzx9GacN+p9d+xGPUujmr+29rKKp0288XQANwK+GnWY8BtBdynOt3VqXhM3yX1dPvUnTPpun3aRN+l3vQlZi0Zzodr+rmS1odr+jFr6d5Ok8kYIHZ7Mslfd+xwZaprUzLJQzuyrnepB6cHhmYJcIeP+d4JLC7gPtXprk7FB0a+tp5OW5ztVem0pYWRr633LHh9Evjda4ezaquzSNOrtnbjd68dTjLpeM9L1uHQ+62tPObQ2NQnk/yqqSnXmo8u23hgaEBOafTDa2kuzk+uVJ3u6VQ8piyWYOwLa+i6rrA9gF3XNTP2hTWUxbyd4mmKlfPzF77IwnV9C7p/4bq+/PyFL9IUK/e8TF+IxfhTczOFmO9PEwlub2riU50yK4qhaQJOBzZ4mN8Gk4eT1UzV6a5OxQ9j05Jg3xfXsNc7mylrSVi+Z693NrPvi2ss3+OU7S0V3PnSsTzyzoE0tlgzGI0t5TzyzoHc+dKxbG+p8K1MZ7e2cmNjI/+z6DXWnEzyj5YWbm5sZL0aGX/rf5v/LwGOQ7yX+ric1zrkvJQlLqSlOt3VqTinGcgZ7TKUhD0/qqPvknrW7VXDpv7V1PesIB7d2d+LxBLUbtxBj1WN9FnWQMTaKKbZTZ2JZIgXF4xi1tK9OXjIUsYPWMGQHhupjO5cdmyORVm+qSdzVg5k9vKhNMeibuu0tEayMZHg983NPB0Os19ZGaMjEXqGQnQxscu2JhKsTCT4MB7n7dZWmqw7EmzXKu2doQF4F5gIPIZ7Yefnmp63m42i6lQjEyTmAAdbuTASS9Bv4Tb6LZS2NFYZIV4WItKaJNocLzRv13U2x6K8umgkry4aCUBtZTMVZTF2tEapb670Wucb2DjIb30iwb9bWvi3O79lE7BQq7R7hHP0xCcAt+PMeypm0pjgUaOoOpWgcG+hN0ab41Q2tBZqZOzmXbDO+uZKNjbUFmpk7OZ9D7C5SL/lfeh0tC+GJjXMvRYYDfzeZsE3AX8w916Lt5FQVWdbrrpKa7b//Am4vwj53m/ybm86NwKnAVt91vkOMFWrs7tYCa+6GLgQmAKcCBwJjAeGAF3NNVuB5WZo/ArwDNDghsBRoWlWL10MXDg/Oc2WzlGhaZZ1znenzItanopnJIFvAP8Fvmt+Ty9ZjrjQ3409V9xg69y1k/QfYIx5Vo5G9tZUA7k8DroChfhWrzYjmVutdAJnzZofmIo3ceKodmFo2lbS9L9ElveLhjEcD1Kc3fl2SNc5wlTwY035zQKuBpZp+11SJIBfmr8eQJe2F8Sj4fDy/bqNbexafmhrNDwyGQ7tmQzJdaEkdaFEcnVZLLGgemvszSHvbX4/EsvoHlUHbPJSZ2U0Fj51/Dtj9+y69dDKaGxkWTixZziU7AKQSIbqWhPh1c2x6II1dV3ffOy9A95vjkW90AmwCsg6RL+npiYMHGgM0ThgEJDaDLQF+AR4H3j5rqam9z6IxzPF2on50JGzrNN0AtqVW5wVQzPMTNecDWSL+93b/E0ALkY8Nh5AdqsXey3hOGTaqRm4FHguYL/B54Dn0yodwKnAJOAY7C2gKsFhU3oj+9rXhnQz9e9CIFcQsPHACXW9K1kzvHYF8Dvg7kl/W77FD533fPXPtnTu3Xsdh+298DOdF9//f1v8KNx7amqs6pwAnAlwWVXVTp0NDVt8qge2dQKf6TRGqOQJ7TPzlmyfVSIbAaeQ4RAii7Qgu9Z/RI51hfmTsk+JjnrtViffr4cZFaSOON5mpgoKWmTMpbPAdZHPAS+wc8qsLRsLNjYzZmhT78cIOn/9DAHfBm7K8TvnYyvwA+DXuXq6OevnzMrA6OSwZifPkX86czxDFqbOfNNZClNn2ZwBhgJvmpGMk22+5cA1Jq1hRfh+J6UZGczrEwM0knkhTyXsaa4Zr016SVIDPAH8ykFjg7n3LuBxk6bqVJ0lRSZDsz/wusuN23hk3WF/H79b1Bi5tlxOYYuFfhsZNTalzWDTwTrZxTRPNmkOVp2qs5QNzTBkDaOPB3n1MWn7NbK5FBiZ4f0DgHNKxMiosSlNepnfa18P0t7XpN1LdarOUjQ0VcCjHn+RXsgO+SqPv1dPZF0oG9PJ7SIZJCOjxqa0iJg67mWHahgynVKmOlVnqRmaaYjbndeMxftowz/O05gPAr5TQkZGjU3pcC3iMeg1E8k8Naw6VWdgDc1QxLvML6Z4aPn3RVwJ83E90L2EjIwam+DT39Qrv7je5Kk6VWdJGJqpyOK5X0TxLszDnRaHlt2AG0rMyKixCTZXIzvX/aLa5Kk6VWfgDU0tshnTb84iy3GtDjgF2XlrlW/jrSeHF0ZGjU0wqQTOLUK+52JvzVN1dkydRTc0x5N9x7+XdMJGGHALVCCRje3ec3MJGhk1NsFjMrvu2fKLziZv1ak6A21oji5i/m7mfRmwd4EjqwNL0MiosQkWXyiR50h1dkydRTc0Y4uYv1t590FCNRRCqICRUC729tHIpBub54G9tL0vGsU09ONUp+oMuqEZWsT83cr7JofD1yNwLzTNz3w2Mil6IRGgleKwdxHzHq46VWfQDU3nIubvRt7jgfNcSOc23NkIVcyh9LHa3pd0XfYjb9XZMXUW3dCUOne69D1GuWSwikkcpSM+S2HVqTqD/nBsK2L+TvP+MnC4i3puxLkH3vNFLM8Xtb0v2brsV96qs2PqLLqhWVrE/J3kXYlMd7lJX5xvhLoa2FCEstxACYamaEcsL2Ley1Sn6gy6oZlbxPyd5H0l3px3frUxOE6M57E4P8LWrpE5EjkOVim9uuxn3qqzY+osuqF5qYj5F5r3HsD3PdJUg0yhOWEO4hTgh7FJGZkPta0vKi8XMe9XVKfqDLqheRbYXoS8G03ehXAL3p44dx6wTwkYGzUyweEfQFMR8m0GnlGdqjPohqYeeLAIeT9g8rbL54BveKytDHf2pHhpbNTIBIttwMNFyPchoE51qs6gGxpMoxrzMd8YhS3kh4Bf4M9RzCfhjkebF8ZGjUwwuQVo9TG/1gI7RKqzY+osuqFZAtzhY753AosLuO8s4FAfdf7UJaPmprFRIxNcFgJ3+ZjfXcAC1ak6S8XQgJx66YcXw1wKP2Fzms/lcyBwpktpuWFs1MgEnxuA+T7kMx9n5ympzo6ps+iGpgk4HW/3gGwweTQWcO9eFCe2z624F6zSibFRI1MaNAIn+/AcnVzgc6Q6O7bOohsakCm044B1HuS1zqS9pMD77y1SGQ0G7nMxvUKMzXo1MiXFEuSsEC8anQ0m7SWqU3WWqqEBeBeYiLvTaHNNmu86SGNCEcvpEJfTs2Ns1gNHqZEpOd4BPg984GKaH5g031GdqrPUDU3KMk9Azmlx4o0WM2lMcMES/7eI5TTbgzStGBs1MqXNYlP3Z+DMK6kV+LlJa7HqVJ2lRq6w+M3AtcDvkRha5wDVFtNtAv6OuDC7VUAXAn82lj3kU/kkgdfx7kzwlLF5EejR5rN1yAl6rhqZiy++ODCV75577ukIxqYRCWt0DzAVOBvrZ703IfvNbvWhoVGdHVNn0Q1NunW+EJiCHA52JHIGzBB2HvC1FQkuNwcJi/AM0OCy1mXApHbYEM0BDjIjv6ONcXsOuA74WAcF7Wp0cz7wXeAEM1Idl+U5eh8JbfIs/kfoVZ0dU2fRDU3bHn76XyLL+0Vj/pMbaswPmm4Qu5iP69oYxH+OOqVXQzF0zjr1/Ew6Uz2eo5FoDZ/pnPjEHxqKVKS2ytODDkZ7IxWJ40HVqTo7CqF9Zt6S75phyBTa2Vg/q2W7GfrdhoW1mfmTpmb/8KqrrH4Xz3UyY4ZjnbNOPd+RzolP/MHaWlcWrTamzjwvzw4ydaYoHZ5cI5pKZIPkFKDcZrqdgAuQmGR3Aj9C1ny8IBA6Z516vi86Z516fl6dEyeOKvnyVBSl/ZDN62wo8Kbp0ZY7SL8ccSR40/SQ3UZ1dkydiqKUuKHZH/G0Gu9iPuOBWSZtt1CdHVOnoiglbmiGIR5PfTzIq49J240erursmDoVRSlxQ1MFPAr08jC/XsBjWPcnz4Tq7Jg6FUVpB4ZmGuLf7TVjcRaFWXV2TJ2KopS4oRmKeBn5xRQKm0pRnR1Tp6Io7cDQTAWiPuYbNXnaRXV2TJ2KopS4oalFNuX5zVkmb6uozo6pU1GUdmBojsf6zm836WTytorq7Jg6FUVpB4bm6CLmf7RH16rO9qNTUZR2YGjGFjH/sR5dqzrbj05FUdqBoRlaxPyHenSt6mw/OhVFaQeGpnMR8+/s0bWqs/3oVBSlHRgaRVEURfHU0BTzJLdtHl2rOtuPTkVR2oGhWVrE/Jd6dK3qbD86FUVpB4ZmbhHzn+vRtaqz/ehUFKUdGJqXipj/Sx5dqzrbj05FUdqBoXkWOevdbxpN3lZRnR1Tp6Io7cDQ1AMPFiHvB0zeVlGdHVOnoijtwNAA3ArEfMw3BtxWwH2qs2PqVBSlHRiaJcAdPuZ7J7C4gPtUZ8fUqShKOzA0IKcf+uENNBfnJ0Kqzo6nU1GUdmBomoDTgQ0e5rfB5NHoIA3V2TF1KorSDgwNyFTKccA6D/JaZ9Je4kJaqrNj6lQUpR0YGoB3gYm4O50y16T5rotpqs6OqVNRlHZgaFI93AnA7TjzSoqZNCZ41KNVnR1Tp6IoJURon5m35Ltmb+Aa4Byg2mK6TcDfEVdWS15G8ydNzfzBzEprOT51qTOdJ99tzRvqsObM7191laXbZ516viOdE5/4gzWdM2ZkfPviiy+2Wjc8/93vuecefQKVgp4j38jyHCn2KLNwzWLgQmAKcCJwJDAeGAJ0NddsBZYDc4BXgGeABl+/iRiKC3nqUns6T77bV53GUFw469Tzbemc+MQfGnyuG6XxuyveYLWDZ7UjpqihaVecfHdJyJz4xB9KpUQbkAgCD+rj0mEZCnwPmAz0BdYD/7YzY1EghwJTgdHARuBfyF6srS6lvwdwHXAS0AP4ELgBeEF/cv8NzTDgWnJPofQyfwcBFyFTKPcj8/R+bdBTnRbQ6SrFJieYTkZN2nv9gfNNHf4G8KgH+U5Cgq9Gzf/3Ms/DhcBpwFsO0z8GeDhtdI5J/1/A4cDr+tP7Y2gqgRuB7wLl5r1VSEDE2cBCYLN5vzswAjgYON5UxAtMJbwT+BHg1Zi6ves8AdjTR52KDUa9dmug9GRd6yyM4aYxztYhqjIdoI/MaMBNbkwzMun0A140z+9rBaZ9LPCk0d+WiOkInqS123tDMwx4DBhr/j8LuNkMlxNZ7nkD+CPiyfZFMySdiCwoH4ds2HPbAymfzu7AZaaHAvAf4K4A6gxKeSpKOt8nvyNIOXC9Gd24ybgcn9WYkcfxwEyb6X4BeCKLkUmxj/707pLJvXl/0xCOReZCv2aGsf/K0SimkzDXHmbu3WrSmmXSdot8Oochi9TTkIXsI83rOeazoOgMSnkqweeL5ndvMqPfv5hRuVcca6Pxdpu6PJ93Ms/FUTbSPBJ4yoLx3KRVzVtDMwx4DugDLAIOMEPjQkiaew8w00J9TNrDXBoh5NP5B2BAhnsHmM+CorOQ8lzksk4l+HwbmWb9PDIN2w34OvBfZGrVC/aweF0vD/J+0cI11cA/LBq6wxGvSCuu+s9rdfPO0FQhi3q9zJTMJGCZC3ksM73xJSbtx/IMW/NhRedgk2c2DkPcdIuhM4TsUdnHvM5HCBiFeN6ETRqTXNSpBJ9LgV9lmYHYA++OXggV8Tv/FGixaGyeMqO9XM/7sxaNzFZkel3xyNBMQ+ZF65A1gPUu5rPeVIStyLTPNAdpWdFppZc/tAg6RyELp4uA+UholiE50hgCvI0stH5g/kaZtCabtJ3qVILNd0zDl6vRP6Edfu/FwHlmJG/F2DxpnrO2TLJhZFqBr+JtgNkObWiGIhvzUhV7qYt5VCOLd8uQhXlMXoVM+VjVWWEhrYocIzAvdIaQRcgRadeNRxYzh2ZJYya7rsPsY0ZJITOi+Y5DnUqwuRz4pYWRRXU7/f73I1OGVoxNpTE2x6e9N9EYmU4W7o8jDg16zLiHhmYq4ko4i8LXENrSHXgE2Gb+/o3sHp9l8irED/P7HujMVsHd1jkMcRdtS39TLkPbGJlXybzQu0+aUXGqUwkuVyCu7Famr95qx+XwW+Bii8amwnTmvoSsZT3Lrvt/8hmZR7TaeWdoaoGzzf9vtviDWjEyLwBnIH7pIcSD5QkgFVztbJO3VbzQmY2kyQPgLJd0xnPcMyDN2Aw1r/vneTDa6rRbnkpw+S5y8qkVIxNH9py0Z36H7COz4qVZbkb9z1p8HuKIN+fDWu28NTTHm6HlajPqcMvIZHK9PRBYaf6qkRhaVjnB3OOWznz82+js1GY4XqjOZYhrdT5j8wqZveVSvMeuzg//LrA8Fe/oCQwke3T0XEyxYWSSprf/Ugco0/uQNZu4RWPT2aKR+QYaXskXQ3O0ef2MxR5DoUYmvRKk5kGPtJH2US7qtEIiTefRLuk8A4kGkMvY5DIyq4Azc+g8Uqt0UdkfeBNZTP4EWMPOdTQrXAn83Eb9vIBdXfXbO38GzrVobKwYmW8i0cYVHwxNarf6bB+MzErkMKw3zf/H2UjfLZ12eLNN3k51LgWOyGNschmZI8gcDaCQ8lTcZTQSEuXgtPd6Ix5j+bzGAK4GrMakTxmZ+zpgOf/VjEKcGJu4GR39Tautf4YmtQi9oM1nZWSONVSokakHvowcirXIvLeXDa3ZdBaKlTWeRW3ydkNnIcYmZWSW5tG5l1bponET2b2/voPsg8lmbL6H7Bux2khegIQn8ppkQMv674gbciHGJlV+f9Eq66+hSc1lpkI+9EHcBOuQEPF/IfeimhUjsw3Z95Hyjtli/u1sQ2tbnblYa+EaK/uEvNJpx9iszGNkCtWpuEu+UCjfBu7OYGyuQaJyW20kz/fJyIBM/VmhGPtOHkIcYOycBJtAoj//Saur/4amLY8CJ5veWTkS5uJ5oIsDI3M8/obdnpun8m8E3g9A+Sddvk4JNpcAv04zNlOxvqs/Nd3zZx/1Wg3F8mKRynMJsN3m85bQalgcQ7PNvO6C7DqfmOG6g5G4Wl1cMjLd0j63SrrOfMTIva/kWos9Ia90plyYB1hIbwCyp2Yvl3Uq7vKyxeu+hewNuY6drv5WjMy5+D/dcyv5j6NoYaeLvZ+MN+1PVxv3RBDniXO1uvpvaFJTMiPIvYM23dg4Hcnsbf61E0stXacV7jOjsfTpqVXmPauLqHu3ydsNnanNmANspJkyNkPz6FymVbpoXA80Wrz2ImC6DSPzf8giuN8sRDYyZhs1NCFrJR/4rGucaX96FHBvythcoFXWX0Mz17w+BJlOWm3B2DidLjvU/DvXhtZ0nVb5GzDINPojzGs7niZu6xxG9h3/VozNK1mMTSE6FXeZj+yhanQxzdQ+j/uL+L2eMKOHe5H1wphpI+4z7z/qs56xpv3p6SCNkPk+F2m19c/QpDZ7ncjOoHKNeYyNEyOT2iRqZ7oB08imdFrdCNcJ8fi5xfx9B2txj9rqfMklnY/kMTIryb/P5mGXylNxn1fNb+GGsYmb0XcQ9nksQTaGDkTWbVNHOS/yWce+yHqQG8cShJApzG9rtfXH0DxrhsZ7IpGL/2MayUIeFisL/8eaBrMR2dRolWfMPSmd+egPvAP8Ajlj/DTz+h2LI4p0nc+6oHMv0wPMZWRSB7TlMjb7s+t6TaHlqXjDfxAPy+0O0oibDt8DAflOIeTMl5+ZGYGfI5GS/TxGYLTpSFkxMklgh8Xv9SvsbapVCjQ09ewMwXBdWq/c7jSAVe+y682/D5i8rVKf9uBdZ+H635N5nWSE+QyfdUZy3LPKGJilpveYz9hEXNCpeMdMY2waCjQyZyPuu0FgD2M8XwCuMgZwCnK65evYW2sslFE2jcwUJLCmlfYrhETIvkKrrbeGBsS7JIZ4nH0tbRrAqrGxamS+avKIUdhhTZl0ZhvN5Br1fDHPA+KFziXI4momI3MEuzocLCH7PpuF7IwO4FSn4h2vmWfCjrFpNUYmKFGEOyGx9CZl+fwQYwC83L+1j8mjt8XrrzQzFy/YNDZ3mnsVDw3NEiSQH0i4jCE2jI1VIzPEDFMxP+riAvRm05kpr3wM8llnEpm++yjtuneR0/8yebUtRY6fndPGyJxm0trLBZ2K98ZmssWRZixgRgYkivSYPNcMQyIbeMEAY2T62DAyd6b9/2XTflmdxpyB7HVSPDI0IKc0zkX80p9P60HkMjapHf/5jExv0zPqavKY5kBzNp3prLSQzuoi6JyPzDUPN9MBnwOW50hjGbImsy8y5TfKpOGmTsVbZplnZJsFI/NowLSfbfG6r3iQdwiZ0u9r8fqr0zp36byKvWnMu9CYgZ4amibgdGRH/TAkKOS+aT/W8ey62z517PEbefLYFwn6uLe5/3SceeXk0pniY9ObzPXwLy+SzqQZfXyEtR3/SeQo50XIruYxJq1hLulUvOd18/xkCku0wzTojwVQt9VTW4d4kPcX2Om2n49ryB2Q1M7IMoIcXKh4ZGhSUz7HAetM5XkDWQcAWRAchoSnOdZ8ni+S8tdMGnuZNI8jc/Rhu+TSmeK8LCObley+M7iYOu3wNdNoDXFZp+KPsZmA7EupM9M5LyDrH48FVPMmi9dt8SDvYy1eNxVrAUlnmefFSqzEL2h19dbQgKwbTDRTMrWIO2O6F83T5gFpzJHmZHPPX00ac02a77qoPZfOsGmA90OmlV41f9PMe0sCpNPKb+SHTsV7UmtsXZEjho8F/hdgvcWMdWZlQ+Z12HOCecOisemiVdVdynL0xCcgR8ROMb2uScAKJDLAG2b6J9Xj6Y6sOxxiGsWB5v0YMm/6I/LHTCp0xJBP5wvsdN/ujuwRCqLOTOV5qNE5wCedipLOrchR5pU5rvEq1tlHeT6/Aeux4tKZDRxjjGjXLNdohA2XCe0zM+9vtTcyB3oO2c/baEsTsqP5Nix6Q82flCUG5sxKq9/FF50clqV9v+qqYOmcMUNrt1I4O5+7U81IulOWevkN0p0YDnPY/9n5HPVAYqi1dQZIkH9NxgrjgKfY3fs0DpxEapO2PkeejmjSWYyc4TDFjAaORHa4D0nrEWxFFtfnIJs9n6GwzWpOUJ2K4j6pWGffQ6ad+iKOQM+bjo9XYWg2Ia7/M8wz0oJMH9+GO6fsvo8451yBeNX2Mc/mT7EXckqxYWgms/Ps8fORXb9nmh+5GtkA9QQyBfVgEfWqTkXxn1SsM79ZbEYXXtGARNGerj+xt6Smzj5FQk2AnKrXD9jMznNOUryKrDO86rYQi1NnRddpceqs+Dp1yK+UItanoP1BnyNXDU3b/Rwhcu/xmGkaSMfRgrMamMzGpmg6Lc0973xIiqdTHwxFUQJGuMD7DkPmMV9DPDiCiupUFEUpUUOTYiKyKPg6slAYVFSnoihKiRqaFIciC96z2XkIVxBRnYqiKCVqaFJMAP4J/Bdx3Q0F9HurTkVRlBI1NCkOBP6BhNc4KcANpOpUFEUpUUOT4gBk9+07wCkBbiBVp6IoSokamhT7IRsU30PC2tcEtDxUp6IoSokamhTjkLhI64BLA1wuqlNRFMUHQxP3MN9qJAKxG6hOd3UqiqL4Zmi8DOIYY9ezvZ2gOt3VqSiK4iplPuc3F7gdOSNmfYDLRXUqiqKUmKF5Azmk6J/kjvlVbFSnoihKiRma55BT+v4T8HJQnYqiKCVkaBLA48jxru8F+LurTkVRlBIzNC3A3/D21D3VqSiK0gENzXbg98jpkSsD/F1Vp6IoSokZmi3A3cixxBsD/B1Vp6IoSokZmrXAz4HfAvUB/m6qU1EUJeCGZivQJe3/y4CfAn8CmgP0HVSnoihKgMkVGeAyZI2gHnGpHWF63UFrFFWnoihKiY5o/mH+go7qVBRFKdERjaIoiqKooVEURVHU0CiKoihqaBRFURRFDY2iKIqihkZRFEVRdiWU/E8Fo0LTPgX2MO+tnZ+ctofvSg7Lsp1kZmX6/3bRmfY6WDqfunRXnSffHRydiqIoRRrRXGAa7tXA+QHWqzoVRVFKcUTjwEg9D4SAY5BzU7we0ahOHdEEkilXrPUzu0OQI7yHAzOBKXf8ou+qYuls2B5mwIAYx03eSjwO8Xgo9VE34FFgLHLc+LkTJ47a4YXObdsijB7dxJFHb6OxMUzS3rmzruls2RGiulOCE760lepOCVp2hNws6oJ1Fhsn0ZvPAI42r78MPBTQ76g6lfZEGXAHMMH8/xRgA/DtYgmKhGFHc4jWVohEIB7/7KOngEnm9dmmE3V2AMtUdXqME2eAi7O8DhqqU2lP7JVmZFKGp6iNTUV5gk2byti4sYyqqs8G4kPTGsUUpwWwPFVngA1NH+DwtP8fZt4LGqpTaW/0zvBe16I2ImXQ3BxmyeJKQjtblJ4ZLo0HsDxVZ4ANzalABJgPLDCvTw3g91OdSqnRBTgPuBQYk+HzUIC0HgGcQhKqq+OsXFHBpo0RKisTIEeRt6XVSzGhUB6dmfFdZ97yDL5O3wzNmebfR4CHzesvB/D7qU6llKgBbgamAz8BbkMW/NNJBkTrr4FXgCeAuRUVyZ5btkRYtqySikr/JaYW/8Ph3DqzjAwCV54B1umboRmITO2AeEA8Yl4fDgwI0HdTnUqpMQlZ1O+LeBhNBs4NoM7jgEvS/j8GmBEOw7o1UVpjoVyjC08oiyTZVh8mFttlZJNRZ6mUZ0c3NNciUztzgA/N33vmvakB+m5tdX5QAjo/CLBOxXsOyfDeoQHUeUSG9yaEw5BIiNeZ34amsirBmk/LWbMmSk1NPDXCyaizVMqzIxuak4Bvmdc/Ar5o/m40733LXFNsMumkBHQSUJ2Ku0SyvF9u49piEsvw3g6QqatQEVaRysqguSnM4oVVhMPJlIasOkulPDuiobkQmdYJA38GnjY97qmIf/efzGePmGuLRTadlIBOAqhTcdfA7Ad8BTgggxHJtLhRrDWZPoj77OAMn8UtvuebzmSSwTU1cZYvq2Dt2ijV1Ymi6QyF5C9ZmuVZFENTARwPvAzca3pczyD7PA5B1hEON68vNp+Vm2tfNvdW+PA9rOhMEVSdbSmmTsUbJpvf9PfIsd4nBlTnocBi4DHz7wmloLO8InnCtvoIixdWEo0W32ciVHrl6d2I01T+84D+QNS838181jdtOB8DbjXTOnF2XT+4FnHLO8VMAU0FjjR/LUjcr1ZgS1paq4A/As/aeEid6sToCaJOfNapeDNiCZtRSCbX0+lAP/O6CvEqeyZgvdcw8CBQm9ZGPAp0B5qCrDOZ5NFoWbL7+g3RpuYdIVJrRr5WgDLYvj3M9u0hunZN0LIjUirl6bmheRhxq8zGZuBxxAtigXlvFPCltGtOMu/NB34I/B24ygwVuyOeVZk4Lu0HyEchOke30Zk+LA2Szmx4qVNxl1rgeuBgYDnwY/Nvih5IjKp0RiBurOt81noVEu5oBXA5u+7R6Mfu3o6VwEjESSXQOiPh5MhkkvcS8RChUBKfth19pjMSSV5eXx9p+eTjCgYMaAlaeRbV0PwWuNr8f7lp2NaZXtla4CPT4NUi88rDgYva/IIh4G4zxbPI/F2ILGbvY3ryIWSe8sfAEHPfvTa02tH5OaPzwjw1bUERddrBC52Ku0xBNlnWABOR3fqnszM4aqcs91X6rPNaM5JOsTc7Y+xBZoeE1Ggt8DqTEPHZIWE3nRXlyaM/Xl7JmLFNRKPJ8lgsFITyLLqhuQbxcLjONFiXmQdklRkRPG96XnvmSesIdnXTWw0sND2RF41Vv8nkkUQ2pv3AhlYrOkemTU3YIc5O12IvdTrFTZ2Ku1ycNpKNINOeg9JGNdmaPr8XE65r8/+jzEhrblody1b3VKcFndHy5NimpvDchoYwvXu3xrMYmnhHejhS88k3INGD64GDgHeRRfQPjZHYs4C09wReMmkcArxj0q43ed1g8yGzorOfw/LwWqdbuKFTcZd+ed4Lym9TleG9/gEsz5LVmUzSPxIRF+ukPpGfGZoUjyObhBYAvUzDvR9wCzCtgLSnmV7255CzE3qZEc4Ek1ehuK0zhV86neK2TsWf5ysoZNqf0aI63dcZCukDkO1B+Mj0lucA1ciZKFWIZ9R0G+nebO6pBh5A5qffRxZKP3JBdyad1QXoTO+V/N3onOODTie9Jy90Kt6QLBFNqrP96wxcj2srspN+PbIAd5l5/wbgLgtp/grxvsHcO8ykdaxJ2y3a6vyOTZ3pXG7SWG/S9ENnIXipU1EUxdeh/Xp2hkH5Ttp1cyyk+V5a2pea1zeaNN3GiU4CoJOA6VQURfHN0AD8BdlQNAA40Ly3j4U0U9ccaO5tMml5RaE6CYBOAqhTURTFN0PTAMw2rw8y/46ykOaoNvfMNml5RaE6CYBOAqhTURTFN0MD8LH5d2CGBnwJslP9NPO6raEZ2CYNL7GiMxupe5YXQacd/NSpKIrim6HZbv6NIJ5Og4CNyCL/aOQ0uCfM68vMZ4PMtZG0nrzXWNGZjUibNPzSaRc/dSqKovhmaIaaf9eYxvs2xOvpV+zq095i3tsbuN30vteYz/by4XtY1ZmJlM5hPuu0i586FUVRXKMsx2flyNGyAP9FAmZ+HwmzcQayZtDHfL7OXPMcO6Ml9zb/TkSiGMc8+g6F6mxIuweThp86U9QgwTCDolNRFMU3Q/N50wjWAW8gmwW/j+zl6JLlnjrgl8gu/TfM/7sYY/OKR99BdSqKopSooUkdzvM8srj+ADvdhj9FwqCkFqaHAMcgsZ1+YEYSZ5l7v2zS8qphVJ1KUAlleY2F93HpekUpCUPTF3GprUQW2K8G/sbu0UcjwNeAn5kG9C12TvecwM7Q+V414KpTCRrpoUiyRetNtPnN8z2jTsObRPO8V2bhvvJsn6fF94rabG981Zknn/aos6hkcwYYhITcB1kTqDQ96PHI+fbZzrj+s7nmFXPPYeazkSZNt1GdSlCoy/DehrTX29oYlZTRSPfKzHQA2uY2/88UEWKrDZ2ZjFlDG52ZSH8/li3dROKziMV1DhtGT3Xm+d3ao87ijmhmhd/d7c2Jif3T96G0IscJ3zor/K6Vg1FXT0zs/wVk/WFaWmGMmhV+95MMeTnRn1Fnhgc6o04go07gE5fLuVR0lhyzZs13dP/EiaPckvIAcEHa7/MWsLRNw/I0cDI7p7+eZedx3CDHaqxjp1PIduDJNvksM2lPSKtPD9jQ+ZAZKadYC/yvjXF8AZm6TfEBu54G+whyoF86fw2FksQTIRKJEKFQciGE5rLrqaIvBkFnm/8vRM64ae86AzmiWWJ6Uq8Ch84Kv3uzRSMjD3/43cSs8LvTgUNNGpvZdVOnW+yiE4kabeeU8AQS7Vl1Kk6ZbozCemAWcKUxAulch6yzrTdG5Zo2n8811yw0HYzfAfe3uaYVOc1zlknnSVOfrHIBsq9ss8nvKHYPdf8Vo3OzyWdym88/AM5BNiBvRE7XvSUUgkQilH4Gy5dMo7sZ+HebBrloOjPk1RF0FndEk8VQLEbOOP+MjRsX1SBrA0ea6Zwh7PSWqkMWsueYaZ5/9uw5vGFW+N3/mesd8+TmBzO9vYvOUChEMpm0pdMMc/PqPKX7Wa7pNNjSGQ6HGxKJhHs6n3wy62emHAmHwyQSiULKMy+nnHKKqxW5kPrp8rO0CnHUyMVHiCt7rg7FfebPK3aQO1IGZpT1RQsjuAcAGraHGTAgxtlf3UQ8DmknStabv4RpHLd7pXPbtgijRzdx5NHbaGwM09IS2k1nDlzT2bIjRHWnBCd8aSvVnRI0NYVtl6cXOp2O/G1yCLKfcjgwE5hSZuEBHgZcC6Gzy8urO0WjnYhGKwmHo4RCMiBKJhO9E4lY71iseUIstv3ilpbG7Rs3LnoAuK1nz+F+9byHAddWVFSe06NH7+q+ffegS5daKisriETCvPnmgow6IfkAssHTV53ZyvOQQ0YSjyd6Nzfv6F1XVz9h/fp1F69fv6axtTX2oOnl+Knz+2Vl0bN69uxd3bt3b7p160KnTtU0NcVYtmwd9fXbfSnPjz7aeeROeXk54XCY1tZWamtr2bhx0bBIJPL9aLT8rJ49U797Z6qrqygrk/rZ2pro3djY1LuubtuEtWvXXLxx4/rGLVuWPhiPx29Zu7b7kvr6esrKykgkErS07Nzfu88++xBAyoA70qbOTjHTM98ulqBIGHY0h2hthUgE4jtXHJ9i596xs82U4dkBLFPV6XH9LMthYCqBaaFQeEpVVbfyysquhMORLD3gCOFwhLKySqqqupJIxDs1N2+9oKlpyzc2blx0J/Cjnj2HN2e8+bDm3LJTn2fvgVcC02pqaq8cOHCv6MCB/ams3NVBI5lMEgqFcupMJhN3ImsnnurMV56RSJiysggVFVG6dKlh4MA9iMX2rV6x4tPzPv54ydfr67fd4UhnfiqBH1dVVX934MDB0UGD+lNdvetZbS0tccLhEOGwg/J0yIcfflgJTKuu7nTlgAGDo4MGDaCyspxQKLzbyYbl5WHKy2vp0qWWAQP2oLm5pfqTT1aet3Llx1+fPXv2HcCPxo0b10xpsFfaQ5x6sM8upqGpKE+waVMZGzeWMXhwC7FYBCQKxqQ2l54WwPJUnT7Uz7IsRmYo8GhFRe34Tp16EQ7bc24IhyNUV/egsrJL+fbtG67ZsaP+2I0bF33Zg9HN0HA4/NigQUPHDR8+jKqqCsc6zfTHEg8qScHlGY2WMXToQAYO7BddtGjpNR9/vGRyLBY7zQud4XD48X79BowdOXI4NTWdAlme77///tBQKPTYnnsOHDdy5AiqqysJh/Mf8RMKQSgUprq6khEjhjJgwJ7RBQsWXrN69Yovvv/++2eMGTOmFNa9emd4r2sxBYXLoHlbmCWLKxmy12cjwp4ZLo0HsDxVpw/1M5zByOwPvF5T03t8be0ethvFXRueMmpr96Cmpvd4YJZJ2y32j0ajb4wf/7lx48aNtm1kcukEXNXpVnlGo2WMHj2C/fc/aExlZeUbbuuMRqNvjho1Zuz48WNsGxm/ynPevHn7R6PRN0ePHjduzJjR1NRUWzIyu2sMU1NTzZgxoxk9ety4aDT6xrx58/YPwIPaBTgPOeRuTCZ7GaBG5QjgFJJQXR1n5YoKNm2MUFmZgMwxBlu9FBMK5dGZGd915i3PYOssqH6G2xiZYcBztbV79KmsdK+TVFnZldraPfoAz5k8nDIsGo3+e7/9Duo9cGA/T3TiTvBKT8pzjz16cdBBh/SqrKx83i2d0Wj0hX33HddryJBBlJWVBbI8Fy5cOCwajT6/777jew0e3J+KinLn0z4V5Qwe3J999x3fKxqNPr9w4cJiBi2tQTzIpgM/Qda6hre5Jijn0f8acax4AphbUZHsuWVLhGXLKqmo9F9iytMtQ59jF51ZRgaBK8+A6iy4fobTjEwV8GhNTe9eFRW1riusqKilpqZ3L+Axk1ehVIXD4cf23Xe/nv369fJUJxKPrGCdXpZn9+5dOOCAg3qUlZU94VRnOBx+bMSIUd3799+DSCQcyPJcuHBhFfDoyJH79thzzz6uGUOAsrIy9tyzLyNH7tsDeMzkVQwmIWstfYFuiBvsuQFscI4DLkn7/xhgRjgM69ZEaY2Fco0uPKEskmRbfZhYbJeRTUadpVKeAdRZcP1Mb1WmVVTUjnOz552ph1tRUTsW2XhYKNMGDRo6duDAPQKv0+vy7NWrO3vvPXLfcDj848KnG0I37rnnwLEDB/YnEokEsjzLy8sBpvXvP2jcgAH9XDUyO41NhAED+tG//6CxwDSTp98ckuG9QwPY4ByR4b0J4bBEBojH8d3QVFYlWPNpOWvWRKmpiadGOBl1lkp5BlBnwfUzbEYzQ0Oh8JROnXp5rrRTp96EQuEpBU6hDa2pqb1y+PBhhDyuySmdBU75+Faew4btRW1t5+8WqrOysmrKiBF7U14eDWx5zps3b2hVVdWVw4cP91RneXmU4cOHU1VVfeW8efO8nELLZtHLbVxbTDKFTNkBMnUVKsIqUlkZNDeFWbywinA4mdKQVWeplGeRcL1+pkY0U6uqukWdLFRbJRyOUFXVLcrOc2vs9L6nDhy4V5mThX8/dPpZnpFImOHD9ymLRCLX2f+O4esHDBhUVlVVGfTf/bqBA/cqq6mp9lxnTU01AwcOKQuFQtd59ADvh+wUPyDDQ5ppfrtYazJ9EPfZwRk+i1t8zzedySSDa2riLF9Wwdq1UaqrE0XTKd6Nu/1wpVCentXP8MaNi2ohdLaXUzyZplIgdJbkbZna8vKKcwYO3NN3nYAtnX6X5x579Ka8vOIrdnVGImVfGTx4oGdTZm6U55NPPlkbiZSdNXjwQMJh77vK4XAIKZOyrzz55JNuL65NBp4Bfg/8AziRYHIoEs3iMfPvCaWgs7wiecK2+giLF1YSjRbfZyJUeuXpWf0MA8eXl1d3yrYZ06vebXl5dSfgeBu3Hd+zZ+/qysrywOv0vzxD9OvXv9quzl69eldXVlYEvjx79epT7ccodqdBrKBXrz52yzPVI4ySParudOSMoSpgD8RrJ2hTY2HgwbTOQBnwKM4cTnzRmUzyaLQsWbV+Q5TmHSHCYf9FRcpg+/Yw27eHqChPBK08i1Y/w8DR0Wgn37+xyfNoG7cc3afPHiWhsxjl2atXb9s6e/fu7flalxvl2bdvX397oiEwedrRWWse1BeQYJhD2nzeg10j7wKMoDhurFchkaN/y+7z7v2AAW1tLzuPuQi0zkg4OTKZhEQ8RCiU9F1nJJIsb2wM88nHFYTDySCVZ1HrZxkwtqyswvcaZPIca+OWsZ0715aEzmKUZ21tp3Zbnl27dvFdp8nTjs4pyCa2GuSo7a7A6eyM0p2t91Hp81e7FjmiIsXebQxqeY7ecOB1JiHis0PCbjorypNHf7y8kjFjm4hGk+VpQUaLWZ5FrZ9hYGgk4r8rp8lzqI1bhlZXV5SEzmKUp9m8aLM8q30f0RRSnlVV/s8ymDzt6LzYPMSpRuQUdj2cLltB+72Y0NbJ4ag2BjXbInRcdVrTGS1Pjm1qCtPQECYaTQZFZ1HrZxjoHC7CZKbJs7ONWzqHw2GSyaTtv0Qi6bvOUijPaLRwr7iUgZJgpdb/jOOBLZ2pKMz+jrxsl2e/PO8FZUd/Jqvdn+BRsjqTSfpHIuJinUwGRmdR62fJHAUKMHv2AoIV6ik4JBIJ3/KqqalizJjCTpKOx+M888yijvKzhAOoaQe7nz/fojrd1xkKaf1Mz2ibn41Um4Zxm41bVGcOWlpitnXGYoXH5LM7kkn9tbbGbetsbfW/PE2e2xwmkwxg45JUnR1SZ1HrZxhYGo/731EweS61cYvqzEF9faNtnY2NjSR9HNsnk0kaG+3rbGpq8r08TZ5LURTFFUMzt7XV/2gH8fgOkCilVlGdOdi8eYttndu21fuu0+RpS+fWrXW+6zR5ztUmQlHcMTQvxWLbfc+4pWU7wEs2blGdWUgkkqxZ86ltnevXr/d9RLN+/XrbOteuXevromoyCWvXrrWrU1GUHIbm2ZaWxu2JhH/edolEnJaWxkZkk5NVVGcW1q/fSkPDVts6N2xY39jc7N/oq7l5Bxs2rG+yr3NdEXSus6tTUZRshqZnz+H1kHywuXmrjw/yViD5gORtmaLplLyDqTMeT7Bs2XISibhtnfF468OffLKSeDzug844klfrQ3Z0nnLKKfXxeOtDH3+8wpGbup3R4ccfryAeb33wlFNOqdcmQlHcGdEA3NrUtCXmRy88kYjT1LQlhsTRsYvqbMOKFevZuHF1QToTicT0FSs+bm1qavZcZ1NTMytXftyaSCRutntvMpm8ecWK5a0NDY2e69y+vZEVK5a3JpPJW7R5UBQXDU3PnsOXJJOJO7ZvX+/Dg7yeZDJxZ8+ewxcXcLvvOpFoq4HUuWlTPYsXLyCRiBess7m56Y6FCxen3KM9oaUlxsKFi2lsbLyjEJ1jxoxZ0tTU+PNFixb5orOpqfGOMWPGLNbmQVHcHdEATNuxo36ul1M+zc1b2bGjfi4OT65UnbB163bmz19IY+NWRzqTyeSPVq9eMW/FilWeTKHF43FWrFjF6tUr5hWqs6WlBWDaqlWfzF258tPUXhxXaW1tZeXKT1m9+pN5wDSTp6Iobhqanj2HNwGnNzSs37Bjh/tT0zt21NPQsH4DcHrPnsOdzIH4phMIpM716+v44IOFbNq0yhWdiUTitIUL529etWoN8bh7myPj8QSrVq1h4cL5mxOJxGlOdI4YMaIJOH3Bgg82rV691lVj09oaZ/XqdSxY8MGmZDJ52ogRIxq1aVAUb0Y09Ow5fAlwXH39mnVu9sSbm7dSX79mHXCcycMpnus0eQRKZyzWytKla5g/fwEbN65wVWcsFjvmgw/e37h8+Se0trY6TrC1tZXlyz/hgw/e3xiLxY5xQ+eIESOWxGKxYz/4YM6Gjz9eyY4dzkcdO3a08PHHK/nggzkbYrHYsSNGjFji4vMVyvIaC+/j0vWKUvT6uVusm549h78LTGxoWD+3vn4NiUThjU4iEae+fg0NDevnAhNN2m7hmU6TdmB0xmJxVqzYwJw5y1i0aD5bt67xRGcsFjtk/vx5H8yZM4+GhsL3AjU0bGfOnHnMnz/vg1gsdoibOseMGfNuLBY7dP78ufPmzfuQhobGguK8JRIJGhoamTfvQ+bPnzsvFosdOmbMmHddfpDT3eSyDcHSxWcKHV+WI81CiOZ5r8zCfeXZPk+L7xW18F2KpjNPPu1RZ1HrZ8agambUMWHHjvrbt2z5ONbYuAk7HlSJRJzGxk1s2bI8tmNH/e3ABJdGMplGDK7qdGmEULDOeDxJS0sr27Y18umnm5k/fyVvv72QhQsX8umnCzzXmUgkDly9esXPXn/99daPPlqUChljicbGRj76aBGvv/566+rVK36WSCQO9ELnuHHjliQSiYNWrfrk9jfeeL114cKlNDY2k0gkcm7sTCbFwDQ2NrNw4VLeeOP11lWrPrk9kUgcNG7cOKc6M4Uv2JD2elubhzb1UDak/X9dhjQ2t/l/Jg8TO8PlTI1FQxudmUh/P5Yt3UTis4jFdQ4bRk915vnd2qPOotbPrEJ79hzeDFy7ceOi3zc2brqmsXHzOeXl1dXRaCei0UrC4WgqND2JRIJEIkYs1kwstp2WlsYmSP4duK1A7zJbM17AtclkwpFOCvPacl3n7NkfBUHn95qaGu9dvHjB1KVLF5/ds2fvqt69e9OtWxeqq6soKyv7bHqssbGJLVvqWL9+PRs3rm9OJOIPJBKJW0KhkKc6R48e3VxbW3vt7Nmzf79kyYKpy5aJzr59+9K1axeqqqooK4sYnXGamprYurWOtWvXfqYzHo/fcvDBBy+ur3dlDe0B4IK0h/8tdo2Vtg14Gjg5bXrhWWBL2jUvmYe5j/n/duDJNvksM2lPSM1Smryt8hDwtbT/rwX+16bxeQE4Ju29D4AFaf9/BPhhm3T/GgoliSdCJBIhQqHkQgjNZdczZF4Mgs42/1+IhBpq7zqLWj9Dr732oSWVGzcuqgFOBI4ExiNHgXZN61EtB+YArwDP9Ow5vMFKuo890p07fpH9qN4pV6wF4PAjZ1stUFs621js7K1vUwVnnT056+cPPvAvACqrdpS8zlAoRDKZJBwOk0gkbOkMh8MNiUTiszSc6sxH/wGDHNXPVSs/yZtHLp1p9bQ/cAdwGLAIOXnxjTaX7WOu2Q+YB1wOzG8zw/BN4BpTPx4Brmd3J4pDgNuB4cBMYModv+i7ykp5TblibYVpdA4HVgFnAR+1uawbcs7954y+s8216ZwN3Gx0PgR8Z/v2MHv2j3Hc5K0kEhCPhwYCjyIHyP0POGfixFGbvdS5vSG8qv/AFo6bXEc8DvF4aDedGbJzVWcsFvooGk0y+YSt9OjRSlNTuKDydFPnrFnzi1o/Q9+9fE034H7gWKwdL9oCPAycf/qXN7cYY1GJnEP9lSxziW1pNVb+bKDOiqExlaognUDLhIPfAzmWtGCdFhtGRzrNe6rTBZ39BwxqMcbEM52KouQnDPwCmIz1M6zLzVDx+sce6c5jj3QH+IF5L2oxjTKT5502tBasM+091dmBdK5a+UlqxOKHTkVRchiaQrtr6fcd50Iabl6rOlWn3zoVRclhaHoWeG+ftNdupJEP1ak6g6xTUZQchkZRlCzo+oyiqKFRFEVR1NAoiqIoamgURVEURQ2NoiiKooZGURRFUdTQKIqiKGpoFEVRlHZlaOoKvDc9mJsbaeRDdarOIOtUFCWHoXm0wHsfS3vtRhr5UJ2qM8g6FUXJQhlwFVALfAFrx3a2mgfw9rT3bgX6IefXWwl+mEDOUvieDa2qU3UGWaeiKDkMTR0SPt0JLcC3zJ9XqE7VGWSdiqLkMDQdgrdm7+c4jbPO9jZ9t/BDpznfR1EUxZKh6QLci/WpiTgyNXE5Ow/AKgfuAk6zODWRRA6WuhjrC7WqU3UGWaeiKDkMzQzgTJv3XYwcRXqT+f9U4CKbaXwFOafa6n2qU3UGWaeiKFkIA2cUeO/paa/dSCMfqlN1Blmnoig5DE2XAu/t3mZ6w2ka+VCdqjPIOhVFyWFoFEVRFEUNjaIoiqKGRlEURVHU0CiKoihqaBRFURQ1NIqiKIqihkZRFEVRQ6MoiqJ0BEOzscB716W9diONfKhO1RlknYqi5DA0/yrw3mfTXj/nQhr5UJ2qM8g6FUXJYWguNw9zq8V7WoC/Ajenvfdj4G/sjJabj1bzEE+xoVV1qs4g61QUJQv/PwAlukJhy2ScjQAAAABJRU5ErkJggg==",luckysheet.getluckysheet_select_save=function(){return luckysheet_select_save},luckysheet.setluckysheet_select_save=function(e){luckysheet_select_save=e},luckysheet.getluckysheet_scroll_status=function(){return luckysheet_scroll_status},luckysheet.setluckysheet_scroll_status=function(e){luckysheet_scroll_status=e};var luckysheetConfigsetting={allowCopy:!0,showtoolbar:!0,showinfobar:!0,showsheetbar:!0,showstatisticBar:!0,pointEdit:!1,pointEditUpdate:null,pointEditZoom:1,showConfigWindowResize:!0,enableAddRow:!0,enableAddCol:!0,enablePage:!0,pageInfo:null,autoFormatw:!1,accuracy:void 0,editMode:!1,chartConfigChange:null,beforeCreateDom:null,total:0};luckysheet.luckysheetConfigsetting=luckysheetConfigsetting;var luckysheetdefaultstyle={font:"normal "+Math.ceil(10*window.devicePixelRatio)+'pt 微软雅黑, "Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif',fillStyle:"#000000",textBaseline:"middle",strokeStyle:"#dfdfdf",rowFillStyle:"#5e5e5e",textAlign:"center"};luckysheet.luckysheetdefaultstyle=luckysheetdefaultstyle,luckysheet.setluckysheet_pointEditZoom=function(e){luckysheetConfigsetting.pointEditZoom=e},luckysheet.replaceHtml=function(e,r){return e.replace(/\$\{([\w]+)\}/g,function(e,t){var l=r[t];return void 0!==l?l:e})},luckysheet.isEditMode=function(){return!!luckysheet.luckysheetConfigsetting.editMode},luckysheet.flowdataInit=function(e){for(var t=[],l={},r={},a=0;a<e.length;a++){for(var s,n,o=[],c=0;c<e[a].length;c++){null!=e[a][c]&&null!=e[a][c].mc?(null!=(s=$.extend(!0,{},e[a][c])).mc.rs?(r[s.mc.r+"_"+s.mc.c]=[a,c],l[(s.mc.r=a)+"_"+(s.mc.c=c)]=s.mc):s.mc.r+"_"+s.mc.c in r&&(n=r[s.mc.r+"_"+s.mc.c],s.mc.r=n[0],s.mc.c=n[1]),o.push(s)):o.push(e[a][c])}t.push(o)}return 2<JSON.stringify(l).length?{data:t,config:{merge:l}}:{data:t}},luckysheet.getObjType=function(e){return{"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object"}[Object.prototype.toString.call(e)]},luckysheet.func_methods={getCellDataArr:function(e,t,l){var r=[];if(null==e.data)l||("number"==t?r.push(0):"text"==t&&r.push(""));else if("array"==luckysheet.getObjType(e.data))for(var a=0;a<e.data.length;a++)for(var s=0;s<e.data[a].length;s++)null==e.data[a][s]||luckysheet.func_methods.isRealNull(e.data[a][s].v)?l||("number"==t?r.push(0):"text"==t&&r.push("")):r.push(e.data[a][s].v);else luckysheet.func_methods.isRealNull(e.data.v)?l||("number"==t?r.push(0):"text"==t&&r.push("")):r.push(e.data.v);return r},getCellDataDyadicArr:function(e,t){var l=[];if(null==e.data){var r=[];"number"==t?r.push(0):"text"==t&&r.push(""),l.push(r)}else if("array"==luckysheet.getObjType(e.data))for(var a=0;a<e.data.length;a++){for(var r=[],s=0;s<e.data[a].length;s++){null==e.data[a][s]||luckysheet.func_methods.isRealNull(e.data[a][s].v)?"number"==t?n=0:"text"==t&&(n=""):n=e.data[a][s].v,r.push(n)}l.push(r)}else{var r=[],n=e.data.v;luckysheet.func_methods.isRealNull(n)&&("number"==t?n=0:"text"==t&&(n="")),r.push(n),l.push(r)}return l},getDataArr:function(e,t){var l=[];if(null==t&&(t=!1),"array"==luckysheet.getObjType(e[0]))for(var r=0;r<e.length;r++)for(var a=0;a<e[r].length;a++)t&&!luckysheet.func_methods.isRealNum(e[r][a])||l.push(e[r][a]);else for(r=0;r<e.length;r++)t&&!luckysheet.func_methods.isRealNum(e[r])||l.push(e[r]);return l},getDataDyadicArr:function(e){var t=[];if("array"==luckysheet.getObjType(e[0]))for(var l=0;l<e.length;l++){for(var r=[],a=0;a<e[l].length;a++)r.push(e[l][a]);t.push(r)}else{for(r=[],l=0;l<e.length;l++)r.push(e[l]);t.push(r)}return t},isDyadicArr:function(e){var t=!0;if(1<e.length)for(var l=e[0].length,r=1;r<e.length;r++)if(e[r].length!=l){t=!1;break}return t},getFirstValue:function(e,t){var l;if(null==t&&(t="number"),"array"==luckysheet.getObjType(e))if("array"==luckysheet.getObjType(e[0])){if(!luckysheet.func_methods.isDyadicArr(e))return luckysheet.formula.error.v;l=e[0][0]}else l=e[0];else if("object"==luckysheet.getObjType(e)&&null!=e.startCell)if(null==e.data)"number"==t?l=0:"text"==t&&(l="");else{var r=window.luckysheetCurrentRow,a=window.luckysheetCurrentColumn;if(1==e.rowl&&1==e.coll)null==(l=e.data)||luckysheet.func_methods.isRealNull(l.v)?"number"==t?l=0:"text"==t&&(l=""):l=l.v;else if(null!=e.data[0][0].mc&&e.data[0][0].mc.rs==e.rowl&&e.data[0][0].mc.cs==e.coll)null==(l=e.data[0][0])||luckysheet.func_methods.isRealNull(l.v)?"number"==t?l=0:"text"==t&&(l=""):l=l.v;else{if(1!=e.rowl&&1!=e.coll)return luckysheet.formula.error.v;var s=luckysheet.formula.getcellrange(e.startCell),n=s.row[0],o=n+e.rowl-1,c=s.column[0],u=c+e.coll-1;if(1==e.rowl){if(a<c||u<a)return luckysheet.formula.error.v;l=e.data[0][a-c]}else if(1==e.coll){if(r<n||o<r)return luckysheet.formula.error.v;l=e.data[r-n][0]}null==l||luckysheet.func_methods.isRealNull(l.v)||null!=l.mc?"number"==t?l=0:"text"==t&&(l=""):l=l.v}}else l=e;return l},getCellBoolen:function(e){var t=luckysheet.func_methods.getFirstValue(e);if(luckysheet.func_methods.valueIsError(t))return t;if("boolean"!=luckysheet.getObjType(t))if("string"!=luckysheet.getObjType(t)||"true"!=t.toLowerCase()&&"false"!=t.toLowerCase()){if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=0!=(t=parseFloat(t))}else"true"==t.toLowerCase()?t=!0:"false"==t.toLowerCase()&&(t=!1);return t},getCellDate:function(e){var t;if("array"==luckysheet.getObjType(e))if("array"==luckysheet.getObjType(e[0])){if(!luckysheet.func_methods.isDyadicArr(e))return luckysheet.formula.error.v;t=e[0][0]}else t=e[0];else if("object"==luckysheet.getObjType(e)&&null!=e.startCell){if(null==e.data||"array"==luckysheet.getObjType(e.data)||luckysheet.func_methods.isRealNull(e.data.v))return luckysheet.formula.error.v;t=e.data.v,null!=e.data.ct&&"d"==e.data.ct.t&&(t=luckysheet.mask.update("YYYY-MM-DD h:mm:ss",t))}else t=e;return t},getCellrangeDate:function(e){var t=[];if("array"==luckysheet.getObjType(e)){if("array"==luckysheet.getObjType(e[0])&&!luckysheet.func_methods.isDyadicArr(e))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(e,!1))}else if("object"==luckysheet.getObjType(e)&&null!=e.startCell)if(null==e.data)t.push(0);else if("array"==luckysheet.getObjType(e.data))for(var l=0;l<e.data.length;l++)for(var r=0;r<e.data[l].length;r++){null==e.data[l][r]||luckysheet.func_methods.isRealNull(e.data[l][r].v)?t.push(0):(a=e.data[l][r].v,null!=e.data[l][r].ct&&"d"==e.data[l][r].ct.t&&(a=luckysheet.mask.update("YYYY-MM-DD h:mm:ss",a)),t.push(a))}else{var a=e.data.v;null!=e.data.ct&&"d"==e.data.ct.t&&(a=luckysheet.mask.update("YYYY-MM-DD h:mm:ss",a)),t.push(a)}else t.push(e);return t},isRealNum:function(e){return null!=e&&""!=e.toString().replace(/\s/g,"")&&("boolean"!=typeof e&&!isNaN(e))},isRealNull:function(e){return null==e||""==e.toString().replace(/\s/g,"")},valueIsError:function(e){var t=!1;for(x in luckysheet.formula.error)if(e==luckysheet.formula.error[x]){t=!0;break}return t},getRegExpStr:function(e){return e.replace("~*","\\*").replace("~?","\\?").replace(".","\\.").replace("*",".*").replace("?",".")},factorial:function(e){return 0==e||1==e?1:e*luckysheet.func_methods.factorial(e-1)},factorialDouble:function(e){return e<=0?1:e*luckysheet.func_methods.factorialDouble(e-2)},variance:function(e){for(var t=0,l=0,r=0;r<e.length;r++){t+=a=e[r],l++}for(var a,s=t/l,n=0,o=0;o<e.length;o++){n+=((a=e[o])-s)*(a-s)}return n/l},variance_s:function(e){for(var t=0,l=0,r=0;r<e.length;r++){t+=a=e[r],l++}for(var a,s=t/l,n=0,o=0;o<e.length;o++){n+=((a=e[o])-s)*(a-s)}return n/(l-1)},standardDeviation:function(e){for(var t=0,l=0,r=0;r<e.length;r++){t+=a=e[r],l++}for(var a,s=t/l,n=0,o=0;o<e.length;o++){n+=((a=e[o])-s)*(a-s)}return Math.sqrt(n/l)},standardDeviation_s:function(e){for(var t=0,l=0,r=0;r<e.length;r++){t+=a=e[r],l++}for(var a,s=t/l,n=0,o=0;o<e.length;o++){n+=((a=e[o])-s)*(a-s)}return Math.sqrt(n/(l-1))},isLeapYear:function(e){return 1===new Date(e,1,29).getMonth()},feb29Between:function(e,t){var l=moment(e).year(),r=moment().set({year:l,month:2,date:1});if(luckysheet.func_methods.isLeapYear(l)&&moment(e)<moment(r)&&moment(t)>=moment(r))return!0;var a=moment(t).year(),s=moment().set({year:a,month:2,date:1});return luckysheet.func_methods.isLeapYear(a)&&moment(t)>=moment(s)&&moment(e)<moment(s)},findResultIndex:function(database,criterias){for(var matches={},i=1;i<database[0].length;++i)matches[i]=!0;for(var maxCriteriaLength=criterias[0].length,i=1;i<criterias.length;++i)criterias[i].length>maxCriteriaLength&&(maxCriteriaLength=criterias[i].length);for(var k=1;k<database.length;++k)for(var l=1;l<database[k].length;++l){for(var currentCriteriaResult=!1,hasMatchingCriteria=!1,j=0;j<criterias.length;++j){var criteria=criterias[j];if(!(criteria.length<maxCriteriaLength)){var criteriaField=criteria[0];if(database[k][0]===criteriaField){hasMatchingCriteria=!0;for(var p=1;p<criteria.length;++p)currentCriteriaResult=currentCriteriaResult||eval(database[k][l]+criteria[p])}}}hasMatchingCriteria&&(matches[l]=matches[l]&&currentCriteriaResult)}for(var result=[],n=0;n<database[0].length;++n)matches[n]&&result.push(n-1);return result},findField:function(e,t){for(var l=null,r=0;r<e.length;r++)if(e[r][0]==t){l=r;break}return null==l?luckysheet.formula.error.v:l},rest:function(e,t){return t=t||1,e&&"function"==typeof e.slice?e.slice(t):e},compact:function(e){if(!e)return e;for(var t=[],l=0;l<e.length;++l)e[l]&&t.push(e[l]);return t}},luckysheet.hexToRgb=function(e){var t=[],l=[];if(3==(e=e.replace(/#/,"")).length){for(var r=[],a=0;a<3;a++)r.push(e.charAt(a)+e.charAt(a));e=r.join("")}for(a=0;a<3;a++)t[a]="0x"+e.substr(a+2,2),l.push(parseInt(Number(t[a])));return"rgb("+l.join(",")+")"},luckysheet.rgbTohex=function(e){var t;return t=-1<e.indexOf("rgba")?e.replace("rgba(","").replace(")","").split(","):e.replace("rgb(","").replace(")","").split(","),"#"+((1<<24)+(parseInt(t[0])<<16)+(parseInt(t[1])<<8)+parseInt(t[2])).toString(16).slice(1)},luckysheet.luckysheetABCatNum=function(e){var t=(e=e.toUpperCase()).length;if(0==t)return NaN;for(var l=e.split(""),r=columeHeader_word.length,a=0,s=t-1;0<=s;s--)a+=s==t-1?columeHeader_word_index[l[s]]:Math.pow(r,t-s-1)*(columeHeader_word_index[l[s]]+1);return a},luckysheet.luckysheetchatatABC=function(e){var t=columeHeader_word.length;if(e<t)return columeHeader_word[e];for(var l=0,r="",a=1,s=0;e>=t/(t-1)*(Math.pow(t,a++)-1);)s=a;for(var l=1+(e-t/(t-1)*(Math.pow(t,s-1)-1)),n=s;0<n;n--){var o=l;if(1==n)return 0==(o%=t)&&(o=26),r+columeHeader_word[o-1];o=Math.ceil(o/Math.pow(t,n-1)),r+=columeHeader_word[o-1],1<n&&(l-=(o-1)*t)}},luckysheet.getByteLen=function(e){if(null==e)return 0;for(var t=0,l=0;l<e.length;l++){null!=e.charAt(l).match(/[^\x00-\xff]/gi)?t+=2:t+=1}return t},luckysheet.ceateABC=function(e){var t=columeHeader_word.length;if(e<t)return columeHeader_word;for(var l=[],r=2,a=0;e<t/(t-1)*(Math.pow(t,r)-1);)a=r,r++;for(var s=0;s<a;s++)l=0==s?l.concat(columeHeader_word):l.concat(luckysheet.createABCdim(s),e)},luckysheet.convertRowColumn=function(e){if(0==e.length)return[];for(var t=[],l=0;l<e[0].length;l++){t[l]=[];for(var r=0;r<e.length;r++)t[l][r]=e[r][l]}return t},luckysheet.createABCdim=function(e,t){var l=columeHeader_word.length;if(1==e)for(var r=[],a=0,s=0;s<l;s++)for(var n=columeHeader_word[s],o=0;o<l;o++){var c=n+columeHeader_word[o];if(r.push(c),++a>index)return r}else if(2==e)for(r=[],a=0,s=0;s<l;s++)for(var u=columeHeader_word[s],i=0;i<l;i++)for(var h=columeHeader_word[i],o=0;o<l;o++){var d=u+h+columeHeader_word[o];if(r.push(d),++a>index)return r}},luckysheet.jfshowloading=function(e){$("#luckysheet-cell-loading").find("span").text(e).end().show()},luckysheet.jfhideloading=function(){$("#luckysheet-cell-loading").hide()},luckysheet.browser={mobilecheck:function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),document.body&&document.body.clientWidth&&document.body.clientHeight&&document.body.clientWidth<350&&document.body.clientHeight<500&&(t=!0),t},iphoneCheck:function(){return/iPhone/i.test(navigator.userAgent),!0},isWeixin:function(){return"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)},isAndroid:function(){var e=navigator.userAgent;return navigator.appVersion,-1<e.indexOf("Android")||-1<e.indexOf("Linux")},tabletCheck:function(){return/ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase())},BrowserType:function(){var e=navigator.userAgent,t=-1<e.indexOf("Opera"),l=-1<e.indexOf("compatible")&&-1<e.indexOf("MSIE")&&!t,r=-1<e.indexOf("Trident")&&-1<e.indexOf("rv:11.0"),a=-1<e.indexOf("Edge"),s=-1<e.indexOf("Firefox"),n=-1<e.indexOf("Safari")&&-1==e.indexOf("Chrome"),o=-1<e.indexOf("Chrome")&&-1<e.indexOf("Safari");if(l){new RegExp("MSIE (\\d+\\.\\d+);").test(e);var c=parseFloat(RegExp.$1);return 7==c?"IE7":8==c?"IE8":9==c?"IE9":10==c?"IE10":"0"}return s?"FF":t?"Opera":n?"Safari":o?"Chrome":a?"Edge":r?"IE11":void 0},isIE:function(){var e=navigator.userAgent,t=-1<e.indexOf("Opera"),l=-1<e.indexOf("compatible")&&-1<e.indexOf("MSIE")&&!t,r=-1<e.indexOf("Trident")&&-1<e.indexOf("rv:11.0");return l||r?"1":"-1"},IEVersion:function(){var e=navigator.userAgent,t=-1<e.indexOf("Opera"),l=-1<e.indexOf("compatible")&&-1<e.indexOf("MSIE")&&!t,r=-1<e.indexOf("Trident")&&-1<e.indexOf("rv:11.0"),a=-1<e.indexOf("Windows NT 6.1; Trident/7.0;")&&!l;if(l){new RegExp("MSIE (\\d+\\.\\d+);").test(e);var s=parseFloat(RegExp.$1);return 7==s?"IE7":8==s?"IE8":9==s?"IE9":10==s?"IE10":"0"}return a?"Edge":r?"IE11":"-1"},luckysheetrefreshfixednum:null,luckysheetrefreshfixed:function(){var e=this;return null==e.luckysheetrefreshfixednum&&("FF"==e.BrowserType()?e.luckysheetrefreshfixednum=5:e.luckysheetrefreshfixednum=0),e.luckysheetrefreshfixednum}};var mobilecheck=luckysheet.browser.mobilecheck(),luckysheet_touchmove_status,luckysheet_touchmove_startPos,luckysheet_touchhandle_status;mobilecheck&&(cellMainSrollBarSize=0,luckysheet_touchmove_status=!1,luckysheet_touchmove_startPos={},luckysheet_touchhandle_status=!1,$(document).on("touchstart","#luckysheet-grid-window-1",function(e){luckysheet_touchmove_status=!0;var t=e.originalEvent.targetTouches[0];luckysheet_touchmove_startPos={x:t.pageX,y:t.pageY}}),$(document).on("touchmove","#luckysheet-grid-window-1",function(e){var t,l,r,a,s,n,o,c,u,i,h,d,y,f,m,k,p,g,v,b,_,w,x,C;1<e.originalEvent.targetTouches.length||e.scale&&1!==e.scale||(t=e.originalEvent.targetTouches[0],luckysheet_touchmove_status?(l=t.pageX-luckysheet_touchmove_startPos.x,r=t.pageY-luckysheet_touchmove_startPos.y,luckysheet_touchmove_startPos={x:t.pageX,y:t.pageY},a=$("#luckysheet-cell-main").scrollLeft(),s=$("#luckysheet-cell-main").scrollTop(),(a-=l)<0&&(a=0),(s-=r)<0&&(s=0),Math.abs(l)<Math.abs(r)?$("#luckysheet-scrollbar-y").scrollTop(s):$("#luckysheet-scrollbar-x").scrollLeft(a)):luckysheet_touchhandle_status&&(o=(n=luckysheet.mouseposition(t.pageX,t.pageY))[0]+$("#luckysheet-cell-main").scrollLeft(),c=n[1]+$("#luckysheet-cell-main").scrollTop(),i=(u=luckysheet.rowLocation(c))[1],h=u[0],d=u[2],f=(y=luckysheet.colLocation(o))[1],m=y[0],k=y[2],v=g=0,b=[],b=(p=$.extend(!0,{},luckysheet_select_save[luckysheet_select_save.length-1])).top>h?(g=h,v=p.top+p.height-h,p.row[1]>p.row_focus&&(p.row[1]=p.row_focus),[d,p.row[1]]):p.top==h?(g=h,v=p.top+p.height-h,[d,p.row[0]]):(g=p.top,v=i-p.top-1,p.row[0]<p.row_focus&&(p.row[0]=p.row_focus),[p.row[0],d]),w=_=0,x=[],x=p.left>m?(_=m,w=p.left+p.width-m,p.column[1]>p.column_focus&&(p.column[1]=p.column_focus),[k,p.column[1]]):p.left==m?(_=m,w=p.left+p.width-m,[k,p.column[0]]):(_=p.left,w=f-p.left-1,p.column[0]<p.column_focus&&(p.column[0]=p.column_focus),[p.column[0],k]),null!=(C=luckysheet.menuButton.mergeMoveMain(x,b,p,g,v,_,w))&&(x=C[0],b=C[1],g=C[2],v=C[3],_=C[4],w=C[5]),p.row=b,p.column=x,p.left_move=_,p.width_move=w,p.top_move=g,p.height_move=v,luckysheet_select_save[luckysheet_select_save.length-1]=p,luckysheet.selectHightlightShow(),luckysheet.freezen.scrollFreezen()),e.stopPropagation())}),$(document).on("touchend",function(e){luckysheet_touchmove_status=!1,luckysheet_touchhandle_status=!(luckysheet_touchmove_startPos={})}),$(document).on("touchstart",".luckysheet-cs-touchhandle",function(e){luckysheet_touchhandle_status=!0,e.stopPropagation()}),document.addEventListener("touchmove",function(e){e.preventDefault()},{passive:!1})),luckysheet.controlHistory={redo:function(e){if(0!=luckysheet.jfredo.length){var ctr=luckysheet.jfredo.pop();if(luckysheet.jfundo.push(ctr),clearjfundo=!1,luckysheet.sheetmanage.hasSheet(ctr.sheetIndex)&&luckysheet.currentSheetIndex!=ctr.sheetIndex&&luckysheet.sheetmanage.changeSheetExec(ctr.sheetIndex),"datachange"==ctr.type){for(var s=0;s<ctr.range.length;s++)for(var st_r=ctr.range[s].row[0],ed_r=ctr.range[s].row[1],st_c=ctr.range[s].column[0],ed_c=ctr.range[s].column[1],r=st_r;r<ed_r+1;r++)for(var c=st_c;c<ed_c+1;c++)null==ctr.data[r][c]&&luckysheet.formula.delFunctionGroup(r,c);luckysheet.formula.execFunctionGroup(null,null,null,null,ctr.data),luckysheet.jfrefreshgrid(ctr.data,ctr.range,ctr.config,ctr.cdformat,ctr.RowlChange)}else if("pasteCut"==ctr.type){var s={sheetIndex:ctr.source.sheetIndex,data:ctr.source.curData,curData:ctr.source.data,config:ctr.source.curConfig,curConfig:ctr.source.config,cdformat:ctr.source.curCdformat,curCdformat:ctr.source.cdformat,range:ctr.source.range},t={sheetIndex:ctr.target.sheetIndex,data:ctr.target.curData,curData:ctr.target.data,config:ctr.target.curConfig,curConfig:ctr.target.config,cdformat:ctr.target.curCdformat,curCdformat:ctr.target.cdformat,range:ctr.target.range};luckysheet.jfrefreshgrid_pastcut(s,t,ctr.RowlChange)}else if("cellchange"==ctr.type)luckysheet.formula.execFunctionGroup(ctr.uprow,ctr.upcolumn,ctr.value),luckysheet.jfrefreshcell(ctr.value,ctr.uprow,ctr.upcolumn);else if("rangechange"==ctr.type){for(var s=0;s<ctr.range.length;s++)for(var st_r=ctr.range[s].row[0],ed_r=ctr.range[s].row[1],st_c=ctr.range[s].column[0],ed_c=ctr.range[s].column[1],r=st_r;r<ed_r+1;r++)for(var c=st_c;c<ed_c+1;c++)null==ctr.data[r][c]&&luckysheet.formula.delFunctionGroup(r,c);luckysheet.formula.execFunctionGroup(null,null,null,null,ctr.data),luckysheet.jfrefreshrange(ctr.data,ctr.range,ctr.cdformat)}else if("resize"==ctr.type)config=ctr.config,luckysheetfile[luckysheet.sheetmanage.getSheetIndex(ctr.sheetIndex)].config=config,"resizeR"==ctr.ctrlType?luckysheet.server.saveParam("cg",ctr.sheetIndex,ctr.config.rowlen,{k:"rowlen"}):"resizeC"==ctr.ctrlType&&luckysheet.server.saveParam("cg",ctr.sheetIndex,ctr.config.columlen,{k:"columlen"}),luckysheet.jfrefreshgrid_rhcw(luckysheet.flowdata.length,luckysheet.flowdata[0].length);else if("cellRowChange"==ctr.type)luckysheet.jfrefreshgridall(ctr.data[0].length,ctr.data.length,ctr.data,ctr.config,ctr.range,ctr.ctrlType,ctr.ctrlValue,ctr.cdformat);else if("extend"==ctr.type)luckysheet.jfrefreshgridall(ctr.data[0].length,ctr.data.length,ctr.data,ctr.config,ctr.range,"dele",ctr.ctrlValue);else if("dele"==ctr.type){var ctrlValue1=$.extend(!0,{},ctr.ctrlValue);ctrlValue1.restore=!0,luckysheet.jfrefreshgridall(ctr.data[0].length,ctr.data.length,ctr.data,ctr.config,ctr.range,"extend",ctrlValue1)}else if("addRC"==ctr.type){var ctrlValue=$.extend(!0,{},ctr.ctrlValue);"rightbottom"==ctrlValue.direction&&(ctrlValue.index=ctrlValue.index+1),luckysheet.jfrefreshgrid_adRC(ctr.data,ctr.config,"delRC",ctrlValue,ctr.calc,ctr.filterObj,ctr.cf,ctr.af,ctr.freezen)}else if("delRC"==ctr.type){var ctrlValue=$.extend(!0,{},ctr.ctrlValue);ctrlValue.restore=!0,ctrlValue.direction="lefttop",luckysheet.jfrefreshgrid_adRC(ctr.data,ctr.config,"addRC",ctrlValue,ctr.calc,ctr.filterObj,ctr.cf,ctr.af,ctr.freezen)}else if("datachangeAll"==ctr.type)luckysheet.formula.execFunctionGroup(),luckysheet.jfrefreshgridall(ctr.data[0].length,ctr.data.length,ctr.data,null,ctr.range,"datachangeAll",ctr.ctrlValue);else if("datachangeAll_filter_clear"==ctr.type)luckysheet.createFilterOptions(ctr.filter_save),$("#luckysheet-filter-options-sheet"+luckysheet.currentSheetIndex+" .luckysheet-filter-options").each(function(e){var t=$(this),l=ctr.optiongroups[e];luckysheet.labelFilterOptionState(t,l.optionstate,l.rowhidden,l.caljs,!1,l.st_r,l.ed_r,l.cindex,l.st_c,l.ed_c)}),luckysheet.server.saveParam("fsr",luckysheet.currentSheetIndex,{filter:ctr.optiongroups,filter_select:ctr.filter_save}),config=ctr.config,luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].config=config,null==config.rowhidden&&(config.rowhidden={}),luckysheet.server.saveParam("cg",luckysheet.currentSheetIndex,config.rowhidden,{k:"rowhidden"}),luckysheet.jfrefreshgrid_rhcw(luckysheet.flowdata.length,luckysheet.flowdata[0].length),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide();else if("datachangeAll_filter"==ctr.type){var $top=$("#luckysheet-filter-options-sheet"+luckysheet.currentSheetIndex+" .luckysheet-filter-options").eq(ctr.optionsindex),st_r=$top.data("str"),ed_r=$top.data("edr"),cindex=$top.data("cindex"),st_c=$top.data("stc"),ed_c=$top.data("edc");luckysheet.labelFilterOptionState($top,luckysheet.json.hasKey(ctr.rowhidenPre),ctr.rowhidenPre,ctr.caljs,!0,st_r,ed_r,cindex,st_c,ed_c),config=ctr.config,luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].config=config,null==config.rowhidden&&(config.rowhidden={}),luckysheet.server.saveParam("cg",luckysheet.currentSheetIndex,config.rowhidden,{k:"rowhidden"}),luckysheet.jfrefreshgrid_rhcw(luckysheet.flowdata.length,luckysheet.flowdata[0].length),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide()}else if("filtershow"==ctr.type)$("#luckysheet-filter-selected-sheet"+ctr.sheetIndex+", #luckysheet-filter-options-sheet"+ctr.sheetIndex).remove(),luckysheet.server.allowUpdate&&luckysheet.server.saveParam("all",ctr.sheetIndex,null,{k:"filter_select"});else if("pivotTable_change"==ctr.type)luckysheetfile[luckysheet.sheetmanage.getSheetIndex(ctr.sheetIndex)].pivotTable=ctr.pivotTable,luckysheet.pivotTable.getCellData(ctr.sheetIndex),luckysheet.pivotTable.initialPivotManage(!0),luckysheet.pivotTable.refreshPivotTable();else if("addSheet"==ctr.type)luckysheet.sheetmanage.deleteSheet(ctr.index),luckysheet.sheetmanage.changeSheetExec(ctr.currentSheetIndex),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide();else if("copySheet"==ctr.type)luckysheet.sheetmanage.deleteSheet(ctr.index),luckysheet.sheetmanage.changeSheetExec(ctr.copyindex);else if("deleteSheet"==ctr.type){for(var isDupName=!1,i=0;i<luckysheetfile.length;i++)luckysheetfile[i].name==ctr.name&&(isDupName=!0);isDupName||(luckysheet.sheetmanage.createSheetbydata(ctr,"isrenew"),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide())}else if("sheetName"==ctr.type)luckysheetfile[luckysheet.sheetmanage.getSheetIndex(ctr.sheetIndex)].name=ctr.oldtxt,$("#luckysheet-sheets-item"+ctr.sheetIndex).find(".luckysheet-sheets-item-name").html(ctr.oldtxt),luckysheet.server.saveParam("all",ctr.sheetIndex,ctr.oldtxt,{k:"name"});else if("sheetColor"==ctr.type){luckysheetfile[luckysheet.sheetmanage.getSheetIndex(ctr.sheetIndex)].color=ctr.oldcolor;var luckysheetcurrentSheetitem=$("#luckysheet-sheets-item"+ctr.sheetIndex);luckysheetcurrentSheetitem.find(".luckysheet-sheets-item-color").remove(),null!=ctr.oldcolor&&luckysheetcurrentSheetitem.append('<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+ctr.oldcolor+';"></div>'),luckysheet.server.saveParam("all",ctr.sheetIndex,ctr.oldcolor,{k:"color"})}else if("insertChart"==ctr.type)luckysheet.chartparam.luckysheetInsertChartTosheetChange=!1,window.store&&store.commit("deleteChart",ctr.chart_json.chart_id),luckysheet.chartparam.luckysheetInsertChartTosheetChange=!0;else if("moveChart"==ctr.type)$("#"+ctr.chart_id+"_c").css({top:ctr.y,left:ctr.x}),$("#luckysheet-scrollbar-y").scrollTop(ctr.scrollTop1),$("#luckysheet-scrollbar-x").scrollLeft(ctr.scrollLeft1),window.store&&store.commit({type:"updateChartItem",key:"left",value:ctr.x,chartId:ctr.chart_id}),window.store&&store.commit({type:"updateChartItem",key:"top",value:ctr.y,chartId:ctr.chart_id}),luckysheet.server.saveParam("c",ctr.sheetIndex,{left:ctr.x,top:ctr.y,scrollTop:ctr.scrollTop1,scrollLeft:ctr.scrollLeft1},{op:"xy",cid:ctr.chart_id});else if("resizeChart"==ctr.type)$("#"+ctr.chart_id+"_c").css({height:ctr.myHeight1,width:ctr.myWidth1,top:ctr.y,left:ctr.x}),$("#luckysheet-scrollbar-y").scrollTop(ctr.scrollTop1),$("#luckysheet-scrollbar-x").scrollLeft(ctr.scrollLeft1),window.store&&store.commit({type:"updateChartItem",key:"height",value:ctr.myHeight1,chartId:ctr.chart_id}),window.store&&store.commit({type:"updateChartItem",key:"width",value:ctr.myWidth1,chartId:ctr.chart_id}),window.store&&store.commit({type:"updateChartItem",key:"left",value:ctr.x,chartId:ctr.chart_id}),window.store&&store.commit({type:"updateChartItem",key:"top",value:ctr.y,chartId:ctr.chart_id}),window.generator&&generator.resize(ctr.chart_id),luckysheet.server.saveParam("c",ctr.sheetIndex,{width:ctr.myWidth1,height:ctr.myHeight1,top:ctr.y,left:ctr.x,scrollTop:ctr.scrollTop1,scrollLeft:ctr.scrollLeft1},{op:"wh",cid:ctr.chart_id});else if("updateChartRange"==ctr.type)luckysheet.chartparam.luckysheet_chart_redo_click=!0,luckysheet.chartparam.luckysheetInsertChartTosheetChange=!1,luckysheet.updateChartTosheet("updateChartRange",ctr.p_sheetIndex,ctr.p_dataSheetIndex,ctr.p_option,ctr.p_chartType,ctr.p_selfOption,ctr.p_defaultOption,ctr.p_row,ctr.p_column,ctr.p_chart_selection_color,ctr.p_chart_id,ctr.p_chart_selection_id,ctr.p_chartStyle,ctr.p_rangeConfigCheck,ctr.p_rangeRowCheck,ctr.p_rangeColCheck,ctr.p_chartMarkConfig,ctr.p_chartTitleConfig,ctr.p_chartTheme),luckysheet.chartparam.luckysheetInsertChartTosheetChange=!0,luckysheet.chartparam.luckysheet_chart_redo_click=!1,luckysheet.chartrangechange(ctr.p_row,ctr.p_column,ctr.p_sheetIndex,ctr.p_dataSheetIndex,ctr.p_chart_selection_id,ctr.p_rangeConfigCheck,ctr.p_rangeRowCheck,ctr.p_rangeColCheck,ctr.p_chart_id),luckysheet.isEditMode()||window.generator&&generator.hideChartSettingComponent();else if("updateChartType"==ctr.type)luckysheet.chartparam.luckysheet_chart_redo_click=!0,luckysheet.chartparam.luckysheetInsertChartTosheetChange=!1,luckysheet.updateChartTosheet("updateChartType",ctr.p_sheetIndex,ctr.p_dataSheetIndex,ctr.p_option,ctr.p_chartType,ctr.p_selfOption,ctr.p_defaultOption,ctr.p_row,ctr.p_column,ctr.p_chart_selection_color,ctr.p_chart_id,ctr.p_chart_selection_id,ctr.p_chartStyle,ctr.p_rangeConfigCheck,ctr.p_rangeRowCheck,ctr.p_rangeColCheck,ctr.p_chartMarkConfig,ctr.p_chartTitleConfig,ctr.p_chartTheme),luckysheet.chartparam.luckysheetInsertChartTosheetChange=!0,luckysheet.chartparam.luckysheet_chart_redo_click=!1,luckysheet.chartTypeChange(ctr.p_chartType,ctr.p_selfOption,ctr.p_defaultOption,ctr.p_chartStyle,ctr.p_chartMarkConfig,ctr.p_chartTitleConfig,ctr.p_chart_id),luckysheet.isEditMode()||window.generator&&generator.hideChartSettingComponent();else if("updateChartTheme"==ctr.type){null!=luckysheet.chartparam.luckysheetcurrentChart&&luckysheet.chartparam.luckysheetcurrentChart.dispose();var chartTheme="default0000";null!=ctr.p_chartTheme&&0<ctr.p_chartTheme.length&&"object"!=luckysheet.getObjType(ctr.p_chartTheme)&&"default0000"!=ctr.p_chartTheme&&(chartTheme=eval("("+ctr.p_chartTheme+")")),luckysheet.chartparam.luckysheetcurrentChart=jgridChart=echarts.init($("#"+ctr.p_chart_id).find(".luckysheet-modal-dialog-content").get(0),chartTheme),luckysheet.chartparam.luckysheet_chart_default_config=eval("("+ctr.p_defaultOption+")"),luckysheet.chartparam.luckysheet_chart_self_config=eval("("+ctr.p_selfOption+")");var $t=$("#"+ctr.p_chart_id);luckysheet.chartparam.luckysheet_chart_redo_click=!0,$t.mousedown(),luckysheet.chartparam.luckysheetCurrentChartMove=!1,$t.mouseup(),luckysheet.chartparam.luckysheet_chart_redo_click=!1,luckysheet.chartparam.luckysheetcurrentChart.setOption(luckysheet.chartparam.luckysheet_chart_default_config),luckysheet.chartparam.luckysheetcurrentChart.setOption(luckysheet.luckysheetChartConfigHanddle(ctr.p_chartType,"theme",luckysheet.chartparam.luckysheet_chart_self_config)),$t.attr("chartTheme",ctr.p_chartTheme),luckysheet.server.allowUpdate&&luckysheet.server.saveParam("c",ctr.p_sheetIndex,{chartTheme:ctr.p_chartTheme},{op:"update",cid:ctr.p_chart_id}),luckysheet.isEditMode()||window.generator&&generator.hideChartSettingComponent()}else if("updateChart"==ctr.type)luckysheet.chartparam.luckysheetInsertChartTosheetChange=!1,luckysheet.updateChartTosheet(ctr.p_sheetIndex,ctr.p_dataSheetIndex,ctr.p_option,ctr.p_chartType,ctr.p_selfOption,ctr.p_defaultOption,ctr.p_row,ctr.p_column,ctr.p_chart_selection_color,ctr.p_chart_id,ctr.p_chart_selection_id,ctr.p_chartStyle,ctr.p_rangeConfigCheck,ctr.p_rangeRowCheck,ctr.p_rangeColCheck,ctr.p_chartMarkConfig,ctr.p_chartTitleConfig,ctr.p_chartTheme),luckysheet.chartparam.luckysheetInsertChartTosheetChange=!0,luckysheet.isEditMode()||window.generator&&generator.hideChartSettingComponent();else if("updateChartAll"==ctr.type){var chart_json=ctr.pre_Chart_json;luckysheet.chartparam.luckysheetInsertChartTosheetChange=!1,window.generator&&generator.patchVueSet(chart_json),window.generator&&generator.generateChart(chart_json.defaultOption,chart_json.chartTheme,chart_json.chartAllType,$("#"+chart_json.chart_id).get(0)),luckysheet.chartparam.luckysheetInsertChartTosheetChange=!0}else if("deleteChart"==ctr.type)luckysheet.chartparam.luckysheetInsertChartTosheetChange=!1,window.store&&store.commit("insertChart",ctr.chart_json),luckysheet.chartparam.luckysheetInsertChartTosheetChange=!0;else if("mergeChange"==ctr.type)luckysheet.jfrefreshgrid(ctr.data,ctr.range,ctr.config);else if("updateCF"==ctr.type){for(var historyRules=ctr.data.historyRules,i=0;i<historyRules.length;i++){var sheetIndex=historyRules[i].sheetIndex;luckysheetfile[luckysheet.sheetmanage.getSheetIndex(sheetIndex)].luckysheet_conditionformat_save=historyRules[i].luckysheet_conditionformat_save,luckysheet.server.allowUpdate&&luckysheet.server.saveParam("all",sheetIndex,historyRules[i].luckysheet_conditionformat_save,{k:"luckysheet_conditionformat_save"})}luckysheet.conditionformat.ref()}else if("updateAF"==ctr.type){var historyRules=ctr.data.historyRules,index=luckysheet.sheetmanage.getSheetIndex(ctr.sheetIndex);luckysheetfile[index].luckysheet_alternateformat_save=$.extend(!0,[],historyRules),setTimeout(function(){luckysheet.luckysheetrefreshgrid()},1)}else if("borderChange"==ctr.type)null==ctr.config.borderInfo?luckysheet.server.saveParam("cg",ctr.sheetIndex,[],{k:"borderInfo"}):luckysheet.server.saveParam("cg",ctr.sheetIndex,ctr.config.borderInfo,{k:"borderInfo"}),config=ctr.config,luckysheetfile[luckysheet.sheetmanage.getSheetIndex(ctr.sheetIndex)].config=config,setTimeout(function(){luckysheet.luckysheetrefreshgrid()},1);else if("postil"==ctr.type){luckysheet.postil.ref(ctr.data,ctr.rc);for(var i=0;i<ctr.rc.length;i++){var r=ctr.rc[i].split("_")[0],c=ctr.rc[i].split("_")[1];null!=ctr.data[r][c]&&null!=ctr.data[r][c].ps?luckysheet.postil.buildPs(r,c,ctr.data[r][c].ps):luckysheet.postil.buildPs(r,c,null)}}luckysheet.cleargridelement(e),clearjfundo=!0}},undo:function(){if(0!=luckysheet.jfundo.length){var ctr=luckysheet.jfundo.pop();if(luckysheet.jfredo.push(ctr),clearjfundo=!1,luckysheet.sheetmanage.hasSheet(ctr.sheetIndex)&&luckysheet.currentSheetIndex!=ctr.sheetIndex&&luckysheet.sheetmanage.changeSheetExec(ctr.sheetIndex),"datachange"==ctr.type)luckysheet.formula.execFunctionGroup(),luckysheet.jfrefreshgrid(ctr.curdata,ctr.range,ctr.curConfig,ctr.curCdformat,ctr.RowlChange);else if("pasteCut"==ctr.type)luckysheet.jfrefreshgrid_pastcut(ctr.source,ctr.target,ctr.RowlChange);else if("cellchange"==ctr.type)luckysheet.formula.execFunctionGroup(ctr.uprow,ctr.upcolumn,ctr.curvalue),luckysheet.jfrefreshcell(ctr.curvalue,ctr.uprow,ctr.upcolumn);else if("rangechange"==ctr.type)luckysheet.formula.execFunctionGroup(),luckysheet.jfrefreshrange(ctr.curdata,ctr.range,ctr.curCdformat);else if("resize"==ctr.type)config=ctr.curconfig,luckysheetfile[luckysheet.sheetmanage.getSheetIndex(ctr.sheetIndex)].config=config,"resizeR"==ctr.ctrlType?luckysheet.server.saveParam("cg",ctr.sheetIndex,ctr.curconfig.rowlen,{k:"rowlen"}):"resizeC"==ctr.ctrlType&&luckysheet.server.saveParam("cg",ctr.sheetIndex,ctr.curconfig.columlen,{k:"columlen"}),luckysheet.jfrefreshgrid_rhcw(luckysheet.flowdata.length,luckysheet.flowdata[0].length);else if("cellRowChange"==ctr.type)luckysheet.jfrefreshgridall(ctr.curdata[0].length,ctr.curdata.length,ctr.curdata,ctr.curconfig,ctr.currange,ctr.ctrlType,ctr.ctrlValue,ctr.curCdformat);else if("extend"==ctr.type)luckysheet.jfrefreshgridall(ctr.curdata[0].length,ctr.curdata.length,ctr.curdata,ctr.curconfig,ctr.currange,ctr.ctrlType,ctr.ctrlValue);else if("dele"==ctr.type){var ctrlValue1=$.extend(!0,{},ctr.ctrlValue);ctrlValue1.restore=!0,luckysheet.jfrefreshgridall(ctr.curdata[0].length,ctr.curdata.length,ctr.curdata,ctr.curconfig,ctr.currange,ctr.ctrlType,ctr.ctrlValue)}else if("addRC"==ctr.type)luckysheet.jfrefreshgrid_adRC(ctr.curData,ctr.curConfig,"addRC",ctr.ctrlValue,ctr.curCalc,ctr.curFilterObj,ctr.curCf,ctr.curAf,ctr.curFreezen);else if("delRC"==ctr.type)luckysheet.jfrefreshgrid_adRC(ctr.curData,ctr.curConfig,"delRC",ctr.ctrlValue,ctr.curCalc,ctr.curFilterObj,ctr.curCf,ctr.curAf,ctr.curFreezen);else if("datachangeAll"==ctr.type)luckysheet.formula.execFunctionGroup(),luckysheet.jfrefreshgridall(ctr.curdata[0].length,ctr.curdata.length,ctr.curdata,null,ctr.currange,"datachangeAll",ctr.ctrlValue);else if("datachangeAll_filter_clear"==ctr.type)luckysheet.server.saveParam("fsc",luckysheet.currentSheetIndex,null),config=ctr.curconfig,luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].config=config,luckysheet.server.saveParam("cg",luckysheet.currentSheetIndex,{},{k:"rowhidden"}),luckysheet.jfrefreshgrid_rhcw(luckysheet.flowdata.length,luckysheet.flowdata[0].length),$("#luckysheet-filter-menu .luckysheet-filter-selected-input").hide().find("input").val(),$("#luckysheet-filter-selected span").data("type","0").data("type",null).text("无"),$("#luckysheet-filter-selected-sheet"+luckysheet.currentSheetIndex+", #luckysheet-filter-options-sheet"+luckysheet.currentSheetIndex).remove(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide();else if("datachangeAll_filter"==ctr.type){var $top=$("#luckysheet-filter-options-sheet"+luckysheet.currentSheetIndex+" .luckysheet-filter-options").eq(ctr.optionsindex),st_r=$top.data("str"),ed_r=$top.data("edr"),cindex=$top.data("cindex"),st_c=$top.data("stc"),ed_c=$top.data("edc");luckysheet.labelFilterOptionState($top,luckysheet.json.hasKey(ctr.rowhidden),ctr.rowhidden,ctr.caljs,!0,st_r,ed_r,cindex,st_c,ed_c),config=ctr.curconfig,luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].config=config,luckysheet.server.saveParam("cg",luckysheet.currentSheetIndex,config.rowhidden,{k:"rowhidden"}),luckysheet.jfrefreshgrid_rhcw(luckysheet.flowdata.length,luckysheet.flowdata[0].length),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide()}else if("filtershow"==ctr.type)luckysheet_select_save=[ctr.filter_save],filterchage=!1,luckysheet.createFilter(),filterchage=!0,luckysheet.server.saveParam("all",ctr.sheetIndex,ctr.filter_save,{k:"filter_select"});else if("pivotTable_change"==ctr.type)luckysheetfile[luckysheet.sheetmanage.getSheetIndex(ctr.sheetIndex)].pivotTable=ctr.pivotTablecur,luckysheet.pivotTable.getCellData(ctr.sheetIndex),luckysheet.pivotTable.initialPivotManage(!0),luckysheet.pivotTable.refreshPivotTable();else if("addSheet"==ctr.type)luckysheet.sheetmanage.createSheetbydata(ctr.sheetconfig),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide();else if("copySheet"==ctr.type)luckysheet.sheetmanage.copySheet(ctr.copyindex);else if("deleteSheet"==ctr.type)luckysheet.sheetmanage.deleteSheet(ctr.index),0==ctr.order?luckysheet.sheetmanage.changeSheetExec(luckysheetfile[0].index):luckysheet.sheetmanage.changeSheetExec(luckysheetfile[ctr.order-1].index),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide();else if("sheetName"==ctr.type)luckysheetfile[luckysheet.sheetmanage.getSheetIndex(ctr.sheetIndex)].name=ctr.txt,$("#luckysheet-sheets-item"+ctr.sheetIndex).find(".luckysheet-sheets-item-name").html(ctr.txt),luckysheet.server.saveParam("all",ctr.sheetIndex,ctr.txt,{k:"name"});else if("sheetColor"==ctr.type){luckysheetfile[luckysheet.sheetmanage.getSheetIndex(ctr.sheetIndex)].color=ctr.color;var luckysheetcurrentSheetitem=$("#luckysheet-sheets-item"+ctr.sheetIndex);luckysheetcurrentSheetitem.find(".luckysheet-sheets-item-color").remove(),null!=ctr.color&&luckysheetcurrentSheetitem.append('<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+ctr.color+';"></div>'),luckysheet.server.saveParam("all",ctr.sheetIndex,ctr.color,{k:"color"})}else if("insertChart"==ctr.type)luckysheet.chartparam.luckysheetInsertChartTosheetChange=!1,window.store&&store.commit("insertChart",ctr.chart_json),luckysheet.chartparam.luckysheetInsertChartTosheetChange=!0;else if("moveChart"==ctr.type)$("#"+ctr.chart_id+"_c").css({top:ctr.myTop,left:ctr.myLeft}),$("#luckysheet-scrollbar-y").scrollTop(ctr.scrollTop),$("#luckysheet-scrollbar-x").scrollLeft(ctr.scrollLeft),window.store&&store.commit({type:"updateChartItem",key:"left",value:ctr.myLeft,chartId:ctr.chart_id}),window.store&&store.commit({type:"updateChartItem",key:"top",value:ctr.myTop,chartId:ctr.chart_id}),luckysheet.server.saveParam("c",ctr.sheetIndex,{left:ctr.myLeft,left:ctr.myTop,scrollTop:ctr.scrollTop,scrollLeft:ctr.scrollLeft},{op:"xy",cid:ctr.chart_id});else if("resizeChart"==ctr.type)$("#"+ctr.chart_id+"_c").css({height:ctr.myHeight,width:ctr.myWidth,top:ctr.myTop,left:ctr.myLeft}),$("#luckysheet-scrollbar-y").scrollTop(ctr.scrollTop),$("#luckysheet-scrollbar-x").scrollLeft(ctr.scrollLeft),window.store&&store.commit({type:"updateChartItem",key:"height",value:ctr.myHeight,chartId:ctr.chart_id}),window.store&&store.commit({type:"updateChartItem",key:"width",value:ctr.myWidth,chartId:ctr.chart_id}),window.store&&store.commit({type:"updateChartItem",key:"left",value:ctr.myLeft,chartId:ctr.chart_id}),window.store&&store.commit({type:"updateChartItem",key:"top",value:ctr.myTop,chartId:ctr.chart_id}),window.generator&&generator.resize(ctr.chart_id),luckysheet.server.saveParam("c",ctr.sheetIndex,{width:ctr.myWidth,height:ctr.myHeight,top:ctr.myTop,left:ctr.myLeft,scrollTop:ctr.scrollTop,scrollLeft:ctr.scrollLeft},{op:"wh",cid:ctr.chart_id});else if("updateChartRange"==ctr.type)luckysheet.chartparam.luckysheet_chart_redo_click=!0,luckysheet.chartparam.luckysheetInsertChartTosheetChange=!1,luckysheet.updateChartTosheet("updateChartRange",ctr.sheetIndex,ctr.dataSheetIndex,ctr.option,ctr.chartType,ctr.selfOption,ctr.defaultOption,ctr.row,ctr.column,ctr.chart_selection_color,ctr.chart_id,ctr.chart_selection_id,ctr.chartStyle,ctr.rangeConfigCheck,ctr.rangeRowCheck,ctr.rangeColCheck,ctr.chartMarkConfig,ctr.chartTitleConfig,ctr.chartTheme),luckysheet.chartparam.luckysheetInsertChartTosheetChange=!0,luckysheet.chartparam.luckysheet_chart_redo_click=!1,luckysheet.chartrangechange(ctr.row,ctr.column,ctr.sheetIndex,ctr.dataSheetIndex,ctr.chart_selection_id,ctr.rangeConfigCheck,ctr.rangeRowCheck,ctr.rangeColCheck,ctr.chart_id),window.generator&&generator.hideChartSettingComponent();else if("updateChartType"==ctr.type)luckysheet.chartparam.luckysheet_chart_redo_click=!0,luckysheet.chartparam.luckysheetInsertChartTosheetChange=!1,luckysheet.updateChartTosheet("updateChartType",ctr.sheetIndex,ctr.dataSheetIndex,ctr.option,ctr.chartType,ctr.selfOption,ctr.defaultOption,ctr.row,ctr.column,ctr.chart_selection_color,ctr.chart_id,ctr.chart_selection_id,ctr.chartStyle,ctr.rangeConfigCheck,ctr.rangeRowCheck,ctr.rangeColCheck,ctr.chartMarkConfig,ctr.chartTitleConfig,ctr.chartTheme),luckysheet.chartparam.luckysheetInsertChartTosheetChange=!0,luckysheet.chartparam.luckysheet_chart_redo_click=!1,luckysheet.chartTypeChange(ctr.chartType,ctr.selfOption,ctr.defaultOption,ctr.chartStyle,ctr.chartMarkConfig,ctr.chartTitleConfig,ctr.chart_id),window.generator&&generator.hideChartSettingComponent();else if("updateChartTheme"==ctr.type){null!=luckysheet.chartparam.luckysheetcurrentChart&&luckysheet.chartparam.luckysheetcurrentChart.dispose();var chartTheme="default0000";null!=ctr.chartTheme&&0<ctr.chartTheme.length&&"object"!=luckysheet.getObjType(ctr.chartTheme)&&"default0000"!=ctr.chartTheme&&(chartTheme=eval("("+ctr.chartTheme+")")),luckysheet.chartparam.luckysheetcurrentChart=jgridChart=echarts.init($("#"+ctr.chart_id).find(".luckysheet-modal-dialog-content").get(0),chartTheme),luckysheet.chartparam.luckysheet_chart_default_config=eval("("+ctr.defaultOption+")"),luckysheet.chartparam.luckysheet_chart_self_config=eval("("+ctr.selfOption+")");var $t=$("#"+ctr.chart_id);luckysheet.chartparam.luckysheet_chart_redo_click=!0,$t.mousedown(),luckysheet.chartparam.luckysheetCurrentChartMove=!1,$t.mouseup(),luckysheet.chartparam.luckysheet_chart_redo_click=!1,luckysheet.chartparam.luckysheetcurrentChart.setOption(luckysheet.chartparam.luckysheet_chart_default_config),luckysheet.chartparam.luckysheetcurrentChart.setOption(luckysheet.luckysheetChartConfigHanddle(ctr.chartType,"theme",luckysheet.chartparam.luckysheet_chart_self_config)),$t.attr("chartTheme",ctr.chartTheme),luckysheet.server.saveParam("c",ctr.sheetIndex,{chartTheme:ctr.chartTheme},{op:"update",cid:ctr.chart_id}),window.generator&&generator.hideChartSettingComponent()}else if("updateChart"==ctr.type)luckysheet.chartparam.luckysheetInsertChartTosheetChange=!1,luckysheet.updateChartTosheet(ctr.sheetIndex,ctr.dataSheetIndex,ctr.option,ctr.chartType,ctr.selfOption,ctr.defaultOption,ctr.row,ctr.column,ctr.chart_selection_color,ctr.chart_id,ctr.chart_selection_id,ctr.chartStyle,ctr.rangeConfigCheck,ctr.rangeRowCheck,ctr.rangeColCheck,ctr.chartMarkConfig,ctr.chartTitleConfig,ctr.chartTheme),luckysheet.chartparam.luckysheetInsertChartTosheetChange=!0,window.generator&&generator.hideChartSettingComponent();else if("updateChartAll"==ctr.type){var chart_json=ctr.chart_json;luckysheet.chartparam.luckysheetInsertChartTosheetChange=!1,window.generator&&generator.patchVueSet(chart_json),window.generator&&generator.generateChart(chart_json.defaultOption,chart_json.chartTheme,chart_json.chartAllType,$("#"+chart_json.chart_id).get(0)),luckysheet.chartparam.luckysheetInsertChartTosheetChange=!0}else if("deleteChart"==ctr.type)luckysheet.chartparam.luckysheetInsertChartTosheetChange=!1,window.store&&store.commit("deleteChart",ctr.chart_json.chart_id),luckysheet.chartparam.luckysheetInsertChartTosheetChange=!0;else if("mergeChange"==ctr.type)luckysheet.jfrefreshgrid(ctr.curData,ctr.range,ctr.curConfig);else if("updateCF"==ctr.type){for(var currentRules=ctr.data.currentRules,i=0;i<currentRules.length;i++){var sheetIndex=currentRules[i].sheetIndex;luckysheetfile[luckysheet.sheetmanage.getSheetIndex(sheetIndex)].luckysheet_conditionformat_save=currentRules[i].luckysheet_conditionformat_save,luckysheet.server.allowUpdate&&luckysheet.server.saveParam("all",sheetIndex,currentRules[i].luckysheet_conditionformat_save,{k:"luckysheet_conditionformat_save"})}luckysheet.conditionformat.ref()}else if("updateAF"==ctr.type){var currentRules=ctr.data.currentRules,index=luckysheet.sheetmanage.getSheetIndex(ctr.sheetIndex);luckysheetfile[index].luckysheet_alternateformat_save=$.extend(!0,[],currentRules),setTimeout(function(){luckysheet.luckysheetrefreshgrid()},1)}else if("borderChange"==ctr.type)luckysheet.server.saveParam("cg",ctr.sheetIndex,ctr.curconfig.borderInfo,{k:"borderInfo"}),config=ctr.curconfig,luckysheetfile[luckysheet.sheetmanage.getSheetIndex(ctr.sheetIndex)].config=config,setTimeout(function(){luckysheet.luckysheetrefreshgrid()},1);else if("postil"==ctr.type){luckysheet.postil.ref(ctr.curdata,ctr.rc);for(var i=0;i<ctr.rc.length;i++){var r=ctr.rc[i].split("_")[0],c=ctr.rc[i].split("_")[1];null!=ctr.curdata[r][c]&&null!=ctr.curdata[r][c].ps?luckysheet.postil.buildPs(r,c,ctr.curdata[r][c].ps):luckysheet.postil.buildPs(r,c,null)}}clearjfundo=!0}}},luckysheet.editor={deepCopyFlowDataState:!1,deepCopyFlowDataCache:"",deepCopyFlowDataWorker:null,deepCopyFlowData:function(e){return this.deepCopyFlowDataState?(null!=this.deepCopyFlowDataWorker&&this.deepCopyFlowDataWorker.terminate(),this.deepCopyFlowDataCache):(null==e&&(e=luckysheet.flowdata),$.extend(!0,[],e))},webWorkerFlowDataCache:function(t){var l=this;try{null!=l.deepCopyFlowDataWorker&&l.deepCopyFlowDataWorker.terminate();var e;l.deepCopyFlowDataState=!1,1==luckysheet.browser.isIE()?(e=new Worker("./plugins/Worker-helper.js")).postMessage("self.onmessage=function(e){postMessage(e.data);}"):e=new Worker("data:text/javascript;chartset=US-ASCII,onmessage = function (e) { postMessage(e.data); };"),(l.deepCopyFlowDataWorker=e).postMessage(t),e.onmessage=function(e){l.deepCopyFlowDataCache=e.data,l.deepCopyFlowDataState=!0}}catch(e){l.deepCopyFlowDataCache=$.extend(!0,[],t)}},controlHandler:function(e){var t=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),l=luckysheet_select_save[luckysheet_select_save.length-1],r=null==l.row?0:l.row[0],a=null==l.column?0:l.column[0],s=e.length,n=e[0].length,o=r+s-t.length,c=a+n-t[0].length;(0<o||0<c)&&(t=luckysheet.datagridgrowth([].concat(t),o,c,!0));for(var u=0;u<s;u++){for(var i=[].concat(t[u+r]),h=0;h<n;h++){var d="";null!=e[u]&&null!=e[u][h]&&(d=e[u][h]),i[h+a]=d}t[u+r]=i}0<o||0<c?luckysheet.jfrefreshgridall(t[0].length,t.length,t,null,luckysheet_select_save,"datachangeAll"):luckysheet.jfrefreshrange(t,luckysheet_select_save)},clearRangeByindex:function(e,t,l,r,a){for(var s=luckysheet.sheetmanage.getSheetIndex(a),n=$.extend(!0,[],luckysheetfile[s].data),o=e;o<=t;o++){for(var c=[].concat(n[o]),u=l;u<=r;u++)luckysheet.formula.delFunctionGroup(o,u),luckysheet.formula.execFunctionGroup(o,u,""),c[u]=null;n[o]=c}a==luckysheet.currentSheetIndex?5e3<t-e+1?luckysheet.jfrefreshgrid(n,e,t,l,r):luckysheet.jfrefreshrange(n,{row:[e,t],column:[l,r]}):luckysheetfile[s].data=n},controlHandlerD:function(e){var t=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),l=luckysheet_select_save[luckysheet_select_save.length-1],r=l.row[0],a=l.row[1],s=l.column[0],n=l.column[1],o=e.length,c=e[0].length,u=r+o-t.length,i=s+c-t[0].length;(0<u||0<i)&&(t=luckysheet.datagridgrowth([].concat(t),u,i,!0));for(var h=r;h<=a;h++)for(var d=s;d<=n;d++)t[h][d]=null;for(var y=0;y<o;y++)for(var f=0;f<c;f++)t[r+y][s+f]=e[y][f];var m=[{row:[r,a],column:[s,n]},{row:[r,r+o-1],column:[s,s+c-1]}];luckysheet.jfrefreshgrid(t,m)}},luckysheet.selection={clearcopy:function(e){var t=window.clipboardData;t||e&&(t=e.originalEvent.clipboardData);if(copyType="normal",copysetting=[],luckysheet_selection_range=[],luckysheet.selectionCopyShow(),luckysheet_copy_save={},t)return t.setData("Text"," "),!1;var l=$("#luckysheet-copy-content").css("visibility","hidden");l.val(" "),l.focus(),l.select(),setTimeout(function(){l.blur().css("visibility","visible")},10)},getHtmlBorderStyle:function(e,t){var l="";return-1<(e={0:"none",1:"Thin",2:"Hair",3:"Dotted",4:"Dashed",5:"DashDot",6:"DashDotDot",7:"Double",8:"Medium",9:"MediumDashed",10:"MediumDashDot",11:"MediumDashDotDot",12:"SlantedDashDot",13:"Thick"}[e.toString()]).indexOf("Medium")?l+="1pt ":l+="Thick"==e?"1.5pt ":"0.5pt ","Hair"==e?l+="double ":-1<e.indexOf("DashDotDot")?l+="dotted ":-1<e.indexOf("DashDot")?l+="dashed ":-1<e.indexOf("Dotted")?l+="dotted ":-1<e.indexOf("Dashed")?l+="dashed ":l+="solid ",l+t+";"},copy:function(e){var t=(t=window.clipboardData)||e.originalEvent.clipboardData;luckysheet_selection_range=[];for(var l=luckysheet_select_save[0].row[0],r=luckysheet_select_save[0].row[1],a=luckysheet_select_save[0].column[0],s=luckysheet_select_save[0].column[1],n=[],o=!1,c=!1,u=0;u<luckysheet_select_save.length;u++){luckysheet_select_save[u].row[0]<l&&(l=luckysheet_select_save[u].row[0]),luckysheet_select_save[u].row[1]>r&&(r=luckysheet_select_save[u].row[1]),luckysheet_select_save[u].column[0]<a&&(a=luckysheet_select_save[u].column[0]),luckysheet_select_save[u].column[1]>s&&(s=luckysheet_select_save[u].column[1]);for(var i=luckysheet_select_save[u].row[0];i<=luckysheet_select_save[u].row[1];i++)if(null==config.rowhidden||null==config.rowhidden[i]){null!=config.rowlen&&i in config.rowlen&&(o=!0);for(var h=luckysheet_select_save[u].column[0];h<=luckysheet_select_save[u].column[1];h++){var d=luckysheet.flowdata[i][h];"object"==luckysheet.getObjType(d)&&"mc"in d&&null!=d.mc.rs&&(c=!0)}}luckysheet_selection_range.push({row:luckysheet_select_save[u].row,column:luckysheet_select_save[u].column}),n.push({row:luckysheet_select_save[u].row,column:luckysheet_select_save[u].column})}luckysheet.selectionCopyShow(),luckysheet_copy_save={dataSheetIndex:luckysheet.currentSheetIndex,copyRange:n,RowlChange:o,HasMC:c};var y,f=this;config.borderInfo&&0<config.borderInfo.length&&(y=luckysheet.getBorderInfoCompute());for(var m="",k=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),p="",g=l;g<=r;g++){if(null==config.rowhidden||null==config.rowhidden[g]){m+="<tr>";for(var v=a;v<=s;v++){var b='<td ${span} style="${style}">';if(null!=k[g]&&null!=k[g][v]){var _="",w="";g==l&&(null==config||null==config.columlen||null==config.columlen[v.toString()]?p+='<colgroup width="72px"></colgroup>':p+='<colgroup width="'+config.columlen[v.toString()]+'px"></colgroup>'),v==a&&(null==config||null==config.rowlen||null==config.rowlen[g.toString()]?_+="height:19px;":_+="height:"+config.rowlen[g.toString()]+"px;");var C=null!=k[g][v].ct&&null!=k[g][v].ct.fa&&k[g][v].ct.fa.match(/^(w|W)((0?)|(0\.0+))$/)?luckysheet.getcellvalue(g,v,k):luckysheet.getcellvalue(g,v,k,"m");if(_+=luckysheet.menuButton.getStyleByCell(k,g,v),"object"==luckysheet.getObjType(k[g][v])&&"mc"in k[g][v]){if(!("rs"in k[g][v].mc))continue;if(w='rowspan="'+k[g][v].mc.rs+'" colspan="'+k[g][v].mc.cs+'"',y&&y[g+"_"+v]){for(var T={color:{},style:{}},I={color:{},style:{}},R={color:{},style:{}},S={color:{},style:{}},A=g;A<g+k[g][v].mc.rs;A++)for(var F=v;F<v+k[g][v].mc.cs;F++){A==g&&y[A+"_"+F]&&y[A+"_"+F].t&&(q=y[A+"_"+F].t.style,H=y[A+"_"+F].t.color,null==R.style[q]?R.style[q]=1:R.style[q]=R.style[q]+1,null==R.color[H]?R.color[H]=1:R.color[H]=R.color[H]+1),A==g+k[g][v].mc.rs-1&&y[A+"_"+F]&&y[A+"_"+F].b&&(q=y[A+"_"+F].b.style,H=y[A+"_"+F].b.color,null==S.style[q]?S.style[q]=1:S.style[q]=S.style[q]+1,null==S.color[H]?S.color[H]=1:S.color[H]=S.color[H]+1),F==v&&y[A+"_"+F]&&y[A+"_"+F].l&&(q=y[g+"_"+v].l.style,H=y[A+"_"+F].l.color,null==T.style[q]?T.style[q]=1:T.style[q]=T.style[q]+1,null==T.color[H]?T.color[H]=1:T.color[H]=T.color[H]+1),F==v+k[g][v].mc.cs-1&&y[A+"_"+F]&&y[A+"_"+F].r&&(q=y[A+"_"+F].r.style,H=y[A+"_"+F].r.color,null==I.style[q]?I.style[q]=1:I.style[q]=I.style[q]+1,null==I.color[H]?I.color[H]=1:I.color[H]=I.color[H]+1)}var N=k[g][v].mc.rs,M=k[g][v].mc.cs;if(23<JSON.stringify(T).length){var E=null,O=null;for(x in T.color)T.color[x]>=N/2&&(E=x);for(x in T.style)T.style[x]>=N/2&&(O=x);null!=E&&null!=O&&(_+="border-left:"+f.getHtmlBorderStyle(O,E))}if(23<JSON.stringify(I).length){var j=null,z=null;for(x in I.color)I.color[x]>=N/2&&(j=x);for(x in I.style)I.style[x]>=N/2&&(z=x);null!=j&&null!=z&&(_+="border-right:"+f.getHtmlBorderStyle(z,j))}if(23<JSON.stringify(R).length){var D=null,P=null;for(x in R.color)R.color[x]>=M/2&&(D=x);for(x in R.style)R.style[x]>=M/2&&(P=x);null!=D&&null!=P&&(_+="border-top:"+f.getHtmlBorderStyle(P,D))}if(23<JSON.stringify(S).length){var L=null,B=null;for(x in S.color)S.color[x]>=M/2&&(L=x);for(x in S.style)S.style[x]>=M/2&&(B=x);null!=L&&null!=B&&(_+="border-bottom:"+f.getHtmlBorderStyle(B,L))}}}else{y&&y[g+"_"+v]&&(y[g+"_"+v].l&&(q=y[g+"_"+v].l.style,H=y[g+"_"+v].l.color,_+="border-left:"+f.getHtmlBorderStyle(q,H)),y[g+"_"+v].r&&(q=y[g+"_"+v].r.style,H=y[g+"_"+v].r.color,_+="border-right:"+f.getHtmlBorderStyle(q,H)),y[g+"_"+v].b&&(q=y[g+"_"+v].b.style,H=y[g+"_"+v].b.color,_+="border-bottom:"+f.getHtmlBorderStyle(q,H)),y[g+"_"+v].t&&(q=y[g+"_"+v].t.style,H=y[g+"_"+v].t.color,_+="border-top:"+f.getHtmlBorderStyle(q,H)))}b=luckysheet.replaceHtml(b,{style:_,span:w}),null==C&&(C=luckysheet.getcellvalue(g,v,k)),null==C&&(C=""),b+=C}else{var q,H,_="";y&&y[g+"_"+v]&&(y[g+"_"+v].l&&(q=y[g+"_"+v].l.style,H=y[g+"_"+v].l.color,_+="border-left:"+f.getHtmlBorderStyle(q,H)),y[g+"_"+v].r&&(q=y[g+"_"+v].r.style,H=y[g+"_"+v].r.color,_+="border-right:"+f.getHtmlBorderStyle(q,H)),y[g+"_"+v].b&&(q=y[g+"_"+v].b.style,H=y[g+"_"+v].b.color,_+="border-bottom:"+f.getHtmlBorderStyle(q,H)),y[g+"_"+v].t&&(q=y[g+"_"+v].t.style,H=y[g+"_"+v].t.color,_+="border-top:"+f.getHtmlBorderStyle(q,H))),b+="",g==l&&(null==config||null==config.columlen||null==config.columlen[v.toString()]?p+='<colgroup width="72px"></colgroup>':p+='<colgroup width="'+config.columlen[v.toString()]+'px"></colgroup>'),v==a&&(null==config||null==config.rowlen||null==config.rowlen[g.toString()]?_+="height:19px;":_+="height:"+config.rowlen[g.toString()]+"px;"),b=luckysheet.replaceHtml(b,{style:_,span:""})}m+=b+="</td>"}m+="</tr>"}}if(m='<table data-type="luckysheet_copy_action_table">'+p+m+"</table>",iscopyself=!0,copyType="normal",copysetting=[],t)return t.setData("Text",m),!1;var V=$("#luckysheet-copy-content");V.html(m),V.focus(),V.select(),document.execCommand("selectAll"),document.execCommand("Copy"),setTimeout(function(){$("#luckysheet-copy-content").blur()},10)},copybyformat:function(e,t){var l=(l=window.clipboardData)||e.originalEvent.clipboardData;luckysheet_selection_range=[{row:luckysheet_select_save[0].row,column:luckysheet_select_save[0].column}],luckysheet.selectionCopyShow();var r=t;if(iscopyself=!0,copyType="normal",copysetting=[],l)return l.setData("Text",r),!1;var a=$("#luckysheet-copy-content");a.text(r),a.focus(),a.select(),document.execCommand("selectAll"),document.execCommand("Copy"),setTimeout(function(){a.blur()},10)},isPasteAction:!1,paste:function(t,l){var r=$("#luckysheet-copy-content"),a=this;r.focus(),r.select(),setTimeout(function(){var e=r.html();-1<e.indexOf("luckysheet_copy_action_table")&&null!=luckysheet_copy_save.copyRange&&0<luckysheet_copy_save.copyRange.length?luckysheet_paste_iscut?(luckysheet_paste_iscut=!1,luckysheet.selection.pasteHandlerOfCutPaste(luckysheet_copy_save),luckysheet.selection.clearcopy(t)):luckysheet.selection.pasteHandlerOfCopyPaste(luckysheet_copy_save):"btn"!=l?a.pasteHandler(e):luckysheet.isEditMode()?alert("在表格中进行复制粘贴: Ctrl + C 进行复制, Ctrl + V 进行粘贴, Ctrl + X 进行剪切"):luckysheet.tooltip.info("在表格中进行复制粘贴","<span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + C</span>&nbsp;&nbsp;进行复制<br/><span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + V</span>&nbsp;&nbsp;进行粘贴<br/><span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + X</span>&nbsp;&nbsp;进行剪切")},10)},pasteHandler:function(e,t){if(1<luckysheet_select_save.length&&(luckysheet.isEditMode()?alert("不能对多重选择区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info('<i class="fa fa-exclamation-triangle"></i>提示',"不能对多重选择区域执行此操作，请选择单个区域，然后再试")),"object"==typeof e){if(0==e.length)return;var l=$.extend(!0,{},config);null==l.merge&&(l.merge={}),2<JSON.stringify(t).length&&null==l.borderInfo&&(l.borderInfo=[]);var r=e.length,a=e[0].length,s=luckysheet_select_save[0].row[0],n=s+r-1,o=luckysheet_select_save[0].column[0],c=o+a-1,u=!1;if(null!=l.merge&&(u=luckysheet.hasPartMC(l,s,n,o,c)),u)return void(luckysheet.isEditMode()?alert("不能对合并单元格做部分更改"):luckysheet.tooltip.info('<i class="fa fa-exclamation-triangle"></i>提示',"不能对合并单元格做部分更改"));var i=(I=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata)).length,h=c-I[0].length+1;(0<(M=n-i+1)||0<h)&&(I=luckysheet.datagridgrowth([].concat(I),M,h,!0)),null==l.rowlen&&(l.rowlen={});for(var d=!1,y={},f=s;f<=n;f++){var m=[].concat(I[f]),k=defaultrowlen;null!=l.rowlen[f]&&(k=l.rowlen[f]);for(var p=o;p<=c;p++){"object"==luckysheet.getObjType(m[p])&&"mc"in m[p]&&("rs"in m[p].mc&&delete l.merge[m[p].mc.r+"_"+m[p].mc.c],delete m[p].mc);var g,v=null;null!=e[f-s]&&null!=e[f-s][p-o]&&(v=e[f-s][p-o]),m[p]=$.extend(!0,{},v),null!=v&&"mc"in m[p]&&(null!=m[p].mc.rs?(m[p].mc.r=f,m[p].mc.c=p,l.merge[m[p].mc.r+"_"+m[p].mc.c]=m[p].mc,y[v.mc.r+"_"+v.mc.c]=[m[p].mc.r,m[p].mc.c]):m[p]={mc:{r:y[v.mc.r+"_"+v.mc.c][0],c:y[v.mc.r+"_"+v.mc.c][1]}}),t[f-s+"_"+(p-o)]&&(g={rangeType:"cell",value:{row_index:f,col_index:p,l:t[f-s+"_"+(p-o)].l,r:t[f-s+"_"+(p-o)].r,t:t[f-s+"_"+(p-o)].t,b:t[f-s+"_"+(p-o)].b}},l.borderInfo.push(g));var b=luckysheetfontformat(m[p]),_=luckysheet.menuButton.getTextSize("田",b)[1];k<_&&(k=_,d=!0)}I[f]=m,k!=defaultrowlen&&(l.rowlen[f]=k)}luckysheet_select_save=[{row:[s,n],column:[o,c]}],0<M||0<h||d?luckysheet.jfrefreshgrid(I,luckysheet_select_save,l,null,!0):(luckysheet.jfrefreshgrid(I,luckysheet_select_save,l),luckysheet.selectHightlightShow())}else{for(var w=[],x=(e=e.replace(/\r/g,"")).split("\n"),C=x[0].split("\t").length,T=0;T<x.length;T++)x[T].split("\t").length<C||w.push(x[T].split("\t"));var I=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),R=luckysheet_select_save[luckysheet_select_save.length-1],S=null==R.row?0:R.row[0],A=null==R.column?0:R.column[0],F=w.length,N=w[0].length,u=!1;if(null!=config.merge&&(u=luckysheet.hasPartMC(config,S,S+F-1,A,A+N-1)),u)return void(luckysheet.isEditMode()?alert("不能对合并单元格做部分更改"):luckysheet.tooltip.info('<i class="fa fa-exclamation-triangle"></i>提示',"不能对合并单元格做部分更改"));var M=S+F-I.length,h=A+N-I[0].length;(0<M||0<h)&&(I=luckysheet.datagridgrowth([].concat(I),M,h,!0));for(var E=0;E<F;E++){for(m=[].concat(I[E+S]),p=0;p<N;p++){var O={},j=luckysheet.mask.genarate(w[E][p]);O.v=j[2],O.ct=j[1],O.m=j[0],m[p+A]=O}I[E+S]=m}R.row=[S,S+F-1],R.column=[A,A+N-1],0<M||0<h?luckysheet.jfrefreshgrid(I,luckysheet_select_save,null,null,!0):(luckysheet.jfrefreshgrid(I,luckysheet_select_save),luckysheet.selectHightlightShow())}},pasteHandlerOfCutPaste:function(e){var t=$.extend(!0,{},config);null==t.merge&&(t.merge={});var l=e.HasMC,r=e.RowlChange,a=e.dataSheetIndex,s=$.extend(!0,[],luckysheet.getdatabyselection({row:e.copyRange[0].row,column:e.copyRange[0].column},a)),n=s.length,o=s[0].length,c=luckysheet_select_save[luckysheet_select_save.length-1],u=c.row_focus,i=u+n-1,h=c.column_focus,d=h+o-1,y=!1;if(null!=t.merge&&(y=luckysheet.hasPartMC(t,u,i,h,d)),y)luckysheet.isEditMode()?alert("不能对合并单元格做部分更改"):luckysheet.tooltip.info('<i class="fa fa-exclamation-triangle"></i>提示',"不能对合并单元格做部分更改");else{var f=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),m=n+u-f.length,k=o+h-f[0].length;(0<m||0<k)&&(f=luckysheet.datagridgrowth([].concat(f),m,k,!0));var p=luckysheet.getBorderInfoCompute(a);if(luckysheet.currentSheetIndex==a){for(var g=e.copyRange[0].row[0];g<=e.copyRange[0].row[1];g++)for(var v=e.copyRange[0].column[0];v<=e.copyRange[0].column[1];v++){var b=f[g][v];"object"==luckysheet.getObjType(b)&&"mc"in b&&("rs"in b.mc&&delete t.merge[b.mc.r+"_"+b.mc.c],delete b.mc),f[g][v]=null}if(t.borderInfo&&0<t.borderInfo.length){for(var _=[],g=0;g<t.borderInfo.length;g++){if("range"==(B=t.borderInfo[g].rangeType)){for(var w=t.borderInfo[g].range,x=[],v=0;v<w.length;v++)x=x.concat(luckysheet.conditionformat.CFSplitRange(w[v],{row:e.copyRange[0].row,column:e.copyRange[0].column},{row:[u,i],column:[h,d]},"restPart"));t.borderInfo[g].range=x,_.push(t.borderInfo[g])}else{"cell"==B&&(q=t.borderInfo[g].value.row_index,H=t.borderInfo[g].value.col_index,q>=e.copyRange[0].row[0]&&q<=e.copyRange[0].row[1]&&H>=e.copyRange[0].column[0]&&H<=e.copyRange[0].column[1]||_.push(t.borderInfo[g]))}}t.borderInfo=_}}for(var C={},T=u;T<=i;T++){for(var I,R=[].concat(f[T]),S=h;S<=d;S++){p[e.copyRange[0].row[0]+T-u+"_"+(e.copyRange[0].column[0]+S-h)]?(I={rangeType:"cell",value:{row_index:T,col_index:S,l:p[e.copyRange[0].row[0]+T-u+"_"+(e.copyRange[0].column[0]+S-h)].l,r:p[e.copyRange[0].row[0]+T-u+"_"+(e.copyRange[0].column[0]+S-h)].r,t:p[e.copyRange[0].row[0]+T-u+"_"+(e.copyRange[0].column[0]+S-h)].t,b:p[e.copyRange[0].row[0]+T-u+"_"+(e.copyRange[0].column[0]+S-h)].b}},null==t.borderInfo&&(t.borderInfo=[]),t.borderInfo.push(I)):p[T+"_"+S]&&(I={rangeType:"cell",value:{row_index:T,col_index:S,l:null,r:null,t:null,b:null}},null==t.borderInfo&&(t.borderInfo=[]),t.borderInfo.push(I)),"object"==luckysheet.getObjType(R[S])&&"mc"in R[S]&&("rs"in R[S].mc&&delete t.merge[R[S].mc.r+"_"+R[S].mc.c],delete R[S].mc);var A=null;null!=s[T-u]&&null!=s[T-u][S-h]&&(A=s[T-u][S-h]),R[S]=$.extend(!0,{},A),null!=A&&l&&"mc"in R[S]&&(null!=R[S].mc.rs?(R[S].mc.r=T,R[S].mc.c=S,t.merge[R[S].mc.r+"_"+R[S].mc.c]=R[S].mc,C[A.mc.r+"_"+A.mc.c]=[R[S].mc.r,R[S].mc.c]):R[S]={mc:{r:C[A.mc.r+"_"+A.mc.c][0],c:C[A.mc.r+"_"+A.mc.c][1]}})}f[T]=R}if(c.row=[u,i],c.column=[h,d],r&&(t=(luckysheet.currentSheetIndex!=a||(t=luckysheet.rowlenByRange(f,e.copyRange[0].row[0],e.copyRange[0].row[1],t)),luckysheet.rowlenByRange(f,u,i,t))),luckysheet.currentSheetIndex!=a){var F=$.extend(!0,[],luckysheetfile[luckysheet.sheetmanage.getSheetIndex(a)].data),N=$.extend(!0,{},luckysheetfile[luckysheet.sheetmanage.getSheetIndex(a)].config),M=$.extend(!0,[],F),E=$.extend(!0,{},N);null==E.merge&&(E.merge={});for(var O=e.copyRange[0].row[0],j=e.copyRange[0].row[1],z=e.copyRange[0].column[0],D=e.copyRange[0].column[1],P=O;P<=j;P++)for(var L=z;L<=D;L++){b=M[P][L];"object"==luckysheet.getObjType(b)&&"mc"in b&&("rs"in b.mc&&delete E.merge[b.mc.r+"_"+b.mc.c],delete b.mc),M[P][L]=null}if(r&&(E=luckysheet.rowlenByRange(M,O,j,E)),E.borderInfo&&0<E.borderInfo.length){for(var B,q,H,_=[],g=0;g<E.borderInfo.length;g++){if("range"==(B=E.borderInfo[g].rangeType)){for(w=E.borderInfo[g].range,x=[],v=0;v<w.length;v++)x=x.concat(luckysheet.conditionformat.CFSplitRange(w[v],{row:e.copyRange[0].row,column:e.copyRange[0].column},{row:[u,i],column:[h,d]},"restPart"));E.borderInfo[g].range=x,_.push(E.borderInfo[g])}else{"cell"==B&&(q=E.borderInfo[g].value.row_index,H=E.borderInfo[g].value.col_index,q>=e.copyRange[0].row[0]&&q<=e.copyRange[0].row[1]&&H>=e.copyRange[0].column[0]&&H<=e.copyRange[0].column[1]||_.push(E.borderInfo[g]))}}E.borderInfo=_}var V=$.extend(!0,[],luckysheetfile[luckysheet.sheetmanage.getSheetIndex(a)].luckysheet_conditionformat_save),U=$.extend(!0,[],V),Y=[];if(null!=U&&0<U.length)for(g=0;g<U.length;g++){for(var W,G=U[g].cellrange,X=[],K=[],v=0;v<G.length;v++){var Z=luckysheet.conditionformat.CFSplitRange(G[v],{row:e.copyRange[0].row,column:e.copyRange[0].column},{row:[u,i],column:[h,d]},"restPart");X=X.concat(Z);var J=luckysheet.conditionformat.CFSplitRange(G[v],{row:e.copyRange[0].row,column:e.copyRange[0].column},{row:[u,i],column:[h,d]},"operatePart");0<J.length&&(K=K.concat(J))}U[g].cellrange=X,0<K.length&&((W=$.extend(!0,{},U[g])).cellrange=K,Y.push(W))}var Q=$.extend(!0,[],luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_conditionformat_save),ee=$.extend(!0,[],Q);0<Y.length&&(ee=ee.concat(Y));var te={sheetIndex:a,data:F,curData:M,config:N,curConfig:E,cdformat:V,curCdformat:U,range:{row:e.copyRange[0].row,column:e.copyRange[0].column}},le={sheetIndex:luckysheet.currentSheetIndex,data:luckysheet.flowdata,curData:f,config:$.extend(!0,{},config),curConfig:t,cdformat:Q,curCdformat:ee,range:{row:[u,i],column:[h,d]}}}else{var re=$.extend(!0,[],luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_conditionformat_save),ae=$.extend(!0,[],re);if(null!=ae&&0<ae.length)for(g=0;g<ae.length;g++){for(var se=ae[g].cellrange,X=[],v=0;v<se.length;v++){Z=luckysheet.conditionformat.CFSplitRange(se[v],{row:e.copyRange[0].row,column:e.copyRange[0].column},{row:[u,i],column:[h,d]},"allPart");X=X.concat(Z)}ae[g].cellrange=X}te={sheetIndex:luckysheet.currentSheetIndex,data:luckysheet.flowdata,curData:f,config:$.extend(!0,{},config),curConfig:t,cdformat:re,curCdformat:ae,range:{row:e.copyRange[0].row,column:e.copyRange[0].column}},le={sheetIndex:luckysheet.currentSheetIndex,data:luckysheet.flowdata,curData:f,config:$.extend(!0,{},config),curConfig:t,cdformat:re,curCdformat:ae,range:{row:[u,i],column:[h,d]}}}0<m||0<k?luckysheet.jfrefreshgrid_pastcut(te,le,!0):luckysheet.jfrefreshgrid_pastcut(te,le,r)}},pasteHandlerOfCopyPaste:function(e){var t=$.extend(!0,{},config);null==t.merge&&(t.merge={});for(var l=e.HasMC,r=e.RowlChange,a=e.dataSheetIndex,s=[],n=!1,o=0;o<e.copyRange.length;o++){var c=luckysheet.getdatabyselection({row:e.copyRange[o].row,column:e.copyRange[o].column},a);1<e.copyRange.length?e.copyRange[0].row[0]==e.copyRange[1].row[0]&&e.copyRange[0].row[1]==e.copyRange[1].row[1]?(c=c[0].map(function(e,t){return c.map(function(e){return e[t]})}),s=s.concat(c),n=!0):e.copyRange[0].column[0]==e.copyRange[1].column[0]&&e.copyRange[0].column[1]==e.copyRange[1].column[1]&&(s=s.concat(c)):s=c}n&&(s=s[0].map(function(e,t){return s.map(function(e){return e[t]})}));var u=$.extend(!0,[],s);if(1<e.copyRange.length)for(o=0;o<u.length;o++)for(var i=0;i<u[o].length;i++)null!=u[o][i]&&null!=u[o][i].f&&(delete u[o][i].f,delete u[o][i].spl);var h=u.length,d=u[0].length,y=luckysheet_select_save[luckysheet_select_save.length-1],f=y.row[0],m=y.row[1],k=y.column[0],p=y.column[1];0==(m-f+1)%h&&0==(p-k+1)%d||(m=f+h-1,p=k+d-1);var g=!1;if(null!=t.merge&&(g=luckysheet.hasPartMC(t,f,m,k,p)),g)luckysheet.isEditMode()?alert("不能对合并单元格做部分更改"):luckysheet.tooltip.info('<i class="fa fa-exclamation-triangle"></i>提示',"不能对合并单元格做部分更改");else{var v=(m-f+1)/h,b=(p-k+1)/d,_=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),w=h+f-_.length,x=d+k-_[0].length;(0<w||0<x)&&(_=luckysheet.datagridgrowth([].concat(_),w,x,!0));for(var C=luckysheet.getBorderInfoCompute(a),T=0,I=0,R=0,S=0,A=1;A<=v;A++)for(var F=1;F<=b;F++){I=k+(F-1)*d,S=f+A*h,R=k+F*d;for(var N=(T=f+(A-1)*h)-e.copyRange[0].row[0],M=I-e.copyRange[0].column[0],E={},O=T;O<S;O++){for(var j,z=[].concat(_[O]),D=I;D<R;D++){C[e.copyRange[0].row[0]+O-T+"_"+(e.copyRange[0].column[0]+D-I)]?(j={rangeType:"cell",value:{row_index:O,col_index:D,l:C[e.copyRange[0].row[0]+O-T+"_"+(e.copyRange[0].column[0]+D-I)].l,r:C[e.copyRange[0].row[0]+O-T+"_"+(e.copyRange[0].column[0]+D-I)].r,t:C[e.copyRange[0].row[0]+O-T+"_"+(e.copyRange[0].column[0]+D-I)].t,b:C[e.copyRange[0].row[0]+O-T+"_"+(e.copyRange[0].column[0]+D-I)].b}},null==t.borderInfo&&(t.borderInfo=[]),t.borderInfo.push(j)):C[O+"_"+D]&&(j={rangeType:"cell",value:{row_index:O,col_index:D,l:null,r:null,t:null,b:null}},null==t.borderInfo&&(t.borderInfo=[]),t.borderInfo.push(j)),"object"==luckysheet.getObjType(z[D])&&"mc"in z[D]&&("rs"in z[D].mc&&delete t.merge[z[D].mc.r+"_"+z[D].mc.c],delete z[D].mc);var P,L,B=null;null!=u[O-T]&&null!=u[O-T][D-I]&&(B=$.extend(!0,{},u[O-T][D-I])),null!=B&&null!=B.f&&(P=B.f,0<N&&(P="="+luckysheet.formula.functionCopy(P,"down",N)),N<0&&(P="="+luckysheet.formula.functionCopy(P,"up",Math.abs(N))),0<M&&(P="="+luckysheet.formula.functionCopy(P,"right",M)),M<0&&(P="="+luckysheet.formula.functionCopy(P,"left",Math.abs(M))),L=luckysheet.formula.execfunction(P,O,D,!0),null!=B.spl?(B.f=L[2],B.v=L[1],B.spl=L[3].data):(B.f=L[2],B.v=L[1],null!=B.ct&&null!=B.ct.fa&&(B.m=luckysheet.mask.update(B.ct.fa,L[1])))),z[D]=$.extend(!0,{},B),null!=B&&l&&"mc"in z[D]&&(null!=z[D].mc.rs?(z[D].mc.r=O,z[D].mc.c=D,t.merge[z[D].mc.r+"_"+z[D].mc.c]=z[D].mc,E[B.mc.r+"_"+B.mc.c]=[z[D].mc.r,z[D].mc.c]):z[D]={mc:{r:E[B.mc.r+"_"+B.mc.c][0],c:E[B.mc.r+"_"+B.mc.c][1]}})}_[O]=z}}if(1==e.copyRange.length){var q=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(a)],H=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)],V=e.copyRange[0].row[0],U=e.copyRange[0].row[1],Y=e.copyRange[0].column[0],W=e.copyRange[0].column[1],G=$.extend(!0,[],q.luckysheet_conditionformat_save),X=$.extend(!0,[],H.luckysheet_conditionformat_save);if(null!=G&&0<G.length)for(o=0;o<G.length;o++){for(var K=G[o].cellrange,Z=[],A=1;A<=v;A++)for(F=1;F<=b;F++){T=f+(A-1)*h,I=k+(F-1)*d,S=f+A*h,R=k+F*d;for(i=0;i<K.length;i++){var J=luckysheet.conditionformat.CFSplitRange(K[i],{row:[V,U],column:[Y,W]},{row:[T,S-1],column:[I,R-1]},"operatePart");0<J.length&&(Z=Z.concat(J))}}0<Z.length&&(G[o].cellrange=Z,X.push(G[o]))}}y.row=[f,m],y.column=[k,p],r||0<w||0<x?(t=luckysheet.rowlenByRange(_,f,m,t),1==e.copyRange.length&&null!=G&&0<G.length?luckysheet.jfrefreshgrid(_,luckysheet_select_save,t,X,!0):luckysheet.jfrefreshgrid(_,luckysheet_select_save,t,null,!0)):(1==e.copyRange.length&&null!=G&&0<G.length?luckysheet.jfrefreshgrid(_,luckysheet_select_save,t,X):luckysheet.jfrefreshgrid(_,luckysheet_select_save,t),luckysheet.selectHightlightShow())}},pasteHandlerOfPaintModel:function(e){var t=$.extend(!0,{},config);null==t.merge&&(t.merge={});var l=e.HasMC,r=e.RowlChange,a=e.dataSheetIndex,s=$.extend(!0,[],luckysheet.getdatabyselection({row:e.copyRange[0].row,column:e.copyRange[0].column},a)),n=luckysheet_select_save[luckysheet_select_save.length-1],o=n.row[0],c=n.row[1],u=n.column[0],i=n.column[1],h=s.length,d=s[0].length;if(o==c&&u==i){var y=!1;if(null!=t.merge&&(y=luckysheet.hasPartMC(t,o,o+h-1,u,u+d-1)),y)return void(luckysheet.isEditMode()?alert("不能对合并单元格做部分更改"):luckysheet.tooltip.info('<i class="fa fa-exclamation-triangle"></i>提示',"不能对合并单元格做部分更改"));c=o+h-1,i=u+d-1}for(var f,m,k=Math.ceil((c-o+1)/h),p=Math.ceil((i-u+1)/d),g=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),v=g[0].length,b=g.length,_=luckysheet.getBorderInfoCompute(a),w=0,x=0,C=1;C<=k;C++)for(var T=1;T<=p;T++){m=u+(T-1)*d,c+1<(x=b<o+C*h?b:o+C*h)&&(x=c+1),i+1<(w=v<u+T*d?v:u+T*d)&&(w=i+1);for(var I={},R=f=o+(C-1)*h;R<x;R++){for(var S,A=[].concat(g[R]),F=m;F<w;F++){_[e.copyRange[0].row[0]+R-f+"_"+(e.copyRange[0].column[0]+F-m)]?(S={rangeType:"cell",value:{row_index:R,col_index:F,l:_[e.copyRange[0].row[0]+R-f+"_"+(e.copyRange[0].column[0]+F-m)].l,r:_[e.copyRange[0].row[0]+R-f+"_"+(e.copyRange[0].column[0]+F-m)].r,t:_[e.copyRange[0].row[0]+R-f+"_"+(e.copyRange[0].column[0]+F-m)].t,b:_[e.copyRange[0].row[0]+R-f+"_"+(e.copyRange[0].column[0]+F-m)].b}},null==t.borderInfo&&(t.borderInfo=[]),t.borderInfo.push(S)):_[R+"_"+F]&&(S={rangeType:"cell",value:{row_index:R,col_index:F,l:null,r:null,t:null,b:null}},null==t.borderInfo&&(t.borderInfo=[]),t.borderInfo.push(S)),"object"==luckysheet.getObjType(A[F])&&"mc"in A[F]&&("rs"in A[F].mc&&delete t.merge[A[F].mc.r+"_"+A[F].mc.c],delete A[F].mc);var N,M=null;null!=s[R-f]&&null!=s[R-f][F-m]&&(M=s[R-f][F-m]),null!=M&&(delete M.v,delete M.m,delete M.f,delete M.spl,"object"==luckysheet.getObjType(A[F])||(A[F]={v:A[F]}),A[F]=$.extend(!0,A[F],M),l&&"mc"in A[F]&&(null!=A[F].mc.rs?(A[F].mc.r=R,A[F].mc.rs+R>=x&&(A[F].mc.rs=x-R),A[F].mc.c=F,A[F].mc.cs+F>=w&&(A[F].mc.cs=w-F),t.merge[A[F].mc.r+"_"+A[F].mc.c]=A[F].mc,I[M.mc.r+"_"+M.mc.c]=[A[F].mc.r,A[F].mc.c]):A[F]={mc:{r:I[M.mc.r+"_"+M.mc.c][0],c:I[M.mc.r+"_"+M.mc.c][1]}}),null!=A[F].v&&null!=M.ct&&null!=M.ct.fa&&(N=luckysheet.mask.update(M.ct.fa,A[F].v),A[F].m=N))}g[R]=A}}var E=$.extend(!0,[],luckysheetfile[luckysheet.sheetmanage.getSheetIndex(a)].luckysheet_conditionformat_save),O=$.extend(!0,[],luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_conditionformat_save);if(null!=E&&0<E.length)for(var j=0;j<E.length;j++){for(var z=E[j].cellrange,D=[],P=0;P<z.length;P++){var L=luckysheet.conditionformat.CFSplitRange(z[P],{row:e.copyRange[0].row,column:e.copyRange[0].column},{row:[o,c],column:[u,i]},"operatePart");0<L.length&&(D=D.concat(L))}0<D.length&&(E[j].cellrange=[{row:[o,c],column:[u,i]}],O.push(E[j]))}n.row=[o,c],n.column=[u,i],r?(t=luckysheet.rowlenByRange(g,o,c,t),null!=E&&0<E.length?luckysheet.jfrefreshgrid(g,luckysheet_select_save,t,O,!0):luckysheet.jfrefreshgrid(g,luckysheet_select_save,t,null,!0)):(null!=E&&0<E.length?luckysheet.jfrefreshgrid(g,luckysheet_select_save,t,O):luckysheet.jfrefreshgrid(g,luckysheet_select_save,t),luckysheet.selectHightlightShow())},matchcopy:function(e,t){var l,r,a=[],s=[];if("object"==typeof e)a=e;else{a=e.split("\n");for(var n=0;n<a.length;n++)a[n]=a[n].split("\t")}if(l=a.length,"object"==typeof t)s=t;else{s=t.split("\n");for(n=0;n<s.length;n++)s[n]=s[n].split("\t")}if(l!=(r=s.length))return!1;for(var o=0;o<l;o++)if(null==config.rowhidden||null==config.rowhidden[o])for(var c=0;c<r;c++)if(a[o].length!=s[c].length)return!1;for(var u=0;u<l;u++)if(null==config.rowhidden||null==config.rowhidden[u])for(var i=0;i<a[0].length;i++)if(luckysheet.getcellvalue(u,i,a)!=luckysheet.getcellvalue(u,i,s))return!1;return!0}},luckysheet.datecontroll={isdatetime:function(e){return!(null==e||e.toString().length<5)&&!!function(e){if(!/^(\d{4})-(\d{1,2})-(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/.test(e)&&!/^(\d{4})\/(\d{1,2})\/(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/.test(e))return!1;var t=RegExp.$1,l=RegExp.$2,r=RegExp.$3;if(t<1900)return!1;if(12<l)return!1;if(31<r)return!1;if(2==l){if(29==new Date(t,1,29).getDate()&&29<r)return!1;if(29!=new Date(t,1,29).getDate()&&28<r)return!1}return!0}(e)},diff:function(e,t){return moment(e).diff(moment(t))}},luckysheet.isdatatype=function(e){var t="string";return luckysheet.datecontroll.isdatetime(e)?t="date":isNaN(parseFloat(e))||luckysheet.hasChinaword(e)||(t="num"),t},luckysheet.isdatatypemulti=function(e){var t={};return luckysheet.datecontroll.isdatetime(e)&&(t.date=!0),isNaN(parseFloat(e))||luckysheet.hasChinaword(e)||(t.num=!0),t},luckysheet.numfloatlen=function(e){if(null==e||isNaN(parseFloat(e))||luckysheet.hasChinaword(e))return null;var t=numeral(e).value().toString().split(".");return t=1==t.length?0:t[1].length},luckysheet.range_config=function(e,t,l){if(e&&(luckysheet.chartparam.jgridCurrentChartData=luckysheet.jgfridturntrans(luckysheet.chartparam.jgridCurrentChartData)),!t){for(var r,a=[],s=e?(r=luckysheet.chartparam.jgridCurrentChartSelection.row[0],luckysheet.chartparam.jgridCurrentChartSelection.row[1]):(r=luckysheet.chartparam.jgridCurrentChartSelection.column[0],luckysheet.chartparam.jgridCurrentChartSelection.column[1]),n=r;n<=s;n++)l&&n==r?a.push(""):a.push(luckysheet.luckysheetchatatABC(n));luckysheet.chartparam.jgridCurrentChartData.unshift(a)}if(!l){var o=luckysheet.chartparam.jgridCurrentChartData.length;luckysheet.chartparam.jgridCurrentChartData[0].unshift("");for(n=1;n<o;n++){var c=t?1:0;luckysheet.chartparam.jgridCurrentChartData[n].unshift(luckysheet.luckysheetchatatABC(luckysheet.chartparam.jgridCurrentChartSelection.column[0])+(n+luckysheet.chartparam.jgridCurrentChartSelection.row[0]+c))}}},luckysheet.numFormat=function(e,t){if(null==e||isNaN(parseFloat(e))||luckysheet.hasChinaword(e)||e==-1/0||e==1/0)return null;var l=6,r=!1;null==t||"auto"==t?l=e<1?6:1:"num"==luckysheet.isdatatype(t)?(l=parseInt(t),r=!0):l=6;for(var a="",s=0;s<l;s++)a+="0";return r||(a="["+a+"]"),1e21<=e?parseFloat(numeral(e).value()):parseFloat(numeral(e).format("0."+a))},luckysheet.array={transpose:function(e){var t=[];if(0==e.length)return[];if(0==e[0].length)return[];for(var l=0;l<e[0].length;l++){for(var r=[],a=0;a<e.length;a++){var s="";null!=e[a]&&null!=e[a][l]&&(s=luckysheet.getcellvalue(a,l,e)),r.push(s)}t.push(r)}return t},minusClear:function(e,t){if(t.row[0]>e.row[1]||t.row[1]<e.row[0]||t.column[0]>e.column[1]||t.column[1]<e.column[0])return null;if(t.row[0]==e.row[0]&&t.row[1]<e.row[1]&&t.column[0]>e.column[0]&&t.column[1]<e.column[1])return[];var l=[],r=null,a=[e.column[0],e.column[1]];t.row[1]>e.row[0]&&t.row[1]<e.row[1]?r=[t.row[1]+1,e.row[1]]:t.row[0]>e.row[0]&&t.row[0]<e.row[1]&&(r=[e.row[0],t.row[0]-1]),null!=r&&l.push({row:r,column:a});r=[e.row[0],e.row[1]],a=null;return t.column[1]>e.column[0]&&t.column[1]<e.column[1]?a=[t.column[1]+1,e.column[1]]:t.column[0]>e.column[0]&&t.column[0]<e.column[1]&&(a=[e.column[0],t.column[0]-1]),null!=a&&l.push({row:r,column:a}),l}},luckysheet.analysis={STDEVP:function(e,t){for(var l=0,r=0;r<t.length;r++){var a=t[r];l+=Math.pow(a-e,2)}return luckysheet.numFormat(Math.sqrt(l/t.length))},STDEV:function(e,t){for(var l=0,r=0;r<t.length;r++){var a=t[r];l+=Math.pow(a-e,2)}return luckysheet.numFormat(Math.sqrt(l/(t.length-1)))},VARP:function(e,t){for(var l=0,r=0;r<t.length;r++){var a=t[r];l+=Math.pow(a-e,2)}return luckysheet.numFormat(l/t.length)},VAR:function(e,t){for(var l=0,r=0;r<t.length;r++){var a=t[r];l+=Math.pow(a-e,2)}return luckysheet.numFormat(l/(t.length-1))}},luckysheet.tooltip={info:function(e,t){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-info").remove(),$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-info",addclass:"",title:e,content:t,botton:'<button class="btn btn-default luckysheet-model-close-btn">&nbsp;&nbsp;关闭&nbsp;&nbsp;</button>',style:"z-index:100003"}));var l=$("#luckysheet-info").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),r=l.outerHeight(),a=l.outerWidth(),s=$(window).width(),n=$(window).height(),o=$(document).scrollLeft(),c=$(document).scrollTop();$("#luckysheet-info").css({left:(s+o-a)/2,top:(n+c-r)/3}).show()},confirm:function(e,t,l,r,a,s){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-confirm").remove(),null==a&&(a="确定"),null==s&&(s="取消"),$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-confirm",addclass:"",style:"z-index:100003",title:e,content:t,botton:'<button class="btn btn-primary luckysheet-model-conform-btn">&nbsp;&nbsp;'+a+'&nbsp;&nbsp;</button><button class="btn btn-default luckysheet-model-cancel-btn">&nbsp;&nbsp;'+s+"&nbsp;&nbsp;</button>"}));var n=$("#luckysheet-confirm").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),o=n.outerHeight(),c=n.outerWidth(),u=$(window).width(),i=$(window).height(),h=$(document).scrollLeft(),d=$(document).scrollTop();$("#luckysheet-confirm").css({left:(u+h-c)/2,top:(i+d-o)/3}).show(),n.find(".luckysheet-model-conform-btn").click(function(){"function"==typeof l&&l(),$("#luckysheet-confirm").hide(),$("#luckysheet-modal-dialog-mask").hide()}),n.find(".luckysheet-model-cancel-btn").click(function(){"function"==typeof r&&r(),$("#luckysheet-confirm").hide(),$("#luckysheet-modal-dialog-mask").hide()})},screenshot:function(e,t,l){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-confirm").remove(),$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-confirm",addclass:"",style:"z-index:100003",title:e,content:t,botton:'<a style="text-decoration:none;color:#fff;" class="download btn btn-primary luckysheet-model-conform-btn">&nbsp;&nbsp;下载&nbsp;&nbsp;</a>&nbsp;&nbsp;<button class="btn btn-primary luckysheet-model-copy-btn">&nbsp;&nbsp;复制到剪切板&nbsp;&nbsp;</button><button class="btn btn-default luckysheet-model-cancel-btn">&nbsp;&nbsp;关闭&nbsp;&nbsp;</button>'}));var r=$("#luckysheet-confirm").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),a=r.outerHeight(),s=r.outerWidth(),n=$(window).width(),o=$(window).height(),c=$(document).scrollLeft(),u=$(document).scrollTop();$("#luckysheet-confirm").css({left:(n+c-s)/2,top:(o+u-a)/3}).show(),r.find(".luckysheet-model-conform-btn").click(function(){"1"==luckysheet.browser.isIE()?alert("下载功能IE浏览器不支持！"):(window.ActiveXObject||"ActiveXObject"in window)&&(0===$("#IframeReportImg").length&&$('<iframe style="display:none;" id="IframeReportImg" name="IframeReportImg" onload="downloadImg();" width="0" height="0" src="about:blank"></iframe>').appendTo("body"),$("#IframeReportImg").attr("src")!=l?$("#IframeReportImg").attr("src",l):"about:blank"!=$("#IframeReportImg").src&&window.frames.IframeReportImg.document.execCommand("SaveAs"))}),r.find(".luckysheet-model-cancel-btn").click(function(){$("#luckysheet-confirm").hide(),$("#luckysheet-modal-dialog-mask").hide()}),$("#luckysheet-confirm .luckysheet-model-copy-btn").click(function(){var e=new clipboard.DT;e.setData("text/html","<img src='"+l+"'>"),"1"==luckysheet.browser.isIE()?alert("请在图片上右键点击'复制'"):(clipboard.write(e),alert("已成功复制（如果粘贴失败，请在图片上右键点击'复制图片'）"))})},chartPointConfig:function(e,t,l){$("body").append(luckysheet.replaceHtml(modelHTML,{id:e,addclass:"luckysheet-chart-point-config-c",title:"数据点批量设置",content:luckysheetchartpointconfigHTML,botton:'<button class="btn btn-danger luckysheet-model-save-btn">&nbsp;&nbsp;保存设置&nbsp;&nbsp;</button><button class="btn btn-default luckysheet-model-close-btn">&nbsp;&nbsp;取消&nbsp;&nbsp;</button>',style:"z-index:100003;height:80%;width:80%;top:10%;left:10%;"})),$("#luckysheet-modal-dialog-mask").show();var r=$(window).width(),a=$(window).height();$("#"+e).find(".luckysheet-chart-point-config").css("height",a-160),$("#"+e).css({height:a-90,width:r-100,left:7,top:14}).show().find(".luckysheet-model-save-btn").click(function(){"function"==typeof t&&t(),$("#"+e).hide(),$("#luckysheet-modal-dialog-mask").hide()}),$("#"+e).find(".luckysheet-model-save-btn").click(function(){"function"==typeof l&&l(),$("#"+e).hide(),$("#luckysheet-modal-dialog-mask").hide()})},sheetConfig:function(){},hoverTipshowState:!1,hoverTipshowTimeOut:null,createHoverTip:function(e,t){$(e).on("mouseover",t,function(n){luckysheet.tooltip.hoverTipshowState||(clearTimeout(luckysheet.tooltip.hoverTipshowTimeOut),luckysheet.tooltip.hoverTipshowTimeOut=setTimeout(function(){var e,t,l=$(n.currentTarget),r=l.offset(),a=$("#luckysheet-tooltip-up"),s=l.data("tips");(null!=s&&0!=s.length||null!=(s=l.prev().data("tips"))&&0!=s.length)&&(0==a.length&&($("body").append(luckysheetToolHTML),a=$("#luckysheet-tooltip-up")),a.removeClass("jfk-tooltip-hide").find("div.jfk-tooltip-contentId").html(s),e=a.outerWidth(),a.find("div.jfk-tooltip-arrow").css("left",e/2),(t=r.left+(l.outerWidth()-e)/2)<2&&(t=2,a.find("div.jfk-tooltip-arrow").css("left",l.outerWidth()/2)),a.css({top:r.top+l.outerHeight()+1,left:t}))},300))}).on("mouseout",t,function(e){luckysheet.tooltip.hoverTipshowState=!1,clearTimeout(luckysheet.tooltip.hoverTipshowTimeOut),$("#luckysheet-tooltip-up").addClass("jfk-tooltip-hide")}).on("click",t,function(e){luckysheet.tooltip.hoverTipshowState=!0,clearTimeout(luckysheet.tooltip.hoverTipshowTimeOut),$("#luckysheet-tooltip-up").addClass("jfk-tooltip-hide")})},popover:function(e,t,l,r,a,s){null==a&&(a="关闭");var n='<div id="luckysheetpopover" class="luckysheetpopover"><div class="luckysheetpopover-content">格式刷开启</div><div class="luckysheetpopover-btn">'+a+"</div></div>";$("#luckysheetpopover").remove(),$("body").append(n),$("#luckysheetpopover .luckysheetpopover-content").html(e);var o=$("#luckysheetpopover").outerWidth(),c=$("#luckysheetpopover").outerHeight(),u={};"topLeft"==t?(u.top="20px",u.left="20px"):"topCenter"==t?(u.top="20px",u.left="50%",u["margin-left"]=-o/2):"topRight"==t?(u.top="20px",u.right="20px"):"midLeft"==t?(u.top="50%",u["margin-top"]=-c/2,u.left="20px"):"center"==t?(u.top="50%",u["margin-top"]=-c/2,u.left="50%",u["margin-left"]=-o/2):"midRight"==t?(u.top="50%",u["margin-top"]=-c/2,u.right="20px"):"bottomLeft"==t?(u.bottom="20px",u.left="20px"):"bottomCenter"==t?(u.bottom="20px",u.left="50%",u["margin-left"]=-o/2):"bottomRight"==t?(u.bottom="20px",u.right="20px"):(u.top="20px",u.left="50%",u["margin-left"]=-o/2),"white"==r&&(u.background="rgba(255,255,255,0.65)",u.color="#000",$("#luckysheetpopover .luckysheetpopover-btn").css({border:"1px solid #000"})),setTimeout(function(){$("#luckysheetpopover .luckysheetpopover-content").css({"margin-left":-$("#luckysheetpopover .luckysheetpopover-btn").outerWidth()/2})},1),$("#luckysheetpopover").css(u).fadeIn(),$("#luckysheetpopover .luckysheetpopover-btn").click(function(){"function"==typeof s&&s()}),null!=l&&"number"==typeof l&&setTimeout(function(){$("#luckysheetpopover").fadeOut().remove(),"function"==typeof s&&s()},l)}},luckysheet.mask=function(){var v={};!function(e){function A(e){for(var t="",l=e.length-1;0<=l;)t+=e.charAt(l--);return t}function F(e,t){for(var l="";l.length<t;)l+=e;return l}function N(e,t){var l=""+e;return t<=l.length?l:F("0",t-l.length)+l}function M(e,t){var l=""+e;return t<=l.length?l:F(" ",t-l.length)+l}function E(e,t){var l=""+e;return t<=l.length?l:l+F(" ",t-l.length)}e.version="0.10.2";var c=Math.pow(2,32);function O(e,t){if(c<e||e<-c)return l=e,r=t,a=""+Math.round(l),r<=a.length?a:F("0",r-a.length)+a;var l,r,a,s,n,o=Math.round(e);return(s=t)<=(n=""+o).length?n:F("0",s-n.length)+n}function $(e,t){return t=t||0,e.length>=7+t&&103==(32|e.charCodeAt(t))&&101==(32|e.charCodeAt(t+1))&&110==(32|e.charCodeAt(t+2))&&101==(32|e.charCodeAt(t+3))&&114==(32|e.charCodeAt(t+4))&&97==(32|e.charCodeAt(t+5))&&108==(32|e.charCodeAt(t+6))}var R=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],S=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function t(e){e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e[65535]="General"}var y={};function j(e,t,l){for(var r=e<0?-1:1,a=e*r,s=0,n=1,o=0,c=1,u=0,i=0,h=Math.floor(a);u<t&&(o=(h=Math.floor(a))*n+s,i=h*u+c,!(a-h<5e-8));)a=1/(a-h),s=n,n=o,c=u,u=i;if(t<i&&(o=t<u?(i=c,s):(i=u,n)),!l)return[0,r*o,i];var d=Math.floor(r*o/i);return[d,r*o-d*i,i]}function z(e,t,l){if(2958465<e||e<0)return null;var r,a=0|e,s=Math.floor(86400*(e-a)),n=0,o=[],c={D:a,T:s,u:86400*(e-a)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};return Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(a+=1462),.9999<c.u&&(c.u=0,86400==++s&&(c.T=s=0,++a,++c.D)),60===a?(o=l?[1317,10,29]:[1900,2,29],n=3):0===a?(o=l?[1317,8,29]:[1900,1,0],n=6):(60<a&&--a,(r=new Date(1900,0,1)).setDate(r.getDate()+a-1),o=[r.getFullYear(),r.getMonth()+1,r.getDate()],n=r.getDay(),a<60&&(n=(n+6)%7),l&&(n=0)),c.y=o[0],c.m=o[1],c.d=o[2],c.S=s%60,s=Math.floor(s/60),c.M=s%60,s=Math.floor(s/60),c.H=s,c.q=n,c}t(y),e.parse_date_code=z;var r=new Date(1899,11,31,0,0,0),a=r.getTime(),s=new Date(1900,2,1,0,0,0);function f(e,t){var l=e.getTime();return t?l-=1262304e5:s<=e&&(l+=864e5),(l-(a+6e4*(e.getTimezoneOffset()-r.getTimezoneOffset())))/864e5}function l(e){return e.toString(10)}e._general_int=l;var u,n,i,h,d,o=(u=/\.(\d*[1-9])0+$/,n=/\.0*$/,i=/\.(\d*[1-9])0+/,h=/\.0*[Ee]/,d=/(E[+-])(\d)$/,function(e){var t,l,r,a,s,n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),o=-4<=n&&n<=-1?e.toPrecision(10+n):Math.abs(n)<=9?(a=(r=e)<0?12:11,(s=m(r.toFixed(12))).length<=a||(s=r.toPrecision(10)).length<=a?s:r.toExponential(5)):10===n?e.toFixed(10).substr(0,12):((l=(t=e).toFixed(11).replace(u,".$1")).length>(t<0?12:11)&&(l=t.toPrecision(6)),l);return m(function(e){for(var t=0;t!=e.length;++t)if(101==(32|e.charCodeAt(t)))return e.replace(i,".$1").replace(h,"E").replace("e","E").replace(d,"$10$2");return e}(o))});function m(e){return-1<e.indexOf(".")?e.replace(n,"").replace(u,".$1"):e}function D(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return((0|e)===e?l:o)(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return w(14,f(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function P(e){if(e.length<=3)return e;for(var t=e.length%3,l=e.substr(0,t);t!=e.length;t+=3)l+=(0<l.length?",":"")+e.substr(t,3);return l}e._general_num=o,e._general=D;var L,B,q,H,V,U=(L=/%/g,B=/# (\?+)( ?)\/( ?)(\d+)/,q=/^#*0*\.([0#]+)/,H=/\).*[0#]/,V=/\(###\) ###\\?-####/,function(e,t,l){return((0|l)===l?_:X)(e,t,l)});function Y(e){for(var t,l="",r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:l+=" ";break;case 48:l+="0";break;default:l+=String.fromCharCode(t)}return l}function W(e,t){var l=Math.pow(10,t);return""+Math.round(e*l)/l}function G(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?0:Math.round((e-Math.floor(e))*Math.pow(10,t))}function X(e,t,l){if(40===e.charCodeAt(0)&&!t.match(H)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return 0<=l?X("n",r,l):"("+X("n",r,-l)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,l){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return U(e,t.substr(0,r),l/Math.pow(10,3*(t.length-r)))}(e,t,l);if(-1!==t.indexOf("%"))return a=e,n=l,o=(s=t).replace(L,""),c=s.length-o.length,U(a,o,n*Math.pow(10,2*c))+F("%",c);var a,s,n,o,c,u;if(-1!==t.indexOf("E"))return function e(t,l){var r,a=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==l)return"0.0E+0";if(l<0)return"-"+e(t,-l);var s=t.indexOf(".");-1===s&&(s=t.indexOf("E"));var n=Math.floor(Math.log(l)*Math.LOG10E)%s;if(n<0&&(n+=s),-1===(r=(l/Math.pow(10,n)).toPrecision(1+a+(s+n)%s)).indexOf("e")){var o=Math.floor(Math.log(l)*Math.LOG10E);for(-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+n):r+="E+"+(o-n);"0."===r.substr(0,2);)r=(r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,l,r){return t+l+r.substr(0,(s+n)%s)+"."+r.substr(n)+"E"})}else r=l.toExponential(a);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}(t,l);if(36===t.charCodeAt(0))return"$"+X(e,t.substr(" "==t.charAt(1)?2:1),l);var i,h,d,y,f,m,k,p,g,v,b,_,w,x=Math.abs(l),C=l<0?"-":"";if(t.match(/^00+$/))return C+O(x,t.length);if(t.match(/^[#?]+$/))return"0"===(u=O(l,0))&&(u=""),u.length>t.length?u:Y(t.substr(0,t.length-u.length))+u;if(i=t.match(B))return y=i,f=x,m=C,k=parseInt(y[4],10),p=Math.round(f*k),g=Math.floor(p/k),m+(0===g?"":""+g)+" "+(0==(v=p-g*(b=k))?F(" ",y[1].length+1+y[4].length):M(v,y[1].length)+y[2]+"/"+y[3]+N(b,y[4].length));if(t.match(/^#+0+$/))return C+O(x,t.length-t.indexOf("0"));if(i=t.match(q))return u=W(l,i[1].length).replace(/^([^\.]+)$/,"$1."+Y(i[1])).replace(/\.$/,"."+Y(i[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+F("0",Y(i[1]).length-t.length)}),-1!==t.indexOf("0.")?u:u.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return C+W(x,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return C+P(O(x,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return l<0?"-"+X(e,t,-l):P(""+(Math.floor(l)+(_=l,(w=i[1].length)<(""+Math.round((_-Math.floor(_))*Math.pow(10,w))).length?1:0)))+"."+N(G(l,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return X(e,t.replace(/^#,#*,/,""),l);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return u=A(X(e,t.replace(/[\\-]/g,""),l)),h=0,A(A(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return h<u.length?u.charAt(h++):"0"===e?"0":""}));if(t.match(V))return"("+(u=X(e,"##########",l)).substr(0,3)+") "+u.substr(3,3)+"-"+u.substr(6);var T,I="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return h=Math.min(i[4].length,7),d=j(x,Math.pow(10,h)-1,!1),u=C," "==(I=U("n",i[1],d[1])).charAt(I.length-1)&&(I=I.substr(0,I.length-1)+"0"),u+=I+i[2]+"/"+i[3],(I=E(d[2],h)).length<i[4].length&&(I=Y(i[4].substr(i[4].length-I.length))+I),u+=I;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return h=Math.min(Math.max(i[1].length,i[4].length),7),C+((d=j(x,Math.pow(10,h)-1,!0))[0]||(d[1]?"":"0"))+" "+(d[1]?M(d[1],h)+i[2]+"/"+i[3]+E(d[2],h):F(" ",2*h+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return u=O(l,0),t.length<=u.length?u:Y(t.substr(0,t.length-u.length))+u;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){u=""+l.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),h=u.indexOf(".");var $=t.indexOf(".")-h,R=t.length-u.length-$;return Y(t.substr(0,$)+u+t.substr(t.length-R))}if(i=t.match(/^00,000\.([#0]*0)$/))return h=G(l,i[1].length),l<0?"-"+X(e,t,-l):P((T=l)<2147483647&&-2147483648<T?""+(0<=T?0|T:T-1|0):""+Math.floor(T)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?N(0,3-e.length):"")+e})+"."+N(h,i[1].length);switch(t){case"###,##0.00":return X(e,"#,##0.00",l);case"###,###":case"##,###":case"#,###":var S=P(O(x,0));return"0"!==S?C+S:"";case"###,###.00":return X(e,"###,##0.00",l).replace(/^0\./,".");case"#,###.00":return X(e,"#,##0.00",l).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function _(e,t,l){if(40===e.charCodeAt(0)&&!t.match(H)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return 0<=l?_("n",r,l):"("+_("n",r,-l)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,l){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return U(e,t.substr(0,r),l/Math.pow(10,3*(t.length-r)))}(e,t,l);if(-1!==t.indexOf("%"))return a=e,n=l,o=(s=t).replace(L,""),c=s.length-o.length,U(a,o,n*Math.pow(10,2*c))+F("%",c);var a,s,n,o,c,u;if(-1!==t.indexOf("E"))return function e(t,l){var r,a=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==l)return"0.0E+0";if(l<0)return"-"+e(t,-l);var s=t.indexOf(".");-1===s&&(s=t.indexOf("E"));var n,o=Math.floor(Math.log(l)*Math.LOG10E)%s;o<0&&(o+=s),(r=(l/Math.pow(10,o)).toPrecision(1+a+(s+o)%s)).match(/[Ee]/)||(n=Math.floor(Math.log(l)*Math.LOG10E),-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(n-r.length+o):r+="E+"+(n-o),r=r.replace(/\+-/,"-")),r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,l,r){return t+l+r.substr(0,(s+o)%s)+"."+r.substr(o)+"E"})}else r=l.toExponential(a);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}(t,l);if(36===t.charCodeAt(0))return"$"+_(e,t.substr(" "==t.charAt(1)?2:1),l);var i,h,d,y,f,m=Math.abs(l),k=l<0?"-":"";if(t.match(/^00+$/))return k+N(m,t.length);if(t.match(/^[#?]+$/))return(u=0===l?"":""+l).length>t.length?u:Y(t.substr(0,t.length-u.length))+u;if(i=t.match(B))return k+(0===(f=m)?"":""+f)+F(" ",(y=i)[1].length+2+y[4].length);if(t.match(/^#+0+$/))return k+N(m,t.length-t.indexOf("0"));if(i=t.match(q))return u=(u=(""+l).replace(/^([^\.]+)$/,"$1."+Y(i[1])).replace(/\.$/,"."+Y(i[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+F("0",Y(i[1]).length-t.length)}),-1!==t.indexOf("0.")?u:u.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return k+(""+m).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return k+P(""+m);if(i=t.match(/^#,##0\.([#0]*0)$/))return l<0?"-"+_(e,t,-l):P(""+l)+"."+F("0",i[1].length);if(i=t.match(/^#,#*,#0/))return _(e,t.replace(/^#,#*,/,""),l);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return u=A(_(e,t.replace(/[\\-]/g,""),l)),h=0,A(A(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return h<u.length?u.charAt(h++):"0"===e?"0":""}));if(t.match(V))return"("+(u=_(e,"##########",l)).substr(0,3)+") "+u.substr(3,3)+"-"+u.substr(6);var p="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return h=Math.min(i[4].length,7),d=j(m,Math.pow(10,h)-1,!1),u=k," "==(p=U("n",i[1],d[1])).charAt(p.length-1)&&(p=p.substr(0,p.length-1)+"0"),u+=p+i[2]+"/"+i[3],(p=E(d[2],h)).length<i[4].length&&(p=Y(i[4].substr(i[4].length-p.length))+p),u+=p;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return h=Math.min(Math.max(i[1].length,i[4].length),7),k+((d=j(m,Math.pow(10,h)-1,!0))[0]||(d[1]?"":"0"))+" "+(d[1]?M(d[1],h)+i[2]+"/"+i[3]+E(d[2],h):F(" ",2*h+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return u=""+l,t.length<=u.length?u:Y(t.substr(0,t.length-u.length))+u;if(i=t.match(/^([#0]+)\.([#0]+)$/)){u=""+l.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),h=u.indexOf(".");var g=t.indexOf(".")-h,v=t.length-u.length-g;return Y(t.substr(0,g)+u+t.substr(t.length-v))}if(i=t.match(/^00,000\.([#0]*0)$/))return l<0?"-"+_(e,t,-l):P(""+l).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?N(0,3-e.length):"")+e})+"."+N(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var b=P(""+m);return"0"!==b?k+b:"";default:if(t.match(/\.[0#?]*$/))return _(e,t.slice(0,t.lastIndexOf(".")),l)+Y(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function k(e){for(var t=[],l=!1,r=0,a=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:l=!l;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(a,r-a),a=r+1}if(t[t.length]=e.substr(a),!0===l)throw new Error("Format |"+e+"| unterminated string ");return t}e._split=k;var K=/\[[HhMmSs]*\]/;function Z(e){for(var t=0,l="",r="";t<e.length;)switch(l=e.charAt(t)){case"G":$(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;)++t;++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(r=l;"]"!==e.charAt(t++)&&t<e.length;)r+=e.charAt(t);if(r.match(K))return!0;break;case".":case"0":case"#":for(;t<e.length&&(-1<"0#?.,E+-%".indexOf(l=e.charAt(++t))||"\\"==l&&"-"==e.charAt(t+1)&&-1<"0#".indexOf(e.charAt(t+2))););break;case"?":for(;e.charAt(++t)===l;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&-1<"0123456789".indexOf(e.charAt(++t)););break;case" ":default:++t}return!1}function p(e,t,l,r){for(var a,s,n,o=[],c="",u=0,i="",h="t",d="H";u<e.length;)switch(i=e.charAt(u)){case"G":if(!$(e,u))throw new Error("unrecognized character "+i+" in "+e);o[o.length]={t:"G",v:"General"},u+=7;break;case'"':for(c="";34!==(n=e.charCodeAt(++u))&&u<e.length;)c+=String.fromCharCode(n);o[o.length]={t:"t",v:c},++u;break;case"\\":var y=e.charAt(++u),f="("===y||")"===y?y:"t";o[o.length]={t:f,v:y},++u;break;case"_":o[o.length]={t:"t",v:" "},u+=2;break;case"@":o[o.length]={t:"T",v:t},++u;break;case"B":case"b":if("1"===e.charAt(u+1)||"2"===e.charAt(u+1)){if(null==a&&null==(a=z(t,l,"2"===e.charAt(u+1))))return"";o[o.length]={t:"X",v:e.substr(u,2)},h=i,u+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":i=i.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==a&&null==(a=z(t,l)))return"######";for(c=i;++u<e.length&&e.charAt(u).toLowerCase()===i;)c+=i;"m"===i&&"h"===h.toLowerCase()&&(i="M"),"h"===i&&(i=d),o[o.length]={t:i,v:c},h=i;break;case"A":case"a":var m={t:i,v:i};if(null==a&&(a=z(t,l)),"A/P"===e.substr(u,3).toUpperCase()?(null!=a&&(m.v=12<=a.H?"P":"A"),m.t="T",d="h",u+=3):"AM/PM"===e.substr(u,5).toUpperCase()?(null!=a&&(m.v=12<=a.H?"PM":"AM"),m.t="T",u+=5,d="h"):(m.t="t",++u),null==a&&"T"===m.t)return"";o[o.length]=m,h=i;break;case"[":for(c=i;"]"!==e.charAt(u++)&&u<e.length;)c+=e.charAt(u);if("]"!==c.slice(-1))throw'unterminated "[" block: |'+c+"|";if(c.match(K)){if(null==a&&null==(a=z(t,l)))return"";o[o.length]={t:"Z",v:c.toLowerCase()},h=c.charAt(1)}else-1<c.indexOf("$")&&(c=(c.match(/\$([^-\[\]]*)/)||[])[1]||"$",Z(e)||(o[o.length]={t:"t",v:c}));break;case".":if(null!=a){for(c=i;++u<e.length&&"0"===(i=e.charAt(u));)c+=i;o[o.length]={t:"s",v:c};break}case"0":case"#":for(c=i;++u<e.length&&-1<"0#?.,E+-%".indexOf(i=e.charAt(u))||"\\"==i&&"-"==e.charAt(u+1)&&u<e.length-2&&-1<"0#".indexOf(e.charAt(u+2));)c+=i;o[o.length]={t:"n",v:c};break;case"?":for(c=i;e.charAt(++u)===i;)c+=i;o[o.length]={t:i,v:c},h=i;break;case"*":++u," "!=e.charAt(u)&&"*"!=e.charAt(u)||++u;break;case"(":case")":o[o.length]={t:1===r?"t":i,v:i},++u;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(c=i;u<e.length&&-1<"0123456789".indexOf(e.charAt(++u));)c+=e.charAt(u);o[o.length]={t:"D",v:c};break;case" ":o[o.length]={t:i,v:i},++u;break;default:if(-1==="¤฿BsBr₵₡₫ƒFtRs.₭kr£₤Lm₥₦₱PQRSkRp৲৳R$S/.〒₮₩¥NT￥zł₴₪៛руб€＄,$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP$￥LekdinAf$dhAflRial?￡BirrKzMOPPGKRsGsB/R$ррlevkrKMzBsPNuFBuKPkrRD$NfkCFA?CVEGMDFrCDHTGNAfLFdjKGSFGGHSRielKCFknKshLSLL￡LtRFRONArRfMWKRMMURsMROS/KMDLMTnRC$kr€GELCHFSLLSCRDbSZLSDGSOSSomFCFPTShT$VUVQUGXгрнsomWSTNT$FtDramRpZMWFCFA".indexOf(i))throw new Error("unrecognized character "+i+" in "+e);o[o.length]={t:"t",v:i},++u}var k,p=0,g=0;for(u=o.length-1,h="t";0<=u;--u)switch(o[u].t){case"h":case"H":o[u].t=d,h="h",p<1&&(p=1);break;case"s":(k=o[u].v.match(/\.0+$/))&&(g=Math.max(g,k[0].length-1)),p<3&&(p=3);case"d":case"y":case"M":case"e":h=o[u].t;break;case"m":"s"===h&&(o[u].t="M",p<2&&(p=2));break;case"X":break;case"Z":p<1&&o[u].v.match(/[Hh]/)&&(p=1),p<2&&o[u].v.match(/[Mm]/)&&(p=2),p<3&&o[u].v.match(/[Ss]/)&&(p=3)}switch(p){case 0:break;case 1:.5<=a.u&&(a.u=0,++a.S),60<=a.S&&(a.S=0,++a.M),60<=a.M&&(a.M=0,++a.H);break;case 2:.5<=a.u&&(a.u=0,++a.S),60<=a.S&&(a.S=0,++a.M)}var v,b="";for(u=0;u<o.length;++u)switch(o[u].t){case"t":case"T":case" ":case"D":break;case"X":o[u].v="",o[u].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[u].v=function(e,t,l,r){var a,s="",n=0,o=0,c=l.y,u=0;switch(e){case 98:c=l.y+543;case 121:switch(t.length){case 1:case 2:a=c%100,u=2;break;default:a=c%1e4,u=4}break;case 109:switch(t.length){case 1:case 2:a=l.m,u=t.length;break;case 3:return S[l.m-1][1];case 5:return S[l.m-1][0];default:return S[l.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=l.d,u=t.length;break;case 3:return R[l.q][0];default:return R[l.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(l.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=l.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=l.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==l.u||"s"!=t&&"ss"!=t?(60*(o=2<=r?3===r?1e3:100:1===r?10:1)<=(n=Math.round(o*(l.S+l.u)))&&(n=0),"s"===t?0===n?"0":""+n/o:(s=N(n,2+r),"ss"===t?s.substr(0,2):"."+s.substr(2,t.length-1))):N(l.S,t.length);case 90:switch(t){case"[h]":case"[hh]":a=24*l.D+l.H;break;case"[m]":case"[mm]":a=60*(24*l.D+l.H)+l.M;break;case"[s]":case"[ss]":a=60*(60*(24*l.D+l.H)+l.M)+Math.round(l.S+l.u);break;default:throw"bad abstime format: "+t}u=3===t.length?1:2;break;case 101:a=c,u=1}return 0<u?N(a,u):""}(o[u].t.charCodeAt(0),o[u].v,a,g),o[u].t="t";break;case"n":case"(":case"?":for(v=u+1;null!=o[v]&&("?"===(i=o[v].t)||"D"===i||(" "===i||"t"===i)&&null!=o[v+1]&&("?"===o[v+1].t||"t"===o[v+1].t&&"/"===o[v+1].v)||"("===o[u].t&&(" "===i||"n"===i||")"===i)||"t"===i&&("/"===o[v].v||" "===o[v].v&&null!=o[v+1]&&"?"==o[v+1].t));)o[u].v+=o[v].v,o[v]={v:"",t:";"},++v;b+=o[u].v,u=v-1;break;case"G":o[u].t="t",o[u].v=D(t,l)}var _,w,x="";if(0<b.length){40==b.charCodeAt(0)?(_=t<0&&45===b.charCodeAt(0)?-t:t,w=U("(",b,_)):(w=U("n",b,_=t<0&&1<r?-t:t),_<0&&o[0]&&"t"==o[0].t&&(w=w.substr(1),o[0].v="-"+o[0].v)),v=w.length-1;for(var C=o.length,u=0;u<o.length;++u)if(null!=o[u]&&"t"!=o[u].t&&-1<o[u].v.indexOf(".")){C=u;break}var T=o.length;if(C===o.length&&-1===w.toUpperCase().indexOf("E")){for(u=o.length-1;0<=u;--u)null!=o[u]&&-1!=="n?(".indexOf(o[u].t)&&(v>=o[u].v.length-1?(v-=o[u].v.length,o[u].v=w.substr(v+1,o[u].v.length)):v<0?o[u].v="":(o[u].v=w.substr(0,v+1),v=-1),o[u].t="t",T=u);0<=v&&T<o.length&&(o[T].v=w.substr(0,v+1)+o[T].v)}else if(C!==o.length&&-1===w.toUpperCase().indexOf("E")){for(v=w.indexOf(".")-1,u=C;0<=u;--u)if(null!=o[u]&&-1!=="n?(".indexOf(o[u].t)){for(s=-1<o[u].v.indexOf(".")&&u===C?o[u].v.indexOf(".")-1:o[u].v.length-1,x=o[u].v.substr(s+1);0<=s;--s)0<=v&&("0"===o[u].v.charAt(s)||"#"===o[u].v.charAt(s))&&(x=w.charAt(v--)+x);o[u].v=x,o[u].t="t",T=u}for(0<=v&&T<o.length&&(o[T].v=w.substr(0,v+1)+o[T].v),v=w.indexOf(".")+1,u=C;u<o.length;++u)if(null!=o[u]&&(-1!=="n?(".indexOf(o[u].t)||u===C)){for(s=-1<o[u].v.indexOf(".")&&u===C?o[u].v.indexOf(".")+1:0,x=o[u].v.substr(0,s);s<o[u].v.length;++s)v<w.length&&(x+=w.charAt(v++));o[u].v=x,o[u].t="t",T=u}}}for(u=0;u<o.length;++u)null!=o[u]&&-1<"n(?".indexOf(o[u].t)&&(_=1<r&&t<0&&0<u&&"-"===o[u-1].v?-t:t,o[u].v=U(o[u].t,o[u].v,_),o[u].t="t");var I="";for(u=0;u!==o.length;++u)null!=o[u]&&(I+=o[u].v);return I}e.is_date=Z,e._eval=p;var g=/\[[=<>]/,v=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function b(e,t){if(null!=t){var l=parseFloat(t[2]);switch(t[1]){case"=":if(e==l)return 1;break;case">":if(l<e)return 1;break;case"<":if(e<l)return 1;break;case"<>":if(e!=l)return 1;break;case">=":if(l<=e)return 1;break;case"<=":if(e<=l)return 1}}}function w(e,t,l){null==l&&(l={});var r="";switch(typeof e){case"string":r="m/d/yy"==e&&l.dateNF?l.dateNF:e;break;case"number":r=14==e&&l.dateNF?l.dateNF:(null!=l.table?l.table:y)[e]}if(r.match(/^(w|W)((0?)|(0\.0+))$/)){if(isNaN(t))return t;var a=r.slice(1),s=!1;!isNaN(t)&&Number(t)<0&&(s=!0,t=Math.abs(t));var n,o,c,u=parseInt(t).toString().length;if(4<u){if(-1!=(t=8<u?(n=parseInt(t/1e8),o=parseInt(luckysheet.floatTool.subtract(t,1e8*n)/1e4),c=luckysheet.floatTool.subtract(t,1e8*n+1e4*o),""!=a&&(c=numeral(c).format(a)),n+"亿"+o+"万"+c):(o=parseInt(t/1e4),c=luckysheet.floatTool.subtract(t,1e4*o),""!=a&&(c=numeral(c).format(a)),o+"万"+c)).indexOf("亿0万0")?t=t.replace("0万0",""):-1!=t.indexOf("亿0万")?t=t.replace("0万",""):-1!=t.indexOf("万0")&&(t=t.replace("万0","万")),-1!=t.indexOf("亿")&&-1==t.indexOf("万")){if("."!==(i=t.substring(t.indexOf("亿")+1)).substring(0,1)&&""!=i){switch((parseInt(i)+"").length){case 1:i="000"+i;break;case 2:i="00"+i;break;case 3:i="0"+i}t=t.substring(0,t.indexOf("亿")+1)+i}}else if(-1==t.indexOf("亿")&&-1!=t.indexOf("万")){if("."!==(h=t.substring(t.indexOf("万")+1)).substring(0,1)&&""!=h){switch((parseInt(h)+"").length){case 1:h="000"+h;break;case 2:h="00"+h;break;case 3:h="0"+h}t=t.substring(0,t.indexOf("万")+1)+h}}else if(-1!=t.indexOf("亿")&&-1!=t.indexOf("万")){var i=t.substring(t.indexOf("亿")+1,t.indexOf("万")),h=t.substring(t.indexOf("万")+1);switch((parseInt(i)+"").length){case 1:i="000"+i;break;case 2:i="00"+i;break;case 3:i="0"+i}if(t=t.substring(0,t.indexOf("亿")+1)+i+t.substring(t.indexOf("万")),"."!==h.substring(0,1)&&""!=h){switch((parseInt(h)+"").length){case 1:h="000"+h;break;case 2:h="00"+h;break;case 3:h="0"+h}t=t.substring(0,t.indexOf("万")+1)+h}}}else""!=a&&(t=numeral(t).format(a));return s?"-"+t:t}if($(r,0))return D(t,l);t instanceof Date&&(t=f(t,l.date1904));var d=function(e,t){var l=k(e),r=l.length,a=l[r-1].indexOf("@");if(r<4&&-1<a&&--r,4<l.length)throw new Error("cannot find right format for |"+l.join("|")+"|");if("number"!=typeof t)return[4,4===l.length||-1<a?l[l.length-1]:"@"];switch(l.length){case 1:l=-1<a?["General","General","General",l[0]]:[l[0],l[0],l[0],"@"];break;case 2:l=-1<a?[l[0],l[0],l[0],l[1]]:[l[0],l[1],l[0],"@"];break;case 3:l=-1<a?[l[0],l[1],l[0],l[2]]:[l[0],l[1],l[2],"@"]}var s=0<t?l[0]:t<0?l[1]:l[2];if(-1===l[0].indexOf("[")&&-1===l[1].indexOf("["))return[r,s];if(null==l[0].match(g)&&null==l[1].match(g))return[r,s];var n=l[0].match(v),o=l[1].match(v);return b(t,n)?[r,l[0]]:b(t,o)?[r,l[1]]:[r,l[null!=n&&null!=o?2:1]]}(r,t);if($(d[1]))return D(t,l);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return p(d[1],t,l,d[0])}function x(e,t){if("number"!=typeof t){t=+t||-1;for(var l=0;l<392;++l)if(null!=y[l]){if(y[l]==e){t=l;break}}else t<0&&(t=l);t<0&&(t=391)}return y[t]=e,t}e.load=x,e._table=y,e.get_table=function(){return y},e.load_table=function(e){for(var t=0;392!=t;++t)void 0!==e[t]&&x(e[t],t)},e.init_table=t,e.format=w}(v);var s,n,r={"General Number":"General","General Date":v._table[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":v._table[15],"Short Date":v._table[14],"Long Time":v._table[19],"Medium Time":v._table[18],"Short Time":v._table[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:v._table[2],Standard:v._table[4],Percent:v._table[10],Scientific:v._table[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'},a=(s=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/g,n=/_x([\da-fA-F]{4})_/g,function e(t){var l=t+"",r=l.indexOf("<![CDATA[");if(-1==r)return l.replace(s,function(e,t){return encodings[e]||String.fromCharCode(parseInt(t,-1<e.indexOf("x")?16:10))||e}).replace(n,function(e,t){return String.fromCharCode(parseInt(t,16))});var a=l.indexOf("]]>");return e(l.slice(0,r))+l.slice(r+9,a)+e(l.slice(a+3))});luckysheet.xlml_format=function(e,t){var l=r[e]||a(e);return"General"===l?v._general(t):v.format(l,t)},luckysheet.SSF=v;new Date(1899,11,31,0,0,0).getTime();var b=new Date(1900,2,1,0,0,0);var o=new Date("2017-02-19T19:06:09.000Z");isNaN(o.getFullYear())&&(o=new Date("2/19/17"));var c=2017==o.getFullYear();function _(e,t){var l=new Date(e);if(c)return 0<t?l.setTime(l.getTime()+60*l.getTimezoneOffset()*1e3):t<0&&l.setTime(l.getTime()-60*l.getTimezoneOffset()*1e3),l;if(e instanceof Date)return e;if(1917==o.getFullYear()&&!isNaN(l.getFullYear())){var r=l.getFullYear();return-1<e.indexOf(""+r)?l:(l.setFullYear(l.getFullYear()+100),l)}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return-1<e.indexOf("Z")&&(s=new Date(s.getTime()-60*s.getTimezoneOffset()*1e3)),s}function u(e){var t=Number(e);if("number"==typeof e)return e;if(!isNaN(t))return t;var l=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return l*=100,""});return isNaN(t=Number(r))?(r=r.replace(/[(](.*)[)]/,function(e,t){return l=-l,t}),isNaN(t=Number(r))?t:t/l):t/l}return luckysheet.parseDate=_,luckysheet.fuzzynum=u,luckysheet.fuzzydate=function(e){var t=new Date(e),l=new Date(NaN),r=t.getYear(),a=t.getMonth(),s=t.getDate();return isNaN(s)||r<0||8099<r||(!(0<a||1<s)||101==r)&&!e.toLowerCase().match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)&&e.match(/[^-0-9:,\/\\]/)?l:t},{genarate:function(e){var t,l,r,a,s=null,n={},o=e;if(null==e)return null;if("'"===e.toString().substr(0,1))s=e.toString().substr(1),n={fa:"@",t:"s"};else if("TRUE"===e.toString().toUpperCase())s="TRUE",n={fa:"General",t:"b"},o=!0;else if("FALSE"===e.toString().toUpperCase())s="FALSE",o=!(n={fa:"General",t:"b"});else if(luckysheet.func_methods.valueIsError(e))s=e.toString(),n={fa:"General",t:"e"};else if(/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(e))s=e.toString(),n={fa:"@",t:"s"};else if(luckysheet.func_methods.isRealNum(e)&&0<Math.abs(parseFloat(e))&&(1e11<=Math.abs(parseFloat(e))||Math.abs(parseFloat(e))<1e-9))var c,u=(o=numeral(e).value()).toExponential(),n=-1<u.indexOf(".")?(5<(c=u.split(".")[1].split("e")[0].length)&&(c=5),{fa:"#0."+new Array(c+1).join("0")+"E+00",t:"n"}):{fa:"#0.E+00",t:"n"},s=v.format(n.fa,o);else if(-1<e.toString().indexOf("%")){var i=e.toString().indexOf("%"),h=(k=e.toString().substr(0,i)).replace(/,/g,"");if(i==e.toString().length-1&&luckysheet.func_methods.isRealNum(h))if(-1<k.indexOf("."))if(k.indexOf(".")==k.lastIndexOf(".")){var d=k.split(".")[0];if(9<(p=k.split(".")[1].length)&&(p=9),-1<d.indexOf(",")){for(var y=!0,f=d.split(","),m=1;m<f.length;m++)if(f[m].length<3){y=!1;break}y?(n={fa:"#,##0."+new Array(p+1).join("0")+"%",t:"n"},o=numeral(e).value(),s=v.format(n.fa,o)):(s=e.toString(),n={fa:"@",t:"s"})}else n={fa:"0."+new Array(p+1).join("0")+"%",t:"n"},o=numeral(e).value(),s=v.format(n.fa,o)}else s=e.toString(),n={fa:"@",t:"s"};else if(-1<k.indexOf(",")){for(y=!0,f=k.split(","),m=1;m<f.length;m++)if(f[m].length<3){y=!1;break}y?(n={fa:"#,##0%",t:"n"},o=numeral(e).value(),s=v.format(n.fa,o)):(s=e.toString(),n={fa:"@",t:"s"})}else n={fa:"0%",t:"n"},o=numeral(e).value(),s=v.format(n.fa,o);else s=e.toString(),n={fa:"@",t:"s"}}else if(-1<e.toString().indexOf("."))if(e.toString().indexOf(".")==e.toString().lastIndexOf(".")){var k,p,g=e.toString().split(".")[0];if(9<(p=(k=e.toString().split(".")[1]).length)&&(p=9),-1<g.indexOf(",")){for(y=!0,f=g.split(","),m=1;m<f.length;m++)if(!luckysheet.func_methods.isRealNum(f[m])||f[m].length<3){y=!1;break}y?(n={fa:"#,##0."+new Array(p+1).join("0"),t:"n"},o=numeral(e).value(),s=v.format(n.fa,o)):(s=e.toString(),n={fa:"@",t:"s"})}else luckysheet.func_methods.isRealNum(g)&&luckysheet.func_methods.isRealNum(k)?(n={fa:"0."+new Array(p+1).join("0"),t:"n"},o=numeral(e).value(),s=v.format(n.fa,o)):(s=e.toString(),n={fa:"@",t:"s"})}else s=e.toString(),n={fa:"@",t:"s"};else luckysheet.func_methods.isRealNum(e)?(s=e.toString(),n={fa:"General",t:"n"},o=parseFloat(e)):luckysheet.datecontroll.isdatetime(e)&&(-1<e.toString().indexOf(".")||-1<e.toString().indexOf(":")||e.toString().length<16)?(t=_(e.toString().replace(/-/g,"/")),r=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds()),a=Date.UTC(1899,11,31,0,0,0),l?r-=1262304e5:b<=t&&(r+=864e5),-1<(o=(r-a)/864e5).toString().indexOf(".")?18<e.toString().length?n.fa="yyyy-MM-dd hh:mm:ss":11<e.toString().length?n.fa="yyyy-MM-dd hh:mm":n.fa="yyyy-MM-dd":n.fa="yyyy-MM-dd",n.t="d",s=v.format(n.fa,o)):(s=e,n.fa="General",n.t="g");return[s,n,o]},update:function(e,t){return v.format(e,t)},is_date:function(e,t){return v.is_date(e,t)},valueShowEs:function(e,t,l){var r=luckysheet.getcellvalue(e,t,l,"m");return null==r?r=luckysheet.getcellvalue(e,t,l,"v"):isNaN(u(r))?null!=l[e][t].ct&&"d"==l[e][t].ct.t||null!=l[e][t].ct&&"b"==l[e][t].ct.t||(r=luckysheet.getcellvalue(e,t,l,"v")):"string"==typeof r&&-1<r.indexOf("%")||(r=luckysheet.getcellvalue(e,t,l,"v")),r}}}(),luckysheet.pivotTable={pivotDatas:null,pivotSheetIndex:0,pivotDataSheetIndex:0,celldata:null,origindata:null,getCellData:function(cursheetindex,datasheetindex,data_select_save){var sheetIndex,sheetIndex=null!=cursheetindex?cursheetindex:luckysheet.currentSheetIndex,realIndex=luckysheet.sheetmanage.getSheetIndex(sheetIndex);"object"!=luckysheet.getObjType(luckysheetfile[realIndex].pivotTable)&&(luckysheetfile[realIndex].pivotTable=eval("("+luckysheetfile[realIndex].pivotTable+")")),null!=luckysheetfile[realIndex].pivotTable?(this.column=luckysheetfile[realIndex].pivotTable.column,this.row=luckysheetfile[realIndex].pivotTable.row,this.values=luckysheetfile[realIndex].pivotTable.values,this.filter=luckysheetfile[realIndex].pivotTable.filter,this.showType=luckysheetfile[realIndex].pivotTable.showType,this.filterparm=luckysheetfile[realIndex].pivotTable.filterparm,null!=luckysheetfile[realIndex].pivotTable.drawPivotTable?this.drawPivotTable=luckysheetfile[realIndex].pivotTable.drawPivotTable:this.drawPivotTable=!0,null!=luckysheetfile[realIndex].pivotTable.pivotTableBoundary?this.pivotTableBoundary=luckysheetfile[realIndex].pivotTable.pivotTableBoundary:this.pivotTableBoundary=[12,6],this.pivot_select_save=null!=data_select_save?data_select_save:luckysheetfile[realIndex].pivotTable.pivot_select_save,this.pivotDataSheetIndex=null!=datasheetindex?datasheetindex:luckysheetfile[realIndex].pivotTable.pivotDataSheetIndex):(this.column=null,this.row=null,this.values=null,this.filter=null,this.showType=null,this.filterparm=null,this.drawPivotTable=!0,this.pivotTableBoundary=[12,6],this.pivot_select_save=null!=data_select_save?data_select_save:luckysheet_select_save,this.pivotDataSheetIndex=null!=datasheetindex?datasheetindex:sheetIndex);var pivotrealIndex=luckysheet.sheetmanage.getSheetIndex(this.pivotDataSheetIndex),otherfile=luckysheetfile[pivotrealIndex];null==otherfile.data&&(otherfile.data=luckysheet.sheetmanage.buildGridData(otherfile)),this.origindata=luckysheet.getdatabyselectionD(otherfile.data,this.pivot_select_save);var rowhidden={};if(null!=this.filterparm)for(var f in this.filterparm)for(h in this.filterparm[f])null!=h.rowhidden&&(rowhidden=$.extend(!0,rowhidden,h.rowhidden));this.rowhidden=rowhidden,this.pivotSheetIndex=sheetIndex;for(var newdata=[],i=0;i<this.origindata.length;i++)null!=this.rowhidden&&null!=this.rowhidden[i]||newdata.push([].concat(this.origindata[i]));this.celldata=newdata,this.pivot_data_type={};for(var c=0;c<this.celldata[1].length;c++){var type=luckysheet.isdatatype(this.celldata[1][c]);this.pivot_data_type[c.toString()]=type}},pivot_data_type:{},pivot_select_save:null,column:null,row:null,values:null,filter:null,showType:null,rowhidden:null,selected:null,caljs:null,initial:!0,filterparm:null,luckysheet_pivotTable_select_state:!1,jgridCurrentPivotInput:null,movestate:!1,moveitemposition:[],movesave:{},showvaluecolrow:function(){2<=$("#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item").length?($("#luckysheetpivottablevaluecolrowshow").show(),"column"==this.showType?($("#luckysheetpivottablevaluecolrow").prop("checked",!0),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']").addClass("ui-state-active"),$("#luckysheetpivottablevaluecolrow1").prop("checked",!1),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']").removeClass("ui-state-active")):($("#luckysheetpivottablevaluecolrow1").prop("checked",!0),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']").addClass("ui-state-active"),$("#luckysheetpivottablevaluecolrow").prop("checked",!1),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']").removeClass("ui-state-active"))):$("#luckysheetpivottablevaluecolrowshow").hide()},resetOrderby:function(e){var t=$("#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item").index(e);$("#luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column").find(".luckysheet-modal-dialog-slider-config-item").each(function(){$(this).data("orderby")==t&&$(this).data("orderby","self")})},luckysheetsliderlistclearfilter:function(e){var t=e.parent(),l=t.data("index"),r={},a=luckysheet.pivotTable.origindata;t.data("rowhidden","").find(".luckysheet-slider-list-item-filtered").hide(),luckysheet.pivotTable.setDatatojsfile("selected",{},l),luckysheet.pivotTable.setDatatojsfile("rowhidden",null,l);for(var s=[],n=0;n<a.length;n++)null==r[n]&&s.push([].concat(a[n]));luckysheet.pivotTable.celldata=s,luckysheet.pivotTable.refreshPivotTable(),$("#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu").hide()},luckysheetsliderlistitemfilter:function(e){var t=e.parent(),T=t.offset(),l=$("#luckysheet-pivotTableFilter-menu"),I=$(window).height(),R=($(window).width(),t.data("index")),S=t.data("rowhidden");null==S||""==S?S={}:"string"==luckysheet.getObjType(S)&&(S=JSON.parse(S)),$("body .luckysheet-cols-menu").hide(),$("#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu").hide(),$("#luckysheet-pivotTableFilter-byvalue-input").val(""),$("#luckysheet-pivotTableFilter-bycondition").next().hide(),$("#luckysheet-pivotTableFilter-byvalue").next().show(),l.data("index",R),$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").hide().find("input").val(),$("#luckysheet-pivotTableFilter-selected span").data("type","0").data("type",null).text("无");var r,a=t.data("byconditiontype");$("#luckysheet-pivotTableFilter-selected span").data("value",t.data("byconditionvalue")).data("type",a).text(t.data("byconditiontext")),"2"==a?((r=$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input2").show().find("input")).eq(0).val(t.data("byconditionvalue1")),r.eq(1).val(t.data("byconditionvalue2"))):"1"==a&&$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").eq(0).show().find("input").val(t.data("byconditionvalue1")),$("#luckysheet-pivotTableFilter-byvalue-select").empty().html('<div style="width:100%;text-align:center;position:relative;top:45%;font-size: 14px;"> <div class="luckysheetLoaderGif"> </div> <span>数据量大！请稍后</span></div>');var A={};$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").not(t.get(0)).each(function(){var e=$(this).data("rowhidden");if(null==e||""==e)return!0;for(var t in"string"==luckysheet.getObjType(e)&&(e=JSON.parse(e)),e)A[t]=0});var F=luckysheet.pivotTable.origindata;setTimeout(function(){for(var e,t,l,r,a={},s={},n={},o={},c=1;c<F.length;c++){c in A||null!=F[c]&&(null!=(e=F[c][R])&&null!=e.ct&&"d"==e.ct.t?(t=(C=luckysheet.mask.update("YYYY-MM-DD",e.v)).split("-")[0],r=C.split("-")[1],l=C.split("-")[2],t in a||(a[t]={}),r in a[t]||(a[t][r]={}),l in a[t][r]||(a[t][r][l]=0),a[t][r][l]++,c in S&&(s[t]=0,s[r]=0,s[l]=0)):(r=null==e||luckysheet.func_methods.isRealNull(e.v)?C=null:(C=e.v,e.m),C in n||(n[C]={}),r in n[C]||(n[C][r]=0),n[C][r]++,c in S&&(o[C+"#$$$#"+r]=0)))}var u=[];if(2<JSON.stringify(a).length)for(t in a){var i,h=0,d="";for(r in a[t]){var y,f=0,m="";for(l in a[t][r]){var k,p,g=a[t][r][l];f+=g,k=Number(r)<10?"0"+Number(r):r,p=Number(l)<10?"0"+Number(l):l,t in s&&r in s&&l in s?m+='<div class="day luckysheet-mousedown-cancel cf" data-check="false" title="'+t+"-"+k+"-"+p+'"><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+l+'</label><span class="count luckysheet-mousedown-cancel">( '+g+" )</span></div>":m+='<div class="day luckysheet-mousedown-cancel cf" data-check="true" title="'+t+"-"+k+"-"+p+'"><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+l+'</label><span class="count luckysheet-mousedown-cancel">( '+g+" )</span></div>"}h+=f,y=Number(r)<10?"0"+Number(r):r,t in s&&r in s?d+='<div class="monthBox luckysheet-mousedown-cancel"><div class="month luckysheet-mousedown-cancel cf" data-check="false" title="'+t+"-"+y+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+r+'月</label><span class="count luckysheet-mousedown-cancel">( '+f+' )</span></div><div class="dayList luckysheet-mousedown-cancel">'+m+"</div></div>":d+='<div class="monthBox luckysheet-mousedown-cancel"><div class="month luckysheet-mousedown-cancel cf" data-check="true" title="'+t+"-"+y+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+r+'月</label><span class="count luckysheet-mousedown-cancel">( '+f+' )</span></div><div class="dayList luckysheet-mousedown-cancel">'+m+"</div></div>"}i=t in s?'<div class="yearBox luckysheet-mousedown-cancel"><div class="year luckysheet-mousedown-cancel cf" data-check="false" title="'+t+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+t+'年</label><span class="count luckysheet-mousedown-cancel">( '+h+' )</span></div><div class="monthList luckysheet-mousedown-cancel">'+d+"</div></div>":'<div class="yearBox luckysheet-mousedown-cancel"><div class="year luckysheet-mousedown-cancel cf" data-check="true" title="'+t+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+t+'年</label><span class="count luckysheet-mousedown-cancel">( '+h+' )</span></div><div class="monthList luckysheet-mousedown-cancel">'+d+"</div></div>",u.unshift(i)}if(2<JSON.stringify(n).length)for(var v=Object.keys(n),v=luckysheet.orderbydata1D(v,!0),b=0;b<v.length;b++){var _,w,C=v[b];for(x in n[C]){_=C+"#$$$#"+x=="null#$$$#null"?"(空白)":x,w=C+"#$$$#"+x in o?'<div class="textBox luckysheet-mousedown-cancel cf" data-check="false" data-filter="'+C+"#$$$#"+x+'" title="'+x+'"><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+_+'</label><span class="luckysheet-mousedown-cancel count">( '+n[C][x]+" )</span></div>":'<div class="textBox luckysheet-mousedown-cancel cf" data-check="true" data-filter="'+C+"#$$$#"+x+'" title="'+x+'"><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+_+'</label><span class="luckysheet-mousedown-cancel count">( '+n[C][x]+" )</span></div>",u.push(w)}}$("#luckysheet-pivotTableFilter-byvalue-select").html("<div class='ListBox luckysheet-mousedown-cancel' style='max-height:"+(I-T.top-350)+"px;overflow-y:auto;overflow-x:hidden;'>"+u.join("")+"</div>")},1),showrightclickmenu(l,T.left-250,T.top)},getSumTypeName:function(e){var t="";return"SUM"==e?t="求和":"COUNT"==e?t="数值计数":"COUNTA"==e?t="计数":"COUNTUNIQUE"==e?t="去重计数":"AVERAGE"==e?t="平均值":"MAX"==e?t="最大值":"MIN"==e?t="最小值":"MEDIAN"==e?t="中位数":"PRODUCT"==e?t="乘积":"STDEV"==e?t="标准差":"STDEVP"==e?t="整体标准差":"VAR"==e?t="方差":"VARP"==e&&(t="整体方差"),t},setDatatojsfile:function(e,t,l){var r=luckysheet.sheetmanage.getSheetIndex(this.pivotSheetIndex);null==luckysheetfile[r].pivotTable&&(luckysheetfile[r].pivotTable={}),null==l?(luckysheetfile[r].pivotTable[e]=t,this[e]=t):(null==luckysheetfile[r].pivotTable.filterparm&&(luckysheetfile[r].pivotTable.filterparm={}),null==luckysheetfile[r].pivotTable.filterparm[l.toString()]&&(luckysheetfile[r].pivotTable.filterparm[l.toString()]={}),luckysheetfile[r].pivotTable.filterparm[l.toString()][e]=t,null==this.filterparm&&(this.filterparm={}),null==this.filterparm[l.toString()]&&(this.filterparm[l.toString()]={}),this.filterparm[l.toString()][e]=t)},createPivotTable:function(e){var t,l=luckysheet.currentSheetIndex;luckysheet.isEditMode()?alert("非编辑模式下禁止该操作！"):1<luckysheet_select_save.length?luckysheet.tooltip.info("提示","不能对多重选择区域执行此操作，请选择单个区域，然后再试"):0!=luckysheet_select_save.length&&luckysheet_select_save[0].row[0]!=luckysheet_select_save[0].row[1]&&luckysheet_select_save[0].column[0]!=luckysheet_select_save[0].column[1]?(t=$.extend(!0,{},luckysheet_select_save[0]),luckysheet.sheetmanage.addNewSheet(e,!0),this.getCellData(luckysheet.currentSheetIndex,l,t),this.setDatatojsfile("pivot_select_save",t),this.setDatatojsfile("pivotDataSheetIndex",l),this.initialPivotManage()):luckysheet.tooltip.info("提示","请选择新建透视表的区域")},changePivotTable:function(e){var t=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(e)].pivotTable.pivotDataSheetIndex;null!=luckysheet.sheetmanage.getSheetIndex(t)?(this.getCellData(e),this.initialPivotManage(!0)):luckysheet.tooltip.info("此数据透视表的源数据已损坏！","")},refreshPivotTable:function(){var e={},t=this.getPivotTableData();e.pivotTable=t,e.data=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),this.storePivotTableParam();var l=this.dataHandler(this.column,this.row,this.values,this.showType,this.celldata);this.setDatatojsfile("pivotDatas",l);var r=$.extend(!0,[],luckysheet.sheetmanage.nulldata),a=r;if(0==l.length)this.setDatatojsfile("drawPivotTable",!0),this.setDatatojsfile("pivotTableBoundary",[12,6]);else{this.setDatatojsfile("drawPivotTable",!1),this.setDatatojsfile("pivotTableBoundary",[l.length,l[0].length]);for(var s=l.length,n=l[0].length,o=s-r.length,c=n-r[0].length,a=luckysheet.datagridgrowth(r,o+20,c+10,!0),u=0;u<s;u++){for(var i=[].concat(a[u]),h=0;h<n;h++){var d="";null!=l[u]&&null!=l[u][h]&&(d=luckysheet.getcellvalue(u,h,l)),i[h]=d}a[u]=i}}e.type="pivotTable_change",e.curdata=$.extend(!0,[],a),e.sheetIndex=luckysheet.currentSheetIndex;t=this.getPivotTableData();e.pivotTablecur=t,clearjfundo&&(luckysheet.jfundo=[],luckysheet.jfredo.push(e)),luckysheet.cleargridelement(),clearjfundo=!1,0<o||0<c?luckysheet.jfrefreshgridall(a[0].length,a.length,a,null,luckysheet_select_save,"datachangeAll"):(luckysheet.jfrefreshgrid(a,luckysheet_select_save),luckysheet.selectHightlightShow()),clearjfundo=!0},drawPivotTable:!0,pivotTableBoundary:[12,6],pivotclick:function(e,t,l){null==l&&(l=luckysheet.currentSheetIndex);var r,a=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(l)];a.isPivotTable&&(r=a.pivotTable.pivotDataSheetIndex,null!=luckysheet.sheetmanage.getSheetIndex(r)&&(this.isPivotRange(e,t)?($("#luckysheet-modal-dialog-slider-pivot").show(),luckysheet.luckysheetsizeauto(),$("#luckysheet-sta-content").css("padding-right",260)):($("#luckysheet-modal-dialog-slider-pivot").hide(),luckysheet.luckysheetsizeauto(),$("#luckysheet-sta-content").css("padding-right",10))))},isPivotRange:function(e,t){if(luckysheetcurrentisPivotTable)return e<this.pivotTableBoundary[0]&&t<this.pivotTableBoundary[1]},storePivotTableParam:function(){var t=[],l=[],r=[],a=[];$("#luckysheet-modal-dialog-config-filter .luckysheet-modal-dialog-slider-config-item").each(function(){var e={};e.index=$(this).data("index"),e.name=$(this).data("name"),e.fullname=$(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text(),r.push(e)}),$("#luckysheet-modal-dialog-config-row .luckysheet-modal-dialog-slider-config-item").each(function(){var e={};e.index=$(this).data("index"),e.name=$(this).data("name"),e.fullname=$(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text(),e.order=$(this).data("order"),e.orderby=$(this).data("orderby"),e.stastic=$(this).data("stastic"),l.push(e)}),$("#luckysheet-modal-dialog-config-column .luckysheet-modal-dialog-slider-config-item").each(function(){var e={};e.index=$(this).data("index"),e.name=$(this).data("name"),e.fullname=$(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text(),e.order=$(this).data("order"),e.orderby=$(this).data("orderby"),e.stastic=$(this).data("stastic"),t.push(e)}),$("#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item").each(function(){var e={};e.index=$(this).data("index"),e.name=$(this).data("name"),e.fullname=$(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text(),e.sumtype=$(this).data("sumtype"),e.nameindex=$(this).data("nameindex"),a.push(e)}),this.setDatatojsfile("column",t),this.setDatatojsfile("row",l),this.setDatatojsfile("filter",r),this.setDatatojsfile("values",a);var e=$("#luckysheetpivottablevaluecolrow:checked, #luckysheetpivottablevaluecolrow1:checked").val();this.setDatatojsfile("showType","0"==e?"row":"column");var s=this.getPivotTableData();delete s.pivotDatas,luckysheet.server.saveParam("all",this.pivotSheetIndex,s,{k:"pivotTable"})},getPivotTableData:function(dataindex){null==dataindex&&(dataindex=this.pivotSheetIndex);var index=luckysheet.sheetmanage.getSheetIndex(dataindex),pivotTable=luckysheetfile[index].pivotTable,pivotTable="object"==luckysheet.getObjType(pivotTable)?$.extend(!0,{},luckysheetfile[index].pivotTable):eval("("+pivotTable+")");return pivotTable},addValuesToTitle:function(e,t){var l=e.length*t.length,r=e[0].length+1,a=[];if(0==e.length&&0<t.length){for(var s=0;s<t.length;s++)a.push(t[s].fullname);return a}if(0==t.length&&0<e.length)return e;for(var n=0;n<l;n++){a[n]=new Array(r);for(var o=0;o<r-1;o++)a[n][o]=e[Math.floor(n/t.length)][o];a[n][r-1]=t[n%t.length].fullname}return a},initialPivotManage:function(e){var c;this.initial&&(this.initial=!1,$("body").append(luckysheetPivotTableHTML),$("#luckysheet-modal-dialog-slider-close").click(function(){$("#luckysheet-modal-dialog-slider-pivot").hide(),luckysheet.luckysheetsizeauto()}),$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-data-pivotTable-selection",addclass:"luckysheet-data-pivotTable-selection",title:"选取数据范围",content:'<input id="luckysheet-pivotTable-range-selection-input" class="luckysheet-datavisual-range-container" style="font-size: 14px;padding:5px;max-width:none;" spellcheck="false" aria-label="数据范围" placeholder="数据范围">',botton:'<button id="luckysheet-pivotTable-selection-confirm" class="btn btn-primary">确认选取</button><button class="btn btn-default luckysheet-model-close-btn">取消</button>'})),$("body").append(luckysheet.replaceHtml(filtermenuHTML,{menuid:"pivotTableFilter"})),$("body").append(luckysheet.replaceHtml(filtersubmenuHTML,{menuid:"pivotTableFilter"})),$("body").append(pivottableconfigHTML),$("body").append(pivottablesumHTML),$("#luckysheet-pivotTableFilter-orderby-asc").remove(),$("#luckysheet-pivotTableFilter-orderby-desc").next().remove(),$("#luckysheet-pivotTableFilter-orderby-desc").remove(),$("#luckysheet-pivotTableFilter-orderby-color").next().remove(),$("#luckysheet-pivotTableFilter-orderby-color").remove(),$("#luckysheetpivottablevaluecolrow, #luckysheetpivottablevaluecolrow1").checkboxradio({icon:!1}).change(function(){luckysheet.pivotTable.refreshPivotTable()}),c=null,$("#luckysheet-pivotTableFilter-menu").mouseover(function(){clearTimeout(c),c=setTimeout(function(){$("#luckysheet-pivotTableFilter-submenu").hide()},500)}),$(document).off("click.ptFilterCheckbox1").on("click.ptFilterCheckbox1","#luckysheet-pivotTableFilter-byvalue-select .textBox",function(){"true"==$(this).attr("data-check")?($(this).attr("data-check","false"),$(this).find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).find("input[type='checkbox']").prop("checked",!0))}),$(document).off("click.ptFilterCheckbox2").on("click.ptFilterCheckbox2","#luckysheet-pivotTableFilter-byvalue-select .year",function(){"true"==$(this).attr("data-check")?($(this).attr("data-check","false"),$(this).parents(".yearBox").find(".month").attr("data-check","false"),$(this).parents(".yearBox").find(".day").attr("data-check","false"),$(this).parents(".yearBox").find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).parents(".yearBox").find(".month").attr("data-check","true"),$(this).parents(".yearBox").find(".day").attr("data-check","true"),$(this).parents(".yearBox").find("input[type='checkbox']").prop("checked",!0))}),$(document).off("click.ptFilterCheckbox3").on("click.ptFilterCheckbox3","#luckysheet-pivotTableFilter-byvalue-select .month",function(){"true"==$(this).attr("data-check")?($(this).attr("data-check","false"),$(this).parents(".monthBox").find(".day").attr("data-check","false"),$(this).parents(".monthBox").find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).parents(".monthBox").find(".day").attr("data-check","true"),$(this).parents(".monthBox").find("input[type='checkbox']").prop("checked",!0));var l=!0;$(this).parents(".yearBox").find(".day").each(function(e,t){"true"==$(t).attr("data-check")||(l=!1)}),l?($(this).parents(".yearBox").find(".year").attr("data-check","true"),$(this).parents(".yearBox").find(".year input[type='checkbox']").prop("checked",!0)):($(this).parents(".yearBox").find(".year").attr("data-check","false"),$(this).parents(".yearBox").find(".year input[type='checkbox']").removeAttr("checked"))}),$(document).off("click.ptFilterCheckbox4").on("click.ptFilterCheckbox4","#luckysheet-pivotTableFilter-byvalue-select .day",function(){"true"==$(this).attr("data-check")?($(this).attr("data-check","false"),$(this).find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).find("input[type='checkbox']").prop("checked",!0));var l=!0;$(this).parents(".monthBox").find(".day").each(function(e,t){"true"==$(t).attr("data-check")||(l=!1)}),l?($(this).parents(".monthBox").find(".month").attr("data-check","true"),$(this).parents(".monthBox").find(".month input[type='checkbox']").prop("checked",!0)):($(this).parents(".monthBox").find(".month").attr("data-check","false"),$(this).parents(".monthBox").find(".month input[type='checkbox']").removeAttr("checked"));var r=!0;$(this).parents(".yearBox").find(".day").each(function(e,t){"true"==$(t).attr("data-check")||(r=!1)}),r?($(this).parents(".yearBox").find(".year").attr("data-check","true"),$(this).parents(".yearBox").find(".year input[type='checkbox']").prop("checked",!0)):($(this).parents(".yearBox").find(".year").attr("data-check","false"),$(this).parents(".yearBox").find(".year input[type='checkbox']").removeAttr("checked"))}),$(document).off("click.ptFilterYearDropdown").on("click.ptFilterYearDropdown","#luckysheet-pivotTableFilter-byvalue-select .yearBox .fa-caret-right",function(){var e=$(this).parents(".luckysheet-mousedown-cancel");e.hasClass("year")&&$(this).parents(".yearBox").find(".monthList").slideToggle(),e.hasClass("month")&&$(this).parents(".monthBox").find(".dayList").slideToggle()}),$("#luckysheet-pivotTableFilter-byvalue-btn-all").click(function(){$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").prop("checked",!0),$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").parents(".luckysheet-mousedown-cancel").attr("data-check","true")}),$("#luckysheet-pivotTableFilter-byvalue-btn-contra").click(function(){$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").each(function(e,t){$(t).is(":checked")?($(t).removeAttr("checked"),$(t).parents(".luckysheet-mousedown-cancel").attr("data-check","false")):($(t).prop("checked",!0),$(t).parents(".luckysheet-mousedown-cancel").attr("data-check","true"))}),$("#luckysheet-pivotTableFilter-byvalue-select .ListBox .monthBox").each(function(e,t){var l=!0;$(t).find(".day input[type='checkbox']").each(function(e,t){$(t).is(":checked")||(l=!1)}),l?($(t).find(".month input[type='checkbox']").prop("checked",!0),$(t).attr("data-check","true")):($(t).find(".month input[type='checkbox']").removeAttr("checked"),$(t).attr("data-check","false"))}),$("#luckysheet-pivotTableFilter-byvalue-select .ListBox .yearBox").each(function(e,t){var l=!0;$(t).find(".day input[type='checkbox']").each(function(e,t){$(t).is(":checked")||(l=!1)}),l?($(t).find(".year input[type='checkbox']").prop("checked",!0),$(t).attr("data-check","true")):($(t).find(".year input[type='checkbox']").removeAttr("checked"),$(t).attr("data-check","false"))})}),$("#luckysheet-pivotTableFilter-byvalue-btn-clear").click(function(){$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").removeAttr("checked"),$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").parents(".luckysheet-mousedown-cancel").attr("data-check","false")}),$("#luckysheet-pivotTableFilter-byvalue-input").on("input propertychange",function(){var s=$(this).val().toString();$("#luckysheet-pivotTableFilter-byvalue-select .ListBox .luckysheet-mousedown-cancel").show(),""!=s&&$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").each(function(e,t){var l,r,a=$(t).parents(".luckysheet-mousedown-cancel");a.hasClass("day")&&(l=$(t).siblings("label").text().toString(),r=$(t).parents(".monthBox").find(".month label").text().toString(),-1==($(t).parents(".yearBox").find(".year label").text().toString()+"-"+r+"-"+l).indexOf(s)&&($(t).parents(".day").hide(),0==$(t).parents(".dayList").find(".day:visible").length&&$(t).parents(".monthBox").find(".month").hide(),0==$(t).parents(".monthList").find(".day:visible").length&&$(t).parents(".yearBox").find(".year").hide())),a.hasClass("textBox")&&-1==$(t).siblings("label").text().toString().indexOf(s)&&$(t).parents(".textBox").hide()})}),$("#luckysheet-pivotTableFilter-bycondition, #luckysheet-pivotTableFilter-byvalue").click(function(){var e=$(this);e.next().slideToggle(200),setTimeout(function(){"luckysheet-pivotTableFilter-bycondition"==e.attr("id")&&$("#luckysheet-pivotTableFilter-bycondition").next().is(":visible")&&"无"!=$("#luckysheet-pivotTableFilter-selected span").text()&&$("#luckysheet-pivotTableFilter-byvalue").next().slideUp(200),e.is($("#luckysheet-pivotTableFilter-bycondition"))&&$("#luckysheet-pivotTableFilter-bycondition").next().is(":hidden")&&$("#luckysheet-pivotTableFilter-byvalue").next().is(":hidden")&&$("#luckysheet-pivotTableFilter-byvalue").next().slideDown(200)},300)}),$("#luckysheet-pivotTableFilter-cancel").click(function(){$("#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu").hide()}),$("#luckysheet-pivotTableFilter-selected").click(function(){var e=$(this).offset(),t=$("#luckysheet-pivotTableFilter-submenu");t.hide();var l=$(window).height(),r=$(window).width(),a=t.width(),s=(t.height(),e.top),n=e.left,o=l-e.top-20;e.left+a>r&&(n=e.left-a),e.top>l/2&&((s=l-e.top)<0&&(s=0),o=e.top-20),t.css({top:s,left:n,height:o}).show(),clearTimeout(c)}),$("#luckysheet-pivotTableFilter-submenu").mouseover(function(){clearTimeout(c)}).find(".luckysheet-cols-menuitem").click(function(e){$("#luckysheet-pivotTableFilter-selected span").html($(this).find(".luckysheet-cols-menuitem-content").text()).data("value",$(this).data("value")),$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").hide(),"2"==$(this).data("type")?($("#luckysheet-pivotTableFilter-selected span").data("type","2"),$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input2").show()):"0"==$(this).data("type")?$("#luckysheet-pivotTableFilter-selected span").data("type","0"):($("#luckysheet-pivotTableFilter-selected span").data("type","1"),$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").eq(0).show(),"dateequal"==$(this).attr("data-value")||"datelessthan"==$(this).attr("data-value")||"datemorethan"==$(this).attr("data-value")?$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input input").prop("type","date"):$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input input").prop("type","text")),$("#luckysheet-pivotTableFilter-byvalue").next().slideUp(),$("#luckysheet-pivotTableFilter-submenu").hide()}),$("#luckysheet-modal-dialog-pivotTable-list").on("click"," .luckysheet-slider-list-item-filter",function(e){return luckysheet.pivotTable.luckysheetsliderlistitemfilter($(this)),e.stopPropagation(),!1}),$("#luckysheet-modal-dialog-pivotTable-list").on("click"," .luckysheet-slider-list-item-filtered",function(e){return luckysheet.pivotTable.luckysheetsliderlistclearfilter($(this).next()),e.stopPropagation(),!1}),$("#luckysheet-dialog-pivotTable-range-seleted").click(function(){$("#luckysheet-modal-dialog-slider-pivot").hide(),luckysheet.luckysheetsizeauto();var e=$("#luckysheet-data-pivotTable-selection"),t=e.outerHeight(),l=e.outerWidth(),r=$(window).width(),a=$(window).height(),s=$(document).scrollLeft(),n=$(document).scrollTop();$("#luckysheet-data-pivotTable-selection").css({left:(r+s-l)/2,top:(a+n-t)/4}).show(),luckysheet.pivotTable.jgridCurrentPivotInput=$("#luckysheet-dialog-pivotTable-range").html(),$("#luckysheet-pivotTable-range-selection-input").val(luckysheet.pivotTable.jgridCurrentPivotInput),luckysheet.pivotTable.luckysheet_pivotTable_select_state=!0}),$("#luckysheet-pivotTableFilter-initial").click(function(){$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-slider-list-item-filtered").hide(),$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").data("rowhidden",""),$("#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu").hide(),$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").hide().find("input").val(),$("#luckysheet-pivotTableFilter-selected span").data("type","0").data("type",null).text("无"),luckysheet.pivotTable.setDatatojsfile("filterparm",null),luckysheet.pivotTable.celldata=luckysheet.pivotTable.origindata,luckysheet.pivotTable.refreshPivotTable()}),$("#luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column").on("click",".luckysheet-modal-dialog-slider-config-item-icon",function(e){var t=$(e.target).closest(".luckysheet-modal-dialog-slider-config-item"),l=t.data("index"),r=t.offset(),a=t.data("order"),s=t.data("orderby"),n=t.data("stastic");null==a&&(a="default");var o='<option value="self">'+t.find(".luckysheet-modal-dialog-slider-config-item-txt").data("name")+"</option>";return $("#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item").each(function(e){o+='<option value="'+e+'">'+$(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text()+"</option>"}),$("#luckysheet-pivotTable-config-option-orderby").empty().html(o),null==s&&(s="self"),null==n&&(n="1"),$("#luckysheet-pivotTable-config-option-order").val(a).data("index",l),$("#luckysheet-pivotTable-config-option-orderby").val(s).data("index",l),$("#luckysheet-pivotTable-config-option-stastic").val(n).data("index",l),mouseclickposition($("#luckysheet-pivotTable-config-option"),r.left+t.outerWidth(),r.top-13,"rightbottom"),e.stopPropagation(),!1}),$("#luckysheet-pivotTable-config-option-order,#luckysheet-pivotTable-config-option-orderby,#luckysheet-pivotTable-config-option-stastic").change(function(){var e=$(this),t=e.data("index");$("#luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column").find(".luckysheet-modal-dialog-slider-config-item").each(function(){$(this).data("index")==t&&$(this).data(e.attr("id").replace("luckysheet-pivotTable-config-option-",""),e.val())}),luckysheet.pivotTable.refreshPivotTable()}),$("#luckysheet-modal-dialog-config-value").on("click",".luckysheet-modal-dialog-slider-config-item-icon",function(e){var t=$(e.target).closest(".luckysheet-modal-dialog-slider-config-item"),l=t.data("index"),r=t.offset(),a=t.data("sumtype"),s=luckysheet.pivotTable.pivot_data_type[l.toString()];null==a&&(a="num"==s?"SUM":"COUNTA");var n=$("#luckysheet-pivotTable-config-option-sumtype");return n.find(".luckysheet-submenu-arrow").hide(),n.find(".luckysheet-cols-menuitem[sumtype='"+a+"'] .luckysheet-submenu-arrow").css("display","inline"),n.data("item",t),mouseclickposition(n,r.left+t.outerWidth(),r.top-13,"rightbottom"),e.stopPropagation(),!1}),$("#luckysheet-pivotTable-config-option-sumtype .luckysheet-cols-menuitem").click(function(){var e=$("#luckysheet-pivotTable-config-option-sumtype").data("item"),t=$(this).attr("sumtype");e.data("sumtype",$(this).attr("sumtype"));var l=luckysheet.pivotTable.getSumTypeName(t)+":"+e.data("name");e.attr("title",l).find(".luckysheet-modal-dialog-slider-config-item-txt").html(l),$("#luckysheet-pivotTable-config-option-sumtype").hide(),luckysheet.pivotTable.refreshPivotTable()}),$("#luckysheet-modal-dialog-config-filter").on("click",".luckysheet-modal-dialog-slider-config-item-icon",function(e){var t=$(e.target).closest(".luckysheet-modal-dialog-slider-config-item").data("index");return luckysheet.pivotTable.luckysheetsliderlistitemfilter($("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(t).find(".luckysheet-slider-list-item-filter")),e.stopPropagation(),!1}),$("#luckysheet-pivotTableFilter-confirm").click(function(){var r=$("#luckysheet-pivotTableFilter-menu").data("index"),a={};$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").each(function(){var e=$(this),t=e.data("rowhidden");if(e.data("index")!=r){if(null==t||""==t)return!0;for(var l in"string"==luckysheet.getObjType(t)&&(t=JSON.parse(t)),t)a[l]=0}});var e=luckysheet.pivotTable.origindata,n={},t={},l={};if($("#luckysheet-pivotTableFilter-bycondition").next().is(":visible")&&$("#luckysheet-pivotTableFilter-byvalue").next().is(":hidden")&&"null"!=$("#luckysheet-pivotTableFilter-selected span").data("value")){var s,o=$("#luckysheet-pivotTableFilter-selected span"),c=o.data("type"),u=o.data("value");l.value=u,l.text=o.text(),"0"==c?l.type="0":"2"==c?(s=$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input2 input"),l.type="2",l.value1=s.eq(0).val(),l.value2=s.eq(1).val()):(l.type="1",l.value1=$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").eq(0).find("input").val());for(var i,h,d,y,f,m=1;m<e.length;m++){m in a||null!=e[m]&&(k=e[m][r],"cellnull"==u?null==k||luckysheet.func_methods.isRealNull(k.v)||(t[m]=0):"cellnonull"==u?null!=k&&!luckysheet.func_methods.isRealNull(k.v)||(t[m]=0):"textinclude"==u?(h=l.value1,null!=k&&!luckysheet.func_methods.isRealNull(k.v)&&-1!=k.m.indexOf(h)||(t[m]=0)):"textnotinclude"==u?(h=l.value1,null==k||luckysheet.func_methods.isRealNull(k.v)||-1<k.m.indexOf(h)&&(t[m]=0)):"textstart"==u?(i=(h=l.value1).length,null!=k&&!luckysheet.func_methods.isRealNull(k.v)&&k.m.substr(0,i)==h||(t[m]=0)):"textend"==u?(i=(h=l.value1).length,(null==k||luckysheet.func_methods.isRealNull(k.v)||i>k.m.length||k.m.substr(k.m.length-i,i)!=h)&&(t[m]=0)):"textequal"==u?(h=l.value1,null!=k&&!luckysheet.func_methods.isRealNull(k.v)&&k.m==h||(t[m]=0)):"dateequal"==u?(h=luckysheet.mask.genarate(l.value1)[2],null!=k&&!luckysheet.func_methods.isRealNull(k.v)&&null!=k.ct&&"d"==k.ct.t&&parseInt(k.v)==h||(t[m]=0)):"datelessthan"==u?(h=luckysheet.mask.genarate(l.value1)[2],(null==k||luckysheet.func_methods.isRealNull(k.v)||null==k.ct||"d"!=k.ct.t||parseInt(k.v)>=h)&&(t[m]=0)):"datemorethan"==u?(h=luckysheet.mask.genarate(l.value1)[2],(null==k||luckysheet.func_methods.isRealNull(k.v)||null==k.ct||"d"!=k.ct.t||parseInt(k.v)<=h)&&(t[m]=0)):"morethan"==u?(h=parseFloat(l.value1),(null==k||luckysheet.func_methods.isRealNull(k.v)||null==k.ct||"n"!=k.ct.t||k.v<=h)&&(t[m]=0)):"moreequalthan"==u?(h=parseFloat(l.value1),(null==k||luckysheet.func_methods.isRealNull(k.v)||null==k.ct||"n"!=k.ct.t||k.v<h)&&(t[m]=0)):"lessthan"==u?(h=parseFloat(l.value1),(null==k||luckysheet.func_methods.isRealNull(k.v)||null==k.ct||"n"!=k.ct.t||k.v>=h)&&(t[m]=0)):"lessequalthan"==u?(h=parseFloat(l.value1),(null==k||luckysheet.func_methods.isRealNull(k.v)||null==k.ct||"n"!=k.ct.t||k.v>h)&&(t[m]=0)):"equal"==u?(h=parseFloat(l.value1),null!=k&&!luckysheet.func_methods.isRealNull(k.v)&&null!=k.ct&&"n"==k.ct.t&&k.v==h||(t[m]=0)):"noequal"==u?(h=parseFloat(l.value1),null!=k&&!luckysheet.func_methods.isRealNull(k.v)&&null!=k.ct&&"n"==k.ct.t&&k.v!=h||(t[m]=0)):"include"==u?((h=parseFloat(l.value1))<(d=parseFloat(l.value2))?(f=h,y=d):(y=h,f=d),(null==k||luckysheet.func_methods.isRealNull(k.v)||null==k.ct||"n"!=k.ct.t||k.v<f||k.v>y)&&(t[m]=0)):"noinclude"==u&&((h=parseFloat(l.value1))<(d=parseFloat(l.value2))?(f=h,y=d):(y=h,f=d),(null==k||luckysheet.func_methods.isRealNull(k.v)||null==k.ct||"n"!=k.ct.t||k.v>=f&&k.v<=y)&&(t[m]=0)))}}else{$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").each(function(e,t){return!(!$(t).is(":visible")||!$(t).is(":checked"))||(0<$(t).closest(".day").length&&(l=$(t).siblings("label").text(),Number(l)<10&&(l="0"+l),r=$(t).closest(".monthBox").find(".month label").text().replace("月",""),Number(r)<10&&(r="0"+r),a=$(t).closest(".yearBox").find(".year label").text().replace("年",""),n[s="日期格式#$$$#"+a+"-"+r+"-"+l]="1"),void(0<$(t).closest(".textBox").length&&(s=$(t).closest(".textBox").data("filter"),n[s]="1")));var l,r,a,s});for(var k,m=1;m<e.length;m++){m in a||null!=e[m]&&(u=null==(k=e[m][r])||luckysheet.func_methods.isRealNull(k.v)?"null#$$$#null":null!=k.ct&&"d"==k.ct.t?"日期格式#$$$#"+luckysheet.mask.update("YYYY-MM-DD",k.v):k.v+"#$$$#"+k.m)in n&&(t[m]=0)}}var p=$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(r);$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']:visible:checked").length<$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']:visible").length||0<$("#luckysheet-pivotTableFilter-byvalue-input").val().length||$("#luckysheet-pivotTableFilter-bycondition").next().is(":visible")&&$("#luckysheet-pivotTableFilter-byvalue").next().is(":hidden")&&"null"!=$("#luckysheet-pivotTableFilter-selected span").data("value")?(p.data("rowhidden",JSON.stringify(t)).find(".luckysheet-slider-list-item-filtered").show(),luckysheet.pivotTable.setDatatojsfile("rowhidden",t,r),null!=l&&(p.data("byconditionvalue",l.value).data("byconditiontype",l.type).data("byconditiontext",l.text),null!=l.value1&&p.data("byconditionvalue1",l.value1),null!=l.value2&&p.data("byconditionvalue2",l.value2),luckysheet.pivotTable.setDatatojsfile("caljs",l,r))):(p.data("rowhidden","").find(".luckysheet-slider-list-item-filtered").hide(),luckysheet.pivotTable.setDatatojsfile("rowhidden",null,r));for(var g=[],v=0;v<e.length;v++)v in t||v in a||g.push([].concat(e[v]));luckysheet.pivotTable.celldata=g,luckysheet.pivotTable.refreshPivotTable(),$("#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu").hide(),luckysheet.cleargridelement()}),$("#luckysheet-data-pivotTable-selection .luckysheet-model-close-btn, #luckysheet-data-pivotTable-selection .luckysheet-modal-dialog-title-close").click(function(){$("#luckysheet-modal-dialog-slider-pivot").show(),luckysheet.luckysheetsizeauto(),$("#luckysheet-cell-main .luckysheet-pivotTable-selection-set div").show(),$("#luckysheet-data-pivotTable-selection").hide(),luckysheet.sheetmanage.changeSheetExec(luckysheet.pivotTable.pivotSheetIndex),luckysheet.pivotTable.luckysheet_pivotTable_select_state=!1,luckysheet.cleargridelement()}),$("#luckysheet-pivotTable-selection-confirm").click(function(){var e=$("#luckysheet-pivotTable-range-selection-input"),t=e.val();if(0==$.trim(t).length||$.trim(t).toUpperCase()==luckysheet.pivotTable.jgridCurrentPivotInput.toUpperCase())return e.val(luckysheet.pivotTable.jgridCurrentPivotInput),void $("#luckysheet-data-pivotTable-selection .luckysheet-model-close-btn").click();var l=t.split("!"),r="",a="",s=-1;if(1<l.length){for(var n in r=l[0],a=l[1],luckysheetfile)if(r==luckysheetfile[n].name){s=luckysheetfile[n].index;break}-1==s&&(s=0)}else var o=luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex),r=luckysheetfile[o].name,s=luckysheetfile[o].index,a=l[0];if(luckysheetfile[luckysheet.sheetmanage.getSheetIndex(s)].isPivotTable)return luckysheet.isEditMode()?alert("不可选择数据透视表为源数据！"):luckysheet.tooltip.info("选择失败","不可选择数据透视表为源数据！"),void e.val(luckysheet.pivotTable.jgridCurrentPivotInput);if(-1==a.indexOf(":"))return luckysheet.isEditMode()?alert("选择失败, 输入范围错误！"):luckysheet.tooltip.info("选择失败","输入范围错误！"),void e.val(luckysheet.pivotTable.jgridCurrentPivotInput);a=a.split(":");var c=[],u=[];return c[0]=parseInt(a[0].replace(/[^0-9]/g,""))-1,c[1]=parseInt(a[1].replace(/[^0-9]/g,""))-1,c[0]>c[1]?(luckysheet.isEditMode()?alert("选择失败, 输入范围错误！"):luckysheet.tooltip.info("选择失败","输入范围错误！"),void e.val(luckysheet.pivotTable.jgridCurrentPivotInput)):(u[0]=luckysheet.luckysheetABCatNum(a[0].replace(/[^A-Za-z]/g,"")),u[1]=luckysheet.luckysheetABCatNum(a[1].replace(/[^A-Za-z]/g,"")),u[0]>u[1]?(luckysheet.isEditMode()?alert("选择失败, 输入范围错误！"):luckysheet.tooltip.info("选择失败","输入范围错误！"),void e.val(luckysheet.pivotTable.jgridCurrentPivotInput)):(luckysheet.sheetmanage.changeSheetExec(luckysheet.pivotTable.pivotSheetIndex),luckysheet.pivotTable.setDatatojsfile("pivot_select_save",{row:c,column:u}),luckysheet.pivotTable.setDatatojsfile("pivotDataSheetIndex",s),luckysheet.pivotTable.getCellData(luckysheet.pivotTable.pivotSheetIndex,s,{row:c,column:u}),luckysheet.pivotTable.initialPivotManage(),$("#luckysheet-dialog-pivotTable-range").html(t),$("#luckysheet-modal-dialog-slider-pivot").show(),$("#luckysheet-data-pivotTable-selection").hide(),luckysheet.pivotTable.luckysheet_pivotTable_select_state=!1,luckysheet.pivotTable.refreshPivotTable(),luckysheet.luckysheetsizeauto(),void luckysheet.cleargridelement()))}),$("#luckysheet-modal-dialog-slider-pivot").on("mousedown",".luckysheet-slider-list-item-name, .luckysheet-modal-dialog-slider-config-item-txt",function(e){var t=$(e.target);luckysheet.pivotTable.movestate=!0,luckysheet.pivotTable.movesave.obj=t.parent(),luckysheet.pivotTable.movesave.name=t.data("name"),luckysheet.pivotTable.movesave.containerid=t.parent().parent().attr("id"),luckysheet.pivotTable.movesave.index=t.data("index"),0==$("#luckysheet-modal-dialog-slider-pivot-move").length&&$("body").append('<div id="luckysheet-modal-dialog-slider-pivot-move">'+luckysheet.pivotTable.movesave.name+"</div>"),luckysheet.pivotTable.movesave.width=$("#luckysheet-modal-dialog-slider-pivot-move").outerWidth(),luckysheet.pivotTable.movesave.height=$("#luckysheet-modal-dialog-slider-pivot-move").outerHeight(),$("#luckysheet-modal-dialog-pivotTable-list, #luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").css("cursor","default")}),$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").mousemove(function(e){var t,l,r,a;luckysheet.pivotTable&&luckysheet.pivotTable.movestate&&(0==luckysheet.pivotTable.moveitemposition.length&&(luckysheet.pivotTable.moveitemposition=[0],$(this).find(".luckysheet-modal-dialog-slider-config-item").each(function(e){var t=$(this).outerHeight();luckysheet.pivotTable.moveitemposition.push(luckysheet.pivotTable.moveitemposition[e]+t+2)}),$(this).append('<div id="luckysheet-modal-dialog-config-order-help" style="position:absolute;height:3px;width:100%;background:#007ACC;z-index:1;pointer-events: none;user-select:none;"></div>')),$("#luckysheet-modal-dialog-slider-pivot-move").css({background:"#FD8585",color:"#fff",border:"1px solid #FD7070"}),event.pageX,l=event.pageY-(t=$(this)).offset().top+t.scrollTop(),r=luckysheet.pivotTable.moveitemposition,-1==(a=luckysheet_searcharray(r,l))?$("#luckysheet-modal-dialog-config-order-help").css({top:r[r.length-1]}):l-r[a-1]>(r[a]-r[a-1])/2?$("#luckysheet-modal-dialog-config-order-help").css({top:r[a]}):$("#luckysheet-modal-dialog-config-order-help").css({top:r[a-1]}))}).mouseleave(function(){luckysheet.pivotTable&&luckysheet.pivotTable.movestate&&($("#luckysheet-modal-dialog-slider-pivot-move").css({background:"#fff",color:"#000",border:"1px dotted #000"}),luckysheet.pivotTable.moveitemposition=[],$("#luckysheet-modal-dialog-config-order-help").remove())}).mouseup(function(e){var t,l,r,a,s,n,o,c,u;luckysheet.pivotTable&&luckysheet.pivotTable.movestate&&(t=$(this),s=luckysheet.pivotTable.movesave.containerid==t.attr("id")?luckysheet.pivotTable.movesave.obj.clone():(l=luckysheet.pivotTable.movesave.name,a=r="","luckysheet-modal-dialog-config-value"==t.attr("id")&&(r="num"==luckysheet.pivotTable.pivot_data_type[luckysheet.pivotTable.movesave.index.toString()]?(l="求和:"+l,"data-sumtype='SUM'"):(l="计数:"+l,"data-sumtype='COUNTA'"),a="data-nameindex='0'",$("#luckysheet-modal-dialog-config-value").find(".luckysheet-modal-dialog-slider-config-item").each(function(){if($(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text()==l){var e=parseFloat($(this).data("nameindex"))+1;return l+=e.toString(),$(this).data("nameindex",e),!1}})),'<div title="'+l+'" class="luckysheet-modal-dialog-slider-config-item" '+a+" "+r+' data-index="'+luckysheet.pivotTable.movesave.index+'" data-name="'+luckysheet.pivotTable.movesave.name+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" '+a+" "+r+' data-index="'+luckysheet.pivotTable.movesave.index+'" data-name="'+luckysheet.pivotTable.movesave.name+'">'+l+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>'),event.pageX,o=event.pageY-(n=$(this)).offset().top+n.scrollTop(),c=luckysheet.pivotTable.moveitemposition,u=luckysheet_searcharray(c,o),("luckysheet-modal-dialog-pivotTable-list"==luckysheet.pivotTable.movesave.containerid||"luckysheet-modal-dialog-config-value"==luckysheet.pivotTable.movesave.containerid&&luckysheet.pivotTable.movesave.containerid!=t.attr("id"))&&$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column").find(".luckysheet-modal-dialog-slider-config-item").each(function(){$(this).data("index")==luckysheet.pivotTable.movesave.index&&$(this).remove()}),-1==u?0==t.find(".luckysheet-modal-dialog-slider-config-item").length?t.append(s):t.find(".luckysheet-modal-dialog-slider-config-item").last().after(s):o-c[u-1]>(c[u]-c[u-1])/2?t.find(".luckysheet-modal-dialog-slider-config-item").eq(u-1).after(s):t.find(".luckysheet-modal-dialog-slider-config-item").eq(u-1).before(s),"luckysheet-modal-dialog-pivotTable-list"==luckysheet.pivotTable.movesave.containerid||"luckysheet-modal-dialog-config-value"==luckysheet.pivotTable.movesave.containerid&&luckysheet.pivotTable.movesave.containerid!=t.attr("id")||luckysheet.pivotTable.movesave.obj.remove(),$("#luckysheet-modal-dialog-pivotTable-list").find(".luckysheet-modal-dialog-slider-list-item").each(function(){var e=$(this).find(".luckysheet-slider-list-item-selected");$(this).data("index")==luckysheet.pivotTable.movesave.index&&0==e.find("i").length&&e.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')}),luckysheet.pivotTable.refreshPivotTable(),$("#luckysheet-modal-dialog-slider-pivot-move").remove(),luckysheet.pivotTable.movestate=!1,$("#luckysheet-modal-dialog-pivotTable-list, #luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").css("cursor","default"),luckysheet.pivotTable.moveitemposition=[],$("#luckysheet-modal-dialog-config-order-help").remove(),luckysheet.pivotTable.showvaluecolrow(),e.stopPropagation())}),$("#luckysheet-modal-dialog-pivotTable-list").on("click",".luckysheet-slider-list-item-selected",function(){var e,t,l,r,a,s=$(this),n=s.parent(),o=n.data("index"),c=n.data("name");0==s.find("i").length?(s.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>'),"num"==luckysheet.pivotTable.pivot_data_type[o.toString()]?(e='<div title="'+c+'" class="luckysheet-modal-dialog-slider-config-item" data-nameindex="0" data-sumtype="SUM" data-index="'+o+'" data-name="'+c+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" data-nameindex="0" data-sumtype="SUM" data-index="'+o+'" data-name="'+c+'">求和:'+c+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>',$("#luckysheet-modal-dialog-config-value").append(e)):(e='<div title="'+c+'" class="luckysheet-modal-dialog-slider-config-item" data-index="'+o+'" data-name="'+c+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" data-index="'+o+'" data-name="'+c+'">'+c+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>',t=$("#luckysheet-modal-dialog-config-column"),l=$("#luckysheet-modal-dialog-config-row"),r=t.find(".luckysheet-modal-dialog-slider-config-item"),a=l.find(".luckysheet-modal-dialog-slider-config-item"),!(r.length<2)&&a.length<2?l.append(e):t.append(e))):(s.find("i").remove(),$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").find(".luckysheet-modal-dialog-slider-config-item").each(function(){$(this).data("index")==o&&("luckysheet-modal-dialog-config-value"==$(this).parent().attr("id")&&luckysheet.pivotTable.resetOrderby($(this)),$(this).remove())})),luckysheet.pivotTable.refreshPivotTable(),luckysheet.pivotTable.showvaluecolrow()}),$("#luckysheet-dialog-pivotTable-clearitem").click(function(){$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").find(".luckysheet-modal-dialog-slider-config-item").each(function(){$(this).remove()}),$("#luckysheet-modal-dialog-pivotTable-list").find(".luckysheet-modal-dialog-slider-list-item").each(function(){$(this).find(".luckysheet-slider-list-item-selected").find("i").remove()}),luckysheet.pivotTable.refreshPivotTable(),luckysheet.pivotTable.showvaluecolrow()})),null==e&&(e=!1),this.celldata.length<=1&&this.celldata[0].length<=1&&(luckysheet.isEditMode()?alert("请扩大选择的数据范围!"):luckysheet.tooltip.info("提示","请扩大选择的数据范围!"));for(var t,l="",r=1,a={},s=1,n=0;n<this.celldata[0].length;n++){null!=(t=this.celldata[0][n]&&this.celldata[0][n].m?this.celldata[0][n].m:luckysheet.getcellvalue(0,n,this.celldata))&&(t=t.toString()),null!=t&&0!=$.trim(t.toString()).length||(t="列 "+s),s++,t in a&&(t+=r++)in a&&(t+=r++)in a&&(t+=r++),a[t]=1;var o,u,i="",h="";e&&null!=this.filterparm&&null!=this.filterparm[n.toString()]&&(null!=(o=this.filterparm[n.toString()]).rowhidden&&(i+="data-rowhidden='"+JSON.stringify(o.rowhidden)+"'"),null!=o.selected&&(i+="data-selected='"+JSON.stringify(o.selected)+"'"),null!=o.caljs&&(null!=(u=o.caljs).value&&(i+="data-byconditionvalue='"+u.value+"'"),null!=u.type&&(i+="data-byconditiontype='"+u.type+"'"),null!=u.text&&(i+="data-byconditiontext='"+u.text+"'"),null!=u.value1&&(i+="data-byconditionvalue1='"+u.value1+"'"),null!=u.value2&&(i+="data-byconditionvalue2='"+u.value2+"'"))),0<i.length&&(h="display:block;"),l+='<div class="luckysheet-modal-dialog-slider-list-item" '+i+' data-index="'+n+'" data-name="'+t+'"><div title="添加列到数据透视表" class="luckysheet-slider-list-item-selected"><div></div></div><div title="移动该列到下方白框" class="luckysheet-slider-list-item-name" '+i+' data-index="'+n+'" data-name="'+t+'">'+t+'</div><div title="清除该列的筛选条件" class="luckysheet-slider-list-item-filtered" style="'+h+'"><i class="fa fa-filter luckysheet-mousedown-cancel" aria-hidden="true"></i><i class="fa fa-times" aria-hidden="true"></i></div><div title="筛选该列" class="luckysheet-slider-list-item-filter"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>'}if($("#luckysheet-modal-dialog-pivotTable-list").html(l),$("#luckysheetpivottablevaluecolrowshow").hide(),$("#luckysheetpivottablevaluecolrow").prop("checked",!0),$("#luckysheetpivottablevaluecolrow1").prop("checked",!1),$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").empty(),e){if(null!=this.filter&&0<this.filter.length)for(n=0;n<this.filter.length;n++){var d='<div title="'+t+'" class="luckysheet-modal-dialog-slider-config-item" data-index="'+(f=this.filter[n]).index+'" data-name="'+f.name+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" data-index="'+f.index+'" data-name="'+f.name+'">'+f.name+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';$("#luckysheet-modal-dialog-config-filter").append(d),0==(m=$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(f.index).find(".luckysheet-slider-list-item-selected")).find("i").length&&m.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')}if(null!=this.row&&0<this.row.length)for(n=0;n<this.row.length;n++){var y="";null!=(f=this.row[n]).order&&(y+="data-order = '"+f.order+"'"),null!=f.orderby&&(y+="data-orderby = '"+f.orderby+"'"),null!=f.order&&(y+="data-stastic = '"+f.stastic+"'");d='<div title="'+t+'" class="luckysheet-modal-dialog-slider-config-item" '+y+' data-index="'+f.index+'" data-name="'+f.name+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" '+y+' data-index="'+f.index+'" data-name="'+f.name+'">'+f.name+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';$("#luckysheet-modal-dialog-config-row").append(d),0==(m=$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(f.index).find(".luckysheet-slider-list-item-selected")).find("i").length&&m.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')}if(null!=this.column&&0<this.column.length)for(n=0;n<this.column.length;n++){y="";null!=(f=this.column[n]).order&&(y+="data-order = '"+f.order+"'"),null!=f.orderby&&(y+="data-orderby = '"+f.orderby+"'"),null!=f.order&&(y+="data-stastic = '"+f.stastic+"'");d='<div title="'+t+'" class="luckysheet-modal-dialog-slider-config-item" '+y+' data-index="'+f.index+'" data-name="'+f.name+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" '+y+' data-index="'+f.index+'" data-name="'+f.name+'">'+f.name+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';$("#luckysheet-modal-dialog-config-column").append(d),0==(m=$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(f.index).find(".luckysheet-slider-list-item-selected")).find("i").length&&m.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')}if(null!=this.values&&0<this.values.length){for(n=0;n<this.values.length;n++){var f,y="";null!=(f=this.values[n]).sumtype&&(y+="data-sumtype = '"+f.sumtype+"'"),null!=f.nameindex&&(y+="data-nameindex = '"+f.nameindex+"'");var m,d='<div title="'+t+'" class="luckysheet-modal-dialog-slider-config-item" '+y+' data-index="'+f.index+'" data-name="'+f.name+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" '+y+' data-index="'+f.index+'" data-name="'+f.name+'">'+luckysheet.pivotTable.getSumTypeName(f.sumtype)+":"+f.name+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';$("#luckysheet-modal-dialog-config-value").append(d),0==(m=$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(f.index).find(".luckysheet-slider-list-item-selected")).find("i").length&&m.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')}2<=this.values.length&&($("#luckysheetpivottablevaluecolrowshow").show(),"column"==this.showType?($("#luckysheetpivottablevaluecolrow").prop("checked",!0),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']").addClass("ui-state-active"),$("#luckysheetpivottablevaluecolrow1").prop("checked",!1),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']").removeClass("ui-state-active")):($("#luckysheetpivottablevaluecolrow1").prop("checked",!0),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']").addClass("ui-state-active"),$("#luckysheetpivottablevaluecolrow").prop("checked",!1),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']").removeClass("ui-state-active")))}}$("#luckysheet-dialog-pivotTable-range").html(luckysheet.sheetmanage.getRangetxt(this.pivotDataSheetIndex,this.pivot_select_save)),$("#luckysheet-modal-dialog-slider-pivot").show(),luckysheet.luckysheetsizeauto()},getComposeArray:function(e){if(0==e.length)return[];for(var t=[],l=0;l<e.length;l++){for(var r="",a=0;a<=l;a++)e[a]&&e[a].m?r+=e[a].m:r+=luckysheet.getcellvalue(a,null,e);t.push(r)}return t},getnameArray:function(e,t){if(0==e.length)return[];if(0==t.length)return[];for(var l,r=[],a=0;a<t.length;a++){l=e[t[a].index]&&e[t[a].index].m?e[t[a].index].m:luckysheet.getcellvalue(t[a].index,null,e),r.push(l)}return r},getTitleFromGroup:function(e,t,l){e.children;var r=this.orderbygroup(e,t,l);return this.generategrouparraymain(r,t)},orderbygroup:function(e,t,l){var r=[];if(0==e.length)return[];for(var a=null,s=(r=e).length,n=r.length,o=0;0!=s;)if(s--,null!=(a=r[o++]).children&&0<a.children.length){a.children=this.orderbygroupchildren(a.children,t[a.index].orderby,t[a.index].order,l);for(var c=0;c<a.children.length;c++)r.push(a.children[c]),s++}return e.splice(0,n)},orderbygroupchildren:function(e,a,t,s){if(0==e.length)return[];var l=!1;null!=t&&"asc"!=t||(l=!0);return l?e.sort(function(e,t){var l=null,r=null;if("self"==a||null==a){if(l=null==e.name?"(空白)":e.name.toString(),r=null==t.name?"(空白)":t.name.toString(),luckysheet.datecontroll.isdatetime(l)&&luckysheet.datecontroll.isdatetime(r))return luckysheet.datecontroll.diff(l,r)}else l=parseFloat(s[e.orderby].result),r=parseFloat(s[t.orderby].result);return isNaN(l)||isNaN(r)?isNaN(l)&&isNaN(r)?l.localeCompare(r):isNaN(l)?1:isNaN(r)?-1:void 0:numeral(l).value()-numeral(r).value()}):e.sort(function(e,t){var l=null,r=null;if("self"==a||null==a){if(l=null==e.name?"(空白)":e.name.toString(),r=null==t.name?"(空白)":t.name.toString(),luckysheet.datecontroll.isdatetime(l)&&luckysheet.datecontroll.isdatetime(r))return luckysheet.datecontroll.diff(l,r)}else l=parseFloat(s[e.orderby].result),r=parseFloat(s[t.orderby].result);return isNaN(l)||isNaN(r)?isNaN(l)&&isNaN(r)?r.localeCompare(l):isNaN(l)?-1:isNaN(r)?1:void 0:numeral(r).value()-numeral(l).value()})},generategroupaddstatic:function(e,t){for(var l=[],r=0;r<e[0].length;r++)0==r?"总计"==t?l.push(t):l.push({name:t,issum:!0}):l.push("");return l},generategrouparraymain:function(e,t){for(var l=[],r=0;r<e.length;r++){var a=e[r].name,s=this.generategrouparray(e[r].children,t,1);"1"!=t[0].stastic&&null!=t[0].stastic||s.push(this.generategroupaddstatic(s,a)),l=l.concat(s)}return l},generategrouparray:function(e,t,l){for(var r=[],a=0;a<e.length;a++){var s,n=e[a].name;if(0==e[a].children||0==e[a].children.length)s=[n],r.push(s);else{s=this.generategrouparray(e[a].children,t,l+1);for(var o=0;o<s.length;o++)s[o].unshift(n);"1"!=t[l].stastic&&null!=t[l].stastic||s.push(this.generategroupaddstatic(s,n)),r=r.concat(s)}}return r},addStatisticsData:function(e,t,l,r){var a,s;null==e[l]&&(e[l]={data:[],count:0,max:-1/0,min:1/0,counta:0,countunique:0,countuniquedata:{},sum:0,digitaldata:[],sumtype:t.sumtype,index:t.index,name:t.fullname,acc:0}),!0===luckysheet.isdatatypemulti(r).num&&(a=luckysheet.numFormat(r),e[l].digitaldata.push(a),e[l].count+=1,e[l].sum+=a,a>e[l].max&&(e[l].max=a),a<e[l].min&&(e[l].min=a),(s=luckysheet.numfloatlen(a))>e[l].acc&&(e[l].acc=s)),""!=r&&(e[l].data.push(r),e[l].counta+=1,r in e[l].countuniquedata||(e[l].countuniquedata[r]=1,e[l].countunique+=1))},dataHandler:function(column,row,values,showType,celldata){if(null==showType&&(showType="column"),0==column.length&&0==row.length&&0==values.length||0==celldata.length)return this.pivotDatas=[],[];for(var dataposition={},data=celldata,datarowtitle=[],datarowtitlegroup=[],datarowposition={},datarowposition_i=0,datacoltitle=[],datacoltitlegroup=[],datacolposition={},datacolposition_i=0,i=1;i<data.length;i++){var d=data[i],groupbyrowtxt="",groupbycoltxt="",rowtxt="",rowtitle=[],rowtitlename=[],coltxt="",coltitle=[],coltitlename=[],rowtitlename=this.getnameArray(d,row),coltitlename=this.getnameArray(d,column),rowtitle=this.getComposeArray(rowtitlename),coltitle=this.getComposeArray(coltitlename);0<rowtitle.length&&rowtitle.unshift("总计"),0<coltitle.length&&coltitle.unshift("总计");for(var curentLevelobj=datarowposition,curentLevelarr=datarowtitlegroup,r=0;r<rowtitle.length;r++){var item=rowtitle[r],name=0==r?"总计":rowtitlename[r-1],orderby;curentLevelarr=null!=curentLevelobj[r.toString()]&&null!=curentLevelobj[r.toString()][item]?curentLevelarr[curentLevelobj[r.toString()][item]].children:(orderby=0==r?"self":"self"==row[r-1].orderby||null==row[r-1].orderby?item:"column"==showType?item+values[parseInt(row[r-1].orderby)].fullname:item+"合计",null==name&&(name="(空白)"),curentLevelarr.push({name:name,fullname:item,index:r,orderby:orderby,children:[]}),null==curentLevelobj[r.toString()]&&(curentLevelobj[r.toString()]={}),null==curentLevelobj[r.toString()][item]&&(curentLevelobj[r.toString()][item]=curentLevelarr.length-1),curentLevelarr[curentLevelarr.length-1].children)}for(var curentLevelobj=datacolposition,curentLevelarr=datacoltitlegroup,r=0;r<coltitle.length;r++){var item=coltitle[r],name=0==r?"总计":coltitlename[r-1],orderby;curentLevelarr=null!=curentLevelobj[r.toString()]&&null!=curentLevelobj[r.toString()][item]?curentLevelarr[curentLevelobj[r.toString()][item]].children:(orderby=0==r?"self":"self"==column[r-1].orderby||null==column[r-1].orderby?item:"column"==showType?"合计"+item:values[parseInt(column[r-1].orderby)].fullname+item,null==name&&(name="(空白)"),curentLevelarr.push({name:name,fullname:item,index:r,orderby:orderby,children:[]}),null==curentLevelobj[r.toString()]&&(curentLevelobj[r.toString()]={}),null==curentLevelobj[r.toString()][item]&&(curentLevelobj[r.toString()][item]=curentLevelarr.length-1),curentLevelarr[curentLevelarr.length-1].children)}for(var v_str="",v=0;v<values.length;v++){var d_value=luckysheet.getcellvalue(values[v].index,null,d),coltitle_c=[].concat(coltitle),rowtitle_c=[].concat(rowtitle);"column"==showType?0<coltitle_c.length?(coltitle_c.push(""),coltitle_c=coltitle_c.join(values[v].fullname+"|||").split("|||").slice(0,coltitle_c.length-1)):coltitle_c.push(values[v].fullname):0<rowtitle_c.length?(rowtitle_c.push(""),rowtitle_c=rowtitle_c.join(values[v].fullname+"|||").split("|||").slice(0,rowtitle_c.length-1)):rowtitle_c.push(values[v].fullname),0==coltitle_c.length&&coltitle_c.push(""),0==rowtitle_c.length&&rowtitle_c.push("");for(var r=0;r<rowtitle_c.length;r++)for(var c=0;c<coltitle_c.length;c++)indicator=rowtitle_c[r]+coltitle_c[c],this.addStatisticsData(dataposition,values[v],indicator,d_value)}}for(indicator in dataposition){var json=dataposition[indicator],numArr,numLen,numindex,mean,mean,mean,mean;"SUM"==json.sumtype?json.result=json.sum:"COUNT"==json.sumtype?json.result=json.count:"COUNTA"==json.sumtype?json.result=json.counta:"COUNTUNIQUE"==json.sumtype?json.result=json.countunique:"AVERAGE"==json.sumtype?json.result=luckysheet.numFormat(json.sum/json.count):"MAX"==json.sumtype?json.result=json.max:"MIN"==json.sumtype?json.result=json.min:"MEDIAN"==json.sumtype?(numArr=json.digitaldata.sort(function(e,t){return e-t}),numLen=numArr.length,numindex=parseInt(numLen/2),json.result=numLen%2==0?(numArr[numindex-1]+numArr[numindex])/2:numArr[numindex]):"PRODUCT"==json.sumtype?json.result=eval(json.digitaldata.join("*")):"STDEV"==json.sumtype?(mean=json.sum/json.count,json.result=luckysheet.analysis.STDEV(mean,json.digitaldata)):"STDEVP"==json.sumtype?(mean=json.sum/json.count,json.result=luckysheet.analysis.STDEVP(mean,json.digitaldata)):"VAR"==json.sumtype?(mean=json.sum/json.count,json.result=luckysheet.analysis.VAR(mean,json.digitaldata)):"VARP"==json.sumtype&&(mean=json.sum/json.count,json.result=luckysheet.analysis.VARP(mean,json.digitaldata));var newAcc=luckysheet.numfloatlen(json.result);newAcc>json.acc&&(json.acc=newAcc),json.result=luckysheet.numFormat(json.result,json.acc)}if(datarowtitle=this.getTitleFromGroup(datarowtitlegroup,row,dataposition),datacoltitle=this.getTitleFromGroup(datacoltitlegroup,column,dataposition),"column"==showType)if(0<datacoltitle.length&&0<datacoltitle[0].length)datacoltitle=this.addValuesToTitle(datacoltitle,values);else for(var v=0;v<values.length;v++)datacoltitle.push([values[v].fullname]);else if(0<datarowtitle.length&&0<datarowtitle[0].length)datarowtitle=this.addValuesToTitle(datarowtitle,values);else for(var v=0;v<values.length;v++)datarowtitle.push([values[v].fullname]);for(var datacoltitle_index=datacoltitle,datacoltitle=luckysheet.array.transpose(datacoltitle),valuenslen=0==values.length?0:1,rowLen=(0==datacoltitle.length?valuenslen:datacoltitle.length)+(0==datarowtitle.length?valuenslen:datarowtitle.length),colLen=(0==datacoltitle.length?valuenslen:datacoltitle[0].length)+(0==datarowtitle.length?valuenslen:datarowtitle[0].length),rowOver=datacoltitle.length,colOver=0==datarowtitle.length?0:datarowtitle[0].length,retdata=[],r=0;r<rowLen;r++){retdata[r]=new Array(colLen);for(var c=0;c<colLen;c++){var drt=datarowtitle[r-rowOver];if(r<rowOver&&c<colOver)retdata[r][c]="";else if(r<rowOver&&colOver<=c)null!=datacoltitle[r]?"object"==luckysheet.getObjType(datacoltitle[r][c-colOver])?retdata[r][c]=datacoltitle[r][c-colOver].name+"总计":retdata[r][c]=datacoltitle[r][c-colOver]:retdata[r][c]="";else if(rowOver<=r&&c<colOver)null!=drt?"object"==luckysheet.getObjType(drt[c])?retdata[r][c]=drt[c].name+"总计":retdata[r][c]=drt[c]:retdata[r][c]="";else{var prefix="";if(null!=drt)if(drt instanceof Array&&1!=drt.length)for(var x=0;x<drt.length;x++)"object"==luckysheet.getObjType(drt[x])?prefix+=drt[x].name:prefix+=drt[x];else prefix=drt instanceof Array?drt[0]:drt;var suffix="",dct=datacoltitle_index[c-colOver];if(null!=dct)if(dct instanceof Array&&1!=dct.length)for(var x=0;x<dct.length;x++)"object"==luckysheet.getObjType(dct[x])?suffix+=dct[x].name:suffix+=dct[x];else suffix=dct instanceof Array?dct[0]:dct;var indicator=prefix;""!=prefix&&""!=suffix?indicator=prefix+suffix:""==prefix&&(indicator=suffix),null==dataposition[indicator]?retdata[r][c]="":retdata[r][c]=dataposition[indicator].result}}}return 1==values.length&&0<column.length&&(retdata[0][0]=values[0].fullname,retdata.splice(column.length,1)),this.pivotDatas=retdata,retdata},drillDown:function(e,t){this.pivotDatas[e][t];for(var l,r=$.extend(!0,[],luckysheet.sheetmanage.nulldata),a=1,s=0;s<this.celldata[0].length;s++){null!=(l=this.celldata[0][s]&&this.celldata[0][s].m?this.celldata[0][s].m:luckysheet.getcellvalue(0,s,this.celldata))&&(l=l.toString()),null!=l&&0!=$.trim(l.toString()).length||(l="列 "+a),a++,r[0][s]=l}var n={};if(null!=this.row&&0<this.row.length)for(var o=0;o<this.row.length;o++)n[this.row[o].index]=this.pivotDatas[e][o];if(null!=this.column&&0<this.column.length)for(var c=0;c<this.column.length;c++)n[this.column[c].index]=this.pivotDatas[c][t];for(var u=[],i=1;i<this.celldata.length;i++){var h=!0;for(x in n){if((y=null!=(y=this.celldata[i][x]&&this.celldata[i][x].m?this.celldata[i][x].m:luckysheet.getcellvalue(i,x,this.celldata))?y.toString():"(空白)")!=n[x]){h=!1;break}}h&&u.push(i)}for(var d=0;d<u.length;d++)for(var y,f=0;f<this.celldata[0].length;f++){y=null!=(y=this.celldata[u[d]][f]&&this.celldata[u[d]][f].m?this.celldata[u[d]][f].m:luckysheet.getcellvalue(u[d],f,this.celldata))?y.toString():"",r[d+1][f]=y}luckysheet_select_save=[{row:[0,u.length],column:[0,this.celldata[0].length-1]}],clearjfundo=!1,luckysheet.jfrefreshgrid(r,luckysheet_select_save),luckysheet.selectHightlightShow(),clearjfundo=!0}},luckysheet.freezen={freezenHorizontalHTML:'<div id="luckysheet-freezebar-horizontal" class="luckysheet-freezebar" tabindex="0"><div class="luckysheet-freezebar-handle luckysheet-freezebar-horizontal-handle" ><div class="luckysheet-freezebar-handle-bar luckysheet-freezebar-horizontal-handle-title" ></div><div class="luckysheet-freezebar-handle-bar luckysheet-freezebar-horizontal-handle-bar" ></div></div><div class="luckysheet-freezebar-drop luckysheet-freezebar-horizontal-drop" ><div class="luckysheet-freezebar-drop-bar luckysheet-freezebar-horizontal-drop-title" ></div><div class="luckysheet-freezebar-drop-bar luckysheet-freezebar-horizontal-drop-bar" >&nbsp;</div></div></div>',freezenVerticalHTML:'<div id="luckysheet-freezebar-vertical" class="luckysheet-freezebar" tabindex="0"><div class="luckysheet-freezebar-handle luckysheet-freezebar-vertical-handle" ><div class="luckysheet-freezebar-handle-bar luckysheet-freezebar-vertical-handle-title" ></div><div class="luckysheet-freezebar-handle-bar luckysheet-freezebar-vertical-handle-bar" ></div></div><div class="luckysheet-freezebar-drop luckysheet-freezebar-vertical-drop" ><div class="luckysheet-freezebar-drop-bar luckysheet-freezebar-vertical-drop-title" ></div><div class="luckysheet-freezebar-drop-bar luckysheet-freezebar-vertical-drop-bar" >&nbsp;</div></div></div>',initialHorizontal:!0,initialVertical:!0,horizontalmovestate:!1,horizontalmoveposition:null,verticalmovestate:!1,verticalmoveposition:null,windowHeight:null,windowWidth:null,freezenhorizontaldata:null,freezenverticaldata:null,cutVolumn:function(e,t){if(t<=0)return e;for(var l=e.slice(0,t),r=l[l.length-1],a=e.slice(t),s=0;s<a.length;s++)a[s]-=r;return a},cancelFreezenVertical:function(e){$("#luckysheet-freezen-btn-vertical").html('<i class="fa fa-indent"></i> 冻结首列'),luckysheet.freezen.freezenverticaldata=null;var t=$("#luckysheet-freezebar-vertical").is(":visible");$("#luckysheet-freezebar-vertical").hide(),null==e&&(e=luckysheet.currentSheetIndex);var l=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(e)];null!=l.freezen&&(l.freezen.vertical=null),null!=l.freezen&&t&&luckysheet.server.saveParam("all",e,l.freezen,{k:"freezen"})},createFreezenVertical:function(e,t){var l,r,a;this.initialVertical&&(this.initialVertical=!1,$("#luckysheet-grid-window-1").append(this.freezenVerticalHTML),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-drop").hover(function(){$(this).parent().addClass("luckysheet-freezebar-hover")},function(){$(this).parent().removeClass("luckysheet-freezebar-hover")}),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-drop").mousedown(function(){luckysheet.freezen.verticalmovestate=!0,luckysheet.freezen.verticalmoveposition=$(this).position().left,luckysheet.freezen.windowWidth=$("#luckysheet-grid-window-1").width(),$(this).parent().addClass("luckysheet-freezebar-active"),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css("cursor","-webkit-grabbing")}),l=$("#luckysheet-grid-window-1").height(),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css({height:l-10,width:"4px",cursor:"-webkit-grab",top:"0px"}).end().find(".luckysheet-freezebar-vertical-drop").css({height:l-10,width:"4px",top:"0px",cursor:"-webkit-grab"})),null==e&&(r=$("#luckysheet-cell-main").scrollLeft(),-1==(a=luckysheet_searcharray(visibledatacolumn,r))&&(a=0),t=visibledatacolumn[a]-2-r+rowHeaderWidth,e=[visibledatacolumn[a],a+1,r,luckysheet.freezen.cutVolumn(visibledatacolumn,a+1),t],luckysheet.freezen.saveFreezen(null,null,e,t)),luckysheet.freezen.freezenverticaldata=e,$("#luckysheet-freezen-btn-horizontal").html('<i class="fa fa-indent"></i> 取消冻结'),$("#luckysheet-freezebar-vertical").show().find(".luckysheet-freezebar-vertical-handle").css({left:t}).end().find(".luckysheet-freezebar-vertical-drop").css({left:t})},saveFreezen:function(e,t,l,r){var a=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)];null==a.freezen&&(a.freezen={}),null!=e&&(null==a.freezen.horizontal&&(a.freezen.horizontal={}),a.freezen.horizontal.freezenhorizontaldata=e,a.freezen.horizontal.top=t),null!=l&&(null==a.freezen.vertical&&(a.freezen.vertical={}),a.freezen.vertical.freezenverticaldata=l,a.freezen.vertical.left=r),null!=a.freezen&&luckysheet.server.saveParam("all",luckysheet.currentSheetIndex,a.freezen,{k:"freezen"})},initialFreezen:function(e){var t=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(e)];null!=t.freezen&&null!=t.freezen.horizontal&&null!=t.freezen.horizontal.freezenhorizontaldata?this.createFreezenHorizontal(t.freezen.horizontal.freezenhorizontaldata,t.freezen.horizontal.top):this.cancelFreezenHorizontal(e),null!=t.freezen&&null!=t.freezen.vertical&&null!=t.freezen.vertical.freezenverticaldata?this.createFreezenVertical(t.freezen.vertical.freezenverticaldata,t.freezen.vertical.left):this.cancelFreezenVertical(e),this.createAssistCanvas()},changeFreezenIndex:function(e,t){var l,r,a;return"v"==t&&null!=this.freezenverticaldata?(l=this.freezenverticaldata[1],e-(a=luckysheet_searcharray(visibledatacolumn,$("#luckysheet-cell-main").scrollLeft()))<l&&(e-=a)):"h"==t&&null!=this.freezenhorizontaldata&&(r=this.freezenhorizontaldata[1],e-(a=luckysheet_searcharray(visibledatarow,$("#luckysheet-cell-main").scrollTop()))<r&&(e-=a)),e},scrollFreezen:function(){var e,t=luckysheet_select_save[0].row_focus;t==luckysheet_select_save[0].row[0]?e=luckysheet_select_save[0].row[1]:t==luckysheet_select_save[0].row[1]&&(e=luckysheet_select_save[0].row[0]);var l,r,a,s=luckysheet_select_save[0].column_focus;s==luckysheet_select_save[0].column[0]?l=luckysheet_select_save[0].column[1]:s==luckysheet_select_save[0].column[1]&&(l=luckysheet_select_save[0].column[0]),null!=this.freezenverticaldata&&(r=this.freezenverticaldata[1],l<=(r+=luckysheet_searcharray(this.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()))&&setTimeout(function(){$("#luckysheet-scrollbar-x").scrollLeft(0)},10)),null!=this.freezenhorizontaldata&&(a=this.freezenhorizontaldata[1],e<=(a+=luckysheet_searcharray(this.freezenhorizontaldata[3],$("#luckysheet-cell-main").scrollTop()))&&setTimeout(function(){$("#luckysheet-scrollbar-y").scrollTop(0)},10))},cancelFreezenHorizontal:function(e){$("#luckysheet-freezen-btn-horizontal").html('<i class="fa fa-list-alt"></i> 冻结首行'),luckysheet.freezen.freezenhorizontaldata=null;var t=$("#luckysheet-freezebar-horizontal").is(":visible");$("#luckysheet-freezebar-horizontal").hide(),null==e&&(e=luckysheet.currentSheetIndex);var l=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(e)];null!=l.freezen&&(l.freezen.horizontal=null),null!=l.freezen&&t&&luckysheet.server.saveParam("all",e,l.freezen,{k:"freezen"})},createFreezenHorizontal:function(e,t){var l,r,a;this.initialHorizontal&&(this.initialHorizontal=!1,$("#luckysheet-grid-window-1").append(this.freezenHorizontalHTML),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-drop").hover(function(){$(this).parent().addClass("luckysheet-freezebar-hover")},function(){$(this).parent().removeClass("luckysheet-freezebar-hover")}),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-drop").mousedown(function(){luckysheet.freezen.horizontalmovestate=!0,luckysheet.freezen.horizontalmoveposition=$(this).position().top,luckysheet.freezen.windowHeight=$("#luckysheet-grid-window-1").height(),$(this).parent().addClass("luckysheet-freezebar-active"),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css("cursor","-webkit-grabbing")}),l=$("#luckysheet-grid-window-1").width(),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css({width:l-10,height:"4px",cursor:"-webkit-grab",left:"0px"}).end().find(".luckysheet-freezebar-horizontal-drop").css({width:l-10,height:"4px",left:"0px",cursor:"-webkit-grab"})),null==e&&(r=$("#luckysheet-cell-main").scrollTop(),-1==(a=luckysheet_searcharray(visibledatarow,r))&&(a=0),t=visibledatarow[a]-2-r+columeHeaderHeight,e=[visibledatarow[a],a+1,r,luckysheet.freezen.cutVolumn(visibledatarow,a+1),t],luckysheet.freezen.saveFreezen(e,t,null,null)),luckysheet.freezen.freezenhorizontaldata=e,$("#luckysheet-freezen-btn-horizontal").html('<i class="fa fa-list-alt"></i> 取消冻结'),$("#luckysheet-freezebar-horizontal").show().find(".luckysheet-freezebar-horizontal-handle").css({top:t}).end().find(".luckysheet-freezebar-horizontal-drop").css({top:t})},createAssistCanvas:function(){var e,t,l,r,a,s,n=this;n.removeAssistCanvas(),null==n.freezenverticaldata&&null==n.freezenhorizontaldata||(a=luckysheetTableContentHW[0],s=luckysheetTableContentHW[1],null!=n.freezenverticaldata&&null!=n.freezenhorizontaldata?(e=n.freezenhorizontaldata[0],n.freezenhorizontaldata[1],t=n.freezenhorizontaldata[2],l=n.freezenverticaldata[0],n.freezenverticaldata[1],r=n.freezenverticaldata[2],n.createCanvas("freezen_3",l-r,e-t+1,rowHeaderWidth-1,columeHeaderHeight-1),n.createCanvas("freezen_4",a-l+r,e-t+1,l-r+rowHeaderWidth-1,columeHeaderHeight-1),n.createCanvas("freezen_7",l-r,s-e+t-columeHeaderHeight,rowHeaderWidth-1,e-t+columeHeaderHeight-1)):null!=n.freezenhorizontaldata?(e=n.freezenhorizontaldata[0],n.freezenhorizontaldata[1],t=n.freezenhorizontaldata[2],n.createCanvas("freezen_h",a,e-t+1,rowHeaderWidth-1,columeHeaderHeight-1)):null!=n.freezenverticaldata&&(l=n.freezenverticaldata[0],n.freezenverticaldata[1],r=n.freezenverticaldata[2],n.createCanvas("freezen_v",l-r,s,rowHeaderWidth-1,columeHeaderHeight-1)),luckysheet.freezen.scrollAdapt())},createCanvas:function(e,t,l,r,a){$("<canvas/>").appendTo("#luckysheet-grid-window-1").attr({id:e,width:Math.ceil(t*devicePixelRatio),height:Math.ceil(l*devicePixelRatio)}).css({"user-select":"none",postion:"absolute",left:r,top:a,width:t,height:l,"z-index":10,"pointer-events":"none"})},removeAssistCanvas:function(){$("#luckysheet-grid-window-1 > canvas").not($("#luckysheetTableContent")).remove(),$("#luckysheet-cell-selected").css("z-index",15)},scrollAdapt:function(){null!=luckysheet_select_save&&0<luckysheet_select_save.length&&luckysheet.freezen.scrollAdaptOfselect(),0<$("#luckysheet-cell-main .luckysheet-data-visualization-chart").length&&luckysheet.freezen.scrollAdaptOfchart(),0<$("#luckysheet-postil-showBoxs .luckysheet-postil-show").length&&luckysheet.freezen.scrollAdaptOfpostil(),0<$("#luckysheet-dropCell-icon").length&&luckysheet.freezen.scrollAdaptOfdpicon(),0<$("#luckysheet-filter-options-sheet"+luckysheet.currentSheetIndex+" .luckysheet-filter-options").length&&luckysheet.freezen.scrollAdaptOffilteroptions()},scrollAdaptOfselect:function(){$("#luckysheet-row-count-show").is(":visible")&&$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").is(":visible")&&$("#luckysheet-column-count-show").hide(),$("#luckysheet-rows-h-selected").empty(),$("#luckysheet-cols-h-selected").empty();var e=$("#luckysheet-cell-main").scrollTop(),t=$("#luckysheet-cell-main").scrollLeft();if(null!=luckysheet.freezen.freezenhorizontaldata&&null!=luckysheet.freezen.freezenverticaldata)for(var l=luckysheet.freezen.freezenhorizontaldata[0],r=luckysheet.freezen.freezenhorizontaldata[1],a=e-luckysheet.freezen.freezenhorizontaldata[2],s=luckysheet.freezen.freezenverticaldata[0],n=luckysheet.freezen.freezenverticaldata[1],o=t-luckysheet.freezen.freezenverticaldata[2],c=0;c<luckysheet_select_save.length;c++){var u=(I=$.extend(!0,{},luckysheet_select_save[c])).row[0],i=I.row[1],h=visibledatarow[i],d=_=u-1==-1?0:visibledatarow[u-1],y=h-_-1,f=!0;r<=u?d+y<l+a?f=!1:d<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(c).show().css({top:l+a,height:y-(l+a-d)}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(c).show().css({top:d,height:y}):r<=i?d+y<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(c).show().css({top:d+a,height:l-d}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(c).show().css({top:d+a,height:y-a}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(c).show().css("top",d+a);var m,k=I.column[0],p=I.column[1],g=visibledatacolumn[p],v=R=k-1==-1?0:visibledatacolumn[k-1],b=g-R-1;n<=k?v+b<s+o?f=!1:v<s+o?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(c).show().css({left:s+o,width:b-(s+o-v)}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(c).show().css({left:v,width:b}):n<=p?v+b<s+o?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(c).show().css({left:v+o,width:s-v}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(c).show().css({left:v+o,width:b-o}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(c).show().css("left",v+o),f||$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(c).hide(),c==luckysheet_select_save.length-1&&(S=null==I.row_focus?u:I.row_focus,A=null==I.column_focus?k:I.column_focus,w=visibledatarow[S],x=S-1==-1?0:visibledatarow[S-1],F=visibledatacolumn[A],N=A-1==-1?0:visibledatacolumn[A-1],(M=luckysheet.menuButton.mergeborer(luckysheet.flowdata,S,A))&&(w=M.row[1],x=M.row[0],F=M.column[1],N=M.column[0]),T=w-x-1,O=F-(E=N)-1,m=!0,l<=(C=x)?C+T<l+a?m=!1:C<l+a?$("#luckysheet-cell-selected-focus").show().css({top:l+a,height:T-(l+a-C)}):$("#luckysheet-cell-selected-focus").show().css({top:C,height:T}):l<=C+T?C+T<l+a?$("#luckysheet-cell-selected-focus").show().css({top:C+a,height:l-C}):$("#luckysheet-cell-selected-focus").show().css({top:C+a,height:T-a}):$("#luckysheet-cell-selected-focus").show().css("top",C+a),s<=E?E+O<s+o?m=!1:E<s+o?$("#luckysheet-cell-selected-focus").show().css({left:s+o,width:O-(s+o-E)}):$("#luckysheet-cell-selected-focus").show().css({left:E,width:O}):s<=E+O?E+O<s+o?$("#luckysheet-cell-selected-focus").show().css({left:E+o,width:s-E}):$("#luckysheet-cell-selected-focus").show().css({left:E+o,width:O-o}):$("#luckysheet-cell-selected-focus").show().css("left",E+o),m||$("#luckysheet-cell-selected-focus").hide())}else if(null!=luckysheet.freezen.freezenhorizontaldata)for(l=luckysheet.freezen.freezenhorizontaldata[0],r=luckysheet.freezen.freezenhorizontaldata[1],a=e-luckysheet.freezen.freezenhorizontaldata[2],c=0;c<luckysheet_select_save.length;c++){var _,w,x,C,T,u=(I=$.extend(!0,{},luckysheet_select_save[c])).row[0],i=I.row[1],h=visibledatarow[i],d=_=u-1==-1?0:visibledatarow[u-1],y=h-_-1;r<=u?d+y<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(c).hide():d<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(c).show().css({top:l+a,height:y-(l+a-d)}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(c).show().css({top:d,height:y}):r<=i?d+y<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(c).show().css({top:d+a,height:l-d}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(c).show().css({top:d+a,height:y-a}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(c).show().css("top",d+a),c==luckysheet_select_save.length-1&&(S=null==I.row_focus?u:I.row_focus,A=null==I.column_focus?I.column[0]:I.column_focus,w=visibledatarow[S],x=S-1==-1?0:visibledatarow[S-1],(M=luckysheet.menuButton.mergeborer(luckysheet.flowdata,S,A))&&(w=M.row[1],x=M.row[0]),T=w-x-1,l<=(C=x)?C+T<l+a?$("#luckysheet-cell-selected-focus").hide():C<l+a?$("#luckysheet-cell-selected-focus").show().css({top:l+a,height:T-(l+a-C)}):$("#luckysheet-cell-selected-focus").show().css({top:C,height:T}):l<=C+T?C+T<l+a?$("#luckysheet-cell-selected-focus").show().css({top:C+a,height:l-C}):$("#luckysheet-cell-selected-focus").show().css({top:C+a,height:T-a}):$("#luckysheet-cell-selected-focus").show().css("top",C+a))}else if(null!=luckysheet.freezen.freezenverticaldata)for(s=luckysheet.freezen.freezenverticaldata[0],n=luckysheet.freezen.freezenverticaldata[1],o=t-luckysheet.freezen.freezenverticaldata[2],c=0;c<luckysheet_select_save.length;c++){var I,R,S,A,F,N,M,E,O,k=(I=$.extend(!0,{},luckysheet_select_save[c])).column[0],p=I.column[1],g=visibledatacolumn[p],v=R=k-1==-1?0:visibledatacolumn[k-1],b=g-R-1;n<=k?v+b<s+o?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(c).hide():v<s+o?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(c).show().css({left:s+o,width:b-(s+o-v)}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(c).show().css({left:v,width:b}):n<=p?v+b<s+o?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(c).show().css({left:v+o,width:s-v}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(c).show().css({left:v+o,width:b-o}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(c).show().css("left",v+o),c==luckysheet_select_save.length-1&&(S=null==I.row_focus?I.row[0]:I.row_focus,A=null==I.column_focus?k:I.column_focus,F=visibledatacolumn[A],N=A-1==-1?0:visibledatacolumn[A-1],(M=luckysheet.menuButton.mergeborer(luckysheet.flowdata,S,A))&&(F=M.column[1],N=M.column[0]),O=F-N-1,s<=(E=N)?E+O<s+o?$("#luckysheet-cell-selected-focus").hide():E<s+o?$("#luckysheet-cell-selected-focus").show().css({left:s+o,width:O-(s+o-E)}):$("#luckysheet-cell-selected-focus").show().css({left:E,width:O}):s<=E+O?E+O<s+o?$("#luckysheet-cell-selected-focus").show().css({left:E+o,width:s-E}):$("#luckysheet-cell-selected-focus").show().css({left:E+o,width:O-o}):$("#luckysheet-cell-selected-focus").show().css("left",E+o))}else luckysheet.selectHightlightShow()},scrollAdaptOfchart:function(){var i,h,d=$("#luckysheet-cell-main").scrollTop(),y=$("#luckysheet-cell-main").scrollLeft();null!=luckysheet.freezen.freezenhorizontaldata&&null!=luckysheet.freezen.freezenverticaldata?(i=luckysheet.freezen.freezenhorizontaldata[0]-luckysheet.freezen.freezenhorizontaldata[2],h=luckysheet.freezen.freezenverticaldata[0]-luckysheet.freezen.freezenverticaldata[2],$("#luckysheet-cell-main .luckysheet-data-visualization-chart").each(function(e,t){var l,r=$(t).position(),a=$(t).width(),s=$(t).height(),n=$(t).find("canvas").width(),o=$(t).find("canvas").height(),c=o-s,u=n-a;r.top-c<i?o+40+2<(l=i-(r.top-c))?$(t).css("visibility","hidden"):($(t).css({top:i+d,height:o-l,visibility:"visible"}),$(t).find("canvas").css("top",-l)):($(t).css({top:r.top-c+d,height:o,visibility:"visible"}),$(t).find("canvas").css("top",0)),r.left-u<h?n+20+2<(l=h-(r.left-u))?$(t).css("visibility","hidden"):($(t).css({left:h+y,width:n-l,visibility:"visible"}),$(t).find("canvas").css("left",-l)):($(t).css({left:r.left-u+y,width:n,visibility:"visible"}),$(t).find("canvas").css("left",0))})):null!=luckysheet.freezen.freezenhorizontaldata?(i=luckysheet.freezen.freezenhorizontaldata[0]-luckysheet.freezen.freezenhorizontaldata[2],$("#luckysheet-cell-main .luckysheet-data-visualization-chart").each(function(e,t){var l,r=$(t).position(),a=$(t).height(),s=$(t).find("canvas").height(),n=s-a;r.top-n<i?s+40+2<(l=i-(r.top-n))?$(t).css("visibility","hidden"):($(t).css({top:i+d,height:s-l,visibility:"visible"}),$(t).find("canvas").css("top",-l)):($(t).css({top:r.top-n+d,height:s,visibility:"visible"}),$(t).find("canvas").css("top",0))})):null!=luckysheet.freezen.freezenverticaldata?(h=luckysheet.freezen.freezenverticaldata[0]-luckysheet.freezen.freezenverticaldata[2],$("#luckysheet-cell-main .luckysheet-data-visualization-chart").each(function(e,t){var l,r=$(t).position(),a=$(t).width(),s=$(t).find("canvas").width(),n=s-a;r.left-n<h?s+20+2<(l=h-(r.left-n))?$(t).css("visibility","hidden"):($(t).css({left:h+y,width:s-l,visibility:"visible"}),$(t).find("canvas").css("left",-l)):($(t).css({left:r.left-n+y,width:s,visibility:"visible"}),$(t).find("canvas").css("left",0))})):$("#luckysheet-cell-main .luckysheet-data-visualization-chart").each(function(e,t){var l=$(t).position(),r=$(t).width(),a=$(t).height(),s=$(t).find("canvas").width(),n=$(t).find("canvas").height(),o=n-a,c=s-r;$(t).css({top:l.top-o+d,height:n,left:l.left-c+y,width:s,visibility:"visible"}),$(t).find("canvas").css({top:0,left:0})})},scrollAdaptOfpostil:function(){var k,p,g,v,e=$("#luckysheet-cell-main").scrollTop(),t=$("#luckysheet-cell-main").scrollLeft();null!=luckysheet.freezen.freezenhorizontaldata&&null!=luckysheet.freezen.freezenverticaldata?(k=luckysheet.freezen.freezenhorizontaldata[0],g=luckysheet.freezen.freezenverticaldata[0],p=e-luckysheet.freezen.freezenhorizontaldata[2],v=t-luckysheet.freezen.freezenverticaldata[2],$("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(e,t){var l=$(t).attr("id"),r=l.split("luckysheet-postil-show_")[1].split("_")[0],a=l.split("luckysheet-postil-show_")[1].split("_")[1],s=luckysheet.flowdata[r][a].ps,n=(visibledatarow[r],r-1==-1?0:visibledatarow[r-1]),o=visibledatacolumn[a],c=(a-1==-1||visibledatacolumn[a-1],luckysheet.menuButton.mergeborer(luckysheet.flowdata,r,a));c&&(c.row[1],n=c.row[0],o=c.column[1],c.column[0]);var u=null==s.left?o+18:s.left,i=null==s.top?n-18:s.top,h=null==s.width?luckysheet.postil.defaultWidth:s.width,d=null==s.height?luckysheet.postil.defaultHeight:s.height;i<0&&(i=2);var y=luckysheet.postil.getArrowCanvasSize(u,i,o,n),f=!0,m=!0;i+d<k?($(t).show().find(".luckysheet-postil-show-main").css("top",i+p),$(t).show().find(".arrowCanvas").css("top",y[1]+p)):i<k+p?i+d<=k+p?f=!1:($(t).show().find(".luckysheet-postil-show-main").css({top:k+p,height:d-(k+p-i)}),$(t).show().find(".formulaInputFocus").css("margin-top",-(k+p-i)),$(t).show().find(".arrowCanvas").hide(),m=!1):($(t).show().find(".luckysheet-postil-show-main").css({top:i,height:d}),$(t).show().find(".formulaInputFocus").css("margin-top",0),$(t).show().find(".arrowCanvas").css("top",y[1])),u+h<g?($(t).show().find(".luckysheet-postil-show-main").css("left",u+v),$(t).show().find(".arrowCanvas").css("left",y[0]+v)):u<g+v?u+h<=g+v?f=!1:($(t).show().find(".luckysheet-postil-show-main").css({left:g+v,width:h-(g+v-u)}),$(t).show().find(".formulaInputFocus").css("margin-left",-(g+v-u)),$(t).show().find(".arrowCanvas").hide(),m=!1):($(t).show().find(".luckysheet-postil-show-main").css({left:u,width:h}),$(t).show().find(".formulaInputFocus").css("margin-left",0),$(t).show().find(".arrowCanvas").css("left",y[0])),f||$(t).hide(),f&&m&&$(t).show().find(".arrowCanvas").show()})):null!=luckysheet.freezen.freezenhorizontaldata?(k=luckysheet.freezen.freezenhorizontaldata[0],p=e-luckysheet.freezen.freezenhorizontaldata[2],$("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(e,t){var l=$(t).attr("id"),r=l.split("luckysheet-postil-show_")[1].split("_")[0],a=l.split("luckysheet-postil-show_")[1].split("_")[1],s=luckysheet.flowdata[r][a].ps,n=(visibledatarow[r],r-1==-1?0:visibledatarow[r-1]),o=visibledatacolumn[a],c=(a-1==-1||visibledatacolumn[a-1],luckysheet.menuButton.mergeborer(luckysheet.flowdata,r,a));c&&(c.row[1],n=c.row[0],o=c.column[1],c.column[0]);var u=null==s.left?o+18:s.left,i=null==s.top?n-18:s.top,h=(null==s.width?luckysheet.postil.defaultWidth:s.width,null==s.height?luckysheet.postil.defaultHeight:s.height);i<0&&(i=2);var d=luckysheet.postil.getArrowCanvasSize(u,i,o,n);i+h<k?($(t).show().find(".luckysheet-postil-show-main").css("top",i+p),$(t).show().find(".arrowCanvas").css("top",d[1]+p)):i<k+p?i+h<=k+p?$(t).hide():($(t).show().find(".luckysheet-postil-show-main").css({top:k+p,height:h-(k+p-i)}),$(t).show().find(".formulaInputFocus").css("margin-top",-(k+p-i)),$(t).show().find(".arrowCanvas").hide()):luckysheet.postil.buildPs(r,a,s)})):null!=luckysheet.freezen.freezenverticaldata?(g=luckysheet.freezen.freezenverticaldata[0],v=t-luckysheet.freezen.freezenverticaldata[2],$("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(e,t){var l=$(t).attr("id"),r=l.split("luckysheet-postil-show_")[1].split("_")[0],a=l.split("luckysheet-postil-show_")[1].split("_")[1],s=luckysheet.flowdata[r][a].ps,n=(visibledatarow[r],r-1==-1?0:visibledatarow[r-1]),o=visibledatacolumn[a],c=(a-1==-1||visibledatacolumn[a-1],luckysheet.menuButton.mergeborer(luckysheet.flowdata,r,a));c&&(c.row[1],n=c.row[0],o=c.column[1],c.column[0]);var u=null==s.left?o+18:s.left,i=null==s.top?n-18:s.top,h=null==s.width?luckysheet.postil.defaultWidth:s.width;null==s.height?luckysheet.postil.defaultHeight:s.height;i<0&&(i=2);var d=luckysheet.postil.getArrowCanvasSize(u,i,o,n);u+h<g?($(t).show().find(".luckysheet-postil-show-main").css("left",u+v),$(t).show().find(".arrowCanvas").css("left",d[0]+v)):u<g+v?u+h<=g+v?$(t).hide():($(t).show().find(".luckysheet-postil-show-main").css({left:g+v,width:h-(g+v-u)}),$(t).show().find(".formulaInputFocus").css("margin-left",-(g+v-u)),$(t).show().find(".arrowCanvas").hide()):luckysheet.postil.buildPs(r,a,s)})):$("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(e,t){var l=$(t).attr("id"),r=l.split("luckysheet-postil-show_")[1].split("_")[0],a=l.split("luckysheet-postil-show_")[1].split("_")[1],s=luckysheet.flowdata[r][a].ps;luckysheet.postil.buildPs(r,a,s)})},scrollAdaptOfdpicon:function(){var e,t,l,r,a,s,n,o,c=luckysheet.dropCell.copyRange.row[1],u=luckysheet.dropCell.copyRange.column[1],i=luckysheet.dropCell.applyRange.row[1],h=luckysheet.dropCell.applyRange.column[1];t=c<=i&&u<=h?(e=i,h):(e=c,u),null!=luckysheet.freezen.freezenhorizontaldata&&null!=luckysheet.freezen.freezenverticaldata?(l=luckysheet.freezen.freezenhorizontaldata[1],r=luckysheet_searcharray(luckysheet.freezen.freezenhorizontaldata[3],$("#luckysheet-cell-main").scrollTop()-luckysheet.freezen.freezenhorizontaldata[2]),a=luckysheet.freezen.freezenverticaldata[1],s=luckysheet_searcharray(luckysheet.freezen.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()-luckysheet.freezen.freezenverticaldata[2]),l<=e&&a<=t?e<l+r-1||t<a+s-1?$("#luckysheet-dropCell-icon").hide():$("#luckysheet-dropCell-icon").show():l<=e?e<l+r-1?$("#luckysheet-dropCell-icon").hide():(o=luckysheet.colLocationByIndex(t+s)[1],$("#luckysheet-dropCell-icon").show().css("left",o)):a<=t?t<a+s-1?$("#luckysheet-dropCell-icon").hide():(n=luckysheet.rowLocationByIndex(e+r)[1],$("#luckysheet-dropCell-icon").show().css("top",n)):(n=luckysheet.rowLocationByIndex(e+r)[1],o=luckysheet.colLocationByIndex(t+s)[1],$("#luckysheet-dropCell-icon").show().css({left:o,top:n}))):null!=luckysheet.freezen.freezenhorizontaldata?(l=luckysheet.freezen.freezenhorizontaldata[1],r=luckysheet_searcharray(luckysheet.freezen.freezenhorizontaldata[3],$("#luckysheet-cell-main").scrollTop()-luckysheet.freezen.freezenhorizontaldata[2]),l<=e?e<l+r-1?$("#luckysheet-dropCell-icon").hide():$("#luckysheet-dropCell-icon").show():(n=luckysheet.rowLocationByIndex(e+r)[1],$("#luckysheet-dropCell-icon").show().css("top",n))):null!=luckysheet.freezen.freezenverticaldata?(a=luckysheet.freezen.freezenverticaldata[1],s=luckysheet_searcharray(luckysheet.freezen.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()-luckysheet.freezen.freezenverticaldata[2]),a<=t?t<a+s-1?$("#luckysheet-dropCell-icon").hide():$("#luckysheet-dropCell-icon").show():(o=luckysheet.colLocationByIndex(t+s)[1],$("#luckysheet-dropCell-icon").show().css("left",o))):(n=luckysheet.rowLocationByIndex(e)[1],o=luckysheet.colLocationByIndex(t)[1],$("#luckysheet-dropCell-icon").show().css({left:o,top:n}))},scrollAdaptOffilteroptions:function(){var n,o,c,u;null!=luckysheet.freezen.freezenhorizontaldata&&null!=luckysheet.freezen.freezenverticaldata?(n=luckysheet.freezen.freezenhorizontaldata[1],o=luckysheet.freezen.freezenhorizontaldata[0]+$("#luckysheet-cell-main").scrollTop(),c=luckysheet.freezen.freezenverticaldata[1],u=luckysheet_searcharray(luckysheet.freezen.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()-luckysheet.freezen.freezenverticaldata[2]),$("#luckysheet-filter-options-sheet"+luckysheet.currentSheetIndex+" .luckysheet-filter-options").each(function(e,t){var l,r=$(t).data("str"),a=r-1==-1?0:visibledatarow[r-1],s=$(t).data("cindex");n<=r&&c<=s?a<o||s<c+u?$(t).hide():$(t).show():n<=r?a<o?$(t).hide():(l=visibledatacolumn[s+u]-20,$(t).show().css("left",l)):c<=s?s<c+u?$(t).hide():$(t).show().css("top",a+$("#luckysheet-cell-main").scrollTop()):(l=visibledatacolumn[s+u]-20,$(t).show().css({left:l,top:a+$("#luckysheet-cell-main").scrollTop()}))})):null!=luckysheet.freezen.freezenhorizontaldata?(n=luckysheet.freezen.freezenhorizontaldata[1],o=luckysheet.freezen.freezenhorizontaldata[0]+$("#luckysheet-cell-main").scrollTop(),$("#luckysheet-filter-options-sheet"+luckysheet.currentSheetIndex+" .luckysheet-filter-options").each(function(e,t){var l=$(t).data("str"),r=l-1==-1?0:visibledatarow[l-1];n<=l?r<o?$(t).hide():$(t).show():$(t).show().css("top",r+$("#luckysheet-cell-main").scrollTop())})):null!=luckysheet.freezen.freezenverticaldata?(c=luckysheet.freezen.freezenverticaldata[1],u=luckysheet_searcharray(luckysheet.freezen.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()-luckysheet.freezen.freezenverticaldata[2]),$("#luckysheet-filter-options-sheet"+luckysheet.currentSheetIndex+" .luckysheet-filter-options").each(function(e,t){var l,r=$(t).data("cindex");c<=r?r<c+u?$(t).hide():$(t).show():(l=visibledatacolumn[r+u]-20,$(t).show().css("left",l))})):($("#luckysheet-filter-options-sheet"+luckysheet.currentSheetIndex).empty(),luckysheet.createFilterOptions(luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].filter_select))}},luckysheet.conditionformat={fileClone:[],editorRule:null,ruleTypeHtml:'<div class="ruleTypeBox"><div class="ruleTypeItem"><span class="icon">► </span><span>基于各自值设置所有单元格的格式</span></div><div class="ruleTypeItem"><span class="icon">► </span><span>只为包含以下内容的单元格设置格式</span></div><div class="ruleTypeItem"><span class="icon">► </span><span>仅对排名靠前或靠后的数值设置格式</span></div><div class="ruleTypeItem"><span class="icon">► </span><span>仅对高于或低于平均值的数值设置格式</span></div><div class="ruleTypeItem"><span class="icon">► </span><span>仅对唯一值或重复值设置格式</span></div></div>',textCellColorHtml:'<div id="textCellColor"><div class="colorbox"><input id="checkTextColor" type="checkbox" checked="checked"><label for="checkTextColor">文本颜色：</label><input id="textcolorshow" data-tips="文本颜色" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="#9c0006" style="display: none;"></div><div class="colorbox"><input id="checkCellColor" type="checkbox" checked="checked"><label for="checkCellColor">单元格颜色：</label><input id="cellcolorshow" data-tips="单元格颜色" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="#ffc7ce" style="display: none;"></div></div>',selectRange:[],selectStatus:!1,dataBarList:[{format:["#638ec6","#ffffff"]},{format:["#63c384","#ffffff"]},{format:["#ff555a","#ffffff"]},{format:["#ffb628","#ffffff"]},{format:["#008aef","#ffffff"]},{format:["#d6007b","#ffffff"]},{format:["#638ec6"]},{format:["#63c384"]},{format:["#ff555a"]},{format:["#ffb628"]},{format:["#008aef"]},{format:["#d6007b"]}],colorGradationList:[{format:["rgb(99, 190, 123)","rgb(255, 235, 132)","rgb(248, 105, 107)"]},{format:["rgb(248, 105, 107)","rgb(255, 235, 132)","rgb(99, 190, 123)"]},{format:["rgb(99, 190, 123)","rgb(252, 252, 255)","rgb(248, 105, 107)"]},{format:["rgb(248, 105, 107)","rgb(252, 252, 255)","rgb(99, 190, 123)"]},{format:["rgb(90, 138, 198)","rgb(252, 252, 255)","rgb(248, 105, 107)"]},{format:["rgb(248, 105, 107)","rgb(252, 252, 255)","rgb(90, 138, 198)"]},{format:["rgb(252, 252, 255)","rgb(248, 105, 107)"]},{format:["rgb(248, 105, 107)","rgb(252, 252, 255)"]},{format:["rgb(99, 190, 123)","rgb(252, 252, 255)"]},{format:["rgb(252, 252, 255)","rgb(99, 190, 123)"]},{format:["rgb(99, 190, 123)","rgb(255, 235, 132)"]},{format:["rgb(255, 235, 132)","rgb(99, 190, 123)"]}],init:function(){$(document).off("change.CFchooseSheet").on("change.CFchooseSheet","#luckysheet-administerRule-dialog .chooseSheet",function(){var e=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val();luckysheet.conditionformat.getConditionRuleList(e)}),$(document).off("click.CFadministerRuleItem").on("click.CFadministerRuleItem","#luckysheet-administerRule-dialog .ruleList .listBox .item",function(){$(this).addClass("on").siblings().removeClass("on")}),$(document).off("click.CFadministerRuleConfirm").on("click.CFadministerRuleConfirm","#luckysheet-administerRule-dialog-confirm",function(){for(var e=$.extend(!0,[],luckysheet.getluckysheetfile()),t=luckysheet.conditionformat.getHistoryRules(e),l=$.extend(!0,[],luckysheet.conditionformat.fileClone),r=0;r<l.length;r++){var a=l[r].index;luckysheetfile[luckysheet.sheetmanage.getSheetIndex(a)].luckysheet_conditionformat_save=l[luckysheet.sheetmanage.getSheetIndex(a)].luckysheet_conditionformat_save}var s=$.extend(!0,[],luckysheet.getluckysheetfile()),n=luckysheet.conditionformat.getCurrentRules(s);if(luckysheet.conditionformat.ref(t,n),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-administerRule-dialog").hide(),luckysheet.server.allowUpdate)for(var o=$.extend(!0,[],luckysheet.getluckysheetfile()),c=0;c<o.length;c++)luckysheet.server.saveParam("all",o[c].index,o[c].luckysheet_conditionformat_save,{k:"luckysheet_conditionformat_save"})}),$(document).off("click.CFadministerRuleClose").on("click.CFadministerRuleClose","#luckysheet-administerRule-dialog-close",function(){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-administerRule-dialog").hide(),luckysheet.conditionformat.fileClone=[]}),$(document).off("click.CFadministerRuleFa").on("click.CFadministerRuleFa","#luckysheet-administerRule-dialog .item .fa-table",function(){$(this).parents("#luckysheet-administerRule-dialog").hide();var e=$("#luckysheet-administerRule-dialog .chooseSheet select option:selected").val();e!=luckysheet.currentSheetIndex&&luckysheet.sheetmanage.changeSheetExec(e);var t=$(this).siblings("input").val().trim(),l=$(this).parents(".item").attr("data-item");luckysheet.conditionformat.multiRangeDialog(l,t),luckysheet.conditionformat.selectRange=[];var r=luckysheet.conditionformat.getRangeByTxt(t);if(0<r.length)for(var a=0;a<r.length;a++){var s=r[a].row[0],n=r[a].row[1],o=r[a].column[0],c=r[a].column[1],u=visibledatarow[n],i=s-1==-1?0:visibledatarow[s-1],h=visibledatacolumn[c],d=o-1==-1?0:visibledatacolumn[o-1];luckysheet.conditionformat.selectRange.push({left:d,width:h-d-1,top:i,height:u-i-1,left_move:d,width_move:h-d-1,top_move:i,height_move:u-i-1,row:[s,n],column:[o,c],row_focus:s,column_focus:o})}luckysheet.selectionCopyShow(luckysheet.conditionformat.selectRange)}),$(document).off("click.CFmultiRangeConfirm").on("click.CFmultiRangeConfirm","#luckysheet-multiRange-dialog-confirm",function(){$(this).parents("#luckysheet-multiRange-dialog").hide();var e=$(this).attr("data-item"),t=$(this).parents("#luckysheet-multiRange-dialog").find("input").val();$("#luckysheet-administerRule-dialog .item[data-item="+e+"] input").val(t);var l=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val();luckysheet.conditionformat.fileClone[luckysheet.sheetmanage.getSheetIndex(l)].luckysheet_conditionformat_save[e].cellrange=luckysheet.conditionformat.getRangeByTxt(t),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").show();luckysheet.selectionCopyShow([])}),$(document).off("click.CFmultiRangeClose").on("click.CFmultiRangeClose","#luckysheet-multiRange-dialog-close",function(){$(this).parents("#luckysheet-multiRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").show(),$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide();luckysheet.selectionCopyShow([])}),$(document).off("click.CFnewConditionRule").on("click.CFnewConditionRule","#newConditionRule",function(){0!=luckysheet_select_save.length?luckysheet.conditionformat.newConditionRuleDialog(1):luckysheet.isEditMode()?alert("请选择应用范围"):luckysheet.tooltip.info("请选择应用范围","")}),$(document).off("click.CFnewConditionRuleConfirm").on("click.CFnewConditionRuleConfirm","#luckysheet-newConditionRule-dialog-confirm",function(){var e,t,l,r,a,s=$("#luckysheet-newConditionRule-dialog .ruleTypeItem.on").index(),n=$("#luckysheet-newConditionRule-dialog #type1 option:selected").val(),o=$("#luckysheet-newConditionRule-dialog ."+n+"Box #type2 option:selected").val();if(0==s){"dataBar"==n?(e=$(this).parents("#luckysheet-newConditionRule-dialog").find(".dataBarBox .luckysheet-conditionformat-config-color").spectrum("get").toHexString(),"gradient"==o?a=[e,"#ffffff"]:"solid"==o&&(a=[e]),_={type:"dataBar",cellrange:$.extend(!0,[],luckysheet_select_save),format:a}):"colorGradation"==n?(t=$(this).parents("#luckysheet-newConditionRule-dialog").find(".colorGradationBox .maxVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString(),l=$(this).parents("#luckysheet-newConditionRule-dialog").find(".colorGradationBox .midVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString(),r=$(this).parents("#luckysheet-newConditionRule-dialog").find(".colorGradationBox .minVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString(),"threeColor"==o?a=[t,l,r]:"twoColor"==o&&(a=[t,r]),_={type:"colorGradation",cellrange:$.extend(!0,[],luckysheet_select_save),format:a}):"icons"==n&&(a={len:$(this).parents("#luckysheet-newConditionRule-dialog").find(".iconsBox .model").attr("data-len"),leftMin:$(this).parents("#luckysheet-newConditionRule-dialog").find(".iconsBox .model").attr("data-leftmin"),top:$(this).parents("#luckysheet-newConditionRule-dialog").find(".iconsBox .model").attr("data-top")},_={type:"icons",cellrange:$.extend(!0,[],luckysheet_select_save),format:a})}else{var c="",u=[],i=[];if(1==s){if("number"==n)if("betweenness"==(c=o)){var h=$("#luckysheet-newConditionRule-dialog #conditionVal input").val().trim(),d=$("#luckysheet-newConditionRule-dialog #conditionVal2 input").val().trim(),y=luckysheet.conditionformat.getRangeByTxt(h);if(1<y.length)return void luckysheet.conditionformat.infoDialog("只能对单个单元格进行引用","");if(1==y.length){var f=y[0].row[0],m=y[0].row[1],k=y[0].column[0],p=y[0].column[1];if(f!=m||k!=p)return void luckysheet.conditionformat.infoDialog("只能对单个单元格进行引用","");h=luckysheet.getcellvalue(f,k,luckysheet.flowdata),u.push({row:y[0].row,column:y[0].column}),i.push(h)}else if(0==y.length){if(isNaN(h)||""==h)return void luckysheet.conditionformat.infoDialog("条件值只能是数字或者单个单元格","");i.push(h)}var g=luckysheet.conditionformat.getRangeByTxt(d);if(1<g.length)return void luckysheet.conditionformat.infoDialog("只能对单个单元格进行引用","");if(1==g.length){f=g[0].row[0],m=g[0].row[1],k=g[0].column[0],p=g[0].column[1];if(f!=m||k!=p)return void luckysheet.conditionformat.infoDialog("只能对单个单元格进行引用","");d=luckysheet.getcellvalue(f,k,luckysheet.flowdata),u.push({row:g[0].row,column:g[0].column}),i.push(d)}else if(0==g.length){if(isNaN(d)||""==d)return void luckysheet.conditionformat.infoDialog("条件值只能是数字或者单个单元格","");i.push(d)}}else{var v=$("#luckysheet-newConditionRule-dialog #conditionVal input").val().trim();if(1<(b=luckysheet.conditionformat.getRangeByTxt(v)).length)return void luckysheet.conditionformat.infoDialog("只能对单个单元格进行引用","");if(1==b.length){f=b[0].row[0],m=b[0].row[1],k=b[0].column[0],p=b[0].column[1];if(f!=m||k!=p)return void luckysheet.conditionformat.infoDialog("只能对单个单元格进行引用","");v=luckysheet.getcellvalue(f,k,luckysheet.flowdata),u.push({row:b[0].row,column:b[0].column}),i.push(v)}else if(0==b.length){if(isNaN(v)||""==v)return void luckysheet.conditionformat.infoDialog("条件值只能是数字或者单个单元格","");i.push(v)}}else if("text"==n){c="textContains";var b,v=$("#luckysheet-newConditionRule-dialog #conditionVal input").val().trim();if(1<(b=luckysheet.conditionformat.getRangeByTxt(v)).length)return void luckysheet.conditionformat.infoDialog("只能对单个单元格进行引用","");if(1==b.length){f=b[0].row[0],m=b[0].row[1],k=b[0].column[0],p=b[0].column[1];if(f!=m||k!=p)return void luckysheet.conditionformat.infoDialog("只能对单个单元格进行引用","");v=luckysheet.getcellvalue(f,k,luckysheet.flowdata),u.push({row:b[0].row,column:b[0].column}),i.push(v)}else if(0==b.length){if(isNaN(v)||""==v)return void luckysheet.conditionformat.infoDialog("条件值只能是数字或者单个单元格","");i.push(v)}}else if("date"==n){if(c="occurrenceDate",""==(v=$("#luckysheet-newConditionRule-dialog #daterange-btn").val())||null==v)return void luckysheet.conditionformat.infoDialog("请选择日期","");i.push(v)}}else if(2==s){"top"==n?c=$("#luckysheet-newConditionRule-dialog #isPercent").is(":selected")?"top10%":"top10":"last"==n&&(c=$("#luckysheet-newConditionRule-dialog #isPercent").is(":selected")?"last10%":"last10");v=$("#luckysheet-newConditionRule-dialog #conditionVal input").val().trim();if(parseInt(v)!=v||parseInt(v)<1||1e3<parseInt(v))return void luckysheet.conditionformat.infoDialog("请输入一个介于 1 和 1000 之间的整数","");i.push(v)}else 3==s?"AboveAverage"==n?(c="AboveAverage",i.push("AboveAverage")):"SubAverage"==n&&(c="SubAverage",i.push("SubAverage")):4==s&&(c="duplicateValue",i.push(n));a={textColor:$("#luckysheet-newConditionRule-dialog #checkTextColor").is(":checked")?$("#luckysheet-newConditionRule-dialog #textcolorshow").spectrum("get").toHexString():null,cellColor:$("#luckysheet-newConditionRule-dialog #checkCellColor").is(":checked")?$("#luckysheet-newConditionRule-dialog #cellcolorshow").spectrum("get").toHexString():null};var _={type:"default",cellrange:$.extend(!0,[],luckysheet_select_save),format:a,conditionName:c,conditionRange:u,conditionValue:i}}$("#luckysheet-newConditionRule-dialog").hide();var w,x,C,T,I,R=$(this).attr("data-source");0==R?($("#luckysheet-modal-dialog-mask").hide(),w=$.extend(!0,[],luckysheet.getluckysheetfile()),x=luckysheet.conditionformat.getHistoryRules(w),(I=null==luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_conditionformat_save?[]:luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_conditionformat_save).push(_),luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_conditionformat_save=I,C=$.extend(!0,[],luckysheet.getluckysheetfile()),T=luckysheet.conditionformat.getCurrentRules(C),luckysheet.conditionformat.ref(x,T),luckysheet.server.allowUpdate&&luckysheet.server.saveParam("all",luckysheet.currentSheetIndex,I,{k:"luckysheet_conditionformat_save"})):1==R&&((I=luckysheet.conditionformat.fileClone[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_conditionformat_save?luckysheet.conditionformat.fileClone[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_conditionformat_save:[]).push(_),luckysheet.conditionformat.fileClone[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_conditionformat_save=I,luckysheet.conditionformat.administerRuleDialog())}),$(document).off("click.CFnewConditionRuleClose").on("click.CFnewConditionRuleClose","#luckysheet-newConditionRule-dialog-close",function(){var e=$(this).attr("data-source");0==e&&$("#luckysheet-modal-dialog-mask").hide(),1==e&&$("#luckysheet-administerRule-dialog").show(),$("#luckysheet-newConditionRule-dialog").hide(),$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide()}),$(document).off("click.CFeditorConditionRule").on("click.CFeditorConditionRule","#editorConditionRule",function(){var e=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val(),t=$("#luckysheet-administerRule-dialog .ruleList .listBox .item.on").attr("data-item"),l={sheetIndex:e,itemIndex:t,data:luckysheet.conditionformat.fileClone[luckysheet.sheetmanage.getSheetIndex(e)].luckysheet_conditionformat_save[t]};luckysheet.conditionformat.editorRule=l,luckysheet.conditionformat.editorConditionRuleDialog()}),$(document).off("click.CFeditorConditionRuleConfirm").on("click.CFeditorConditionRuleConfirm","#luckysheet-editorConditionRule-dialog-confirm",function(){var e,t,l,r,a,s=$("#luckysheet-editorConditionRule-dialog .ruleTypeItem.on").index(),n=$("#luckysheet-editorConditionRule-dialog #type1 option:selected").val(),o=$("#luckysheet-editorConditionRule-dialog ."+n+"Box #type2 option:selected").val(),c=luckysheet.conditionformat.editorRule.data.cellrange;if(0==s){"dataBar"==n?(e=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".dataBarBox .luckysheet-conditionformat-config-color").spectrum("get").toHexString(),"gradient"==o?a=[e,"#ffffff"]:"solid"==o&&(a=[e]),w={type:"dataBar",cellrange:c,format:a}):"colorGradation"==n?(t=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".colorGradationBox .maxVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString(),l=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".colorGradationBox .midVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString(),r=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".colorGradationBox .minVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString(),"threeColor"==o?a=[t,l,r]:"twoColor"==o&&(a=[t,r]),w={type:"colorGradation",cellrange:c,format:a}):"icons"==n&&(w={type:"icons",cellrange:c,format:a={len:$(this).parents("#luckysheet-editorConditionRule-dialog").find(".iconsBox .model").attr("data-len"),leftMin:$(this).parents("#luckysheet-editorConditionRule-dialog").find(".iconsBox .model").attr("data-leftmin"),top:$(this).parents("#luckysheet-editorConditionRule-dialog").find(".iconsBox .model").attr("data-top")}})}else{var u="",i=[],h=[];if(1==s){if("number"==n)if("betweenness"==(u=o)){var d=$("#luckysheet-editorConditionRule-dialog #conditionVal input").val().trim(),y=$("#luckysheet-editorConditionRule-dialog #conditionVal2 input").val().trim(),f=luckysheet.conditionformat.getRangeByTxt(d);if(1<f.length)return void luckysheet.conditionformat.infoDialog("只能对单个单元格进行引用","");if(1==f.length){var m=f[0].row[0],k=f[0].row[1],p=f[0].column[0],g=f[0].column[1];if(m!=k||p!=g)return void luckysheet.conditionformat.infoDialog("只能对单个单元格进行引用","");d=luckysheet.getcellvalue(m,p,luckysheet.flowdata),i.push({row:f[0].row,column:f[0].column}),h.push(d)}else if(0==f.length){if(isNaN(d)||""==d)return void luckysheet.conditionformat.infoDialog("条件值只能是数字或者单个单元格","");h.push(d)}var v=luckysheet.conditionformat.getRangeByTxt(y);if(1<v.length)return void luckysheet.conditionformat.infoDialog("只能对单个单元格进行引用","");if(1==v.length){m=v[0].row[0],k=v[0].row[1],p=v[0].column[0],g=v[0].column[1];if(m!=k||p!=g)return void luckysheet.conditionformat.infoDialog("只能对单个单元格进行引用","");y=luckysheet.getcellvalue(m,p,luckysheet.flowdata),i.push({row:v[0].row,column:v[0].column}),h.push(y)}else if(0==v.length){if(isNaN(y)||""==y)return void luckysheet.conditionformat.infoDialog("条件值只能是数字或者单个单元格","");h.push(y)}}else{var b=$("#luckysheet-editorConditionRule-dialog #conditionVal input").val().trim();if(1<(_=luckysheet.conditionformat.getRangeByTxt(b)).length)return void luckysheet.conditionformat.infoDialog("只能对单个单元格进行引用","");if(1==_.length){m=_[0].row[0],k=_[0].row[1],p=_[0].column[0],g=_[0].column[1];if(m!=k||p!=g)return void luckysheet.conditionformat.infoDialog("只能对单个单元格进行引用","");b=luckysheet.getcellvalue(m,p,luckysheet.flowdata),i.push({row:_[0].row,column:_[0].column}),h.push(b)}else if(0==_.length){if(isNaN(b)||""==b)return void luckysheet.conditionformat.infoDialog("条件值只能是数字或者单个单元格","");h.push(b)}}else if("text"==n){u="textContains";var _,b=$("#luckysheet-editorConditionRule-dialog #conditionVal input").val().trim();if(1<(_=luckysheet.conditionformat.getRangeByTxt(b)).length)return void luckysheet.conditionformat.infoDialog("只能对单个单元格进行引用","");if(1==_.length){m=_[0].row[0],k=_[0].row[1],p=_[0].column[0],g=_[0].column[1];if(m!=k||p!=g)return void luckysheet.conditionformat.infoDialog("只能对单个单元格进行引用","");b=luckysheet.getcellvalue(m,p,luckysheet.flowdata),i.push({row:_[0].row,column:_[0].column}),h.push(b)}else if(0==_.length){if(isNaN(b)||""==b)return void luckysheet.conditionformat.infoDialog("条件值只能是数字或者单个单元格","");h.push(b)}}else if("date"==n){if(u="occurrenceDate",""==(b=$("#luckysheet-editorConditionRule-dialog #daterange-btn").val())||null==b)return void luckysheet.conditionformat.infoDialog("请选择日期","");h.push(b)}}else if(2==s){"top"==n?u=$("#luckysheet-editorConditionRule-dialog #isPercent").is(":selected")?"top10%":"top10":"last"==n&&(u=$("#luckysheet-editorConditionRule-dialog #isPercent").is(":selected")?"last10%":"last10");b=$("#luckysheet-editorConditionRule-dialog #conditionVal input").val().trim();if(parseInt(b)!=b||parseInt(b)<1||1e3<parseInt(b))return void luckysheet.conditionformat.infoDialog("请输入一个介于 1 和 1000 之间的整数","");h.push(b)}else 3==s?"AboveAverage"==n?(u="AboveAverage",h.push("AboveAverage")):"SubAverage"==n&&(u="SubAverage",h.push("SubAverage")):4==s&&(u="duplicateValue",h.push(n));var w={type:"default",cellrange:c,format:a={textColor:$("#luckysheet-editorConditionRule-dialog #checkTextColor").is(":checked")?$("#luckysheet-editorConditionRule-dialog #textcolorshow").spectrum("get").toHexString():null,cellColor:$("#luckysheet-editorConditionRule-dialog #checkCellColor").is(":checked")?$("#luckysheet-editorConditionRule-dialog #cellcolorshow").spectrum("get").toHexString():null},conditionName:u,conditionRange:i,conditionValue:h}}var x=luckysheet.conditionformat.editorRule.sheetIndex,C=luckysheet.conditionformat.editorRule.itemIndex;luckysheet.conditionformat.fileClone[luckysheet.sheetmanage.getSheetIndex(x)].luckysheet_conditionformat_save[C]=w,$("#luckysheet-editorConditionRule-dialog").hide(),luckysheet.conditionformat.administerRuleDialog()}),$(document).off("click.CFeditorConditionRuleClose").on("click.CFeditorConditionRuleClose","#luckysheet-editorConditionRule-dialog-close",function(){$("#luckysheet-editorConditionRule-dialog").hide(),$("#luckysheet-administerRule-dialog").show(),$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide()}),$(document).off("click.CFnewEditorRuleItem").on("click.CFnewEditorRuleItem",".luckysheet-newEditorRule-dialog .ruleTypeItem",function(){$(this).addClass("on").siblings().removeClass("on");var e=$(this).index();$(this).parents(".luckysheet-newEditorRule-dialog").find(".ruleExplainBox").html(luckysheet.conditionformat.getRuleExplain(e)),luckysheet.conditionformat.colorSelectInit()}),$(document).off("change.CFnewEditorRuleType1").on("change.CFnewEditorRuleType1",".luckysheet-newEditorRule-dialog #type1",function(){var e=$(this).find("option:selected").val();"dataBar"!=e&&"colorGradation"!=e&&"icons"!=e&&"number"!=e&&"text"!=e&&"date"!=e||$(this).parents(".luckysheet-newEditorRule-dialog").find("."+e+"Box").show().siblings().hide(),"date"==e&&luckysheet.conditionformat.daterangeInit($(this).parents(".luckysheet-newEditorRule-dialog").attr("id"))}),$(document).off("change.CFnewEditorRuleType2").on("change.CFnewEditorRuleType2",".luckysheet-newEditorRule-dialog #type2",function(){var e=$(this).parents(".luckysheet-newEditorRule-dialog").find("#type1 option:selected").val();"colorGradation"==e?"threeColor"==$(this).find("option:selected").val()?$(this).parents(".luckysheet-newEditorRule-dialog").find(".midVal").show():$(this).parents(".luckysheet-newEditorRule-dialog").find(".midVal").hide():"number"==e&&("betweenness"==$(this).find("option:selected").val()?($(this).parents(".luckysheet-newEditorRule-dialog").find(".txt").show(),$(this).parents(".luckysheet-newEditorRule-dialog").find("#conditionVal2").show()):($(this).parents(".luckysheet-newEditorRule-dialog").find(".txt").hide(),$(this).parents(".luckysheet-newEditorRule-dialog").find("#conditionVal2").hide()))}),$(document).off("click.CFiconsShowbox").on("click.CFiconsShowbox",".luckysheet-newEditorRule-dialog .iconsBox .showbox",function(){$(this).parents(".iconsBox").find("ul").toggle()}),$(document).off("click.CFiconsLi").on("click.CFiconsLi",".luckysheet-newEditorRule-dialog .iconsBox li",function(){var e=$(this).find("div").attr("data-len"),t=$(this).find("div").attr("data-leftmin"),l=$(this).find("div").attr("data-top"),r=$(this).find("div").attr("title"),a=$(this).find("div").css("background-position");$(this).parents(".iconsBox").find(".showbox .model").css("background-position",a),$(this).parents(".iconsBox").find(".showbox .model").attr("data-len",e),$(this).parents(".iconsBox").find(".showbox .model").attr("data-leftmin",t),$(this).parents(".iconsBox").find(".showbox .model").attr("data-top",l),$(this).parents(".iconsBox").find(".showbox .model").attr("title",r),$(this).parents("ul").hide()}),$(document).off("click.CFdeleteConditionRule").on("click.CFdeleteConditionRule","#deleteConditionRule",function(){var e=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val(),t=$("#luckysheet-administerRule-dialog .ruleList .listBox .item.on").attr("data-item");luckysheet.conditionformat.fileClone[luckysheet.sheetmanage.getSheetIndex(e)].luckysheet_conditionformat_save.splice(t,1),luckysheet.conditionformat.administerRuleDialog()}),$(document).off("click.CFdefault").on("click.CFdefault","#luckysheet-conditionformat-dialog-confirm",function(){var e,t,l=$("#luckysheet-conditionformat-dialog .box").attr("data-itemvalue"),r=[],a=[];if("greaterThan"==l||"lessThan"==l||"equal"==l||"textContains"==l){var s=$("#luckysheet-conditionformat-dialog #conditionVal").val().trim(),n=luckysheet.conditionformat.getRangeByTxt(s);if(1<n.length)return void luckysheet.conditionformat.infoDialog("只能对单个单元格进行引用","");if(1==n.length){var o=n[0].row[0],c=n[0].row[1],u=n[0].column[0],i=n[0].column[1];if(o!=c||u!=i)return void luckysheet.conditionformat.infoDialog("只能对单个单元格进行引用","");s=luckysheet.getcellvalue(o,u,luckysheet.flowdata),r.push({row:n[0].row,column:n[0].column}),a.push(s)}else if(0==n.length){if(isNaN(s)||""==s)return void luckysheet.conditionformat.infoDialog("条件值只能是数字或者单个单元格","");a.push(s)}}else if("betweenness"==l){var h=$("#luckysheet-conditionformat-dialog #conditionVal").val().trim(),d=$("#luckysheet-conditionformat-dialog #conditionVal2").val().trim(),y=luckysheet.conditionformat.getRangeByTxt(h);if(1<y.length)return void luckysheet.conditionformat.infoDialog("只能对单个单元格进行引用","");if(1==y.length){o=y[0].row[0],c=y[0].row[1],u=y[0].column[0],i=y[0].column[1];if(o!=c||u!=i)return void luckysheet.conditionformat.infoDialog("只能对单个单元格进行引用","");h=luckysheet.getcellvalue(o,u,luckysheet.flowdata),r.push({row:y[0].row,column:y[0].column}),a.push(h)}else if(0==y.length){if(isNaN(h)||""==h)return void luckysheet.conditionformat.infoDialog("条件值只能是数字或者单个单元格","");a.push(h)}var f=luckysheet.conditionformat.getRangeByTxt(d);if(1<f.length)return void luckysheet.conditionformat.infoDialog("只能对单个单元格进行引用","");if(1==f.length){o=f[0].row[0],c=f[0].row[1],u=f[0].column[0],i=f[0].column[1];if(o!=c||u!=i)return void luckysheet.conditionformat.infoDialog("只能对单个单元格进行引用","");d=luckysheet.getcellvalue(o,u,luckysheet.flowdata),r.push({row:f[0].row,column:f[0].column}),a.push(d)}else if(0==f.length){if(isNaN(d)||""==d)return void luckysheet.conditionformat.infoDialog("条件值只能是数字或者单个单元格","");a.push(d)}}else if("occurrenceDate"==l){if(""==(s=$("#luckysheet-conditionformat-dialog #daterange-btn").val())||null==s)return void luckysheet.conditionformat.infoDialog("请选择日期","");a.push(s)}else if("duplicateValue"==l)a.push($("#luckysheet-conditionformat-dialog #conditionVal option:selected").val());else if("top10"==l||"top10%"==l||"last10"==l||"last10%"==l){s=$("#luckysheet-conditionformat-dialog #conditionVal").val().trim();if(parseInt(s)!=s||parseInt(s)<1||1e3<parseInt(s))return void luckysheet.conditionformat.infoDialog("请输入一个介于 1 和 1000 之间的整数","");a.push(s)}else"AboveAverage"==l?a.push("AboveAverage"):"SubAverage"==l&&a.push("SubAverage");e=$("#checkTextColor").is(":checked")?$("#textcolorshow").spectrum("get").toHexString():null,t=$("#checkCellColor").is(":checked")?$("#cellcolorshow").spectrum("get").toHexString():null;var m=$.extend(!0,[],luckysheet.getluckysheetfile()),k=luckysheet.conditionformat.getHistoryRules(m),p={type:"default",cellrange:$.extend(!0,[],luckysheet_select_save),format:{textColor:e,cellColor:t},conditionName:l,conditionRange:r,conditionValue:a},g=null==luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_conditionformat_save?[]:luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_conditionformat_save;g.push(p),luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_conditionformat_save=g;var v=$.extend(!0,[],luckysheet.getluckysheetfile()),b=luckysheet.conditionformat.getCurrentRules(v);luckysheet.conditionformat.ref(k,b),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-conditionformat-dialog").hide(),luckysheet.server.allowUpdate&&luckysheet.server.saveParam("all",luckysheet.currentSheetIndex,g,{k:"luckysheet_conditionformat_save"})}),$(document).off("click.CFicons").on("click.CFicons","#luckysheet-CFicons-dialog .item",function(){var e,t;$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-CFicons-dialog").hide(),0<luckysheet_select_save.length&&(e=$.extend(!0,[],luckysheet_select_save),t={len:$(this).attr("data-len"),leftMin:$(this).attr("data-leftMin"),top:$(this).attr("data-top")},luckysheet.conditionformat.updateItem("icons",e,t))}),$(document).on("click",".range .fa-table",function(){var e,t=$(this).parents(".luckysheet-modal-dialog").attr("id");$("#"+t).hide(),"luckysheet-conditionformat-dialog"==t?e="conditionVal"==$(this).siblings("input").attr("id")?"0_1":"0_2":"luckysheet-newConditionRule-dialog"==t?e="conditionVal"==$(this).parents(".range").attr("id")?"1_1":"1_2":"luckysheet-editorConditionRule-dialog"==t&&(e="conditionVal"==$(this).parents(".range").attr("id")?"2_1":"2_2");var l=$(this).siblings("input").val();luckysheet.conditionformat.singleRangeDialog(e,l),luckysheet.selectionCopyShow(luckysheet.conditionformat.getRangeByTxt(l))}),$(document).on("click","#luckysheet-singleRange-dialog-confirm",function(){$("#luckysheet-modal-dialog-mask").show(),$(this).parents("#luckysheet-singleRange-dialog").hide();var e=$(this).attr("data-source"),t=$(this).parents("#luckysheet-singleRange-dialog").find("input").val();"0_1"==e?($("#luckysheet-conditionformat-dialog").show(),$("#luckysheet-conditionformat-dialog #conditionVal").val(t)):"0_2"==e?($("#luckysheet-conditionformat-dialog").show(),$("#luckysheet-conditionformat-dialog #conditionVal2").val(t)):"1_1"==e?($("#luckysheet-newConditionRule-dialog").show(),$("#luckysheet-newConditionRule-dialog #conditionVal input").val(t)):"1_2"==e?($("#luckysheet-newConditionRule-dialog").show(),$("#luckysheet-newConditionRule-dialog #conditionVal2 input").val(t)):"2_1"==e?($("#luckysheet-editorConditionRule-dialog").show(),$("#luckysheet-editorConditionRule-dialog #conditionVal input").val(t)):"2_2"==e&&($("#luckysheet-editorConditionRule-dialog").show(),$("#luckysheet-editorConditionRule-dialog #conditionVal2 input").val(t));luckysheet.selectionCopyShow([])}),$(document).on("click","#luckysheet-singleRange-dialog-close",function(){$("#luckysheet-modal-dialog-mask").show(),$(this).parents("#luckysheet-singleRange-dialog").hide();var e=$(this).attr("data-source");"0_1"==e||"0_2"==e?$("#luckysheet-conditionformat-dialog").show():"1_1"==e||"1_2"==e?$("#luckysheet-newConditionRule-dialog").show():"2_1"!=e&&"2_2"!=e||$("#luckysheet-editorConditionRule-dialog").show();luckysheet.selectionCopyShow([])}),$(document).on("click",".luckysheet-modal-dialog-title-close",function(){var e,t,l=$(this).parents(".luckysheet-modal-dialog").attr("id");"luckysheet-newConditionRule-dialog"==l&&1==(e=$("#"+l).find("#luckysheet-newConditionRule-dialog-close").attr("data-source"))&&$("#luckysheet-administerRule-dialog").show(),"luckysheet-editorConditionRule-dialog"==l&&$("#luckysheet-administerRule-dialog").show(),"luckysheet-singleRange-dialog"==l&&($("#luckysheet-modal-dialog-mask").show(),"0_1"==(e=$(this).parents("#luckysheet-singleRange-dialog").find("#luckysheet-singleRange-dialog-confirm").attr("data-source"))||"0_2"==e?$("#luckysheet-conditionformat-dialog").show():"1_1"==e||"1_2"==e?$("#luckysheet-newConditionRule-dialog").show():"2_1"!=e&&"2_2"!=e||$("#luckysheet-editorConditionRule-dialog").show(),t=[],luckysheet.selectionCopyShow(t)),"luckysheet-multiRange-dialog"==l&&($("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").show(),t=[],luckysheet.selectionCopyShow(t)),"luckysheet-conditionformat-info-dialog"==l&&$("#luckysheet-modal-dialog-mask").show()}),$(document).on("click","#luckysheet-conditionformat-info-dialog-close",function(){$(this).parents("#luckysheet-conditionformat-info-dialog").hide()})},singleRangeDialog:function(e,t){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-singleRange-dialog").remove(),$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-singleRange-dialog",addclass:"luckysheet-singleRange-dialog",title:"选择单元格",content:'<input readonly="readonly" placeholder="请选择单元格" value="'+t+'"/>',botton:'<button id="luckysheet-singleRange-dialog-confirm" class="btn btn-primary" data-source="'+e+'">确定</button><button id="luckysheet-singleRange-dialog-close" class="btn btn-default" data-source="'+e+'">取消</button>',style:"z-index:100003"}));var l=$("#luckysheet-singleRange-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),r=l.outerHeight(),a=l.outerWidth(),s=$(window).width(),n=$(window).height(),o=$(document).scrollLeft(),c=$(document).scrollTop();$("#luckysheet-singleRange-dialog").css({left:(s+o-a)/2,top:(n+c-r)/3}).show()},multiRangeDialog:function(e,t){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-multiRange-dialog").remove(),$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-multiRange-dialog",addclass:"luckysheet-multiRange-dialog",title:"选择应用范围",content:'<input readonly="readonly" placeholder="请选择应用范围" value="'+t+'"/>',botton:'<button id="luckysheet-multiRange-dialog-confirm" class="btn btn-primary" data-item="'+e+'">确定</button><button id="luckysheet-multiRange-dialog-close" class="btn btn-default">取消</button>',style:"z-index:100003"}));var l=$("#luckysheet-multiRange-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),r=l.outerHeight(),a=l.outerWidth(),s=$(window).width(),n=$(window).height(),o=$(document).scrollLeft(),c=$(document).scrollTop();$("#luckysheet-multiRange-dialog").css({left:(s+o-a)/2,top:(n+c-r)/3}).show(),luckysheet.selectionCopyShow(luckysheet.conditionformat.getRangeByTxt(t))},getTxtByRange:function(e){if(0<e.length){for(var t=[],l=0;l<e.length;l++){var r=e[l].row[0],a=e[l].row[1],s=e[l].column[0],n=e[l].column[1];t.push(luckysheet.sheetmanage.getRangetxt(luckysheet.currentSheetIndex,{row:[r,a],column:[s,n]},luckysheet.currentSheetIndex))}return t.join(",")}},getRangeByTxt:function(e){var t=[];if(-1!=e.indexOf(","))for(var l=e.split(","),r=0;r<l.length;r++){if(!luckysheet.formula.iscelldata(l[r])){t=[];break}t.push(luckysheet.formula.getcellrange(l[r]))}else luckysheet.formula.iscelldata(e)&&t.push(luckysheet.formula.getcellrange(e));return t},colorSelectInit:function(){$(".luckysheet-conditionformat-config-color").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,maxPaletteSize:8,maxSelectionSize:8,cancelText:"取消",chooseText:"确定颜色",togglePaletteMoreText:"自定义",togglePaletteLessText:"收起",togglePaletteOnly:!0,clearText:"清除颜色选择",noColorSelectedText:"没有颜色被选择",localStorageKey:"spectrum.textcolor"+luckysheet.server.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(e){null!=e&&(e=e.toHexString())}})},conditionformatDialog:function(e,t){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-conditionformat-dialog").remove(),$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-conditionformat-dialog",addclass:"luckysheet-conditionformat-dialog",title:e,content:t,botton:'<button id="luckysheet-conditionformat-dialog-confirm" class="btn btn-primary">确定</button><button class="btn btn-default luckysheet-model-close-btn">取消</button>',style:"z-index:100003"}));var l=$("#luckysheet-conditionformat-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),r=l.outerHeight(),a=l.outerWidth(),s=$(window).width(),n=$(window).height(),o=$(document).scrollLeft(),c=$(document).scrollTop();$("#luckysheet-conditionformat-dialog").css({left:(s+o-a)/2,top:(n+c-r)/3}).show(),luckysheet.conditionformat.init(),luckysheet.conditionformat.colorSelectInit(),"条件格式——发生日期"==e&&luckysheet.conditionformat.daterangeInit("luckysheet-conditionformat-dialog")},CFiconsDialog:function(){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-CFicons-dialog").remove();$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-CFicons-dialog",addclass:"luckysheet-CFicons-dialog",title:"图标集",content:'<div class="box"><div style="margin-bottom: 10px;">请点击选择一组图标：</div><div class="title">方向</div><div class="list"><div class="left"><div class="item" data-len="3" data-leftMin="0" data-top="0" title="三向箭头(彩色)"><div style="background-position:0 0;"></div></div><div class="item" data-len="3" data-leftMin="0" data-top="1" title="3个三角形"><div style="background-position:0 -20px;"></div></div><div class="item" data-len="4" data-leftMin="0" data-top="2" title="四向箭头(彩色)"><div style="background-position:0 -40px;"></div></div><div class="item" data-len="5" data-leftMin="0" data-top="3" title="五向箭头(彩色)"><div style="background-position:0 -60px;"></div></div></div><div class="right"><div class="item" data-len="3" data-leftMin="5" data-top="0" title="三向箭头(灰色)"><div style="background-position:-131px 0;"></div></div><div class="item" data-len="4" data-leftMin="5" data-top="1" title="四向箭头(灰色)"><div style="background-position:-131px -20px;"></div></div><div class="item" data-len="5" data-leftMin="5" data-top="2" title="五向箭头(灰色)"><div style="background-position:-131px -40px;"></div></div></div><div style="clear:both;"></div></div><div class="title">形状</div><div class="list"><div class="left"><div class="item" data-len="3" data-leftMin="0" data-top="4" title="三色交通灯(无边框)"><div style="background-position:0 -80px;"></div></div><div class="item" data-len="3" data-leftMin="0" data-top="5" title="三标志"><div style="background-position:0 -100px;"></div></div><div class="item" data-len="4" data-leftMin="0" data-top="6" title="绿-红-黑渐变"><div style="background-position:0 -120px;"></div></div></div><div class="right"><div class="item" data-len="3" data-leftMin="5" data-top="4" title="三色交通灯(有边框)"><div style="background-position:-131px -80px;"></div></div><div class="item" data-len="4" data-leftMin="5" data-top="5" title="四色交通灯"><div style="background-position:-131px -100px;"></div></div></div><div style="clear:both;"></div></div><div class="title">标记</div><div class="list"><div class="left"><div class="item" data-len="3" data-leftMin="0" data-top="7" title="三个符号(有圆圈)"><div style="background-position:0 -140px;"></div></div><div class="item" data-len="3" data-leftMin="0" data-top="8" title="三色旗"><div style="background-position:0 -160px;"></div></div></div><div class="right"><div class="item" data-len="3" data-leftMin="5" data-top="7" title="三个符号(无圆圈)"><div style="background-position:-131px -140px;"></div></div></div><div style="clear:both;"></div></div><div class="title">等级</div><div class="list"><div class="left"><div class="item" data-len="3" data-leftMin="0" data-top="9" title="3个星形"><div style="background-position:0 -180px;"></div></div><div class="item" data-len="5" data-leftMin="0" data-top="10" title="五象限图"><div style="background-position:0 -200px;"></div></div><div class="item" data-len="5" data-leftMin="0" data-top="11" title="5个框"><div style="background-position:0 -220px;"></div></div></div><div class="right"><div class="item" data-len="4" data-leftMin="5" data-top="9" title="四等级"><div style="background-position:-131px -180px;"></div></div><div class="item" data-len="5" data-leftMin="5" data-top="10" title="五等级"><div style="background-position:-131px -200px;"></div></div></div><div style="clear:both;"></div></div></div>',botton:'<button class="btn btn-default luckysheet-model-close-btn">关闭</button>',style:"z-index:100003"}));var e=$("#luckysheet-CFicons-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),t=e.outerHeight(),l=e.outerWidth(),r=$(window).width(),a=$(window).height(),s=$(document).scrollLeft(),n=$(document).scrollTop();$("#luckysheet-CFicons-dialog").css({left:(r+s-l)/2,top:(a+n-t)/3}).show()},administerRuleDialog:function(){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").remove();for(var e="",t=0;t<luckysheetfile.length;t++)"1"==luckysheetfile[t].status?e+='<option value="'+luckysheetfile[t].index+'" selected="selected">当前工作表：'+luckysheetfile[t].name+"</option>":e+='<option value="'+luckysheetfile[t].index+'">表：'+luckysheetfile[t].name+"</option>";var l='<div class="chooseSheet"><label>显示其格式规则：</label><select>'+e+'</select></div><div class="ruleBox"><div class="ruleBtn"><button id="newConditionRule" class="btn btn-default">新建规则</button><button id="editorConditionRule" class="btn btn-default">编辑规则</button><button id="deleteConditionRule" class="btn btn-default">删除规则</button></div><div class="ruleList"><div class="listTitle"><span>规则</span><span>格式</span><span>应用范围</span></div><div class="listBox"></div></div></div>';$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-administerRule-dialog",addclass:"luckysheet-administerRule-dialog",title:"条件格式规则管理器",content:l,botton:'<button id="luckysheet-administerRule-dialog-confirm" class="btn btn-primary">确定</button><button id="luckysheet-administerRule-dialog-close" class="btn btn-default">关闭</button>',style:"z-index:100003"}));var r=$("#luckysheet-administerRule-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),a=r.outerHeight(),s=r.outerWidth(),n=$(window).width(),o=$(window).height(),c=$(document).scrollLeft(),u=$(document).scrollTop();$("#luckysheet-administerRule-dialog").css({left:(n+c-s)/2,top:(o+u-a)/3}).show();var i=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val();luckysheet.conditionformat.getConditionRuleList(i)},getConditionRuleList:function(e){$("#luckysheet-administerRule-dialog .ruleList .listBox").empty();var h=luckysheet.conditionformat.fileClone[luckysheet.sheetmanage.getSheetIndex(e)].luckysheet_conditionformat_save;if(null!=h&&0<h.length){for(var t=0;t<h.length;t++){var l,r=h[t].type,a=h[t].format,s=h[t].cellrange,n="";"dataBar"==r?(l="数据条",n='<canvas width="46" height="18" style="width: 46px;height: 18px;margin: 3px 0 0 5px;"></canvas>'):"colorGradation"==r?(l="色阶",n='<canvas width="46" height="18" style="width: 46px;height: 18px;margin: 3px 0 0 5px;"></canvas>'):"icons"==r?(l="图标集",n='<canvas width="46" height="18" style="width: 46px;height: 18px;margin: 3px 0 0 5px;"></canvas>'):(l=luckysheet.conditionformat.getConditionRuleName(h[t].conditionName,h[t].conditionRange,h[t].conditionValue),null!=a.textColor&&(n+='<span class="colorbox" title="文本颜色" style="background-color:'+a.textColor+'"></span>'),null!=a.cellColor&&(n+='<span class="colorbox" title="单元格颜色" style="background-color:'+a.cellColor+'"></span>'));for(var o=[],c=0;c<s.length;c++){var u=s[c].row[0],i=s[c].row[1],d=s[c].column[0],y=s[c].column[1];o.push(luckysheet.luckysheetchatatABC(d)+(u+1)+":"+luckysheet.luckysheetchatatABC(y)+(i+1))}var f='<div class="item" data-item="'+t+'"><div class="ruleName" title="'+l+'">'+l+'</div><div class="format">'+n+'</div><div class="ruleRange"><input class="formulaInputFocus" readonly="true" value="'+o.join(",")+'"/><i class="fa fa-table" aria-hidden="true" title="点击选择应用范围"></i></div></div>';$("#luckysheet-administerRule-dialog .ruleList .listBox").prepend(f)}$("#luckysheet-administerRule-dialog .ruleList .listBox .item canvas").each(function(e){var t,l,r,a,s,n,o=$(this).closest(".item").attr("data-item"),c=h[o].type,u=h[o].format,i=$(this).get(0).getContext("2d");"dataBar"==c?2==u.length?((t=i.createLinearGradient(0,0,46,0)).addColorStop(0,u[0]),t.addColorStop(1,u[1]),i.fillStyle=t,i.fillRect(0,0,46,18),i.beginPath(),i.moveTo(0,0),i.lineTo(0,18),i.lineTo(46,18),i.lineTo(46,0),i.lineTo(0,0),i.lineWidth=devicePixelRatio,i.strokeStyle=u[0],i.stroke(),i.closePath()):1==u.length&&(i.fillStyle=u[0],i.fillRect(0,0,46,18),i.beginPath(),i.moveTo(0,0),i.lineTo(0,18),i.lineTo(46,18),i.lineTo(46,0),i.lineTo(0,0),i.lineWidth=devicePixelRatio,i.strokeStyle=u[0],i.stroke(),i.closePath()):"colorGradation"==c?(t=i.createLinearGradient(0,0,46,0),3==u.length?(t.addColorStop(0,u[0]),t.addColorStop(.5,u[1]),t.addColorStop(1,u[2])):2==u.length&&(t.addColorStop(0,u[0]),t.addColorStop(1,u[1])),i.fillStyle=t,i.fillRect(0,0,46,18)):"icons"==c&&(l=u.len,r=u.leftMin,a=u.top,n=1472/(s=32*l+10*(l-1)),"0"==r?i.drawImage(luckysheet_CFiconsImg,0,32*a,s,32,0,(18-n)/2,46,n):"5"==r&&i.drawImage(luckysheet_CFiconsImg,210,32*a,s,32,0,(18-n)/2,46,n))}),$("#luckysheet-administerRule-dialog .ruleList .listBox .item").eq(0).addClass("on")}},getConditionRuleName:function(e,t,l){var r;if(r=null!=t[0]?luckysheet.luckysheetchatatABC(t[0].column[0])+(t[0].row[0]+1):l[0],"greaterThan"==e)return"单元格值 > "+r;if("lessThan"==e)return"单元格值 < "+r;if("betweenness"==e)return"单元格值介于 "+r+" 和 "+(null!=t[1]?luckysheet.luckysheetchatatABC(t[1].column[0])+(t[1].row[0]+1):l[1])+" 之间";if("equal"==e)return"单元格值 = "+r;if("textContains"==e)return"单元格值包含 ="+r;if("occurrenceDate"==e)return l;if("duplicateValue"==e){if("0"==l)return"重复值";if("1"==l)return"唯一值"}else{if("top10"==e)return"前 "+r+" 个";if("top10%"==e)return"前 "+r+"% 个";if("last10"==e)return"后 "+r+" 个";if("last10%"==e)return"后 "+r+"% 个";if("AboveAverage"==e)return"高于平均值";if("SubAverage"==e)return"低于平均值"}},newConditionRuleDialog:function(e){var t=luckysheet.conditionformat.getRuleExplain(0);$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").hide(),$("#luckysheet-newConditionRule-dialog").remove();var l='<div><div class="boxTitle">选择规则类型：</div>'+luckysheet.conditionformat.ruleTypeHtml+'<div class="boxTitle">编辑规则说明：</div><div class="ruleExplainBox">'+t+"</div></div>";$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-newConditionRule-dialog",addclass:"luckysheet-newEditorRule-dialog",title:"新建格式规则",content:l,botton:'<button id="luckysheet-newConditionRule-dialog-confirm" class="btn btn-primary" data-source="'+e+'">确定</button><button id="luckysheet-newConditionRule-dialog-close" class="btn btn-default" data-source="'+e+'">取消</button>',style:"z-index:100003"}));var r=$("#luckysheet-newConditionRule-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),a=r.outerHeight(),s=r.outerWidth(),n=$(window).width(),o=$(window).height(),c=$(document).scrollLeft(),u=$(document).scrollTop();$("#luckysheet-newConditionRule-dialog").css({left:(n+c-s)/2,top:(o+u-a)/3}).show(),$("#luckysheet-newConditionRule-dialog .ruleTypeBox .ruleTypeItem:eq(0)").addClass("on").siblings().removeClass("on"),luckysheet.conditionformat.colorSelectInit()},editorConditionRuleDialog:function(){var e,t,l,r=luckysheet.conditionformat.editorRule.data,a=r.type,s=r.format;"dataBar"==a||"colorGradation"==a||"icons"==a?(e=0,t=a):"greaterThan"==(l=r.conditionName)||"lessThan"==l||"betweenness"==l||"equal"==l||"textContains"==l||"occurrenceDate"==l?(e=1,"greaterThan"==l||"lessThan"==l||"betweenness"==l||"equal"==l?t="number":"textContains"==l?t="text":"occurrenceDate"==l&&(t="date")):"top10"==l||"top10%"==l||"last10"==l||"last10%"==l?(e=2,"top10"==l||"top10%"==l?t="top":"last10"!=l&&"last10%"!=l||(t="last")):"AboveAverage"==l||"SubAverage"==l?(e=3,t=l):"duplicateValue"==l&&(e=4,t=r.conditionValue);var n=luckysheet.conditionformat.getRuleExplain(e);$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").hide(),$("#luckysheet-editorConditionRule-dialog").remove();var o='<div><div class="boxTitle">选择规则类型：</div>'+luckysheet.conditionformat.ruleTypeHtml+'<div class="boxTitle">编辑规则说明：</div><div class="ruleExplainBox">'+n+"</div></div>";$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-editorConditionRule-dialog",addclass:"luckysheet-newEditorRule-dialog",title:"编辑格式规则",content:o,botton:'<button id="luckysheet-editorConditionRule-dialog-confirm" class="btn btn-primary">确定</button><button id="luckysheet-editorConditionRule-dialog-close" class="btn btn-default">取消</button>',style:"z-index:100003"}));var c,u,i,h,d,y=$("#luckysheet-editorConditionRule-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),f=y.outerHeight(),m=y.outerWidth(),k=$(window).width(),p=$(window).height(),g=$(document).scrollLeft(),v=$(document).scrollTop();$("#luckysheet-editorConditionRule-dialog").css({left:(k+g-m)/2,top:(p+v-f)/3}).show(),luckysheet.conditionformat.colorSelectInit(),$("#luckysheet-editorConditionRule-dialog .ruleTypeBox .ruleTypeItem:eq("+e+")").addClass("on").siblings().removeClass("on"),$("#luckysheet-editorConditionRule-dialog #type1").val(t),"dataBar"!=t&&"colorGradation"!=t&&"icons"!=t&&"number"!=t&&"text"!=t&&"date"!=t||($("#luckysheet-editorConditionRule-dialog ."+t+"Box").show(),$("#luckysheet-editorConditionRule-dialog ."+t+"Box").siblings().hide()),"date"==t&&luckysheet.conditionformat.daterangeInit("luckysheet-editorConditionRule-dialog"),"dataBar"==a||"colorGradation"==a||"icons"==a?"dataBar"==t?(2==s.length?$("#luckysheet-editorConditionRule-dialog .dataBarBox #type2").val("gradient"):1==s.length&&$("#luckysheet-editorConditionRule-dialog .dataBarBox #type2").val("solid"),$("#luckysheet-editorConditionRule-dialog .dataBarBox .luckysheet-conditionformat-config-color").spectrum("set",s[0])):"colorGradation"==t?3==s.length?($("#luckysheet-editorConditionRule-dialog .colorGradationBox #type2").val("threeColor"),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .midVal").show(),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .maxVal .luckysheet-conditionformat-config-color").spectrum("set",s[0]),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .midVal .luckysheet-conditionformat-config-color").spectrum("set",s[1]),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .minVal .luckysheet-conditionformat-config-color").spectrum("set",s[2])):2==s.length&&($("#luckysheet-editorConditionRule-dialog .colorGradationBox #type2").val("twoColor"),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .midVal").hide(),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .maxVal .luckysheet-conditionformat-config-color").spectrum("set",s[0]),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .minVal .luckysheet-conditionformat-config-color").spectrum("set",s[1])):"icons"==t&&(c=s.len,u=s.leftMin,i=s.top,$("#luckysheet-editorConditionRule-dialog .iconsBox li").each(function(e,t){if($(t).find("div").attr("data-len")==c&&$(t).find("div").attr("data-leftmin")==u&&$(t).find("div").attr("data-top")==i)return $("#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model").css("background-position",$(t).find("div").css("background-position")),$("#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model").attr("data-len",$(t).find("div").attr("data-len")),$("#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model").attr("data-leftmin",$(t).find("div").attr("data-leftmin")),$("#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model").attr("data-top",$(t).find("div").attr("data-leftmin")),$("#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model").attr("title",$(t).find("div").attr("title")),!0})):"number"==t?($("#luckysheet-editorConditionRule-dialog .numberBox #type2").val(l),d=null!=r.conditionRange[0]?luckysheet.sheetmanage.getRangetxt(luckysheet.currentSheetIndex,{row:r.conditionRange[0].row,column:r.conditionRange[0].column},luckysheet.currentSheetIndex):r.conditionValue[0],$("#luckysheet-editorConditionRule-dialog .numberBox #conditionVal input").val(d),"betweenness"==l?($("#luckysheet-editorConditionRule-dialog .numberBox .txt").show(),$("#luckysheet-editorConditionRule-dialog .numberBox #conditionVal2").show(),h=null!=r.conditionRange[1]?luckysheet.sheetmanage.getRangetxt(luckysheet.currentSheetIndex,{row:r.conditionRange[1].row,column:r.conditionRange[1].column},luckysheet.currentSheetIndex):r.conditionValue[1],$("#luckysheet-editorConditionRule-dialog .numberBox #conditionVal2 input").val(h)):($("#luckysheet-editorConditionRule-dialog .numberBox .txt").hide(),$("#luckysheet-editorConditionRule-dialog .numberBox #conditionVal2").hide())):"text"==t?(d=null!=r.conditionRange[0]?luckysheet.sheetmanage.getRangetxt(luckysheet.currentSheetIndex,{row:r.conditionRange[0].row,column:r.conditionRange[0].column},luckysheet.currentSheetIndex):r.conditionValue[0],$("#luckysheet-editorConditionRule-dialog .textBox #conditionVal input").val(d)):"date"==t?(luckysheet.conditionformat.daterangeInit("luckysheet-editorConditionRule-dialog"),d=r.conditionValue[0],$("#luckysheet-editorConditionRule-dialog .dateBox #daterange-btn").val(d)):"top"!=t&&"last"!=t||(d=r.conditionValue[0],"top10%"!=l&&"last10%"!=l||$("#luckysheet-editorConditionRule-dialog #isPercent").attr("checked","checked"))},infoDialog:function(e,t){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-conditionformat-info-dialog").remove(),$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-conditionformat-info-dialog",addclass:"",title:e,content:t,botton:'<button id="luckysheet-conditionformat-info-dialog-close" class="btn btn-default">&nbsp;&nbsp;关闭&nbsp;&nbsp;</button>',style:"z-index:100003"}));var l=$("#luckysheet-conditionformat-info-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),r=l.outerHeight(),a=l.outerWidth(),s=$(window).width(),n=$(window).height(),o=$(document).scrollLeft(),c=$(document).scrollTop();$("#luckysheet-conditionformat-info-dialog").css({left:(s+o-a)/2,top:(n+c-r)/3}).show()},getRuleExplain:function(e){var t=luckysheet.conditionformat.textCellColorHtml;switch(e){case 0:var l='<div class="title">基于各自值设置所有单元格的格式：</div><div style="height: 30px;margin-bottom: 5px;"><label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">格式样式：</label><select id="type1"><option value="dataBar">数据条</option><option value="colorGradation">色阶</option><option value="icons">图标集</option></select></div><div><div class="type1Box dataBarBox"><div style="height: 30px;margin-bottom: 5px;"><label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">填充类型：</label><select id="type2"><option value="gradient">渐变</option><option value="solid">实心</option></select></div><div style="height: 30px;margin-bottom: 5px;"><label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">颜色：</label><input data-tips="数据条颜色" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="#638ec6" style="display: none;"></div></div><div class="type1Box colorGradationBox" style="display: none;"><div style="height: 30px;margin-bottom: 5px;"><label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">填充类型：</label><select id="type2"><option value="threeColor">三色</option><option value="twoColor">双色</option></select></div><div class="maxVal" style="height: 30px;margin-bottom: 5px;"><label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">最大值：</label><input data-tips="最大值颜色" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="rgb(99, 190, 123)" style="display: none;"></div><div class="midVal" style="height: 30px;margin-bottom: 5px;"><label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">中间值：</label><input data-tips="中间值颜色" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="rgb(255, 235, 132)" style="display: none;"></div><div class="minVal" style="height: 30px;margin-bottom: 5px;"><label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">最小值：</label><input data-tips="最小值颜色" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="rgb(248, 105, 107)" style="display: none;"></div></div><div class="type1Box iconsBox" style="display: none;"><label>填充类型：</label><div class="showbox"><div class="model" data-len="3" data-leftmin="0" data-top="0" title="三向箭头(彩色)" style="background-position: 0 0;"></div><span class="ui-selectmenu-icon ui-icon ui-icon-triangle-1-s" style="margin-top: 2px;"></span></div><ul><li><div data-len="3" data-leftmin="0" data-top="0" title="三向箭头(彩色)" style="background-position: 0 0;"></div></li><li><div data-len="3" data-leftmin="5" data-top="0" title="三向箭头(灰色)" style="background-position: -131px 0;"></div></li><li><div data-len="3" data-leftmin="0" data-top="1" title="3个三角形" style="background-position: 0 -20px;"></div></li><li><div data-len="4" data-leftmin="0" data-top="2" title="四向箭头(彩色)" style="background-position: 0 -40px;"></div></li><li><div data-len="4" data-leftmin="5" data-top="1" title="四向箭头(灰色)" style="background-position: -131px -20px;"></div></li><li><div data-len="5" data-leftmin="0" data-top="3" title="五向箭头(彩色)" style="background-position: 0 -60px;"></div></li><li><div data-len="5" data-leftmin="5" data-top="2" title="五向箭头(灰色)" style="background-position: -131px -40px;"></div></li><li><div data-len="3" data-leftmin="0" data-top="4" title="三色交通灯(无边框)" style="background-position: 0 -80px;"></div></li><li><div data-len="3" data-leftmin="5" data-top="4" title="三色交通灯(有边框)" style="background-position: -131px -80px;"></div></li><li><div data-len="3" data-leftmin="0" data-top="5" title="三标志" style="background-position: 0 -100px;"></div></li><li><div data-len="4" data-leftmin="5" data-top="5" title="四色交通灯" style="background-position: -131px -100px;"></div></li><li><div data-len="4" data-leftmin="0" data-top="6" title="绿-红-黑渐变" style="background-position: 0 -120px;"></div></li><li><div data-len="3" data-leftmin="0" data-top="7" title="三个符号(有圆圈)" style="background-position: 0 -140px;"></div></li><li><div data-len="3" data-leftmin="5" data-top="7" title="三个符号(无圆圈)" style="background-position: -131px -140px;"></div></li><li><div data-len="3" data-leftmin="0" data-top="8" title="三色旗" style="background-position: 0 -160px;"></div></li><li><div data-len="3" data-leftmin="0" data-top="9" title="3个星形" style="background-position: 0 -180px;"></div></li><li><div data-len="5" data-leftmin="0" data-top="10" title="五象限图" style="background-position: 0 -200px;"></div></li><li><div data-len="5" data-leftmin="0" data-top="11" title="5个框" style="background-position: 0 -220px;"></div></li><li><div data-len="4" data-leftmin="5" data-top="9" title="四等级" style="background-position: -131px -180px;"></div></li><li><div data-len="5" data-leftmin="5" data-top="10" title="五等级" style="background-position: -131px -200px;"></div></li></ul></div></div>';break;case 1:l='<div class="title">只为满足以下条件的单元格：</div><div style="height: 30px;margin-bottom: 10px;"><select id="type1"><option value="number">单元格值</option><option value="text">特定文本</option><option value="date">发生日期</option></select><div><div class="type1Box numberBox"><select id="type2"><option value="greaterThan">大于</option><option value="lessThan">小于</option><option value="betweenness">介于</option><option value="equal">等于</option></select><div class="inpbox range" id="conditionVal"><input class="formulaInputFocus"/><i class="fa fa-table" aria-hidden="true" title="点击选择单元格"></i></div><span class="txt" style="display: none;">到</span><div class="inpbox range" id="conditionVal2" style="display: none;"><input class="formulaInputFocus"/><i class="fa fa-table" aria-hidden="true" title="点击选择数据范围"></i></div></div><div class="type1Box textBox" style="display: none;"><select id="type2"><option value="">包含</option></select><div class="inpbox range" id="conditionVal"><input class="formulaInputFocus"/><i class="fa fa-table" aria-hidden="true" title="点击选择单元格"></i></div></div><div class="type1Box dateBox" style="display: none;"><div style="width: 162px;" class="inpbox"><input style="width: 150px;" id="daterange-btn" readonly="readonly" placeholder="请选择日期"/></div></div></div></div><div class="title">设置格式：</div>'+t;break;case 2:l='<div class="title">为以下排名内的值：</div><div style="height: 30px;margin-bottom: 10px;"><select id="type1"><option value="top">前</option><option value="last">后</option></select><div class="inpbox" id="conditionVal"><input class="formulaInputFocus" type="number" value="10"/></div><input id="isPercent" type="checkbox"/><label for="isPercent" class="txt">所选范围的百分比</label></div><div class="title">设置格式：</div>'+t;break;case 3:l='<div class="title">为满足以下条件的值：</div><div style="height: 30px;margin-bottom: 10px;"><select id="type1"><option value="AboveAverage">高于</option><option value="SubAverage">低于</option></select><span class="txt">选定范围的平均值</span></div><div class="title">设置格式：</div>'+t;break;case 4:l='<div class="title">全部：</div><div style="height: 30px;margin-bottom: 10px;"><select id="type1"><option value="0">重复</option><option value="1">唯一</option></select><span class="txt">选定范围中的数值</span></div><div class="title">设置格式：</div>'+t}return l},daterangeInit:function(e){$(".ranges_1 ul").remove(),$("#"+e).find("#daterange-btn").daterangepicker({ranges:{"昨天":[moment().subtract(1,"days"),moment().subtract(1,"days")],"今天":[moment(),moment()],"上周":[moment(moment().subtract(1,"week")).subtract((new Date).getDay()-1,"days"),moment().subtract((new Date).getDay(),"days")],"本周":[moment().subtract((new Date).getDay()-1,"days"),moment().add(7-(new Date).getDay(),"days")],"上月":[moment(moment().format("YYYY-MM")).subtract(1,"month"),moment(moment().format("YYYY-MM")).subtract(1,"day")],"本月":[moment().format("YYYY-MM"),moment(moment(moment().format("YYYY-MM")).add(1,"month")).subtract(1,"day")],"去年":[moment(moment(moment().format("YYYY"))).subtract(1,"years").format("YYYY"),moment(moment().format("YYYY")).subtract(1,"day")],"本年":[moment().format("YYYY"),moment(moment(moment().add(1,"years")).format("YYYY")).subtract(1,"day")],"最近7天":[moment().subtract(6,"days"),moment()],"最近30天":[moment().subtract(29,"days"),moment()]},startDate:moment(),endDate:moment()},function(e,t,l){"全部"==l?$("#daterange-btn").val(""):"昨天"==l||"今天"==l?$("#daterange-btn").val(e.format("YYYY/MM/DD")):"上周"!=l&&"本周"!=l&&"上月"!=l&&"本月"!=l&&"去年"!=l&&"本年"!=l&&"最近7天"!=l&&"最近30天"!=l||$("#daterange-btn").val(e.format("YYYY/MM/DD")+"-"+t.format("YYYY/MM/DD"))})},CFSplitRange:function(e,t,l,r){var a=[],s=l.row[0]-t.row[0],n=l.column[0]-t.column[0],o=e.row[0],c=e.row[1],u=e.column[0],i=e.column[1];return o>=t.row[0]&&c<=t.row[1]&&u>=t.column[0]&&i<=t.column[1]?"allPart"==r?a=[{row:[o+s,c+s],column:[u+n,i+n]}]:"restPart"==r?a=[]:"operatePart"==r&&(a=[{row:[o+s,c+s],column:[u+n,i+n]}]):o>=t.row[0]&&o<=t.row[1]&&u>=t.column[0]&&i<=t.column[1]?"allPart"==r?a=[{row:[t.row[1]+1,c],column:[u,i]},{row:[o+s,t.row[1]+s],column:[u+n,i+n]}]:"restPart"==r?a=[{row:[t.row[1]+1,c],column:[u,i]}]:"operatePart"==r&&(a=[{row:[o+s,t.row[1]+s],column:[u+n,i+n]}]):c>=t.row[0]&&c<=t.row[1]&&u>=t.column[0]&&i<=t.column[1]?"allPart"==r?a=[{row:[o,t.row[0]-1],column:[u,i]},{row:[t.row[0]+s,c+s],column:[u+n,i+n]}]:"restPart"==r?a=[{row:[o,t.row[0]-1],column:[u,i]}]:"operatePart"==r&&(a=[{row:[t.row[0]+s,c+s],column:[u+n,i+n]}]):o<t.row[0]&&c>t.row[1]&&u>=t.column[0]&&i<=t.column[1]?"allPart"==r?a=[{row:[o,t.row[0]-1],column:[u,i]},{row:[t.row[1]+1,c],column:[u,i]},{row:[t.row[0]+s,t.row[1]+s],column:[u+n,i+n]}]:"restPart"==r?a=[{row:[o,t.row[0]-1],column:[u,i]},{row:[t.row[1]+1,c],column:[u,i]}]:"operatePart"==r&&(a=[{row:[t.row[0]+s,t.row[1]+s],column:[u+n,i+n]}]):u>=t.column[0]&&u<=t.column[1]&&o>=t.row[0]&&c<=t.row[1]?"allPart"==r?a=[{row:[o,c],column:[t.column[1]+1,i]},{row:[o+s,c+s],column:[u+n,t.column[1]+n]}]:"restPart"==r?a=[{row:[o,c],column:[t.column[1]+1,i]}]:"operatePart"==r&&(a=[{row:[o+s,c+s],column:[u+n,t.column[1]+n]}]):i>=t.column[0]&&i<=t.column[1]&&o>=t.row[0]&&c<=t.row[1]?"allPart"==r?a=[{row:[o,c],column:[u,t.column[0]-1]},{row:[o+s,c+s],column:[t.column[0]+n,i+n]}]:"restPart"==r?a=[{row:[o,c],column:[u,t.column[0]-1]}]:"operatePart"==r&&(a=[{row:[o+s,c+s],column:[t.column[0]+n,i+n]}]):u<t.column[0]&&i>t.column[1]&&o>=t.row[0]&&c<=t.row[1]?"allPart"==r?a=[{row:[o,c],column:[u,t.column[0]-1]},{row:[o,c],column:[t.column[1]+1,i]},{row:[o+s,c+s],column:[t.column[0]+n,t.column[1]+n]}]:"restPart"==r?a=[{row:[o,c],column:[u,t.column[0]-1]},{row:[o,c],column:[t.column[1]+1,i]}]:"operatePart"==r&&(a=[{row:[o+s,c+s],column:[t.column[0]+n,t.column[1]+n]}]):o>=t.row[0]&&o<=t.row[1]&&u>=t.column[0]&&u<=t.column[1]?"allPart"==r?a=[{row:[o,t.row[1]],column:[t.column[1]+1,i]},{row:[t.row[1]+1,c],column:[u,i]},{row:[o+s,t.row[1]+s],column:[u+n,t.column[1]+n]}]:"restPart"==r?a=[{row:[o,t.row[1]],column:[t.column[1]+1,i]},{row:[t.row[1]+1,c],column:[u,i]}]:"operatePart"==r&&(a=[{row:[o+s,t.row[1]+s],column:[u+n,t.column[1]+n]}]):o>=t.row[0]&&o<=t.row[1]&&i>=t.column[0]&&i<=t.column[1]?"allPart"==r?a=[{row:[o,t.row[1]],column:[u,t.column[0]-1]},{row:[t.row[1]+1,c],column:[u,i]},{row:[o+s,t.row[1]+s],column:[t.column[0]+n,i+n]}]:"restPart"==r?a=[{row:[o,t.row[1]],column:[u,t.column[0]-1]},{row:[t.row[1]+1,c],column:[u,i]}]:"operatePart"==r&&(a=[{row:[o+s,t.row[1]+s],column:[t.column[0]+n,i+n]}]):c>=t.row[0]&&c<=t.row[1]&&u>=t.column[0]&&u<=t.column[1]?"allPart"==r?a=[{row:[o,t.row[0]-1],column:[u,i]},{row:[t.row[0],c],column:[t.column[1]+1,i]},{row:[t.row[0]+s,c+s],column:[u+n,t.column[1]+n]}]:"restPart"==r?a=[{row:[o,t.row[0]-1],column:[u,i]},{row:[t.row[0],c],column:[t.column[1]+1,i]}]:"operatePart"==r&&(a=[{row:[t.row[0]+s,c+s],column:[u+n,t.column[1]+n]}]):c>=t.row[0]&&c<=t.row[1]&&i>=t.column[0]&&i<=t.column[1]?"allPart"==r?a=[{row:[o,t.row[0]-1],column:[u,i]},{row:[t.row[0],c],column:[u,t.column[0]-1]},{row:[t.row[0]+s,c+s],column:[t.column[0]+n,i+n]}]:"restPart"==r?a=[{row:[o,t.row[0]-1],column:[u,i]},{row:[t.row[0],c],column:[u,t.column[0]-1]}]:"operatePart"==r&&(a=[{row:[t.row[0]+s,c+s],column:[t.column[0]+n,i+n]}]):o<t.row[0]&&c>t.row[1]&&u>=t.column[0]&&u<=t.column[1]?"allPart"==r?a=[{row:[o,t.row[0]-1],column:[u,i]},{row:[t.row[0],t.row[1]],column:[t.column[1]+1,i]},{row:[t.row[1]+1,c],column:[u,i]},{row:[t.row[0]+s,t.row[1]+s],column:[u+n,t.column[1]+n]}]:"restPart"==r?a=[{row:[o,t.row[0]-1],column:[u,i]},{row:[t.row[0],t.row[1]],column:[t.column[1]+1,i]},{row:[t.row[1]+1,c],column:[u,i]}]:"operatePart"==r&&(a=[{row:[t.row[0]+s,t.row[1]+s],column:[u+n,t.column[1]+n]}]):o<t.row[0]&&c>t.row[1]&&i>=t.column[0]&&i<=t.column[1]?"allPart"==r?a=[{row:[o,t.row[0]-1],column:[u,i]},{row:[t.row[0],t.row[1]],column:[u,t.column[0]-1]},{row:[t.row[1]+1,c],column:[u,i]},{row:[t.row[0]+s,t.row[1]+s],column:[t.column[0]+n,i+n]}]:"restPart"==r?a=[{row:[o,t.row[0]-1],column:[u,i]},{row:[t.row[0],t.row[1]],column:[u,t.column[0]-1]},{row:[t.row[1]+1,c],column:[u,i]}]:"operatePart"==r&&(a=[{row:[t.row[0]+s,t.row[1]+s],column:[t.column[0]+n,i+n]}]):u<t.column[0]&&i>t.column[1]&&o>=t.row[0]&&o<=t.row[1]?"allPart"==r?a=[{row:[o,t.row[1]],column:[u,t.column[0]-1]},{row:[o,t.row[1]],column:[t.column[1]+1,i]},{row:[t.row[1]+1,c],column:[u,i]},{row:[o+s,t.row[1]+s],column:[t.column[0]+n,t.column[1]+n]}]:"restPart"==r?a=[{row:[o,t.row[1]],column:[u,t.column[0]-1]},{row:[o,t.row[1]],column:[t.column[1]+1,i]},{row:[t.row[1]+1,c],column:[u,i]}]:"operatePart"==r&&(a=[{row:[o+s,t.row[1]+s],column:[t.column[0]+n,t.column[1]+n]}]):u<t.column[0]&&i>t.column[1]&&c>=t.row[0]&&c<=t.row[1]?"allPart"==r?a=[{row:[o,t.row[0]-1],column:[u,i]},{row:[t.row[0],c],column:[u,t.column[0]-1]},{row:[t.row[0],c],column:[t.column[1]+1,i]},{row:[t.row[0]+s,c+s],column:[t.column[0]+n,t.column[1]+n]}]:"restPart"==r?a=[{row:[o,t.row[0]-1],column:[u,i]},{row:[t.row[0],c],column:[u,t.column[0]-1]},{row:[t.row[0],c],column:[t.column[1]+1,i]}]:"operatePart"==r&&(a=[{row:[t.row[0]+s,c+s],column:[t.column[0]+n,t.column[1]+n]}]):o<t.row[0]&&c>t.row[1]&&u<t.column[0]&&i>t.column[1]?"allPart"==r?a=[{row:[o,t.row[0]-1],column:[u,i]},{row:[t.row[0],t.row[1]],column:[u,t.column[0]-1]},{row:[t.row[0],t.row[1]],column:[t.column[1]+1,i]},{row:[t.row[1]+1,c],column:[u,i]},{row:[t.row[0]+s,t.row[1]+s],column:[t.column[0]+n,t.column[1]+n]}]:"restPart"==r?a=[{row:[o,t.row[0]-1],column:[u,i]},{row:[t.row[0],t.row[1]],column:[u,t.column[0]-1]},{row:[t.row[0],t.row[1]],column:[t.column[1]+1,i]},{row:[t.row[1]+1,c],column:[u,i]}]:"operatePart"==r&&(a=[{row:[t.row[0]+s,t.row[1]+s],column:[t.column[0]+n,t.column[1]+n]}]):"allPart"==r||"restPart"==r?a=[{row:[o,c],column:[u,i]}]:"operatePart"==r&&(a=[]),a},getcolorGradation:function(e,t,l,r,a){var s=e.split(","),n=parseInt(s[0].split("(")[1]),o=parseInt(s[1]),c=parseInt(s[2].split(")")[0]),u=t.split(","),i=parseInt(u[0].split("(")[1]),h=parseInt(u[1]),d=parseInt(u[2].split(")")[0]);return"rgb("+Math.round(n-(n-i)/(l-r)*(l-a))+", "+Math.round(o-(o-h)/(l-r)*(l-a))+", "+Math.round(c-(c-d)/(l-r)*(l-a))+")"},getCFPartRange:function(e,t,l){var r=[],a=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(e)].luckysheet_conditionformat_save;if(null!=a&&0<a.length)e:for(var s=0;s<a.length;s++)for(var n=a[s].cellrange,o=0;o<n.length;o++)for(var c=n[o].row[0],u=n[o].row[1],i=n[o].column[0],h=n[o].column[1],d=0;d<range.length;d++)if(range[d].row[0]>=c&&range[d].row[0]<=u||range[d].row[1]>=c&&range[d].row[1]<=u||range[d].column[0]>=i&&range[d].column[0]<=h||range[d].column[1]>=i&&range[d].column[1]<=h){r.push(a[s]);continue e}return r},checksCF:function(e,t,l){return null!=l&&e+"_"+t in l?l[e+"_"+t]:null},getComputeMap:function(){var e=luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex),t=luckysheetfile[e].luckysheet_conditionformat_save,l=luckysheetfile[e].data;return null==l?null:luckysheet.conditionformat.compute(t,l)},compute:function(e,t){null==e&&(e=[]);var l={};if(0<e.length)for(var r=0;r<e.length;r++){var a=e[r].type,s=e[r].cellrange,n=e[r].format;if("dataBar"==a){for(var o=null,c=null,u=0;u<s.length;u++)for(var i=s[u].row[0];i<=s[u].row[1];i++)for(var h=s[u].column[0];h<=s[u].column[1];h++){null!=t[i]&&null!=t[i][h]&&(D=t[i][h],"object"==luckysheet.getObjType(D)&&null!=D.ct&&"n"==D.ct.t&&null!=D.v&&((null==o||parseInt(D.v)>o)&&(o=parseInt(D.v)),(null==c||parseInt(D.v)<c)&&(c=parseInt(D.v))))}if(null!=o&&null!=c)if(c<0)for(var d=Math.round(o/(o-c)*10)/10,y=Math.round(Math.abs(c)/(o-c)*10)/10,u=0;u<s.length;u++)for(i=s[u].row[0];i<=s[u].row[1];i++)for(h=s[u].column[0];h<=s[u].column[1];h++){null!=t[i]&&null!=t[i][h]&&(D=t[i][h],"object"==luckysheet.getObjType(D)&&null!=D.ct&&"n"==D.ct.t&&null!=D.v&&(parseInt(D.v)<0&&(f=Math.round(Math.abs(parseInt(D.v))/Math.abs(c)*100)/100,i+"_"+h in l?l[i+"_"+h].dataBar={valueType:"minus",minusLen:y,valueLen:f,format:n}:l[i+"_"+h]={dataBar:{valueType:"minus",minusLen:y,valueLen:f,format:n}}),0<parseInt(D.v)&&(f=Math.round(parseInt(D.v)/o*100)/100,i+"_"+h in l?l[i+"_"+h].dataBar={valueType:"plus",plusLen:d,minusLen:y,valueLen:f,format:n}:l[i+"_"+h]={dataBar:{valueType:"plus",plusLen:d,minusLen:y,valueLen:f,format:n}})))}else for(d=1,u=0;u<s.length;u++)for(i=s[u].row[0];i<=s[u].row[1];i++)for(var f,h=s[u].column[0];h<=s[u].column[1];h++){null!=t[i]&&null!=t[i][h]&&(D=t[i][h],"object"==luckysheet.getObjType(D)&&null!=D.ct&&"n"==D.ct.t&&null!=D.v&&(f=0==o?1:Math.round(parseInt(D.v)/o*100)/100,i+"_"+h in l?l[i+"_"+h].dataBar={valueType:"plus",plusLen:d,valueLen:f,format:n}:l[i+"_"+h]={dataBar:{valueType:"plus",plusLen:d,valueLen:f,format:n}}))}}else if("colorGradation"==a){for(var o=null,c=null,m=0,k=0,u=0;u<s.length;u++)for(i=s[u].row[0];i<=s[u].row[1];i++)for(h=s[u].column[0];h<=s[u].column[1];h++){null!=t[i]&&null!=t[i][h]&&(D=t[i][h],"object"==luckysheet.getObjType(D)&&null!=D.ct&&"n"==D.ct.t&&null!=D.v&&(k++,m+=parseInt(D.v),(null==o||parseInt(D.v)>o)&&(o=parseInt(D.v)),(null==c||parseInt(D.v)<c)&&(c=parseInt(D.v))))}if(null!=o&&null!=c)if(3==n.length)for(var p=Math.floor(m/k),u=0;u<s.length;u++)for(i=s[u].row[0];i<=s[u].row[1];i++)for(h=s[u].column[0];h<=s[u].column[1];h++){null!=t[i]&&null!=t[i][h]&&(D=t[i][h],"object"==luckysheet.getObjType(D)&&null!=D.ct&&"n"==D.ct.t&&null!=D.v&&(parseInt(D.v)==c?i+"_"+h in l?l[i+"_"+h].cellColor=n[2]:l[i+"_"+h]={cellColor:n[2]}:parseInt(D.v)>c&&parseInt(D.v)<p?i+"_"+h in l?l[i+"_"+h].cellColor=luckysheet.conditionformat.getcolorGradation(n[2],n[1],c,p,parseInt(D.v)):l[i+"_"+h]={cellColor:luckysheet.conditionformat.getcolorGradation(n[2],n[1],c,p,parseInt(D.v))}:parseInt(D.v)==p?i+"_"+h in l?l[i+"_"+h].cellColor=n[1]:l[i+"_"+h]={cellColor:n[1]}:parseInt(D.v)>p&&parseInt(D.v)<o?i+"_"+h in l?l[i+"_"+h].cellColor=luckysheet.conditionformat.getcolorGradation(n[1],n[0],p,o,parseInt(D.v)):l[i+"_"+h]={cellColor:luckysheet.conditionformat.getcolorGradation(n[1],n[0],p,o,parseInt(D.v))}:parseInt(D.v)==o&&(i+"_"+h in l?l[i+"_"+h].cellColor=n[0]:l[i+"_"+h]={cellColor:n[0]})))}else if(2==n.length)for(u=0;u<s.length;u++)for(i=s[u].row[0];i<=s[u].row[1];i++)for(h=s[u].column[0];h<=s[u].column[1];h++){null!=t[i]&&null!=t[i][h]&&(D=t[i][h],"object"==luckysheet.getObjType(D)&&null!=D.ct&&"n"==D.ct.t&&null!=D.v&&(parseInt(D.v)==c?i+"_"+h in l?l[i+"_"+h].cellColor=n[1]:l[i+"_"+h]={cellColor:n[1]}:parseInt(D.v)>c&&parseInt(D.v)<o?i+"_"+h in l?l[i+"_"+h].cellColor=luckysheet.conditionformat.getcolorGradation(n[1],n[0],c,o,parseInt(D.v)):l[i+"_"+h]={cellColor:luckysheet.conditionformat.getcolorGradation(n[1],n[0],c,o,parseInt(D.v))}:parseInt(D.v)==o&&(i+"_"+h in l?l[i+"_"+h].cellColor=n[0]:l[i+"_"+h]={cellColor:n[0]})))}}else if("icons"==a){for(var g=parseInt(n.len),v=parseInt(n.leftMin),b=parseInt(n.top),o=null,c=null,u=0;u<s.length;u++)for(i=s[u].row[0];i<=s[u].row[1];i++)for(h=s[u].column[0];h<=s[u].column[1];h++){null!=t[i]&&null!=t[i][h]&&(D=t[i][h],"object"==luckysheet.getObjType(D)&&null!=D.ct&&"n"==D.ct.t&&null!=D.v&&((null==o||parseInt(D.v)>o)&&(o=parseInt(D.v)),(null==c||parseInt(D.v)<c)&&(c=parseInt(D.v))))}if(null!=o&&null!=c){var _,w,C,T,I,$=Math.floor((o-c+1)/g),R=(o-c+1)%g;if(3==g){C=2==R?(_=[c,c+$],w=[c+$+1,c+2*$],[c+2*$+1,o]):(_=[c,c+$-1],w=[c+$,c+2*$-1],[c+2*$,o]);for(u=0;u<s.length;u++)for(i=s[u].row[0];i<=s[u].row[1];i++)for(h=s[u].column[0];h<=s[u].column[1];h++){null!=t[i]&&null!=t[i][h]&&(D=t[i][h],"object"==luckysheet.getObjType(D)&&null!=D.ct&&"n"==D.ct.t&&null!=D.v&&(parseInt(D.v)>=_[0]&&parseInt(D.v)<=_[1]?i+"_"+h in l?l[i+"_"+h].icons={left:v+2,top:b}:l[i+"_"+h]={icons:{left:v+2,top:b}}:parseInt(D.v)>=w[0]&&parseInt(D.v)<=w[1]?i+"_"+h in l?l[i+"_"+h].icons={left:v+1,top:b}:l[i+"_"+h]={icons:{left:v+1,top:b}}:parseInt(D.v)>=C[0]&&parseInt(D.v)<=C[1]&&(i+"_"+h in l?l[i+"_"+h].icons={left:v,top:b}:l[i+"_"+h]={icons:{left:v,top:b}})))}}else if(4==g){T=2==R?(_=[c,c+$],w=[c+$+1,c+2*$],C=[c+2*$+1,c+3*$],[c+3*$+1,o]):3==R?(_=[c,c+$],w=[c+$+1,c+2*$],C=[c+2*$+1,c+3*$+1],[c+3*$+2,o]):(_=[c,c+$-1],w=[c+$,c+2*$-1],C=[c+2*$,c+3*$-1],[c+3*$,o]);for(u=0;u<s.length;u++)for(i=s[u].row[0];i<=s[u].row[1];i++)for(h=s[u].column[0];h<=s[u].column[1];h++){null!=t[i]&&null!=t[i][h]&&(D=t[i][h],"object"==luckysheet.getObjType(D)&&null!=D.ct&&"n"==D.ct.t&&null!=D.v&&(parseInt(D.v)>=_[0]&&parseInt(D.v)<=_[1]?i+"_"+h in l?l[i+"_"+h].icons={left:v+3,top:b}:l[i+"_"+h]={icons:{left:v+3,top:b}}:parseInt(D.v)>=w[0]&&parseInt(D.v)<=w[1]?i+"_"+h in l?l[i+"_"+h].icons={left:v+2,top:b}:l[i+"_"+h]={icons:{left:v+2,top:b}}:parseInt(D.v)>=C[0]&&parseInt(D.v)<=C[1]?i+"_"+h in l?l[i+"_"+h].icons={left:v+1,top:b}:l[i+"_"+h]={icons:{left:v+1,top:b}}:parseInt(D.v)>=T[0]&&parseInt(D.v)<=T[1]&&(i+"_"+h in l?l[i+"_"+h].icons={left:v,top:b}:l[i+"_"+h]={icons:{left:v,top:b}})))}}else if(5==g){I=2==R?(_=[c,c+$],w=[c+$+1,c+2*$],C=[c+2*$+1,c+3*$],T=[c+3*$+1,c+4*$],[c+4*$+1,o]):3==R?(_=[c,c+$],w=[c+$+1,c+2*$],C=[c+2*$+1,c+3*$+1],T=[c+3*$+2,c+4*$+1],[c+4*$+2,o]):4==R?(_=[c,c+$],w=[c+$+1,c+2*$+1],C=[c+2*$+2,c+3*$+1],T=[c+3*$+2,c+4*$+2],[c+4*$+3,o]):(_=[c,c+$-1],w=[c+$,c+2*$-1],C=[c+2*$,c+3*$-1],T=[c+3*$,c+4*$-1],[c+4*$,o]);for(u=0;u<s.length;u++)for(i=s[u].row[0];i<=s[u].row[1];i++)for(h=s[u].column[0];h<=s[u].column[1];h++){null!=t[i]&&null!=t[i][h]&&(D=t[i][h],"object"==luckysheet.getObjType(D)&&null!=D.ct&&"n"==D.ct.t&&null!=D.v&&(parseInt(D.v)>=_[0]&&parseInt(D.v)<=_[1]?i+"_"+h in l?l[i+"_"+h].icons={left:v+4,top:b}:l[i+"_"+h]={icons:{left:v+4,top:b}}:parseInt(D.v)>=w[0]&&parseInt(D.v)<=w[1]?i+"_"+h in l?l[i+"_"+h].icons={left:v+3,top:b}:l[i+"_"+h]={icons:{left:v+3,top:b}}:parseInt(D.v)>=C[0]&&parseInt(D.v)<=C[1]?i+"_"+h in l?l[i+"_"+h].icons={left:v+2,top:b}:l[i+"_"+h]={icons:{left:v+2,top:b}}:parseInt(D.v)>=T[0]&&parseInt(D.v)<=T[1]?i+"_"+h in l?l[i+"_"+h].icons={left:v+1,top:b}:l[i+"_"+h]={icons:{left:v+1,top:b}}:parseInt(D.v)>=I[0]&&parseInt(D.v)<=I[1]&&(i+"_"+h in l?l[i+"_"+h].icons={left:v,top:b}:l[i+"_"+h]={icons:{left:v,top:b}})))}}}}else for(var S,A,F,N,M=e[r].conditionName,E=e[r].conditionValue[0],O=e[r].conditionValue[1],j=n.textColor,z=n.cellColor,u=0;u<s.length;u++)if("greaterThan"==M||"lessThan"==M||"equal"==M||"textContains"==M)for(i=s[u].row[0];i<=s[u].row[1];i++)for(h=s[u].column[0];h<=s[u].column[1];h++){null!=t[i]&&null!=t[i][h]&&(D=t[i][h],"object"!=luckysheet.getObjType(D)||luckysheet.func_methods.isRealNull(D.v)||("greaterThan"==M&&D.v>E||"lessThan"==M&&D.v<E||"equal"==M&&D.v==E||"textContains"==M&&-1!=D.v.toString().indexOf(E))&&(i+"_"+h in l?(l[i+"_"+h].textColor=j,l[i+"_"+h].cellColor=z):l[i+"_"+h]={textColor:j,cellColor:z}))}else if("betweenness"==M){A=O<E?(S=E,O):(S=O,E);for(i=s[u].row[0];i<=s[u].row[1];i++)for(var D,h=s[u].column[0];h<=s[u].column[1];h++){null!=t[i]&&null!=t[i][h]&&(D=t[i][h],"object"!=luckysheet.getObjType(D)||luckysheet.func_methods.isRealNull(D.v)||D.v>=A&&D.v<=S&&(i+"_"+h in l?(l[i+"_"+h].textColor=j,l[i+"_"+h].cellColor=z):l[i+"_"+h]={textColor:j,cellColor:z}))}}else if("occurrenceDate"==M){N=-1==E.toString().indexOf("-")?(F=luckysheet.mask.genarate(E)[2],luckysheet.mask.genarate(E)[2]):(F=luckysheet.mask.genarate(E.toString().split("-")[1])[2],luckysheet.mask.genarate(E.toString().split("-")[0])[2]);for(i=s[u].row[0];i<=s[u].row[1];i++)for(h=s[u].column[0];h<=s[u].column[1];h++){null!=t[i]&&null!=t[i][h]&&null!=t[i][h].ct&&"d"==t[i][h].ct.t&&N<=(W=luckysheet.getcellvalue(i,h,t))&&W<=F&&(i+"_"+h in l?(l[i+"_"+h].textColor=j,l[i+"_"+h].cellColor=z):l[i+"_"+h]={textColor:j,cellColor:z})}}else if("duplicateValue"==M){for(var P={},i=s[u].row[0];i<=s[u].row[1];i++)for(h=s[u].column[0];h<=s[u].column[1];h++){var L=luckysheet.getcellvalue(i,h,t);L in P||(P[L]=[]),P[L].push({r:i,c:h})}if("0"==E)for(x in P)if("null"!=x&&"undefined"!=x&&1<P[x].length)for(var B=0;B<P[x].length;B++)P[x][B].r+"_"+P[x][B].c in l?(l[P[x][B].r+"_"+P[x][B].c].textColor=j,l[P[x][B].r+"_"+P[x][B].c].cellColor=z):l[P[x][B].r+"_"+P[x][B].c]={textColor:j,cellColor:z};if("1"==E)for(x in P)"null"!=x&&"undefined"!=x&&1==P[x].length&&(P[x][0].r+"_"+P[x][0].c in l?(l[P[x][0].r+"_"+P[x][0].c].textColor=j,l[P[x][0].r+"_"+P[x][0].c].cellColor=z):l[P[x][0].r+"_"+P[x][0].c]={textColor:j,cellColor:z})}else if("top10"==M||"top10%"==M||"last10"==M||"last10%"==M||"AboveAverage"==M||"SubAverage"==M){for(var q=[],i=s[u].row[0];i<=s[u].row[1];i++)for(h=s[u].column[0];h<=s[u].column[1];h++)null!=t[i]&&null!=t[i][h]&&null!=t[i][h].ct&&"n"==t[i][h].ct.t&&q.push(luckysheet.getcellvalue(i,h,t));if("top10"==M||"top10%"==M||"last10"==M||"last10%"==M){for(var H,B=0;B<q.length;B++)for(var V,U=0;U<q.length-1-B;U++){q[U]<q[U+1]&&(V=q[U],q[U]=q[U+1],q[U+1]=V)}"top10"==M?H=q.slice(0,E):"top10%"==M?H=q.slice(0,Math.floor(E*q.length/100)):"last10"==M?H=q.slice(q.length-E,q.length):"last10%"==M&&(H=q.slice(q.length-Math.floor(E*q.length/100),q.length));for(i=s[u].row[0];i<=s[u].row[1];i++)for(h=s[u].column[0];h<=s[u].column[1];h++){null!=t[i]&&null!=t[i][h]&&(W=luckysheet.getcellvalue(i,h,t),-1!=H.indexOf(W)&&(i+"_"+h in l?(l[i+"_"+h].textColor=j,l[i+"_"+h].cellColor=z):l[i+"_"+h]={textColor:j,cellColor:z}))}}else if("AboveAverage"==M||"SubAverage"==M){for(m=0,B=0;B<q.length;B++)m+=q[B];var Y=m/q.length;if("AboveAverage"==M)for(i=s[u].row[0];i<=s[u].row[1];i++)for(h=s[u].column[0];h<=s[u].column[1];h++){null!=t[i]&&null!=t[i][h]&&Y<(W=luckysheet.getcellvalue(i,h,t))&&(i+"_"+h in l?(l[i+"_"+h].textColor=j,l[i+"_"+h].cellColor=z):l[i+"_"+h]={textColor:j,cellColor:z})}else if("SubAverage"==M)for(i=s[u].row[0];i<=s[u].row[1];i++)for(var W,h=s[u].column[0];h<=s[u].column[1];h++){null!=t[i]&&null!=t[i][h]&&(W=luckysheet.getcellvalue(i,h,t))<Y&&(i+"_"+h in l?(l[i+"_"+h].textColor=j,l[i+"_"+h].cellColor=z):l[i+"_"+h]={textColor:j,cellColor:z})}}}}return l},updateItem:function(e,t,l){var r,a,s=luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex),n=luckysheet.getluckysheetfile(),o=$.extend(!0,[],n),c=luckysheet.conditionformat.getHistoryRules(o);"delSheet"==e?a=[]:(r={type:e,cellrange:t,format:l},(a=null==n[s].luckysheet_conditionformat_save?[]:n[s].luckysheet_conditionformat_save).push(r)),n[s].luckysheet_conditionformat_save=a;var u=$.extend(!0,[],n),i=luckysheet.conditionformat.getCurrentRules(u);luckysheet.conditionformat.ref(c,i),luckysheet.server.allowUpdate&&luckysheet.server.saveParam("all",luckysheet.currentSheetIndex,a,{k:"luckysheet_conditionformat_save"})},getHistoryRules:function(e){for(var t=[],l=0;l<e.length;l++)t.push({sheetIndex:e[l].index,luckysheet_conditionformat_save:e[l].luckysheet_conditionformat_save});return t},getCurrentRules:function(e){for(var t=[],l=0;l<e.length;l++)t.push({sheetIndex:e[l].index,luckysheet_conditionformat_save:e[l].luckysheet_conditionformat_save});return t},ref:function(e,t){var l;clearjfundo&&(luckysheet.jfundo=[],(l={type:"updateCF"}).data={historyRules:e,currentRules:t},luckysheet.jfredo.push(l)),setTimeout(function(){luckysheet.luckysheetrefreshgrid()},1),luckysheetConfigsetting.pointEdit&&luckysheet.pointEdit_updateData()}},luckysheet.alternateformat={rangefocus:!1,modelfocusIndex:null,FixedModelColor:[{head:{fc:"#000",bc:"#bfbdbe"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f8f3f7"},foot:{fc:"#000",bc:"#dde2de"}},{head:{fc:"#000",bc:"#4bd4e7"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#eaf7ff"},foot:{fc:"#000",bc:"#aae9f8"}},{head:{fc:"#000",bc:"#5ed593"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#e5fbee"},foot:{fc:"#000",bc:"#a5efcc"}},{head:{fc:"#000",bc:"#f6cb4b"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fff9e7"},foot:{fc:"#000",bc:"#ffebac"}},{head:{fc:"#000",bc:"#f96420"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#ffe5d9"},foot:{fc:"#000",bc:"#ffcfba"}},{head:{fc:"#000",bc:"#5599fc"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#ecf2fe"},foot:{fc:"#000",bc:"#afcbfa"}},{head:{fc:"#000",bc:"#22a69b"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#dff2f8"},foot:{fc:"#000",bc:"#8dd4d0"}},{head:{fc:"#000",bc:"#7a939a"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f0eff7"},foot:{fc:"#000",bc:"#bdcad0"}},{head:{fc:"#000",bc:"#d7a270"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fdf3f1"},foot:{fc:"#000",bc:"#ead2b6"}},{head:{fc:"#000",bc:"#89c54b"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f1f7e9"},foot:{fc:"#000",bc:"#c5e3a7"}},{head:{fc:"#000",bc:"#8f88f0"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f0e5ff"},foot:{fc:"#000",bc:"#c6c4f6"}},{head:{fc:"#000",bc:"#fd1664"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#feddee"},foot:{fc:"#000",bc:"#f98ab5"}},{head:{fc:"#000",bc:"#da96d3"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fce8fb"},foot:{fc:"#000",bc:"#f2caee"}},{head:{fc:"#000",bc:"#b49191"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f5ebe8"},foot:{fc:"#000",bc:"#d8c3c3"}},{head:{fc:"#000",bc:"#91b493"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f0fbf0"},foot:{fc:"#000",bc:"#b4cfb6"}},{head:{fc:"#000",bc:"#b4a891"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f8f6f1"},foot:{fc:"#000",bc:"#d3cab8"}},{head:{fc:"#000",bc:"#91abb4"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#eff7fa"},foot:{fc:"#000",bc:"#b7cbd3"}},{head:{fc:"#000",bc:"#b7ba82"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fafbeb"},foot:{fc:"#000",bc:"#dadcb4"}},{head:{fc:"#000",bc:"#df3e3e"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fde9e9"},foot:{fc:"#000",bc:"#f89292"}},{head:{fc:"#000",bc:"#f2711c"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fef0d7"},foot:{fc:"#000",bc:"#fbb335"}},{head:{fc:"#000",bc:"#b5cc18"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f9fbd4"},foot:{fc:"#000",bc:"#e2ed2a"}},{head:{fc:"#000",bc:"#00b5ad"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#ccfaf9"},foot:{fc:"#000",bc:"#00e4df"}},{head:{fc:"#000",bc:"#2185d0"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#d8f3fc"},foot:{fc:"#000",bc:"#3cc4f0"}},{head:{fc:"#000",bc:"#a5673f"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f6ede5"},foot:{fc:"#000",bc:"#d3a47c"}}],getModelBox:function(e,t){$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelList").empty(),$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelCustom").empty();for(var l="",r=0;r<luckysheet.alternateformat.FixedModelColor.length;r++){var a=luckysheet.alternateformat.FixedModelColor[r];i=e&&t?(o=a.head,c=a.one,u=a.two,a.foot):e?(o=a.head,c=a.one,u=a.two,a.one):t?(o=a.one,c=a.two,u=a.one,a.foot):(o=a.one,c=a.two,u=a.one,a.two),l+='<div class="modelbox"><div class="box"><span style="color:'+o.fc+";background-color:"+o.bc+'"> — </span><span style="color:'+c.fc+";background-color:"+c.bc+'"> — </span><span style="color:'+u.fc+";background-color:"+u.bc+'"> — </span><span style="color:'+i.fc+";background-color:"+i.bc+'"> — </span></div></div>'}$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelList").append(l);var s=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_alternateformat_save_modelCustom;if(null!=s&&0<s.length){for(var n="",r=0;r<s.length;r++){var o,c,u,i,a=s[r];i=e&&t?(o=a.head,c=a.one,u=a.two,a.foot):e?(o=a.head,c=a.one,u=a.two,a.one):t?(o=a.one,c=a.two,u=a.one,a.foot):(o=a.one,c=a.two,u=a.one,a.two),n+='<div class="modelbox"><div class="box"><span style="color:'+o.fc+";background-color:"+o.bc+'"> — </span><span style="color:'+c.fc+";background-color:"+c.bc+'"> — </span><span style="color:'+u.fc+";background-color:"+u.bc+'"> — </span><span style="color:'+i.fc+";background-color:"+i.bc+'"> — </span></div></div>'}$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelCustom").append(n)}},init:function(){$("#luckysheet-modal-dialog-slider-alternateformat").remove(),$("body").append(luckysheetAlternateformatHtml),luckysheet.luckysheetsizeauto(),$("#luckysheet-modal-dialog-slider-alternateformat .luckysheet-model-close-btn").click(function(){$("#luckysheet-modal-dialog-slider-alternateformat").hide(),luckysheet.luckysheetsizeauto()}),$(document).off("focus.AFrangeInput").on("focus.AFrangeInput","#luckysheet-alternateformat-range input",function(){luckysheet.alternateformat.rangefocus=!0}),$(document).off("blur.AFrangeInput").on("blur.AFrangeInput","#luckysheet-alternateformat-range input",function(){luckysheet.alternateformat.rangefocus=!1}),$(document).off("keydown.AFrangeInput").on("keydown.AFrangeInput","#luckysheet-alternateformat-range input",function(e){$(this).val().trim();13==e.keyCode&&luckysheet.alternateformat.update()}),$(document).off("click.AFrangeIcon").on("click.AFrangeIcon","#luckysheet-alternateformat-range .fa-table",function(){$("#luckysheet-modal-dialog-slider-alternateformat").hide(),luckysheet.luckysheetsizeauto();var e=$(this).parents("#luckysheet-alternateformat-range").find("input").val().trim();luckysheet.alternateformat.rangeDialog(e)}),$(document).off("click.AFrDCf").on("click.AFrDCf","#luckysheet-alternateformat-rangeDialog-confirm",function(){var e=$(this).parents("#luckysheet-alternateformat-rangeDialog").find("input").val().trim();$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-range input").val(e),$(this).parents("#luckysheet-alternateformat-rangeDialog").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").show(),luckysheet.luckysheetsizeauto(),luckysheet.alternateformat.update()}),$(document).off("click.AFrDCl").on("click.AFrDCl","#luckysheet-alternateformat-rangeDialog-close",function(){$(this).parents("#luckysheet-alternateformat-rangeDialog").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").show(),luckysheet.luckysheetsizeauto()}),$(document).off("click.AFrDTitle").on("click.AFrDTitle","#luckysheet-alternateformat-rangeDialog .luckysheet-modal-dialog-title-close",function(){$(this).parents("#luckysheet-alternateformat-rangeDialog").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").show(),luckysheet.luckysheetsizeauto()}),$(document).off("change.AFrowHeader").on("change.AFrowHeader","#luckysheet-alternateformat-rowHeader",function(){var e,t;e=!!$(this).is(":checked"),t=!!$("#luckysheet-alternateformat-rowFooter").is(":checked"),luckysheet.alternateformat.checkboxChange(e,t),luckysheet.alternateformat.modelboxOn(),luckysheet.alternateformat.update()}),$(document).off("change.AFrowFooter").on("change.AFrowFooter","#luckysheet-alternateformat-rowFooter",function(){var e,t;e=!!$("#luckysheet-alternateformat-rowHeader").is(":checked"),t=!!$(this).is(":checked"),luckysheet.alternateformat.checkboxChange(e,t),luckysheet.alternateformat.modelboxOn(),luckysheet.alternateformat.update()}),$(document).off("click.AFmodelbox").on("click.AFmodelbox","#luckysheet-modal-dialog-slider-alternateformat .modelbox",function(){var e,t=$(this).index(),l=$(this).parents(".cf").attr("id");"luckysheet-alternateformat-modelList"==l?luckysheet.alternateformat.modelfocusIndex=t:"luckysheet-alternateformat-modelCustom"==l&&(e=luckysheet.alternateformat.FixedModelColor.length,luckysheet.alternateformat.modelfocusIndex=t+e),luckysheet.alternateformat.modelboxOn(),luckysheet.alternateformat.update()}),$(document).off("click.AFselectColor").on("click.AFselectColor","#luckysheet-modal-dialog-slider-alternateformat .luckysheet-color-menu-button-indicator",function(){var e,t,l,r=$(this).closest(".toningbox");$(this).find(".luckysheet-icon-img").hasClass("luckysheet-icon-text-color")?(e="fc",t=r.find(".toningShow").data("fc")):$(this).find(".luckysheet-icon-img").hasClass("luckysheet-icon-cell-color")&&(e="bc",t=r.find(".toningShow").data("bc")),r.hasClass("header")?l="0":r.hasClass("ctOne")?l="1":r.hasClass("ctTwo")?l="2":r.hasClass("footer")&&(l="3"),luckysheet.alternateformat.colorSelectDialog(t,e,l)}),$(document).off("click.AFselectColorConfirm").on("click.AFselectColorConfirm","#luckysheet-alternateformat-colorSelect-dialog-confirm",function(){var e=$(this).parents("#luckysheet-alternateformat-colorSelect-dialog");$("#luckysheet-modal-dialog-mask").hide(),e.hide();var t,l=e.find(".currenColor span").attr("title");"选择文本颜色"==e.find(".luckysheet-modal-dialog-title-text").text()?t="fc":"选择单元格颜色"==e.find(".luckysheet-modal-dialog-title-text").text()&&(t="bc");var r,a,s=e.find(".currenColor").attr("data-source");"0"==s?("fc"==t&&($("#luckysheet-alternateformat-modelToning .header .toningShow").css("color",l),$("#luckysheet-alternateformat-modelToning .header .toningShow").data("fc",l),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",l)),"bc"==t&&($("#luckysheet-alternateformat-modelToning .header .toningShow").css("background-color",l),$("#luckysheet-alternateformat-modelToning .header .toningShow").data("bc",l),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",l))):"1"==s?("fc"==t&&($("#luckysheet-alternateformat-modelToning .ctOne .toningShow").css("color",l),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").data("fc",l),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",l)),"bc"==t&&($("#luckysheet-alternateformat-modelToning .ctOne .toningShow").css("background-color",l),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").data("bc",l),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",l))):"2"==s?("fc"==t&&($("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").css("color",l),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").data("fc",l),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",l)),"bc"==t&&($("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").css("background-color",l),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").data("bc",l),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",l))):"3"==s&&("fc"==t&&($("#luckysheet-alternateformat-modelToning .footer .toningShow").css("color",l),$("#luckysheet-alternateformat-modelToning .footer .toningShow").data("fc",l),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",l)),"bc"==t&&($("#luckysheet-alternateformat-modelToning .footer .toningShow").css("background-color",l),$("#luckysheet-alternateformat-modelToning .footer .toningShow").data("bc",l),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",l))),r=!!$("#luckysheet-alternateformat-rowHeader").is(":checked"),a=!!$("#luckysheet-alternateformat-rowFooter").is(":checked");var n,o,c,u=luckysheet.alternateformat.modelfocusIndex,i=luckysheet.alternateformat.FixedModelColor.length;c=u<i?$.extend(!0,{},luckysheet.alternateformat.getFormatByIndex()):(o=(n=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)]).luckysheet_alternateformat_save_modelCustom,$.extend(!0,{},o[u-i])),"0"==s?"fc"==t?c.head.fc=l:"bc"==t&&(c.head.bc=l):"1"==s?"fc"==t?c.one.fc=l:"bc"==t&&(c.one.bc=l):"2"==s?"fc"==t?c.two.fc=l:"bc"==t&&(c.two.bc=l):"3"==s&&("fc"==t&&(c.foot.fc=l),"bc"==t&&(c.foot.bc=l)),luckysheet.alternateformat.modelfocusIndex<i?(luckysheet.alternateformat.addCustomModel(c),luckysheet.alternateformat.modelfocusIndex=luckysheet.alternateformat.getIndexByFormat(c)):(n.luckysheet_alternateformat_save_modelCustom[u-i]=c,luckysheet.server.allowUpdate&&luckysheet.server.saveParam("all",luckysheet.currentSheetIndex,n.luckysheet_alternateformat_save_modelCustom,{k:"luckysheet_alternateformat_save_modelCustom"})),luckysheet.alternateformat.getModelBox(r,a),luckysheet.alternateformat.modelboxOn(),luckysheet.alternateformat.update()}),$(document).off("click.AFremove").on("click.AFremove","#luckysheet-alternateformat-remove",function(){var e=$(this).data("index"),t=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_alternateformat_save,l=$.extend(!0,[],t);1<t.length?t.splice(e,1):t=[];var r=$.extend(!0,[],t);luckysheet.alternateformat.ref(l,r),luckysheet.server.allowUpdate&&luckysheet.server.saveParam("all",luckysheet.currentSheetIndex,t,{k:"luckysheet_alternateformat_save"}),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").hide(),luckysheet.luckysheetsizeauto()})},perfect:function(){var e=$.extend(!0,{},luckysheet_select_save[0]),t=luckysheet.alternateformat.rangeIsExists(e)[1],l=$.extend(!0,{},luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_alternateformat_save[t]),r=l.cellrange;$("#luckysheet-alternateformat-range input").val(luckysheet.sheetmanage.getRangetxt(luckysheet.currentSheetIndex,{row:r.row,column:r.column},luckysheet.currentSheetIndex)),luckysheet_select_save=[{row:r.row,column:r.column}],luckysheet.selectHightlightShow();var a=l.hasRowHeader,s=l.hasRowFooter,n=l.format;luckysheet.alternateformat.modelfocusIndex=luckysheet.alternateformat.getIndexByFormat(n),null==luckysheet.alternateformat.modelfocusIndex&&(luckysheet.alternateformat.addCustomModel(n),luckysheet.alternateformat.modelfocusIndex=luckysheet.alternateformat.getIndexByFormat(n)),luckysheet.alternateformat.checkboxChange(a,s),luckysheet.alternateformat.modelboxOn(),$("#luckysheet-alternateformat-remove").data("index",t)},checkboxChange:function(e,t){e?($("#luckysheet-alternateformat-rowHeader").prop("checked",!0),$("#luckysheet-alternateformat-modelToning .header").show()):($("#luckysheet-alternateformat-rowHeader").removeAttr("checked"),$("#luckysheet-alternateformat-modelToning .header").hide()),t?($("#luckysheet-alternateformat-rowFooter").prop("checked",!0),$("#luckysheet-alternateformat-modelToning .footer").show()):($("#luckysheet-alternateformat-rowFooter").removeAttr("checked"),$("#luckysheet-alternateformat-modelToning .footer").hide()),luckysheet.alternateformat.getModelBox(e,t)},modelboxOn:function(){$("#luckysheet-modal-dialog-slider-alternateformat .modelbox").removeClass("on");var e=luckysheet.alternateformat.modelfocusIndex,t=luckysheet.alternateformat.FixedModelColor.length;e<t?$("#luckysheet-alternateformat-modelList .modelbox").eq(e).addClass("on"):$("#luckysheet-alternateformat-modelCustom .modelbox").eq(e-t).addClass("on"),luckysheet.alternateformat.modelToningColor()},modelToningColor:function(){var e=luckysheet.alternateformat.getFormatByIndex();$("#luckysheet-alternateformat-modelToning .header .toningShow").css({color:e.head.fc,"background-color":e.head.bc}),$("#luckysheet-alternateformat-modelToning .header .toningShow").data("fc",e.head.fc).data("bc",e.head.bc),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.head.fc),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.head.bc),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").css({color:e.one.fc,"background-color":e.one.bc}),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").data("fc",e.one.fc).data("bc",e.one.bc),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.one.fc),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.one.bc),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").css({color:e.two.fc,"background-color":e.two.bc}),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").data("fc",e.two.fc).data("bc",e.two.bc),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.two.fc),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.two.bc),$("#luckysheet-alternateformat-modelToning .footer .toningShow").css({color:e.foot.fc,"background-color":e.foot.bc}),$("#luckysheet-alternateformat-modelToning .footer .toningShow").data("fc",e.foot.fc).data("bc",e.foot.bc),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.foot.fc),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.foot.bc)},addCustomModel:function(e){var t=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)];null==t.luckysheet_alternateformat_save_modelCustom&&(t.luckysheet_alternateformat_save_modelCustom=[]),t.luckysheet_alternateformat_save_modelCustom.push(e),luckysheet.server.allowUpdate&&luckysheet.server.saveParam("all",luckysheet.currentSheetIndex,t.luckysheet_alternateformat_save_modelCustom,{k:"luckysheet_alternateformat_save_modelCustom"})},colorSelectDialog:function(e,t,l){var r;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-alternateformat-colorSelect-dialog").remove(),"fc"==t?r="选择文本颜色":"bc"==t&&(r="选择单元格颜色"),$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-alternateformat-colorSelect-dialog",addclass:"luckysheet-alternateformat-colorSelect-dialog",title:r,content:"<div class='currenColor' data-source='"+l+"'>当前颜色：<span title='"+e+"' style='background-color:"+e+"'></span></div><div class='colorshowbox'></div>",botton:'<button id="luckysheet-alternateformat-colorSelect-dialog-confirm" class="btn btn-primary">确定</button><button class="btn btn-default luckysheet-model-close-btn">取消</button>',style:"z-index:100003"}));var a=$("#luckysheet-alternateformat-colorSelect-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),s=a.outerHeight(),n=a.outerWidth(),o=$(window).width(),c=$(window).height(),u=$(document).scrollLeft(),i=$(document).scrollTop();$("#luckysheet-alternateformat-colorSelect-dialog").css({left:(o+u-n)/2,top:(c+i-s)/3}).show(),$("#luckysheet-alternateformat-colorSelect-dialog").find(".colorshowbox").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,showButtons:!1,maxPaletteSize:8,maxSelectionSize:8,color:e,cancelText:"取消",chooseText:"确定颜色",togglePaletteMoreText:"自定义",togglePaletteLessText:"收起",togglePaletteOnly:!0,clearText:"清除颜色选择",noColorSelectedText:"没有颜色被选择",localStorageKey:"spectrum.textcolor"+luckysheet.server.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],move:function(e){e=null!=e?e.toHexString():"#000",$("#luckysheet-alternateformat-colorSelect-dialog .currenColor span").css("background-color",e).attr("title",e)}})},rangeDialog:function(e){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-alternateformat-rangeDialog").remove(),$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-alternateformat-rangeDialog",addclass:"luckysheet-alternateformat-rangeDialog",title:"选择应用范围",content:'<input readonly="readonly" placeholder="请选择交替颜色应用范围" value="'+e+'"/>',botton:'<button id="luckysheet-alternateformat-rangeDialog-confirm" class="btn btn-primary">确定</button><button id="luckysheet-alternateformat-rangeDialog-close" class="btn btn-default">取消</button>',style:"z-index:100003"}));var t=$("#luckysheet-alternateformat-rangeDialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),l=t.outerHeight(),r=t.outerWidth(),a=$(window).width(),s=$(window).height(),n=$(document).scrollLeft(),o=$(document).scrollTop();$("#luckysheet-alternateformat-rangeDialog").css({left:(a+n-r)/2,top:(s+o-l)/3}).show()},rangeIsExists:function(e,t){var l=!1,r=null,a=$.extend(!0,[],luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_alternateformat_save);if(null!=t&&null!=t&&(1<a.length?a.splice(t,1):a=[]),0<a.length){for(var s=[],n=0;n<a.length;n++){var o={index:n,map:luckysheet.alternateformat.getRangeMap(a[n].cellrange.row,a[n].cellrange.column)};s.push(o)}var c=luckysheet.alternateformat.getRangeMap(e.row,e.column);for(x in c){if(l)break;for(var u=0;u<s.length;u++)if(x in s[u].map){l=!0,r=s[u].index;break}}}return[l,r]},getRangeMap:function(e,t){for(var l={},r=e[0],a=e[1],s=t[0],n=t[1],o=r;o<=a;o++)for(var c=s;c<=n;c++)l[o+"_"+c]=0;return l},getIndexByFormat:function(e){for(var t=null,l=luckysheet.alternateformat.FixedModelColor,r=0;r<l.length;r++){var a=l[r];if(e.head.fc==a.head.fc&&e.head.bc==a.head.bc&&e.one.fc==a.one.fc&&e.one.bc==a.one.bc&&e.two.fc==a.two.fc&&e.two.bc==a.two.bc&&e.foot.fc==a.foot.fc&&e.foot.bc==a.foot.bc){t=r;break}}var s=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_alternateformat_save_modelCustom;if(null!=s&&0<s.length)for(var n=0;n<s.length;n++){a=s[n];if(e.head.fc==a.head.fc&&e.head.bc==a.head.bc&&e.one.fc==a.one.fc&&e.one.bc==a.one.bc&&e.two.fc==a.two.fc&&e.two.bc==a.two.bc&&e.foot.fc==a.foot.fc&&e.foot.bc==a.foot.bc){t=l.length+n;break}}return t},getFormatByIndex:function(){var e=luckysheet.alternateformat.modelfocusIndex,t=luckysheet.alternateformat.FixedModelColor.length;return e<t?luckysheet.alternateformat.FixedModelColor[e]:luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_alternateformat_save_modelCustom[e-t]},new:function(e){var t=luckysheet.alternateformat.getFormatByIndex(),l=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_alternateformat_save;null==l&&(l=[]);var r=$.extend(!0,[],l),a={cellrange:{row:e.row,column:e.column},format:t,hasRowHeader:!0,hasRowFooter:!1};l.push(a);var s=$.extend(!0,[],l);luckysheet.alternateformat.ref(r,s),luckysheet.server.allowUpdate&&luckysheet.server.saveParam("all",luckysheet.currentSheetIndex,l,{k:"luckysheet_alternateformat_save"})},update:function(){var e,t,l,r,a,s,n,o,c=$("#luckysheet-alternateformat-remove").data("index"),u=$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-range input").val().trim();luckysheet.formula.iscelldata(u)?(e=luckysheet.formula.getcellrange(u),luckysheet.alternateformat.rangeIsExists(e,c)[0]?luckysheet.isEditMode()?alert("您选择的应用范围已存在交替颜色且不属于你要编辑的应用范围！"):luckysheet.tooltip.info("您选择的应用范围已存在交替颜色且不属于你要编辑的应用范围！",""):(t=!!$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-rowHeader").is(":checked"),l=!!$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-rowFooter").is(":checked"),r=luckysheet.alternateformat.getFormatByIndex(),null==(a=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_alternateformat_save)&&(a=[]),s=$.extend(!0,[],a),n={cellrange:{row:e.row,column:e.column},format:r,hasRowHeader:t,hasRowFooter:l},a[c]=n,o=$.extend(!0,[],a),luckysheet.alternateformat.ref(s,o),luckysheet.server.allowUpdate&&luckysheet.server.saveParam("all",luckysheet.currentSheetIndex,a,{k:"luckysheet_alternateformat_save"}))):luckysheet.isEditMode()?alert("您选择的应用范围不是选区！"):luckysheet.tooltip.info("您选择的应用范围不是选区！","")},checksAF:function(e,t,l){return e+"_"+t in l?l[e+"_"+t]:null},getComputeMap:function(){var e=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_alternateformat_save;return luckysheet.alternateformat.compute(e)},compute:function(e){var t={};if(null!=e&&0<e.length)for(var l=0;l<e.length;l++){var r=e[l].cellrange,a=e[l].format,s=e[l].hasRowHeader,n=e[l].hasRowFooter,o=r.row[0],c=r.row[1],u=r.column[0],i=r.column[1];if(s&&n){for(var h=u;h<=i;h++)t[o+"_"+h]=[a.head.fc,a.head.bc];if(1<c-o)for(var d=o+1;d<c;d++){f=(d-o)%2!=0?(y=a.one.fc,a.one.bc):(y=a.two.fc,a.two.bc);for(h=u;h<=i;h++)t[d+"_"+h]=[y,f]}if(o<c)for(h=u;h<=i;h++)t[c+"_"+h]=[a.foot.fc,a.foot.bc]}else if(s){for(h=u;h<=i;h++)t[o+"_"+h]=[a.head.fc,a.head.bc];if(o<c)for(d=o+1;d<=c;d++){f=(d-o)%2!=0?(y=a.one.fc,a.one.bc):(y=a.two.fc,a.two.bc);for(h=u;h<=i;h++)t[d+"_"+h]=[y,f]}}else if(n){if(o<c)for(d=o;d<c;d++){f=(d-o)%2==0?(y=a.one.fc,a.one.bc):(y=a.two.fc,a.two.bc);for(h=u;h<=i;h++)t[d+"_"+h]=[y,f]}for(h=u;h<=i;h++)t[c+"_"+h]=[a.foot.fc,a.foot.bc]}else for(var y,f,d=o;d<=c;d++){f=(d-o)%2==0?(y=a.one.fc,a.one.bc):(y=a.two.fc,a.two.bc);for(h=u;h<=i;h++)t[d+"_"+h]=[y,f]}}return t},ref:function(e,t){var l;clearjfundo&&(luckysheet.jfundo=[],(l={type:"updateAF"}).sheetIndex=luckysheet.currentSheetIndex,l.data={historyRules:e,currentRules:t},luckysheet.jfredo.push(l));var r=luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex);luckysheetfile[r].luckysheet_alternateformat_save=t,setTimeout(function(){luckysheet.luckysheetrefreshgrid()},1)}},luckysheet.ifFormulaGenerator={singleRangeFocus:!1,init:function(){$(document).off("focus.IFcompareValue").on("focus.IFcompareValue","#luckysheet-ifFormulaGenerator-dialog #compareValue",function(){$("#luckysheet-modal-dialog-mask").hide(),luckysheet.ifFormulaGenerator.singleRangeFocus=!0}),$(document).off("click.IFsingRange").on("click.IFsingRange","#luckysheet-ifFormulaGenerator-dialog .singRange",function(){var e=$("#luckysheet-ifFormulaGenerator-dialog #compareValue").val().trim();luckysheet.formula.iscelldata(e)?luckysheet.ifFormulaGenerator.singleRangeDialog(e):luckysheet.ifFormulaGenerator.singleRangeDialog()}),$(document).off("click.IFsingRangeConfirm").on("click.IFsingRangeConfirm","#luckysheet-ifFormulaGenerator-singleRange-confirm",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-ifFormulaGenerator-singleRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show();var e=$(this).parents("#luckysheet-ifFormulaGenerator-singleRange-dialog").find("input").val().trim();$("#luckysheet-ifFormulaGenerator-dialog #compareValue").val(e),luckysheet.ifFormulaGenerator.singleRangeFocus=!1}),$(document).off("click.IFsingRangeCancel").on("click.IFsingRangeCancel","#luckysheet-ifFormulaGenerator-singleRange-cancel",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-ifFormulaGenerator-singleRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show(),luckysheet.ifFormulaGenerator.singleRangeFocus=!1}),$(document).off("click.IFsingRangeClose").on("click.IFsingRangeClose","#luckysheet-ifFormulaGenerator-singleRange-dialog .luckysheet-modal-dialog-title-close",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show(),luckysheet.ifFormulaGenerator.singleRangeFocus=!1}),$(document).off("click.IFmultiRange").on("click.IFmultiRange","#luckysheet-ifFormulaGenerator-dialog .multiRange",function(){luckysheet.ifFormulaGenerator.multiRangeDialog(),luckysheet.ifFormulaGenerator.singleRangeFocus=!1}),$(document).off("click.IFmultiRangeConfirm").on("click.IFmultiRangeConfirm","#luckysheet-ifFormulaGenerator-multiRange-confirm",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide(),$("#luckysheet-ifFormulaGenerator-multiRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show();for(var e=$(this).parents("#luckysheet-ifFormulaGenerator-multiRange-dialog").find("input").val().trim(),t=luckysheet.formula.getcellrange(e),l=t.row[0],r=t.row[1],a=t.column[0],s=t.column[1],n=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),o=[],c=l;c<=r;c++)for(var u=a;u<=s;u++)null!=n[c]&&null!=n[c][u]&&null!=n[c][u].ct&&"n"==n[c][u].ct.t&&o.push(n[c][u].v);for(var i=0;i<o.length;i++)for(var h,d=0;d<o.length-1-i;d++){o[d]<o[d+1]&&(h=o[d],o[d]=o[d+1],o[d+1]=h)}var y=o[0],f=o[o.length-1];$("#luckysheet-ifFormulaGenerator-dialog #smallRange").val(f),$("#luckysheet-ifFormulaGenerator-dialog #largeRange").val(y)}),$(document).off("click.IFmultiRangeCancel").on("click.IFmultiRangeCancel","#luckysheet-ifFormulaGenerator-multiRange-cancel",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide(),$("#luckysheet-ifFormulaGenerator-multiRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show()}),$(document).off("click.IFmultiRangeClose").on("click.IFmultiRangeClose","#luckysheet-ifFormulaGenerator-multiRange-dialog .luckysheet-modal-dialog-title-close",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show()}),$(document).on("change","#DivisionMethod",function(){"2"==$(this).find("option:selected").val()?$("#DivisionMethodVal").hide():$("#DivisionMethodVal").show(),$("#luckysheet-ifFormulaGenerator-dialog .ifList").empty()}),$(document).off("click.IFcreateBtn").on("click.IFcreateBtn","#luckysheet-ifFormulaGenerator-dialog #createBtn",function(){var e=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find("#compareValue").val().trim();if(""!=e){var t=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find("#DivisionMethod option:selected").val();if("2"==t){var l='<div class="item"><input type="number" class="smallNum formulaInputFocus"/><select class="operator"><option value="0"> <= </option><option value="1"> < </option></select><span class="compareValue">'+e+'</span><select class="operator2"><option value="0"> <= </option><option value="1" selected="selected"> < </option></select><input type="number" class="largeNum formulaInputFocus"/><span>标签：</span><input type="text" class="markText formulaInputFocus" value=""><i class="fa fa-remove" aria-hidden="true"></i></div>';$("#luckysheet-ifFormulaGenerator-dialog .ifList").append(l)}else{var r=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find("#smallRange").val().trim(),a=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find("#largeRange").val().trim(),s=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find("#DivisionMethodVal").val().trim();if(""==r||""==a)return void luckysheet.ifFormulaGenerator.info("范围不能为空！");if(""==s)return void luckysheet.ifFormulaGenerator.info("划分值不能为空！");luckysheet.ifFormulaGenerator.getIfList(e,r,a,t,s)}}else luckysheet.ifFormulaGenerator.info("比较值不能为空！")}),$(document).on("click","#luckysheet-ifFormulaGenerator-dialog .item .fa-remove",function(){$(this).parents(".item").remove()}),$(document).off("click.IFconfirmBtn").on("click.IFconfirmBtn","#luckysheet-ifFormulaGenerator-dialog-confirm",function(){var e,t,l,r,a,s,n,h=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find(".ifList .item"),d="";$(h.toArray().reverse()).each(function(e,t){var l,r,a,s=$(t).find(".smallNum").val().trim(),n=$(t).find(".largeNum").val().trim(),o=$(t).find(".operator option:selected").val(),c=$(t).find(".operator2 option:selected").val(),u=$(t).find(".compareValue").text(),i=$(t).find(".markText").val().trim();if(""==i&&(i="标签"+(e+1)),""==s&&""==n)return!0;l="0"==o?u+">="+s:u+">"+s,r="0"==c?u+"<="+n:u+"<"+n,a=0==e&&""==n?l:e==h.length-1&&""==s?r:"and("+l+","+r+")",d=0==e?"if("+a+',"'+i+'")':"if("+a+',"'+i+'",'+d+")"}),0!=d.length?($("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-ifFormulaGenerator-dialog").hide(),t=(e=luckysheet_select_save[luckysheet_select_save.length-1]).row_focus,l=e.column_focus,r=visibledatarow[t],a=t-1==-1?0:visibledatarow[t-1],s=visibledatacolumn[l],n=l-1==-1?0:visibledatacolumn[l-1],luckysheet.luckysheetupdateCell(r,a,t,s,n,l,luckysheet.flowdata),$("#luckysheet-rich-text-editor").html("="+d),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),$("#luckysheet-wa-functionbox-confirm").click()):luckysheet.ifFormulaGenerator.info("没有生成可用的条件！")}),$(document).on("click","#luckysheet-ifFormulaGenerator-info .luckysheet-model-close-btn",function(){$("#luckysheet-modal-dialog-mask").show()}),$(document).on("click","#luckysheet-ifFormulaGenerator-info .luckysheet-modal-dialog-title-close",function(){$("#luckysheet-modal-dialog-mask").show()})},ifFormulaDialog:function(e){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").remove();var t="",l="";if(e)for(var r=e.split("if("),a=1;a<r.length;a++){var s,n,o,c=r[a].replace("and(","").replace(/\)/g,"").replace(/\"/g,"").split(","),c=luckysheet.ifFormulaGenerator.clearArr(c),t=luckysheet.ifFormulaGenerator.splitTxt(c[0])[0];o=3==c.length?(s=luckysheet.ifFormulaGenerator.splitTxt(c[0])[1],n=luckysheet.ifFormulaGenerator.splitTxt(c[1])[2],c[2]):(s=luckysheet.ifFormulaGenerator.splitTxt(c[0])[1],n=luckysheet.ifFormulaGenerator.splitTxt(c[0])[2],c[1]),l+='<div class="item"><input type="number" class="smallNum formulaInputFocus" value="'+s+'"/><select class="operator"><option value="0"> <= </option><option value="1"> < </option></select><span class="compareValue">'+t+'</span><select class="operator2"><option value="0"> <= </option><option value="1" selected="selected"> < </option></select><input type="number" class="largeNum formulaInputFocus" value="'+n+'"/><span>标签：</span><input type="text" class="markText formulaInputFocus" value="'+o+'"><i class="fa fa-remove" aria-hidden="true"></i></div>'}var u='<div class="ifAttr"><div class="attrBox"><label for="compareValue"> 比较值 </label><div class="inpBox"><input id="compareValue" class="formulaInputFocus" value="'+t+'"/><i class="singRange fa fa-table" aria-hidden="true" title="点击选择单元格"></i></div></div><div class="attrBox"><label for="smallRange"> 范围 </label><input type="number" id="smallRange" class="formulaInputFocus"/><span class="text"> 至 </span><input type="number" id="largeRange" class="formulaInputFocus"/><div id="rangeAssess"><span> 范围评估 </span><i class="multiRange fa fa-table" aria-hidden="true" title="点击选择范围"></i></div></div><div class="attrBox"><label for="DivisionMethod"> 划分方式 </label><select id="DivisionMethod"><option value="0"> 划分值相同 </option><option value="1"> 划分为N份 </option><option value="2"> 自定义输入 </option></select><input id="DivisionMethodVal" class="formulaInputFocus"/><div id="createBtn"> 生成 </div></div></div><div class="ifList">'+l+"</div>";$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-ifFormulaGenerator-dialog",addclass:"luckysheet-ifFormulaGenerator-dialog",title:"if公式生成器",content:u,botton:'<button id="luckysheet-ifFormulaGenerator-dialog-confirm" class="btn btn-primary">确认</button><button class="btn btn-default luckysheet-model-close-btn">取消</button>',style:"z-index:100003"}));var i=$("#luckysheet-ifFormulaGenerator-dialog").find(".luckysheet-modal-dialog-content").css("min-width",590).end(),h=i.outerHeight(),d=i.outerWidth(),y=$(window).width(),f=$(window).height(),m=$(document).scrollLeft(),k=$(document).scrollTop();$("#luckysheet-ifFormulaGenerator-dialog").css({left:(y+m-d)/2,top:(f+k-h)/3}).show()},clearArr:function(e){for(var t=0;t<e.length;t++)""!=e[t]&&null!=e[t]&&null!=e[t]||e.splice(t,1);return e},splitTxt:function(e){var t,l;return-1!=e.indexOf(">=")?[e.split(">=")[0],t=e.split(">=")[1],l]:-1!=e.indexOf(">")?[e.split(">")[0],t=e.split(">")[1],l]:-1!=e.indexOf("<=")?[e.split("<=")[0],t,l=e.split("<=")[1]]:-1!=e.indexOf("<")?[e.split("<")[0],t,l=e.split("<")[1]]:void 0},singleRangeDialog:function(e){var t;$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-ifFormulaGenerator-dialog").hide(),$("#luckysheet-ifFormulaGenerator-singleRange-dialog").remove(),t=null!=e&&null!=e?e:"",$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-ifFormulaGenerator-singleRange-dialog",addclass:"luckysheet-ifFormulaGenerator-singleRange-dialog",title:"选择单元格",content:'<input readonly="readonly" placeholder="请选择单元格" value="'+t+'">',botton:'<button id="luckysheet-ifFormulaGenerator-singleRange-confirm" class="btn btn-primary">确认</button><button id="luckysheet-ifFormulaGenerator-singleRange-cancel" class="btn btn-default">取消</button>',style:"z-index:100003"}));var l=$("#luckysheet-ifFormulaGenerator-singleRange-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),r=l.outerHeight(),a=l.outerWidth(),s=$(window).width(),n=$(window).height(),o=$(document).scrollLeft(),c=$(document).scrollTop();$("#luckysheet-ifFormulaGenerator-singleRange-dialog").css({left:(s+o-a)/2,top:(n+c-r)/3}).show()},multiRangeDialog:function(){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-ifFormulaGenerator-dialog").hide(),$("#luckysheet-ifFormulaGenerator-multiRange-dialog").remove(),$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-ifFormulaGenerator-multiRange-dialog",addclass:"luckysheet-ifFormulaGenerator-multiRange-dialog",title:"选择范围",content:'<input readonly="readonly" placeholder="请选择范围" value="">',botton:'<button id="luckysheet-ifFormulaGenerator-multiRange-confirm" class="btn btn-primary">确认</button><button id="luckysheet-ifFormulaGenerator-multiRange-cancel" class="btn btn-default">取消</button>',style:"z-index:100003"}));var e=$("#luckysheet-ifFormulaGenerator-multiRange-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),t=e.outerHeight(),l=e.outerWidth(),r=$(window).width(),a=$(window).height(),s=$(document).scrollLeft(),n=$(document).scrollTop();$("#luckysheet-ifFormulaGenerator-multiRange-dialog").css({left:(r+s-l)/2,top:(a+n-t)/3}).show()},getIfList:function(e,t,l,r,a){$("#luckysheet-ifFormulaGenerator-dialog .ifList").empty();var t=parseInt(t),l=parseInt(l),a=parseInt(a),s=[];if("0"==r)for(var n=Math.ceil((l-t)/a),o=0;o<=n;o++){var c=t+a*o;0==o||l<=c?s.push(""):s.push(c)}else if("1"==r)for(var u=Math.ceil((l-t)/a),o=0;o<=a;o++){c=t+u*o;0==o||l<=c?s.push(""):s.push(c)}for(var i,h=0;h<s.length-1;h++){i=0==h?"小于"+s[h+1]:h==s.length-2?"大于等于"+s[h]:s[h]+"到"+s[h+1];var d='<div class="item"><input type="number" class="smallNum formulaInputFocus" value="'+s[h]+'"/><select class="operator"><option value="0"> <= </option><option value="1"> < </option></select><span class="compareValue">'+e+'</span><select class="operator2"><option value="0"> <= </option><option value="1" selected="selected"> < </option></select><input type="number" class="largeNum formulaInputFocus" value="'+s[h+1]+'"/><span>标签：</span><input type="text" class="markText formulaInputFocus" value="'+i+'"><i class="fa fa-remove" aria-hidden="true"></i></div>';$("#luckysheet-ifFormulaGenerator-dialog .ifList").append(d)}},info:function(e){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-info").remove(),$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-ifFormulaGenerator-info",addclass:"",title:e,content:"",botton:'<button class="btn btn-default luckysheet-model-close-btn">&nbsp;&nbsp;关闭&nbsp;&nbsp;</button>',style:"z-index:100003"}));var t=$("#luckysheet-ifFormulaGenerator-info").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),l=t.outerHeight(),r=t.outerWidth(),a=$(window).width(),s=$(window).height(),n=$(document).scrollLeft(),o=$(document).scrollTop();$("#luckysheet-ifFormulaGenerator-info").css({left:(a+n-r)/2,top:(s+o-l)/3}).show()}},luckysheet.insertFormula={init:function(){$(document).off("keyup.fxSFLI").on("keyup.fxSFLI","#searchFormulaListInput",function(){$("#formulaTypeList").empty();var e=$(this).val().toUpperCase();if(""==e)luckysheet.insertFormula.formulaListByType($("#formulaTypeSelect option:selected").val());else for(var t=0;t<luckysheet.functionlist.length;t++)/^[a-zA-Z]+$/.test(e)?"-1"!=luckysheet.functionlist[t].n.indexOf(e)&&$('<div class="listBox" name="'+luckysheet.functionlist[t].n+'"><span>'+luckysheet.functionlist[t].n+"</span><span>"+luckysheet.functionlist[t].a+"</span></div>").appendTo($("#formulaTypeList")):"-1"!=luckysheet.functionlist[t].a.indexOf(e)&&$('<div class="listBox" name="'+luckysheet.functionlist[t].n+'"><span>'+luckysheet.functionlist[t].n+"</span><span>"+luckysheet.functionlist[t].a+"</span></div>").appendTo($("#formulaTypeList"));$("#formulaTypeList .listBox:first-child").addClass("on")}),$(document).off("change.fxFormulaTS").on("change.fxFormulaTS","#formulaTypeSelect",function(){var e=$("#formulaTypeSelect option:selected").val();luckysheet.insertFormula.formulaListByType(e)}),$(document).off("click.fxListbox").on("click.fxListbox","#formulaTypeList .listBox",function(){$(this).addClass("on").siblings().removeClass("on")}),$(document).off("click.fxFormulaCf").on("click.fxFormulaCf","#luckysheet-search-formula-confirm",function(){var e=$("#luckysheet-search-formula .listBox.on").attr("name"),t='<span dir="auto" class="luckysheet-formula-text-color">=</span><span dir="auto" class="luckysheet-formula-text-color">'+e.toUpperCase()+'</span><span dir="auto" class="luckysheet-formula-text-color">(</span><span dir="auto" class="luckysheet-formula-text-color">)</span>';$("#luckysheet-rich-text-editor").html(t),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),luckysheet.insertFormula.formulaParmDialog(e)}),$(document).off("focus.fxParamInput").on("focus.fxParamInput","#luckysheet-search-formula-parm .parmBox input",function(){var e=$(this).parents(".parmBox").index();luckysheet.formula.data_parm_index=e;var t,l,r=$(this).parents("#luckysheet-search-formula-parm").find(".luckysheet-modal-dialog-title-text").text(),a=window.luckysheet_function[r].p.length;l=a<=e?(t=window.luckysheet_function[r].p[a-1].detail,window.luckysheet_function[r].p[a-1].repeat):(t=window.luckysheet_function[r].p[e].detail,window.luckysheet_function[r].p[e].repeat),luckysheet.insertFormula.parmTxtShow($(this).val()),luckysheet.insertFormula.functionStrCompute(),$("#luckysheet-search-formula-parm .parmDetailsBox").empty();var s,n=$(this).parents(".parmBox").find(".name").text();$("<span>"+n+":</span><span>"+t+"</span>").appendTo($("#luckysheet-search-formula-parm .parmDetailsBox")),"y"!=l||(s=$("#luckysheet-search-formula-parm .parmBox").length)<5&&e==s-1&&$('<div class="parmBox"><div class="name">值'+(s+1)+'</div><div class="txt"><input class="formulaInputFocus" /><i class="fa fa-table" aria-hidden="true" title="点击选择数据范围"></i></div><div class="val">=</div></div>').appendTo($("#luckysheet-search-formula-parm .parmListBox"))}),$(document).off("blur.fxParamInput").on("blur.fxParamInput","#luckysheet-search-formula-parm .parmBox input",function(){var e=$(this).val();null!=luckysheet.formula.getfunctionParam(e).fn||luckysheet.formula.iscelldata(e)||!luckysheet.func_methods.isRealNum(e)&&""!=e&&e.length<=2&&0!=e.indexOf('"')&&0!=e.lastIndexOf('"')&&(e='"'+e+'"',$(this).val(e),luckysheet.insertFormula.parmTxtShow(e),luckysheet.insertFormula.functionStrCompute())}),$(document).off("keyup.fxParamInput").on("keyup.fxParamInput","#luckysheet-search-formula-parm .parmBox input",function(){luckysheet.insertFormula.parmTxtShow($(this).val()),luckysheet.insertFormula.functionStrCompute()}),$(document).off("click.fxParamI").on("click.fxParamI","#luckysheet-search-formula-parm .parmBox i",function(){luckysheet.formula.data_parm_index=$(this).parents(".parmBox").index(),$("#luckysheet-search-formula-parm").hide(),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-search-formula-parm-select").remove(),""==$(this).parents(".parmBox").find(".txt input").val()?$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-search-formula-parm-select",addclass:"luckysheet-search-formula-parm-select",title:"选取数据范围",content:"<input id='luckysheet-search-formula-parm-select-input' class='luckysheet-datavisual-range-container' style='font-size: 14px;padding:5px;max-width:none;' spellcheck='false' aria-label='数据范围' readonly='true' placeholder='数据范围'>",botton:'<button id="luckysheet-search-formula-parm-select-confirm" class="btn btn-primary">确认</button>',style:"z-index:100003"})):$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-search-formula-parm-select",addclass:"luckysheet-search-formula-parm-select",title:"选取数据范围",content:"<input id='luckysheet-search-formula-parm-select-input' class='luckysheet-datavisual-range-container' style='font-size: 14px;padding:5px;max-width:none;' spellcheck='false' aria-label='数据范围' readonly='true' value='"+$(this).parents(".parmBox").find(".txt input").val()+"'>",botton:'<button id="luckysheet-search-formula-parm-select-confirm" class="btn btn-primary">确认</button>',style:"z-index:100003"}));var e=$("#luckysheet-search-formula-parm-select").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),t=e.outerHeight(),l=e.outerWidth(),r=$(window).width(),a=$(window).height(),s=$(document).scrollLeft(),n=$(document).scrollTop();$("#luckysheet-search-formula-parm-select").css({left:(r+s-l)/2,top:(a+n-t)/3}).show(),luckysheet.insertFormula.parmTxtShow($(this).parents(".parmBox").find(".txt input").val())}),$(document).off("click.fxParamCf").on("click.fxParamCf","#luckysheet-search-formula-parm-confirm",function(){$("#luckysheet-wa-functionbox-confirm").click()}),$(document).off("click.fxParamSelectCf").on("click.fxParamSelectCf","#luckysheet-search-formula-parm-select-confirm",function(){var e=$("#luckysheet-search-formula-parm-select-input").attr("data_parm_index");$("#luckysheet-search-formula-parm-select").hide(),$("#luckysheet-search-formula-parm").show(),$("#luckysheet-search-formula-parm .parmBox").eq(e).find(".txt input").focus()})},formulaListDialog:function(){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-search-formula").remove(),$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-search-formula",addclass:"luckysheet-search-formula",title:"",content:"<div class='inpbox'><label for='searchFormulaListInput'>查找函数：</label><input class='formulaInputFocus' id='searchFormulaListInput' placeholder='请输入您要查找的函数名称或函数功能的简要描述' spellcheck='false'/></div><div class='selbox'><label>或选择类别：</label><select id='formulaTypeSelect'><option value='0'>数学</option><option value='1'>统计</option><option value='2'>查找</option><option value='3'>Luckysheet内置</option><option value='4'>数据挖掘</option><option value='5'>数据源</option><option value='6'>日期</option><option value='7'>过滤器</option><option value='8'>财务</option><option value='9'>工程计算</option><option value='10'>逻辑</option><option value='11'>运算符</option><option value='12'>文本</option><option value='13'>转换工具</option><option value='14'>数组</option><option value='-1'>其它</option></select></div><div class='listbox'><label>选择函数：</label><div id='formulaTypeList'></div></div>",botton:'<button id="luckysheet-search-formula-confirm" class="btn btn-primary">确认</button><button class="btn btn-default luckysheet-model-close-btn">取消</button>',style:"z-index:100003"}));var e=$("#luckysheet-search-formula").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),t=e.outerHeight(),l=e.outerWidth(),r=$(window).width(),a=$(window).height(),s=$(document).scrollLeft(),n=$(document).scrollTop();$("#luckysheet-search-formula").css({left:(r+s-l)/2,top:(a+n-t)/3,"user-select":"none"}).show(),luckysheet.insertFormula.formulaListByType("0"),$("#searchFormulaListInput").focus()},formulaListByType:function(e){$("#formulaTypeList").empty();for(var t=0;t<luckysheet.functionlist.length;t++)("-1"==e&&14<luckysheet.functionlist[t].t||luckysheet.functionlist[t].t==e)&&$('<div class="listBox" name="'+luckysheet.functionlist[t].n+'"><span>'+luckysheet.functionlist[t].n+"</span><span>"+luckysheet.functionlist[t].a+"</span></div>").appendTo($("#formulaTypeList"));$("#formulaTypeList .listBox:first-child").addClass("on")},formulaParmDialog:function(formula,parm){for(var parm_title="",parm_content="",parm_list_content="",i=0;i<luckysheet.functionlist.length;i++)if(luckysheet.functionlist[i].n==formula.toUpperCase()){parm_title=luckysheet.functionlist[i].n;for(var j=0;j<luckysheet.functionlist[i].p.length;j++)null==parm?parm_list_content+='<div class="parmBox"><div class="name">'+luckysheet.functionlist[i].p[j].name+'</div><div class="txt"><input class="formulaInputFocus" spellcheck="false"/><i class="fa fa-table" aria-hidden="true" title="点击选择数据范围"></i></div><div class="val">=</div></div>':(null==parm[j]&&(parm[j]=""),parm_list_content+='<div class="parmBox"><div class="name">'+luckysheet.functionlist[i].p[j].name+'</div><div class="txt"><input class="formulaInputFocus" value="'+parm[j]+'" spellcheck="false"/><i class="fa fa-table" aria-hidden="true" title="点击选择数据范围"></i></div><div class="val">=</div></div>');parm_content='<div><div class="parmListBox">'+parm_list_content+'</div><div class="formulaDetails">'+luckysheet.functionlist[i].d+'</div><div class="parmDetailsBox"></div><div class="result">计算结果 = <span></span></div></div>'}$("#luckysheet-search-formula").hide(),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-search-formula-parm").remove(),$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-search-formula-parm",addclass:"luckysheet-search-formula-parm",title:parm_title,content:parm_content,botton:'<button id="luckysheet-search-formula-parm-confirm" class="btn btn-primary">确认</button><button class="btn btn-default luckysheet-model-close-btn">取消</button>',style:"z-index:100003"}));var $t=$("#luckysheet-search-formula-parm").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),myh=$t.outerHeight(),myw=$t.outerWidth(),winw=$(window).width(),winh=$(window).height(),scrollLeft=$(document).scrollLeft(),scrollTop=$(document).scrollTop();$("#luckysheet-search-formula-parm").css({left:(winw+scrollLeft-myw)/2,top:(winh+scrollTop-myh)/3}).show(),$("#luckysheet-search-formula-parm .parmBox:eq(0) input").focus(),$("#luckysheet-search-formula-parm .parmBox").each(function(index,e){var parmtxt=$(e).find(".txt input").val();if(null==luckysheet.formula.getfunctionParam(parmtxt).fn)if(luckysheet.formula.iscelldata(parmtxt)){var txtdata=window.luckysheet_getcelldata(parmtxt).data;if("array"==luckysheet.getObjType(txtdata)){for(var txtArr=[],i=0;i<txtdata.length;i++)for(var j=0;j<txtdata[i].length;j++){var cell=txtdata[i][j];null==cell||luckysheet.func_methods.isRealNull(cell.v)?txtArr.push(null):txtArr.push(cell.v)}$("#luckysheet-search-formula-parm .parmBox").eq(index).find(".val").text(" = {"+txtArr.join(",")+"}")}else $("#luckysheet-search-formula-parm .parmBox").eq(index).find(".val").text(" = {"+txtdata.v+"}")}else $("#luckysheet-search-formula-parm .parmBox").eq(index).find(".val").text(" = {"+parmtxt+"}");else $("#luckysheet-search-formula-parm .parmBox").eq(index).find(".val").text(" = {"+eval($.trim(luckysheet.formula.functionParser("="+parmtxt)))+"}")}),$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight").remove(),luckysheet.formula.data_parm_index=0,luckysheet.formula.rangestart=!0},parmTxtShow:function(parmtxt){if(null==luckysheet.formula.getfunctionParam(parmtxt).fn)if(luckysheet.formula.iscelldata(parmtxt)){var cellrange=luckysheet.formula.getcellrange(parmtxt),r1=cellrange.row[0],r2=cellrange.row[1],c1=cellrange.column[0],c2=cellrange.column[1],row=visibledatarow[r2],row_pre=r1-1==-1?0:visibledatarow[r1-1],col=visibledatacolumn[c2],col_pre=c1-1==-1?0:visibledatacolumn[c1-1];$("#luckysheet-formula-functionrange-select").css({left:col_pre,width:col-col_pre-1,top:row_pre,height:row-row_pre-1}).show(),$("#luckysheet-formula-help-c").hide(),luckysheet.luckysheet_count_show(col_pre,row_pre,col-col_pre-1,row-row_pre-1,cellrange.row,cellrange.column);var txtdata=window.luckysheet_getcelldata(parmtxt).data;if("array"==luckysheet.getObjType(txtdata)){for(var txtArr=[],i=0;i<txtdata.length;i++)for(var j=0;j<txtdata[i].length;j++){var cell=txtdata[i][j];null==cell||luckysheet.func_methods.isRealNull(cell.v)?txtArr.push(null):txtArr.push(cell.v)}$("#luckysheet-search-formula-parm .parmBox").eq(luckysheet.formula.data_parm_index).find(".val").text(" = {"+txtArr.join(",")+"}")}else $("#luckysheet-search-formula-parm .parmBox").eq(luckysheet.formula.data_parm_index).find(".val").text(" = {"+txtdata.v+"}")}else $("#luckysheet-search-formula-parm .parmBox").eq(luckysheet.formula.data_parm_index).find(".val").text(" = {"+parmtxt+"}"),$("#luckysheet-formula-functionrange-select").hide();else{for(var txt,k=0;k<luckysheet.formula.getfunctionParam(parmtxt).param.length;k++)if(luckysheet.formula.iscelldata(luckysheet.formula.getfunctionParam(parmtxt).param[k])){txt=luckysheet.formula.getfunctionParam(parmtxt).param[k];break}var cellrange=luckysheet.formula.getcellrange(txt),r1=cellrange.row[0],r2=cellrange.row[1],c1=cellrange.column[0],c2=cellrange.column[1],row=visibledatarow[r2],row_pre=r1-1==-1?0:visibledatarow[r1-1],col=visibledatacolumn[c2],col_pre=c1-1==-1?0:visibledatacolumn[c1-1];$("#luckysheet-formula-functionrange-select").css({left:col_pre,width:col-col_pre-1,top:row_pre,height:row-row_pre-1}).show(),$("#luckysheet-formula-help-c").hide(),luckysheet.luckysheet_count_show(col_pre,row_pre,col-col_pre-1,row-row_pre-1,cellrange.row,cellrange.column),$("#luckysheet-search-formula-parm .parmBox").eq(luckysheet.formula.data_parm_index).find(".val").text(" = {"+eval($.trim(luckysheet.formula.functionParser("="+parmtxt)))+"}")}},functionStrCompute:function(){var isVal=!0,parmValArr=[],lvi=-1,formulatxt=$("#luckysheet-search-formula-parm").find(".luckysheet-modal-dialog-title-text").text();if($("#luckysheet-search-formula-parm .parmBox").each(function(e,t){var l=$(t).find(".txt input").val(),r=window.luckysheet_function[formulatxt].p[e].require;""==l&&"m"==r&&(isVal=!1),""!=l&&(lvi=e)}),-1==lvi)var functionHtmlTxt="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"()";else if(0==lvi)var functionHtmlTxt="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"("+$("#luckysheet-search-formula-parm .parmBox").eq(0).find(".txt input").val()+")";else{for(var j=0;j<=lvi;j++)parmValArr.push($("#luckysheet-search-formula-parm .parmBox").eq(j).find(".txt input").val());var functionHtmlTxt="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"("+parmValArr.join(",")+")"}var function_str=luckysheet.formula.functionHTMLGenerate(functionHtmlTxt);if($("#luckysheet-rich-text-editor").html(function_str),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),isVal){var fp=$.trim(luckysheet.formula.functionParser($("#luckysheet-rich-text-editor").text())),result=null;try{result=eval(fp)}catch(e){result=luckysheet.formula.error.n}$("#luckysheet-search-formula-parm .result span").text(result)}}},luckysheet.dropCell={iconHtml:'<div id="luckysheet-dropCell-icon" style="position: absolute;padding: 2px;background-color: #f1f1f1;z-index: 990;cursor: pointer;"><div id="icon_dropCell"></div></div>',typeListHtml:'<div id="luckysheet-dropCell-typeList" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="0"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>复制单元格</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="1"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>填充序列</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="2"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>仅填充格式</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="3"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>不带格式填充</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="4"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>以天数填充</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="5"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>以工作日填充</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="6"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>以月填充</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="7"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>以年填充</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="8"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>以中文小写数字填充</div></div></div>',copyRange:{},applyRange:{},applyType:null,direction:null,chnNumChar:{"零":0,"一":1,"二":2,"三":3,"四":4,"五":5,"六":6,"七":7,"八":8,"九":9},chnNameValue:{"十":{value:10,secUnit:!1},"百":{value:100,secUnit:!1},"千":{value:1e3,secUnit:!1},"万":{value:1e4,secUnit:!0},"亿":{value:1e8,secUnit:!0}},ChineseToNumber:function(e){for(var t=0,l=0,r=0,a=e.split(""),s=0;s<a.length;s++){var n,o=luckysheet.dropCell.chnNumChar[a[s]];void 0!==o?(r=o,s==a.length-1&&(l+=r)):(n=luckysheet.dropCell.chnNameValue[a[s]].value,luckysheet.dropCell.chnNameValue[a[s]].secUnit?(t+=l=(l+r)*n,l=0):l+=r*n,r=0)}return t+l},chnNumChar2:["零","一","二","三","四","五","六","七","八","九"],chnUnitSection:["","万","亿","万亿","亿亿"],chnUnitChar:["","十","百","千"],SectionToChinese:function(e){for(var t,l="",r=0,a=!0;0<e;){var s=e%10;0==s?a||(a=!0,l=luckysheet.dropCell.chnNumChar2[s]+l):(a=!1,t=luckysheet.dropCell.chnNumChar2[s],l=(t+=luckysheet.dropCell.chnUnitChar[r])+l),r++,e=Math.floor(e/10)}return l},NumberToChinese:function(e){var t,l=0,r="",a=!1;if(0==e)return luckysheet.dropCell.chnNumChar2[0];for(;0<e;){var s=e%1e4;a&&(r=luckysheet.dropCell.chnNumChar2[0]+r),t=luckysheet.dropCell.SectionToChinese(s),r=(t+=0!=s?luckysheet.dropCell.chnUnitSection[l]:luckysheet.dropCell.chnUnitSection[0])+r,a=s<1e3&&0<s,e=Math.floor(e/1e4),l++}return r},isChnNumber:function(e){var t=!0;if(1==e.length)t="日"==e||e in luckysheet.dropCell.chnNumChar;else for(var l=e.split(""),r=0;r<l.length;r++)if(!(l[r]in luckysheet.dropCell.chnNumChar||l[r]in luckysheet.dropCell.chnNameValue)){t=!1;break}return t},isExtendNumber:function(e){var t,l=/[0-9]/;if(t=!!l.test(e.substr(e.length-1,1))){var r=e.split("");r.reverse();for(var a=0,s=0;s<r.length;s++)if(!l.test(r[s])){a=s;break}return[t,e.substr(0,e.length-a),e.substr(e.length-a,a)]}return[t]},isChnWeek1:function(e){return 1==e.length&&("日"==e||luckysheet.dropCell.ChineseToNumber(e)<7)},isChnWeek2:function(e){return 2==e.length&&("周一"==e||"周二"==e||"周三"==e||"周四"==e||"周五"==e||"周六"==e||"周日"==e)},isChnWeek3:function(e){return 3==e.length&&("星期一"==e||"星期二"==e||"星期三"==e||"星期四"==e||"星期五"==e||"星期六"==e||"星期日"==e)},createIcon:function(){var e,t,l=luckysheet.dropCell.copyRange.row[1],r=luckysheet.dropCell.copyRange.column[1],a=luckysheet.dropCell.applyRange.row[1],s=luckysheet.dropCell.applyRange.column[1];t=l<=a&&r<=s?(e=a,s):(e=l,r);var n=luckysheet.rowLocationByIndex(e)[1],o=(luckysheet.rowLocationByIndex(e)[0],luckysheet.colLocationByIndex(t)[1]);luckysheet.colLocationByIndex(t)[0];$("#luckysheet-dropCell-icon").remove(),$("#luckysheet-cell-main").append(luckysheet.dropCell.iconHtml),$("#luckysheet-dropCell-icon").css({left:o,top:n}),$("#luckysheet-dropCell-icon").mouseover(function(){$(this).css("background-color","#ffe8e8")}).mouseleave(function(){$(this).css("background-color","#f1f1f1")}).mousedown(function(e){$("#luckysheet-dropCell-typeList").remove(),$("body").append(luckysheet.dropCell.typeListHtml);var t=luckysheet.dropCell.typeItemHide();t[0]||t[1]||t[2]||t[3]||t[4]||t[5]||t[6]||($("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=1]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=4]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=5]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=6]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=7]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=8]").hide()),t[2]||($("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=4]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=5]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=6]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=7]").hide()),t[3]||$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=8]").hide();var l=$(this).offset().left,r=$(this).offset().top+25,a=$(window).height(),s=$(window).width(),n=$("#luckysheet-dropCell-typeList").width(),o=$("#luckysheet-dropCell-typeList").height();s<l+n&&(l-=n),a<r+o&&(r=r-o-38),r<0&&(r=0),$("#luckysheet-dropCell-typeList").css({left:l,top:r}).show(),$("#luckysheet-dropCell-icon").mouseleave(function(){$(this).css("backgroundColor","#ffe8e8")});var c=luckysheet.dropCell.applyType;$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type="+c+"]").find("span").append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>'),e.stopPropagation()}),$(document).off("click.dCtypeList").on("click.dCtypeList","#luckysheet-dropCell-typeList .luckysheet-cols-menuitem",function(){$("#luckysheet-dropCell-typeList .fa-check").remove(),$(this).find("span").append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>');var e=$(this).attr("data-type");luckysheet.dropCell.applyType=e,luckysheet.dropCell.update(),$("#luckysheet-dropCell-typeList").hide(),$("#luckysheet-dropCell-icon").css("backgroundColor","#f1f1f1"),$("#luckysheet-dropCell-icon").mouseleave(function(){$(this).css("backgroundColor","#f1f1f1")}),luckysheet.jfcountfunc()})},typeItemHide:function(){for(var e=luckysheet.dropCell.copyRange,t=e.row[0],l=e.row[1],r=e.column[0],a=e.column[1],s=!1,n=!1,o=!1,c=!1,u=!1,i=!1,h=!1,d=t;d<=l;d++)for(var y,f=r;f<=a;f++){luckysheet.flowdata[d][f]&&(y=luckysheet.flowdata[d][f],"object"==luckysheet.getObjType(y)&&null!=y.v&&null==y.f&&(null!=y.ct&&"n"==y.ct.t?s=!0:null!=y.ct&&"d"==y.ct.t?o=!0:luckysheet.dropCell.isExtendNumber(y.m)[0]?n=!0:luckysheet.dropCell.isChnNumber(y.m)&&"日"!=y.m?c=!0:"日"==y.m?u=!0:luckysheet.dropCell.isChnWeek2(y.m)?i=!0:luckysheet.dropCell.isChnWeek3(y.m)&&(h=!0)))}return[s,n,o,c,u,i,h]},update:function(){var e,t=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),l=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)],r=$.extend(!0,{},config),a=luckysheet.getBorderInfoCompute(),s=luckysheet.dropCell.direction,n=(luckysheet.dropCell.applyType,luckysheet.dropCell.copyRange),o=n.row[0],c=n.row[1],u=n.column[0],i=n.column[1],h=luckysheet.dropCell.getCopyData(t,o,c,u,i,s);"down"==s||"up"==s?e=c-o+1:"right"!=s&&"left"!=s||(e=i-u+1);var d=luckysheet.dropCell.applyRange,y=d.row[0],f=d.row[1],m=d.column[0],k=d.column[1];if("down"==s||"up"==s)for(var p=f-y+1,g=m;g<=k;g++){var v=h[g-m],b=luckysheet.dropCell.getApplyData(v,e,p);if("down"==s)for(var _=y;_<=f;_++){null!=(w=b[_-y]).f&&(x="="+luckysheet.formula.functionCopy(w.f,"down",_-y+1),C=luckysheet.formula.execfunction(x,_,g,!0),w.f=C[2],w.v=C[1],null!=w.spl?w.spl=C[3].data:luckysheet.func_methods.isRealNum(w.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(w.v)?(w.v==1/0||w.v==-1/0?w.m=w.v.toString():-1<w.v.toString().indexOf("e")?(5<(T=w.v.toString().split(".")[1].split("e")[0].length)&&(T=5),w.m=w.v.toExponential(T).toString()):(I=luckysheet.mask.genarate(Math.round(1e9*w.v)/1e9),w.m=I[0].toString()),w.ct={fa:"General",t:"n"}):(I=luckysheet.mask.genarate(w.v),w.m=I[0].toString(),w.ct=I[1])),t[_][g]=w,a[(R=o+(_-y)%e)+"_"+(S=g)]?(A={rangeType:"cell",value:{row_index:_,col_index:g,l:a[R+"_"+S].l,r:a[R+"_"+S].r,t:a[R+"_"+S].t,b:a[R+"_"+S].b}},r.borderInfo.push(A)):a[_+"_"+g]&&(A={rangeType:"cell",value:{row_index:_,col_index:g,l:null,r:null,t:null,b:null}},r.borderInfo.push(A))}if("up"==s)for(_=f;y<=_;_--){null!=(w=b[f-_]).f&&(x="="+luckysheet.formula.functionCopy(w.f,"up",f-_+1),C=luckysheet.formula.execfunction(x,_,g,!0),w.f=C[2],w.v=C[1],null!=w.spl?w.spl=C[3].data:luckysheet.func_methods.isRealNum(w.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(w.v)?(w.v==1/0||w.v==-1/0?w.m=w.v.toString():-1<w.v.toString().indexOf("e")?(5<(T=w.v.toString().split(".")[1].split("e")[0].length)&&(T=5),w.m=w.v.toExponential(T).toString()):(I=luckysheet.mask.genarate(Math.round(1e9*w.v)/1e9),w.m=I[0].toString()),w.ct={fa:"General",t:"n"}):(I=luckysheet.mask.genarate(w.v),w.m=I[0].toString(),w.ct=I[1])),t[_][g]=w,a[(R=c-(f-_)%e)+"_"+(S=g)]?(A={rangeType:"cell",value:{row_index:_,col_index:g,l:a[R+"_"+S].l,r:a[R+"_"+S].r,t:a[R+"_"+S].t,b:a[R+"_"+S].b}},r.borderInfo.push(A)):a[_+"_"+g]&&(A={rangeType:"cell",value:{row_index:_,col_index:g,l:null,r:null,t:null,b:null}},r.borderInfo.push(A))}}else if("right"==s||"left"==s)for(p=k-m+1,g=y;g<=f;g++){v=h[g-y],b=luckysheet.dropCell.getApplyData(v,e,p);if("right"==s)for(_=m;_<=k;_++){null!=(w=b[_-m]).f&&(x="="+luckysheet.formula.functionCopy(w.f,"right",_-m+1),C=luckysheet.formula.execfunction(x,g,_,!0),w.f=C[2],w.v=C[1],null!=w.spl?w.spl=C[3].data:luckysheet.func_methods.isRealNum(w.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(w.v)?(w.v==1/0||w.v==-1/0?w.m=w.v.toString():-1<w.v.toString().indexOf("e")?(5<(T=w.v.toString().split(".")[1].split("e")[0].length)&&(T=5),w.m=w.v.toExponential(T).toString()):(I=luckysheet.mask.genarate(Math.round(1e9*w.v)/1e9),w.m=I[0].toString()),w.ct={fa:"General",t:"n"}):(I=luckysheet.mask.genarate(w.v),w.m=I[0].toString(),w.ct=I[1])),t[g][_]=w,a[(R=g)+"_"+(S=u+(_-m)%e)]?(A={rangeType:"cell",value:{row_index:g,col_index:_,l:a[R+"_"+S].l,r:a[R+"_"+S].r,t:a[R+"_"+S].t,b:a[R+"_"+S].b}},r.borderInfo.push(A)):a[g+"_"+_]&&(A={rangeType:"cell",value:{row_index:g,col_index:_,l:null,r:null,t:null,b:null}},r.borderInfo.push(A))}if("left"==s)for(var w,x,C,T,I,R,S,A,_=k;m<=_;_--){null!=(w=b[k-_]).f&&(x="="+luckysheet.formula.functionCopy(w.f,"left",k-_+1),C=luckysheet.formula.execfunction(x,g,_,!0),w.f=C[2],w.v=C[1],null!=w.spl?w.spl=C[3].data:luckysheet.func_methods.isRealNum(w.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(w.v)?(w.v==1/0||w.v==-1/0?w.m=w.v.toString():-1<w.v.toString().indexOf("e")?(5<(T=w.v.toString().split(".")[1].split("e")[0].length)&&(T=5),w.m=w.v.toExponential(T).toString()):(I=luckysheet.mask.genarate(Math.round(1e9*w.v)/1e9),w.m=I[0].toString()),w.ct={fa:"General",t:"n"}):(I=luckysheet.mask.genarate(w.v),w.m=I[0].toString(),w.ct=I[1])),t[g][_]=w,a[(R=g)+"_"+(S=i-(k-_)%e)]?(A={rangeType:"cell",value:{row_index:g,col_index:_,l:a[R+"_"+S].l,r:a[R+"_"+S].r,t:a[R+"_"+S].t,b:a[R+"_"+S].b}},r.borderInfo.push(A)):a[g+"_"+_]&&(A={rangeType:"cell",value:{row_index:g,col_index:_,l:null,r:null,t:null,b:null}},r.borderInfo.push(A))}}var F=$.extend(!0,[],l.luckysheet_conditionformat_save);if(null!=F&&0<F.length)for(g=0;g<F.length;g++){for(var N=F[g].cellrange,M=[],_=0;_<N.length;_++){var E=luckysheet.conditionformat.CFSplitRange(N[_],{row:n.row,column:n.column},{row:d.row,column:d.column},"operatePart");0<E.length&&(M=M.concat(E))}0<M.length&&F[g].cellrange.push(d)}luckysheet.jfrefreshgrid(t,luckysheet_select_save,r,F),luckysheet.selectHightlightShow()},getCopyData:function(e,t,l,r,a,s){var n,o,c,u,i=[];"down"==s||"up"==s?(n=r,o=a,c=t,u=l):"right"!=s&&"left"!=s||(n=t,o=l,c=r,u=a);for(var h=n;h<=o;h++){for(var d,y,f={},m=[],k=[],p="",g=null,v=!0,b=c;b<=u;b++){"down"==s||"up"==s?d=e[b][h]:"right"!=s&&"left"!=s||(d=e[h][b]),d&&d.v&&null==d.f?d.ct&&"n"==d.ct.t?(y="number",g=null):d.ct&&"d"==d.ct.t?(y="date",g=null):luckysheet.dropCell.isExtendNumber(d.m)[0]?(y="extendNumber",null==g?(v=!0,g=luckysheet.dropCell.isExtendNumber(d.m)[1]):luckysheet.dropCell.isExtendNumber(d.m)[1]!=g?(v=!1,g=luckysheet.dropCell.isExtendNumber(d.m)[1]):v=!0):g=(y=luckysheet.dropCell.isChnNumber(d.m)?"chnNumber":luckysheet.dropCell.isChnWeek2(d.m)?"chnWeek2":luckysheet.dropCell.isChnWeek3(d.m)?"chnWeek3":"other",null):(y="other",g=null),"extendNumber"==y?b==c?c==u?(p=y,m.push(d),k.push(b-c+1),f[p]=[],f[p].push({data:m,index:k})):(p=y,m.push(d),k.push(b-c+1)):b==u?(p==y&&v?(m.push(d),k.push(b-c+1)):(p in f||(f[p]=[]),f[p].push({data:m,index:k}),p=y,(m=[]).push(d),(k=[]).push(b-c+1)),p in f||(f[p]=[]),f[p].push({data:m,index:k})):p==y&&v?(m.push(d),k.push(b-c+1)):(p in f||(f[p]=[]),f[p].push({data:m,index:k}),p=y,(m=[]).push(d),(k=[]).push(b-c+1)):b==c?c==u?(p=y,m.push(d),k.push(b-c+1),f[p]=[],f[p].push({data:m,index:k})):(p=y,m.push(d),k.push(b-c+1)):b==u?(p==y?(m.push(d),k.push(b-c+1)):(p in f||(f[p]=[]),f[p].push({data:m,index:k}),p=y,(m=[]).push(d),(k=[]).push(b-c+1)),p in f||(f[p]=[]),f[p].push({data:m,index:k})):p==y?(m.push(d),k.push(b-c+1)):(p in f||(f[p]=[]),f[p].push({data:m,index:k}),p=y,(m=[]).push(d),(k=[]).push(b-c+1))}i.push(f)}return i},getApplyData:function(e,t,l){var r=[],a=luckysheet.dropCell.direction,s=luckysheet.dropCell.applyType,n=Math.floor(l/t),o=l%t,c=e.number,u=[];if(c)for(var i=0;i<c.length;i++){var h=luckysheet.dropCell.getLenS(c[i].index,o),d=c[i].index.length*n+h;I="1"==s||"3"==s?luckysheet.dropCell.getDataByType(c[i].data,d,a,s,"number"):"2"==s?luckysheet.dropCell.getDataByType(c[i].data,d,a,s):luckysheet.dropCell.getDataByType(c[i].data,d,a,"0");var y=luckysheet.dropCell.getDataIndex(t,l,c[i].index);u.push({data:I,index:y})}var f=e.extendNumber,m=[];if(f)for(i=0;i<f.length;i++){h=luckysheet.dropCell.getLenS(f[i].index,o),d=f[i].index.length*n+h;I="1"==s||"3"==s?luckysheet.dropCell.getDataByType(f[i].data,d,a,s,"extendNumber"):"2"==s?luckysheet.dropCell.getDataByType(f[i].data,d,a,s):luckysheet.dropCell.getDataByType(f[i].data,d,a,"0");y=luckysheet.dropCell.getDataIndex(t,l,f[i].index);m.push({data:I,index:y})}var k=e.date,p=[];if(k)for(i=0;i<k.length;i++){h=luckysheet.dropCell.getLenS(k[i].index,o),d=k[i].index.length*n+h;I="1"==s||"3"==s?luckysheet.dropCell.getDataByType(k[i].data,d,a,s,"date"):"8"==s?luckysheet.dropCell.getDataByType(k[i].data,d,a,"0"):luckysheet.dropCell.getDataByType(k[i].data,d,a,s);y=luckysheet.dropCell.getDataIndex(t,l,k[i].index);p.push({data:I,index:y})}var g=e.chnNumber,v=[];if(g)for(i=0;i<g.length;i++){h=luckysheet.dropCell.getLenS(g[i].index,o),d=g[i].index.length*n+h;I="1"==s||"3"==s?luckysheet.dropCell.getDataByType(g[i].data,d,a,s,"chnNumber"):"2"==s||"8"==s?luckysheet.dropCell.getDataByType(g[i].data,d,a,s):luckysheet.dropCell.getDataByType(g[i].data,d,a,"0");y=luckysheet.dropCell.getDataIndex(t,l,g[i].index);v.push({data:I,index:y})}var b=e.chnWeek2,_=[];if(b)for(i=0;i<b.length;i++){h=luckysheet.dropCell.getLenS(b[i].index,o),d=b[i].index.length*n+h;I="1"==s||"3"==s?luckysheet.dropCell.getDataByType(b[i].data,d,a,s,"chnWeek2"):"2"==s?luckysheet.dropCell.getDataByType(b[i].data,d,a,s):luckysheet.dropCell.getDataByType(b[i].data,d,a,"0");y=luckysheet.dropCell.getDataIndex(t,l,b[i].index);_.push({data:I,index:y})}var w=e.chnWeek3,x=[];if(w)for(i=0;i<w.length;i++){h=luckysheet.dropCell.getLenS(w[i].index,o),d=w[i].index.length*n+h;I="1"==s||"3"==s?luckysheet.dropCell.getDataByType(w[i].data,d,a,s,"chnWeek3"):"2"==s?luckysheet.dropCell.getDataByType(w[i].data,d,a,s):luckysheet.dropCell.getDataByType(w[i].data,d,a,"0");y=luckysheet.dropCell.getDataIndex(t,l,w[i].index);x.push({data:I,index:y})}var C=e.other,T=[];if(C)for(i=0;i<C.length;i++){var I,h=luckysheet.dropCell.getLenS(C[i].index,o),d=C[i].index.length*n+h;I="2"==s||"3"==s?luckysheet.dropCell.getDataByType(C[i].data,d,a,s):luckysheet.dropCell.getDataByType(C[i].data,d,a,"0");y=luckysheet.dropCell.getDataIndex(t,l,C[i].index);T.push({data:I,index:y})}for(var $=1;$<=l;$++){if(0<u.length)for(var R=0;R<u.length;R++)$ in u[R].index&&r.push(u[R].data[u[R].index[$]]);if(0<m.length)for(R=0;R<m.length;R++)$ in m[R].index&&r.push(m[R].data[m[R].index[$]]);if(0<p.length)for(R=0;R<p.length;R++)$ in p[R].index&&r.push(p[R].data[p[R].index[$]]);if(0<v.length)for(R=0;R<v.length;R++)$ in v[R].index&&r.push(v[R].data[v[R].index[$]]);if(0<_.length)for(R=0;R<_.length;R++)$ in _[R].index&&r.push(_[R].data[_[R].index[$]]);if(0<x.length)for(R=0;R<x.length;R++)$ in x[R].index&&r.push(x[R].data[x[R].index[$]]);if(0<T.length)for(R=0;R<T.length;R++)$ in T[R].index&&r.push(T[R].data[T[R].index[$]])}return r},getLenS:function(e,t){for(var l=0,r=0;r<e.length&&e[r]<=t;r++)l++;return l},getDataIndex:function(e,t,l){var r={},a=Math.floor(t/e),s=t%e,n=0;if(0<a){for(var o=1;o<=a;o++)for(var c=0;c<l.length;c++)r[l[c]+(o-1)*e]=n,n++;for(var u=0;u<l.length&&l[u]<=s;u++)r[l[u]+e*a]=n,n++}else for(u=0;u<l.length&&l[u]<=s;u++)r[l[u]]=n,n++;return r},getDataByType:function(e,t,l,r,a){var s,n,o,c,u=[];if("0"==r)"up"!=l&&"left"!=l||e.reverse(),u=luckysheet.dropCell.FillCopy(e,t);else if("1"==r)if("number"==a)u=luckysheet.dropCell.FillSeries(e,t,l);else if("extendNumber"==a)if(1==e.length){"down"==l||"right"==l?b=1:"up"!=l&&"left"!=l||(b=-1),u=luckysheet.dropCell.FillExtendNumber(e,t,b)}else{for(var i=[],h=0;h<e.length;h++){var d=e[h].m;i.push(Number(luckysheet.dropCell.isExtendNumber(d)[2]))}"up"!=l&&"left"!=l||(e.reverse(),i.reverse()),u=luckysheet.dropCell.isEqualDiff(i)?(b=i[1]-i[0],luckysheet.dropCell.FillExtendNumber(e,t,b)):luckysheet.dropCell.FillCopy(e,t)}else if("date"==a){u=1==e.length?("down"==l||"right"==l?b=1:"up"!=l&&"left"!=l||(b=-1),luckysheet.dropCell.FillDays(e,t,b)):("up"!=l&&"left"!=l||e.reverse(),(o=luckysheet.dropCell.judgeDate(e))[0]&&o[3]?(b=moment(e[1].m).diff(moment(e[0].m),"months"),luckysheet.dropCell.FillMonths(e,t,b)):!o[0]&&o[2]?(b=moment(e[1].m).diff(moment(e[0].m),"days"),luckysheet.dropCell.FillDays(e,t,b)):luckysheet.dropCell.FillCopy(e,t))}else if("chnNumber"==a)if(1==e.length){u="日"==e[0].m||luckysheet.dropCell.ChineseToNumber(e[0].m)<7?("down"==l||"right"==l?b=1:"up"!=l&&"left"!=l||(b=-1),luckysheet.dropCell.FillChnWeek(e,t,b)):("down"==l||"right"==l?b=1:"up"!=l&&"left"!=l||(b=-1),luckysheet.dropCell.FillChnNumber(e,t,b))}else{for(var y=!1,h=0;h<e.length;h++)if("日"==e[h].m){y=!0;break}for(var i=[],f=0,h=0;h<e.length;h++)"日"==e[h].m?0==h?i.push(0):(f++,i.push(7*f)):y&&0<luckysheet.dropCell.ChineseToNumber(e[h].m)&&luckysheet.dropCell.ChineseToNumber(e[h].m)<7?i.push(luckysheet.dropCell.ChineseToNumber(e[h].m)+7*f):i.push(luckysheet.dropCell.ChineseToNumber(e[h].m));"up"!=l&&"left"!=l||(e.reverse(),i.reverse()),u=luckysheet.dropCell.isEqualDiff(i)?y||i[i.length-1]<6&&0<i[0]||i[0]<6&&0<i[i.length-1]?(b=i[1]-i[0],luckysheet.dropCell.FillChnWeek(e,t,b)):(b=i[1]-i[0],luckysheet.dropCell.FillChnNumber(e,t,b)):luckysheet.dropCell.FillCopy(e,t)}else if("chnWeek2"==a)if(1==e.length){"down"==l||"right"==l?b=1:"up"!=l&&"left"!=l||(b=-1),u=luckysheet.dropCell.FillChnWeek2(e,t,b)}else{for(i=[],f=0,h=0;h<e.length;h++){var m=e[h].m.substr(e[h].m.length-1,1);"周日"==e[h].m?0==h?i.push(0):(f++,i.push(7*f)):i.push(luckysheet.dropCell.ChineseToNumber(m)+7*f)}"up"!=l&&"left"!=l||(e.reverse(),i.reverse()),u=luckysheet.dropCell.isEqualDiff(i)?(b=i[1]-i[0],luckysheet.dropCell.FillChnWeek2(e,t,b)):luckysheet.dropCell.FillCopy(e,t)}else if("chnWeek3"==a)if(1==e.length){"down"==l||"right"==l?b=1:"up"!=l&&"left"!=l||(b=-1),u=luckysheet.dropCell.FillChnWeek3(e,t,b)}else{for(i=[],f=0,h=0;h<e.length;h++){m=e[h].m.substr(e[h].m.length-1,1);"星期日"==e[h].m?0==h?i.push(0):(f++,i.push(7*f)):i.push(luckysheet.dropCell.ChineseToNumber(m)+7*f)}"up"!=l&&"left"!=l||(e.reverse(),i.reverse()),u=luckysheet.dropCell.isEqualDiff(i)?(b=i[1]-i[0],luckysheet.dropCell.FillChnWeek3(e,t,b)):luckysheet.dropCell.FillCopy(e,t)}else"up"!=l&&"left"!=l||e.reverse(),u=luckysheet.dropCell.FillCopy(e,t);else if("2"==r)"up"!=l&&"left"!=l||e.reverse(),u=luckysheet.dropCell.FillOnlyFormat(e,t);else if("3"==r){var k=luckysheet.dropCell.getDataByType(e,t,l,"1",a);u=luckysheet.dropCell.FillWithoutFormat(k)}else if("4"==r){u=1==e.length?("down"==l||"right"==l?b=1:"up"!=l&&"left"!=l||(b=-1),luckysheet.dropCell.FillDays(e,t,b)):2==e.length?("up"!=l&&"left"!=l||e.reverse(),b=moment(e[1].m).diff(moment(e[0].m),"days"),luckysheet.dropCell.FillDays(e,t,b)):("up"!=l&&"left"!=l||e.reverse(),(o=luckysheet.dropCell.judgeDate(e))[0]&&o[3]?(b=moment(e[1].m).diff(moment(e[0].m),"months"),luckysheet.dropCell.FillMonths(e,t,b)):!o[0]&&o[2]?(b=moment(e[1].m).diff(moment(e[0].m),"days"),luckysheet.dropCell.FillDays(e,t,b)):luckysheet.dropCell.FillCopy(e,t))}else if("5"==r)if(1==e.length){"down"==l||"right"==l?b=1:"up"!=l&&"left"!=l||(b=-1);for(var p=Math.round(1.5*t),h=1;h<=p;h++){var g=$.extend(!0,{},e[0]);if(0!=(x=moment(g.m).add(h,"days").day())&&6!=x){var v=moment(g.m).add(b*h,"days").format("YYYY-MM-DD");if(g.m=v,g.v=luckysheet.mask.genarate(v)[2],u.push(g),u.length==t)break}}}else if(2==e.length)if(moment(e[1].m).date()==moment(e[0].m).date()&&0!=moment(e[1].m).diff(moment(e[0].m),"months")){"up"!=l&&"left"!=l||e.reverse();for(var b=moment(e[1].m).diff(moment(e[0].m),"months"),h=1;h<=t;h++){var _=(h-1)%e.length,g=$.extend(!0,{},e[_]);v=0==(x=moment(e[e.length-1]).add(b*h,"months").day())?moment(e[e.length-1]).add(b*h,"months").subtract(2,"days").format("YYYY-MM-DD"):6==x?moment(e[e.length-1]).add(b*h,"months").subtract(1,"days").format("YYYY-MM-DD"):moment(e[e.length-1]).add(b*h,"months").format("YYYY-MM-DD"),g.m=v,g.v=luckysheet.mask.genarate(v)[2],u.push(g)}}else if(7<Math.abs(moment(e[1].m).diff(moment(e[0].m)))){"down"==l||"right"==l?n=1:"up"!=l&&"left"!=l||(n=-1,e.reverse());for(h=1;h<=t;h++){var _=(h-1)%e.length,g=$.extend(!0,{},e[_]),w=Math.ceil(h/e.length);0==_&&(b=moment(g.m).add(n*w,"months").diff(moment(g.m),"days")),v=0==(x=moment(g.m).add(b,"days").day())?moment(g.m).add(b,"days").subtract(2,"days").format("YYYY-MM-DD"):6==x?moment(g.m).add(b,"days").subtract(1,"days").format("YYYY-MM-DD"):moment(g.m).add(b,"days").format("YYYY-MM-DD"),g.m=v,g.v=luckysheet.mask.genarate(v)[2],u.push(g)}}else{"down"==l||"right"==l?s=7:"up"!=l&&"left"!=l||(s=-7,e.reverse());for(h=1;h<=t;h++){_=(h-1)%e.length,g=$.extend(!0,{},e[_]),w=Math.ceil(h/e.length);0==_&&(b=moment(g.m).add(s*w,"days").diff(moment(g.m),"days")),v=0==(x=moment(g.m).add(b,"days").day())?moment(g.m).add(b,"days").subtract(2,"days").format("YYYY-MM-DD"):6==x?moment(g.m).add(b,"days").subtract(1,"days").format("YYYY-MM-DD"):moment(g.m).add(b,"days").format("YYYY-MM-DD"),g.m=v,g.v=luckysheet.mask.genarate(v)[2],u.push(g)}}else{if((o=luckysheet.dropCell.judgeDate(e))[0]&&o[3]){"up"!=l&&"left"!=l||e.reverse();for(var b=moment(e[1].m).diff(moment(e[0].m),"months"),h=1;h<=t;h++){_=(h-1)%e.length,g=$.extend(!0,{},e[_]);v=0==(x=moment(e[e.length-1].m).add(b*h,"months").day())?moment(e[e.length-1].m).add(b*h,"months").subtract(2,"days").format("YYYY-MM-DD"):6==x?moment(e[e.length-1].m).add(b*h,"months").subtract(1,"days").format("YYYY-MM-DD"):moment(e[e.length-1].m).add(b*h,"months").format("YYYY-MM-DD"),g.m=v,g.v=luckysheet.mask.genarate(v)[2],u.push(g)}}else if(!o[0]&&o[2])if(7<Math.abs(moment(e[1].m).diff(moment(e[0].m)))){"down"==l||"right"==l?n=1:"up"!=l&&"left"!=l||(n=-1,e.reverse());for(h=1;h<=t;h++){_=(h-1)%e.length,g=$.extend(!0,{},e[_]),w=Math.ceil(h/e.length);0==_&&(b=moment(g.m).add(n*w,"months").diff(moment(g.m),"days")),v=0==(x=moment(g.m).add(b,"days").day())?moment(g.m).add(b,"days").subtract(2,"days").format("YYYY-MM-DD"):6==x?moment(g.m).add(b,"days").subtract(1,"days").format("YYYY-MM-DD"):moment(g.m).add(b,"days").format("YYYY-MM-DD"),g.m=v,g.v=luckysheet.mask.genarate(v)[2],u.push(g)}}else{"down"==l||"right"==l?s=7:"up"!=l&&"left"!=l||(s=-7,e.reverse());for(h=1;h<=t;h++){var x,_=(h-1)%e.length,g=$.extend(!0,{},e[_]),w=Math.ceil(h/e.length);0==_&&(b=moment(g.m).add(s*w,"days").diff(moment(g.m),"days")),v=0==(x=moment(g.m).add(b,"days").day())?moment(g.m).add(b,"days").subtract(2,"days").format("YYYY-MM-DD"):6==x?moment(g.m).add(b,"days").subtract(1,"days").format("YYYY-MM-DD"):moment(g.m).add(b,"days").format("YYYY-MM-DD"),g.m=v,g.v=luckysheet.mask.genarate(v)[2],u.push(g)}}else"up"!=l&&"left"!=l||e.reverse(),u=luckysheet.dropCell.FillCopy(e,t)}else if("6"==r){if(1==e.length)"down"==l||"right"==l?b=1:"up"!=l&&"left"!=l||(b=-1),u=luckysheet.dropCell.FillMonths(e,t,b);else if(2==e.length)if(moment(e[1].m).date()==moment(e[0].m).date()&&0!=moment(e[1].m).diff(moment(e[0].m),"months")){"up"!=l&&"left"!=l||e.reverse();var b=moment(e[1].m).diff(moment(e[0].m),"months");u=luckysheet.dropCell.FillMonths(e,t,b)}else{"down"==l||"right"==l?n=1:"up"!=l&&"left"!=l||(n=-1,e.reverse());for(h=1;h<=t;h++){_=(h-1)%e.length,g=$.extend(!0,{},e[_]),w=Math.ceil(h/e.length);0==_&&(b=moment(g.m).add(n*w,"months").diff(moment(g.m),"days"));v=moment(g.m).add(b,"days").format("YYYY-MM-DD");g.m=v,g.v=luckysheet.mask.genarate(v)[2],u.push(g)}}else{if((o=luckysheet.dropCell.judgeDate(e))[0]&&o[3]){"up"!=l&&"left"!=l||e.reverse();var b=moment(e[1].m).diff(moment(e[0].m),"months");u=luckysheet.dropCell.FillMonths(e,t,b)}else if(!o[0]&&o[2]){"down"==l||"right"==l?n=1:"up"!=l&&"left"!=l||(n=-1,e.reverse());for(h=1;h<=t;h++){_=(h-1)%e.length,g=$.extend(!0,{},e[_]),w=Math.ceil(h/e.length);0==_&&(b=moment(g.m).add(n*w,"months").diff(moment(g.m),"days"));v=moment(g.m).add(b,"days").format("YYYY-MM-DD");g.m=v,g.v=luckysheet.mask.genarate(v)[2],u.push(g)}}else"up"!=l&&"left"!=l||e.reverse(),u=luckysheet.dropCell.FillCopy(e,t)}}else if("7"==r){if(1==e.length)"down"==l||"right"==l?b=1:"up"!=l&&"left"!=l||(b=-1),u=luckysheet.dropCell.FillYears(e,t,b);else if(2==e.length)if(moment(e[1].m).date()==moment(e[0].m).date()&&moment(e[1].m).month()==moment(e[0].m).month()&&0!=moment(e[1].m).diff(moment(e[0].m),"years")){"up"!=l&&"left"!=l||e.reverse();var b=moment(e[1].m).diff(moment(e[0].m),"years");u=luckysheet.dropCell.FillYears(e,t,b)}else{"down"==l||"right"==l?c=1:"up"!=l&&"left"!=l||(c=-1,e.reverse());for(h=1;h<=t;h++){_=(h-1)%e.length,g=$.extend(!0,{},e[_]),w=Math.ceil(h/e.length);0==_&&(b=moment(g.m).add(c*w,"years").diff(moment(g.m),"days"));v=moment(g.m).add(b,"days").format("YYYY-MM-DD");g.m=v,g.v=luckysheet.mask.genarate(v)[2],u.push(g)}}else{if((o=luckysheet.dropCell.judgeDate(e))[0]&&o[1]&&o[4]){"up"!=l&&"left"!=l||e.reverse();b=moment(e[1].m).diff(moment(e[0].m),"years");u=luckysheet.dropCell.FillYears(e,t,b)}else if(o[0]&&o[3]||o[2]){"down"==l||"right"==l?c=1:"up"!=l&&"left"!=l||(c=-1,e.reverse());for(h=1;h<=t;h++){_=(h-1)%e.length,g=$.extend(!0,{},e[_]),w=Math.ceil(h/e.length);0==_&&(b=moment(g.m).add(c*w,"years").diff(moment(g.m),"days"));v=moment(g.m).add(b,"days").format("YYYY-MM-DD");g.m=v,g.v=luckysheet.mask.genarate(v)[2],u.push(g)}}else"up"!=l&&"left"!=l||e.reverse(),u=luckysheet.dropCell.FillCopy(e,t)}}else if("8"==r)if(1==e.length){"down"==l||"right"==l?b=1:"up"!=l&&"left"!=l||(b=-1),u=luckysheet.dropCell.FillChnNumber(e,t,b)}else{for(i=[],h=0;h<e.length;h++)i.push(luckysheet.dropCell.ChineseToNumber(e[h].m));"up"!=l&&"left"!=l||(e.reverse(),i.reverse()),u=luckysheet.dropCell.isEqualDiff(i)?(b=i[1]-i[0],luckysheet.dropCell.FillChnNumber(e,t,b)):luckysheet.dropCell.FillCopy(e,t)}return u},FillCopy:function(e,t){for(var l=[],r=1;r<=t;r++){var a=(r-1)%e.length,s=$.extend(!0,{},e[a]);l.push(s)}return l},FillSeries:function(e,t,l){for(var r=[],a=[],s=0;s<e.length;s++)a.push(Number(e[s].v));if(2<e.length&&luckysheet.dropCell.isEqualRatio(a))for(var n=1;n<=t;n++){var o,c=(n-1)%e.length,u=$.extend(!0,{},e[c]);"down"==l||"right"==l?o=Number(e[e.length-1].v)*Math.pow(Number(e[1].v)/Number(e[0].v),n):"up"!=l&&"left"!=l||(o=Number(e[0].v)/Math.pow(Number(e[1].v)/Number(e[0].v),n)),u.v=o,u.m=luckysheet.mask.update(u.ct.fa,o),r.push(u)}else for(var i=luckysheet.dropCell.getXArr(e.length),n=1;n<=t;n++){var h,c=(n-1)%e.length,u=$.extend(!0,{},e[c]);"down"==l||"right"==l?h=luckysheet.dropCell.forecast(e.length+n,a,i):"up"!=l&&"left"!=l||(h=luckysheet.dropCell.forecast(1-n,a,i)),u.v=h,u.m=luckysheet.mask.update(u.ct.fa,h),r.push(u)}return r},FillExtendNumber:function(e,t,l){for(var r=[],a=1;a<=t;a++){var s=(a-1)%e.length,n=$.extend(!0,{},e[s]),o=e[e.length-1].m,c=luckysheet.dropCell.isExtendNumber(o)[1],u=luckysheet.dropCell.isExtendNumber(o)[2],i=Math.abs(Number(u)+l*a);n.v=c+i.toString(),n.m=c+i.toString(),r.push(n)}return r},FillOnlyFormat:function(e,t){for(var l=[],r=1;r<=t;r++){var a=(r-1)%e.length,s=$.extend(!0,{},e[a]);delete s.f,delete s.m,delete s.v,l.push(s)}return l},FillWithoutFormat:function(e){for(var t=[],l=0;l<e.length;l++){var r,a=$.extend(!0,{},e[l]);r=null==a.f?{m:a.v.toString(),v:a.v}:{f:a.f,m:a.v.toString(),v:a.v},t.push(r)}return t},FillDays:function(e,t,l){for(var r=[],a=1;a<=t;a++){var s=(a-1)%e.length,n=$.extend(!0,{},e[s]),o=luckysheet.mask.update("yyyy-MM-dd",n.v),o=moment(o).add(l*a,"days").format("YYYY-MM-DD");n.v=luckysheet.mask.genarate(o)[2],n.m=luckysheet.mask.update(n.ct.fa,n.v),r.push(n)}return r},FillMonths:function(e,t,l){for(var r=[],a=1;a<=t;a++){var s=(a-1)%e.length,n=$.extend(!0,{},e[s]),o=luckysheet.mask.update("yyyy-MM-dd",n.v),o=moment(o).add(l*a,"months").format("YYYY-MM-DD");n.v=luckysheet.mask.genarate(o)[2],n.m=luckysheet.mask.update(n.ct.fa,n.v),r.push(n)}return r},FillYears:function(e,t,l){for(var r=[],a=1;a<=t;a++){var s=(a-1)%e.length,n=$.extend(!0,{},e[s]),o=luckysheet.mask.update("yyyy-MM-dd",n.v),o=moment(o).add(l*a,"years").format("YYYY-MM-DD");n.v=luckysheet.mask.genarate(o)[2],n.m=luckysheet.mask.update(n.ct.fa,n.v),r.push(n)}return r},FillChnWeek:function(e,t,l){for(var r=[],a=1;a<=t;a++){var s,n=(a-1)%e.length,o=$.extend(!0,{},e[n]);(s="日"==e[e.length-1].m?7+l*a:luckysheet.dropCell.ChineseToNumber(e[e.length-1].m)+l*a)<0&&(s=7*Math.ceil(Math.abs(s)/7)+s);var c=s%7;0==c?(o.m="日",o.v="日"):1==c?(o.m="一",o.v="一"):2==c?(o.m="二",o.v="二"):3==c?(o.m="三",o.v="三"):4==c?(o.m="四",o.v="四"):5==c?(o.m="五",o.v="五"):6==c&&(o.m="六",o.v="六"),r.push(o)}return r},FillChnWeek2:function(e,t,l){for(var r=[],a=1;a<=t;a++){var s,n,o,c=(a-1)%e.length,u=$.extend(!0,{},e[c]);(o="周日"==e[e.length-1].m?7+l*a:(n=(s=e[e.length-1].m).substr(s.length-1,1),luckysheet.dropCell.ChineseToNumber(n)+l*a))<0&&(o=7*Math.ceil(Math.abs(o)/7)+o);var i=o%7;0==i?(u.m="周日",u.v="周日"):1==i?(u.m="周一",u.v="周一"):2==i?(u.m="周二",u.v="周二"):3==i?(u.m="周三",u.v="周三"):4==i?(u.m="周四",u.v="周四"):5==i?(u.m="周五",u.v="周五"):6==i&&(u.m="周六",u.v="周六"),r.push(u)}return r},FillChnWeek3:function(e,t,l){for(var r=[],a=1;a<=t;a++){var s,n,o,c=(a-1)%e.length,u=$.extend(!0,{},e[c]);(o="星期日"==e[e.length-1].m?7+l*a:(n=(s=e[e.length-1].m).substr(s.length-1,1),luckysheet.dropCell.ChineseToNumber(n)+l*a))<0&&(o=7*Math.ceil(Math.abs(o)/7)+o);var i=o%7;0==i?(u.m="星期日",u.v="星期日"):1==i?(u.m="星期一",u.v="星期一"):2==i?(u.m="星期二",u.v="星期二"):3==i?(u.m="星期三",u.v="星期三"):4==i?(u.m="星期四",u.v="星期四"):5==i?(u.m="星期五",u.v="星期五"):6==i&&(u.m="星期六",u.v="星期六"),r.push(u)}return r},FillChnNumber:function(e,t,l){for(var r=[],a=1;a<=t;a++){var s,n=(a-1)%e.length,o=$.extend(!0,{},e[n]),c=luckysheet.dropCell.ChineseToNumber(e[e.length-1].m)+l*a;s=c<=0?"零":luckysheet.dropCell.NumberToChinese(c),o.v=s,o.m=s.toString(),r.push(o)}return r},isEqualDiff:function(e){for(var t=!0,l=e[1]-e[0],r=1;r<e.length;r++)if(e[r]-e[r-1]!=l){t=!1;break}return t},isEqualRatio:function(e){for(var t=!0,l=e[1]/e[0],r=1;r<e.length;r++)if(e[r]/e[r-1]!=l){t=!1;break}return t},getXArr:function(e){for(var t=[],l=1;l<=e;l++)t.push(l);return t},forecast:function(e,t,l){function r(e){for(var t=0,l=0;l<e.length;l++)t+=e[l];return t/e.length}for(var a,s=r(l),n=r(t),o=0,c=0,u=0;u<l.length;u++)o+=(l[u]-s)*(t[u]-n),c+=(l[u]-s)*(l[u]-s);var i=n-(a=0==c?1:o/c)*s;return Math.round(1e5*(i+a*e))/1e5},judgeDate:function(e){for(var t=!0,l=!0,r=!0,a=!0,s=!0,n=moment(e[0].m).date(),o=moment(e[0].m).month(),c=moment(e[1].m).diff(moment(e[0].m),"days"),u=moment(e[1].m).diff(moment(e[0].m),"months"),i=moment(e[1].m).diff(moment(e[0].m),"years"),h=1;h<e.length;h++)moment(e[h].m).date()!=n&&(t=!1),moment(e[h].m).month()!=o&&(l=!1),moment(e[h].m).diff(moment(e[h-1].m),"days")!=c&&(r=!1),moment(e[h].m).diff(moment(e[h-1].m),"months")!=u&&(a=!1),moment(e[h].m).diff(moment(e[h-1].m),"years")!=i&&(s=!1);return 0==c&&(r=!1),0==u&&(a=!1),0==i&&(s=!1),[t,l,r,a,s]}},luckysheet.locationCell={createDialog:function(){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-locationCell-dialog").remove();$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-locationCell-dialog",addclass:"luckysheet-locationCell-dialog",title:"定位条件",content:'<div class="listbox"><div class="listItem"><input type="radio" name="locationType" checked="checked" id="locationConstant"><label for="locationConstant">常量</label><div class="subbox"><div class="subItem"><input type="checkbox" checked="checked" class="date" id="locationConstantDate"><label for="locationConstantDate">日期</label></div><div class="subItem"><input type="checkbox" checked="checked" class="number" id="locationConstantNumber"><label for="locationConstantNumber">数字</label></div><div class="subItem"><input type="checkbox" checked="checked" class="string" id="locationConstantString"><label for="locationConstantString">字符</label></div><div class="subItem"><input type="checkbox" checked="checked" class="boolean" id="locationConstantBoolean"><label for="locationConstantBoolean">逻辑值</label></div><div class="subItem"><input type="checkbox" checked="checked" class="error" id="locationConstantError"><label for="locationConstantError">错误</label></div></div></div><div class="listItem"><input type="radio" name="locationType" id="locationFormula"><label for="locationFormula">公式</label><div class="subbox"><div class="subItem"><input type="checkbox" checked="checked" class="date" id="locationFormulaDate" disabled="true"><label for="locationFormulaDate" style="color: #666">日期</label></div><div class="subItem"><input type="checkbox" checked="checked" class="number" id="locationFormulaNumber" disabled="true"><label for="locationFormulaNumber" style="color: #666">数字</label></div><div class="subItem"><input type="checkbox" checked="checked" class="string" id="locationFormulaString" disabled="true"><label for="locationFormulaString" style="color: #666">字符</label></div><div class="subItem"><input type="checkbox" checked="checked" class="boolean" id="locationFormulaBoolean" disabled="true"><label for="locationFormulaBoolean" style="color: #666">逻辑值</label></div><div class="subItem"><input type="checkbox" checked="checked" class="error" id="locationFormulaError" disabled="true"><label for="locationFormulaError" style="color: #666">错误</label></div></div></div><div class="listItem"><input type="radio" name="locationType" id="locationNull"><label for="locationNull">空值</label></div><div class="listItem"><input type="radio" name="locationType" id="locationCF"><label for="locationCF">条件格式</label></div><div class="listItem"><input type="radio" name="locationType" id="locationStepRow"><label for="locationStepRow">间隔行</label></div><div class="listItem"><input type="radio" name="locationType" id="locationStepColumn"><label for="locationStepColumn">间隔列</label></div></div>',botton:'<button id="luckysheet-locationCell-dialog-confirm" class="btn btn-primary">确定</button><button class="btn btn-default luckysheet-model-close-btn">取消</button>',style:"z-index:100003"}));var e=$("#luckysheet-locationCell-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),t=e.outerHeight(),l=e.outerWidth(),r=$(window).width(),a=$(window).height(),s=$(document).scrollLeft(),n=$(document).scrollTop();$("#luckysheet-locationCell-dialog").css({left:(r+s-l)/2,top:(a+n-t)/3}).show()},init:function(){$(document).on("click","#luckysheet-locationCell-dialog .listItem input:radio",function(e){$("#luckysheet-locationCell-dialog .listItem input:checkbox").prop("disabled",!0),$("#luckysheet-locationCell-dialog .listItem .subbox label").css("color","#666"),$(this).siblings(".subbox").find("input:checkbox").removeAttr("disabled"),$(this).siblings(".subbox").find("label").css("color","#000")}),$(document).off("click.locationCellConfirm").on("click.locationCellConfirm","#luckysheet-locationCell-dialog #luckysheet-locationCell-dialog-confirm",function(){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-locationCell-dialog").hide();var e=$("#luckysheet-locationCell-dialog .listItem input:radio:checked"),t=e.attr("id");if("locationConstant"==t||"locationFormula"==t){var l=e.siblings(".subbox").find("input:checkbox:checked");if(0==l.length)return;if(5==l.length)var r="all";else{for(var a=[],s=0;s<l.length;s++)$(l[s]).hasClass("date")?a.push("d"):$(l[s]).hasClass("number")?a.push("n"):$(l[s]).hasClass("string")?a.push("s,g"):$(l[s]).hasClass("boolean")?a.push("b"):$(l[s]).hasClass("error")&&a.push("e");r=a.join(",")}n=0==luckysheet_select_save.length||1==luckysheet_select_save.length&&luckysheet_select_save[0].row[0]==luckysheet_select_save[0].row[1]&&luckysheet_select_save[0].column[0]==luckysheet_select_save[0].column[1]?[{row:[0,luckysheet.flowdata.length-1],column:[0,luckysheet.flowdata[0].length-1]}]:$.extend(!0,[],luckysheet_select_save),luckysheet.locationCell.apply(n,t,r)}else if("locationStepRow"==t){if(0==luckysheet_select_save.length||1==luckysheet_select_save.length&&luckysheet_select_save[0].row[0]==luckysheet_select_save[0].row[1])return void(luckysheet.isEditMode()?alert("请选择最少两行"):luckysheet.tooltip.info("提示","请选择最少两行"));var n=$.extend(!0,[],luckysheet_select_save);luckysheet.locationCell.apply(n,"locationStepRow")}else if("locationStepColumn"==t){if(0==luckysheet_select_save.length||1==luckysheet_select_save.length&&luckysheet_select_save[0].column[0]==luckysheet_select_save[0].column[1])return void(luckysheet.isEditMode()?alert("请选择最少两列"):luckysheet.tooltip.info("提示","请选择最少两列"));var n=$.extend(!0,[],luckysheet_select_save);luckysheet.locationCell.apply(n,"locationStepColumn")}else{n=0==luckysheet_select_save.length||1==luckysheet_select_save.length&&luckysheet_select_save[0].row[0]==luckysheet_select_save[0].row[1]&&luckysheet_select_save[0].column[0]==luckysheet_select_save[0].column[1]?[{row:[0,luckysheet.flowdata.length-1],column:[0,luckysheet.flowdata[0].length-1]}]:$.extend(!0,[],luckysheet_select_save),luckysheet.locationCell.apply(n,t)}})},apply:function(range,type,value){var rangeArr=[],str,str,str,str,scrollLeft,scrollTop,winH,winW,row,row_pre,col,col_pre;if("locationFormula"==type||"locationConstant"==type||"locationNull"==type||"locationCF"==type){if("locationFormula"==type)str="all"==value?"luckysheet.flowdata[r] != null && luckysheet.flowdata[r][c] != null && luckysheet.flowdata[r][c].v != null && luckysheet.flowdata[r][c].f != null":"luckysheet.flowdata[r] != null && luckysheet.flowdata[r][c] != null && luckysheet.flowdata[r][c].v != null && luckysheet.flowdata[r][c].f != null && luckysheet.flowdata[r][c].ct != null && value.indexOf(luckysheet.flowdata[r][c].ct.t) != -1";else if("locationConstant"==type){str="all"==value?"luckysheet.flowdata[r] != null && luckysheet.flowdata[r][c] != null && luckysheet.flowdata[r][c].v != null && luckysheet.flowdata[r][c].f == null && luckysheet.flowdata[r][c].ct != null":"luckysheet.flowdata[r] != null && luckysheet.flowdata[r][c] != null && luckysheet.flowdata[r][c].v != null && luckysheet.flowdata[r][c].f == null && luckysheet.flowdata[r][c].ct != null && value.indexOf(luckysheet.flowdata[r][c].ct.t) != -1"}else if("locationNull"==type)var str="luckysheet.flowdata[r] != null && (luckysheet.flowdata[r][c] == null || luckysheet.flowdata[r][c].v == null || luckysheet.flowdata[r][c].v == '') ";else if("locationCF"==type){var index=luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex),ruleArr=luckysheetfile[index].luckysheet_conditionformat_save,data=luckysheetfile[index].data,computeMap=luckysheet.conditionformat.compute(ruleArr,data);if("{}"==JSON.stringify(computeMap))return void(luckysheet.isEditMode()?alert("未找到单元格"):luckysheet.tooltip.info("提示","未找到单元格"));var str="(r + '_' + c) in computeMap"}for(var s=0;s<range.length;s++){var st_r=range[s].row[0],ed_r=range[s].row[1],st_c=range[s].column[0],ed_c=range[s].column[1];if(st_r==ed_r)for(var stack_stc=null,stack_edc=null,r=st_r,c=st_c;c<=ed_c;c++)c==st_c?stack_stc=eval(str)?c:null:c==ed_c?eval(str)?null==stack_stc?rangeArr.push({row:[st_r,ed_r],column:[ed_c,ed_c]}):rangeArr.push({row:[st_r,ed_r],column:[stack_stc,ed_c]}):null==stack_edc&&null!=stack_stc?rangeArr.push({row:[st_r,ed_r],column:[stack_stc,stack_stc]}):null!=stack_edc&&rangeArr.push({row:[st_r,ed_r],column:[stack_stc,stack_edc]}):eval(str)?null==stack_stc?stack_stc=c:stack_edc=c:null==stack_edc&&null!=stack_stc?(rangeArr.push({row:[st_r,ed_r],column:[stack_stc,stack_stc]}),stack_stc=null):null!=stack_edc&&(rangeArr.push({row:[st_r,ed_r],column:[stack_stc,stack_edc]}),stack_stc=null,stack_edc=null);else{for(var stack={},r=st_r;r<=ed_r;r++){stack[r]=[];for(var stack_stc=null,stack_edc=null,c=st_c;c<=ed_c;c++)c==ed_c?eval(str)?null==stack_stc?stack[r].push({status:!1,range:[ed_c,ed_c]}):stack[r].push({status:!1,range:[stack_stc,ed_c]}):null==stack_edc&&null!=stack_stc?stack[r].push({status:!1,range:[stack_stc,stack_stc]}):null!=stack_edc&&stack[r].push({status:!1,range:[stack_stc,stack_edc]}):c==st_c?stack_stc=eval(str)?c:null:eval(str)?null==stack_stc?stack_stc=c:stack_edc=c:null==stack_edc&&null!=stack_stc?(stack[r].push({status:!1,range:[stack_stc,stack_stc]}),stack_stc=null):null!=stack_edc&&(stack[r].push({status:!1,range:[stack_stc,stack_edc]}),stack_stc=null,stack_edc=null)}for(var i=st_r;i<=ed_r;i++)if(i==ed_r){if(0<stack[i].length)for(var j=0;j<stack[i].length;j++)stack[i][j].status||rangeArr.push({row:[ed_r,ed_r],column:stack[i][j].range})}else if(0<stack[i].length)for(var j=0;j<stack[i].length;j++)if(!stack[i][j].status){for(var b=0,a=1;a<ed_r-i&&(null!=stack[i+a][j]&&stack[i+a][j].range[0]==stack[i][j].range[0]&&stack[i+a][j].range[1]==stack[i][j].range[1]);a++)b=a,stack[i+a][j].status=!0;rangeArr.push({row:[i,i+b],column:stack[i][j].range})}}}}else if("locationStepRow"==type){for(var s=0;s<range.length;s++)if(range[s].row[0]!=range[s].row[1])for(var st_r=range[s].row[0],ed_r=range[s].row[1],st_c=range[s].column[0],ed_c=range[s].column[1],r=st_r;r<=ed_r;r++)(r-st_r)%2==0&&rangeArr.push({row:[r,r],column:[st_c,ed_c]})}else if("locationStepColumn"==type)for(var s=0;s<range.length;s++)if(range[s].column[0]!=range[s].column[1])for(var st_r=range[s].row[0],ed_r=range[s].row[1],st_c=range[s].column[0],ed_c=range[s].column[1],c=st_c;c<=ed_c;c++)(c-st_c)%2==0&&rangeArr.push({row:[st_r,ed_r],column:[c,c]});0==rangeArr.length?luckysheet.isEditMode()?alert("未找到单元格"):luckysheet.tooltip.info("提示","未找到单元格"):(luckysheet_select_save=rangeArr,luckysheet.selectHightlightShow(),scrollLeft=$("#luckysheet-cell-main").scrollLeft(),scrollTop=$("#luckysheet-cell-main").scrollTop(),winH=$("#luckysheet-cell-main").height(),winW=$("#luckysheet-cell-main").width(),row=visibledatarow[luckysheet_select_save[0].row[1]],row_pre=luckysheet_select_save[0].row[0]-1==-1?0:visibledatarow[luckysheet_select_save[0].row[0]-1],col=visibledatacolumn[luckysheet_select_save[0].column[1]],col_pre=luckysheet_select_save[0].column[0]-1==-1?0:visibledatacolumn[luckysheet_select_save[0].column[0]-1],0<col-scrollLeft-winW+20?$("#luckysheet-scrollbar-x").scrollLeft(col-winW+20):col_pre-scrollLeft-20<0&&$("#luckysheet-scrollbar-x").scrollLeft(col_pre-20),0<row-scrollTop-winH+20?$("#luckysheet-scrollbar-y").scrollTop(row-winH+20):row_pre-scrollTop-20<0&&$("#luckysheet-scrollbar-y").scrollTop(row_pre-20))}},luckysheet.moreFormat={moneyFmtList:[{name:"人民币",pos:"before",value:"¥"},{name:"美元",pos:"before",value:"$"},{name:"欧元",pos:"before",value:"€"},{name:"英镑",pos:"before",value:"￡"},{name:"港元",pos:"before",value:"$"},{name:"日元",pos:"before",value:"￥"},{name:"阿尔巴尼亚列克",pos:"before",value:"Lek"},{name:"阿尔及利亚第纳尔",pos:"before",value:"din"},{name:"阿富汗尼",pos:"after",value:"Af"},{name:"阿根廷比索",pos:"before",value:"$"},{name:"阿拉伯联合酋长国迪拉姆",pos:"before",value:"dh"},{name:"阿鲁巴弗罗林",pos:"before",value:"Afl"},{name:"阿曼里亚尔",pos:"before",value:"Rial"},{name:"阿塞拜疆马纳特",pos:"before",value:"?"},{name:"埃及镑",pos:"before",value:"￡"},{name:"埃塞俄比亚比尔",pos:"before",value:"Birr"},{name:"安哥拉宽扎",pos:"before",value:"Kz"},{name:"澳大利亚元",pos:"before",value:"$"},{name:"澳门元",pos:"before",value:"MOP"},{name:"巴巴多斯元",pos:"before",value:"$"},{name:"巴布亚新几内亚基那",pos:"before",value:"PGK"},{name:"巴哈马元",pos:"before",value:"$"},{name:"巴基斯坦卢比",pos:"before",value:"Rs"},{name:"巴拉圭瓜拉尼",pos:"after",value:"Gs"},{name:"巴林第纳尔",pos:"before",value:"din"},{name:"巴拿马巴波亚",pos:"before",value:"B/"},{name:"巴西里亚伊",pos:"before",value:"R$"},{name:"白俄罗斯卢布",pos:"after",value:"р"},{name:"百慕大元",pos:"before",value:"$"},{name:"保加利亚列弗",pos:"before",value:"lev"},{name:"冰岛克朗",pos:"before",value:"kr"},{name:"波黑可兑换马克",pos:"before",value:"KM"},{name:"波兰兹罗提",pos:"after",value:"z?"},{name:"玻利维亚诺",pos:"before",value:"Bs"},{name:"伯利兹元",pos:"before",value:"$"},{name:"博茨瓦纳普拉",pos:"before",value:"P"},{name:"不丹努扎姆",pos:"before",value:"Nu"},{name:"布隆迪法郎",pos:"before",value:"FBu"},{name:"朝鲜圆",pos:"before",value:"?KP"},{name:"丹麦克朗",pos:"after",value:"kr"},{name:"东加勒比元",pos:"before",value:"$"},{name:"多米尼加比索",pos:"before",value:"RD$"},{name:"俄国卢布",pos:"after",value:"?"},{name:"厄立特里亚纳克法",pos:"before",value:"Nfk"},{name:"非洲金融共同体法郎",pos:"before",value:"CFA"},{name:"菲律宾比索",pos:"before",value:"?"},{name:"斐济元",pos:"before",value:"$"},{name:"佛得角埃斯库多",pos:"before",value:"CVE"},{name:"福克兰群岛镑",pos:"before",value:"￡"},{name:"冈比亚达拉西",pos:"before",value:"GMD"},{name:"刚果法郎",pos:"before",value:"FrCD"},{name:"哥伦比亚比索",pos:"before",value:"$"},{name:"哥斯达黎加科朗",pos:"before",value:"?"},{name:"古巴比索",pos:"before",value:"$"},{name:"古巴可兑换比索",pos:"before",value:"$"},{name:"圭亚那元",pos:"before",value:"$"},{name:"哈萨克斯坦坚戈",pos:"before",value:"?"},{name:"海地古德",pos:"before",value:"HTG"},{name:"韩元",pos:"before",value:"?"},{name:"荷属安的列斯盾",pos:"before",value:"NAf."},{name:"洪都拉斯拉伦皮拉",pos:"before",value:"L"},{name:"吉布提法郎",pos:"before",value:"Fdj"},{name:"吉尔吉斯斯坦索姆",pos:"before",value:"KGS"},{name:"几内亚法郎",pos:"before",value:"FG"},{name:"加拿大元",pos:"before",value:"$"},{name:"加纳塞地",pos:"before",value:"GHS"},{name:"柬埔寨瑞尔",pos:"before",value:"Riel"},{name:"捷克克朗",pos:"after",value:"K?"},{name:"津巴布韦元",pos:"before",value:"$"},{name:"卡塔尔里亚尔",pos:"before",value:"Rial"},{name:"开曼群岛元",pos:"before",value:"$"},{name:"科摩罗法郎",pos:"before",value:"CF"},{name:"科威特第纳尔",pos:"before",value:"din"},{name:"克罗地亚库纳",pos:"before",value:"kn"},{name:"肯尼亚先令",pos:"before",value:"Ksh"},{name:"莱索托洛蒂",pos:"before",value:"LSL"},{name:"老挝基普",pos:"before",value:"?"},{name:"黎巴嫩镑",pos:"before",value:"L￡"},{name:"立陶宛立特",pos:"before",value:"Lt"},{name:"利比亚第纳尔",pos:"before",value:"din"},{name:"利比亚元",pos:"before",value:"$"},{name:"卢旺达法郎",pos:"before",value:"RF"},{name:"罗马尼亚列伊",pos:"before",value:"RON"},{name:"马达加斯加阿里亚里",pos:"before",value:"Ar"},{name:"马尔代夫拉菲亚",pos:"before",value:"Rf"},{name:"马拉维克瓦查",pos:"before",value:"MWK"},{name:"马来西亚林吉特",pos:"before",value:"RM"},{name:"马其顿戴第纳尔",pos:"before",value:"din"},{name:"毛里求斯卢比",pos:"before",value:"MURs"},{name:"毛里塔尼亚乌吉亚",pos:"before",value:"MRO"},{name:"蒙古图格里克",pos:"before",value:"?"},{name:"孟加拉塔卡",pos:"before",value:"?"},{name:"秘鲁新索尔",pos:"before",value:"S/"},{name:"缅甸开亚特",pos:"before",value:"K"},{name:"摩尔多瓦列伊",pos:"before",value:"MDL"},{name:"摩洛哥迪拉姆",pos:"before",value:"dh"},{name:"莫桑比克梅蒂卡尔",pos:"before",value:"MTn"},{name:"墨西哥比索",pos:"before",value:"$"},{name:"纳米比亚元",pos:"before",value:"$"},{name:"南非兰特",pos:"before",value:"R"},{name:"南苏丹镑",pos:"before",value:"￡"},{name:"尼加拉瓜科多巴",pos:"before",value:"C$"},{name:"尼泊尔卢比",pos:"before",value:"Rs"},{name:"尼日利亚奈拉",pos:"before",value:"?"},{name:"挪威克朗",pos:"after",value:"kr"},{name:"乔治亚拉瑞",pos:"before",value:"GEL"},{name:"人民币（离岸）",pos:"before",value:"￥"},{name:"瑞典克朗",pos:"after",value:"kr"},{name:"瑞士法郎",pos:"before",value:"CHF"},{name:"塞尔维亚第纳尔",pos:"before",value:"din"},{name:"塞拉利昂利昂",pos:"before",value:"SLL"},{name:"塞舌尔卢比",pos:"before",value:"SCR"},{name:"沙特里亚尔",pos:"before",value:"Rial"},{name:"圣多美多布拉",pos:"before",value:"Db"},{name:"圣赫勒拿群岛磅",pos:"before",value:"￡"},{name:"斯里兰卡卢比",pos:"before",value:"Rs"},{name:"斯威士兰里兰吉尼",pos:"before",value:"SZL"},{name:"苏丹镑",pos:"before",value:"SDG"},{name:"苏里南元",pos:"before",value:"$"},{name:"所罗门群岛元",pos:"before",value:"$"},{name:"索马里先令",pos:"before",value:"SOS"},{name:"塔吉克斯坦索莫尼",pos:"before",value:"Som"},{name:"太平洋法郎",pos:"after",value:"FCFP"},{name:"泰国铢",pos:"before",value:"?"},{name:"坦桑尼亚先令",pos:"before",value:"TSh"},{name:"汤加潘加",pos:"before",value:"T$"},{name:"特立尼达和多巴哥元",pos:"before",value:"$"},{name:"突尼斯第纳尔",pos:"before",value:"din"},{name:"土耳其里拉",pos:"before",value:"?"},{name:"瓦努阿图瓦图",pos:"before",value:"VUV"},{name:"危地马拉格查尔",pos:"before",value:"Q"},{name:"委内瑞拉博利瓦",pos:"before",value:"Bs"},{name:"文莱元",pos:"before",value:"$"},{name:"乌干达先令",pos:"before",value:"UGX"},{name:"乌克兰格里夫尼亚",pos:"before",value:"грн."},{name:"乌拉圭比索",pos:"before",value:"$"},{name:"乌兹别克斯坦苏姆",pos:"before",value:"so?m"},{name:"西萨摩亚塔拉",pos:"before",value:"WST"},{name:"新加坡元",pos:"before",value:"$"},{name:"新台币",pos:"before",value:"NT$"},{name:"新西兰元",pos:"before",value:"$"},{name:"匈牙利福林",pos:"before",value:"Ft"},{name:"叙利亚镑",pos:"before",value:"￡"},{name:"牙买加元",pos:"before",value:"$"},{name:"亚美尼亚德拉姆",pos:"before",value:"Dram"},{name:"也门里亚尔",pos:"before",value:"Rial"},{name:"伊拉克第纳尔",pos:"before",value:"din"},{name:"伊朗里亚尔",pos:"before",value:"Rial"},{name:"以色列新谢克尔",pos:"before",value:"?"},{name:"印度卢比",pos:"before",value:"?"},{name:"印度尼西亚卢比",pos:"before",value:"Rp"},{name:"约旦第纳尔",pos:"before",value:"din"},{name:"越南盾",pos:"after",value:"?"},{name:"赞比亚克瓦查",pos:"before",value:"ZMW"},{name:"直布罗陀镑",pos:"before",value:"￡"},{name:"智利比索",pos:"before",value:"$"},{name:"中非金融合作法郎",pos:"before",value:"FCFA"}],dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"1930年8月5日",value:'yyyy"年"M"月"d"日"'},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"8月5日",value:'M"月"d"日"'},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"下午01:30",value:"AM/PM hh:mm"},{name:"下午1:30",value:"AM/PM h:mm"},{name:"下午1:30:30",value:"AM/PM h:mm:ss"},{name:"08-05 下午01:30",value:"MM-dd AM/PM hh:mm"}],numFmtList:[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],createDialog:function(e){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-moreFormat-dialog").remove();var t="",l="";if("morecurrency"==e){t="货币格式";for(var r="",a=0;a<luckysheet.moreFormat.moneyFmtList.length;a++){var s=luckysheet.moreFormat.moneyFmtList[a].name,n=luckysheet.moreFormat.moneyFmtList[a].pos;r+='<div class="listItem"><div class="name">'+s+'</div><div class="value">'+luckysheet.moreFormat.moneyFmtList[a].value+'</div><input type="hidden" value="'+n+'"/></div>'}l='<div class="box" id="morecurrency"><div class="decimal"><label>小数位数：</label><input type="number" class="formulaInputFocus" value="2" min="0" max="9"/></div><div class="listbox">'+r+"</div></div>"}else if("moredatetime"==e){t="日期与时间格式";for(r="",a=0;a<luckysheet.moreFormat.dateFmtList.length;a++){r+='<div class="listItem"><div class="name">'+(s=luckysheet.moreFormat.dateFmtList[a].name)+'</div><div class="value">'+luckysheet.moreFormat.dateFmtList[a].value+"</div></div>"}l='<div class="box" id="moredatetime"><div class="listbox">'+r+"</div></div>"}else if("moredigit"==e){t="数字格式";for(r="",a=0;a<luckysheet.moreFormat.numFmtList.length;a++){r+='<div class="listItem"><div class="name">'+(s=luckysheet.moreFormat.numFmtList[a].name)+'</div><div class="value">'+luckysheet.moreFormat.numFmtList[a].value+"</div></div>"}l='<div class="box" id="moredigit"><div class="listbox">'+r+"</div></div>"}$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-moreFormat-dialog",addclass:"luckysheet-moreFormat-dialog",title:t,content:l,botton:'<button id="luckysheet-moreFormat-dialog-confirm" class="btn btn-primary">确定</button><button class="btn btn-default luckysheet-model-close-btn">取消</button>',style:"z-index:100003"}));var o=$("#luckysheet-moreFormat-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),c=o.outerHeight(),u=o.outerWidth(),i=$(window).width(),h=$(window).height(),d=$(document).scrollLeft(),y=$(document).scrollTop();$("#luckysheet-moreFormat-dialog").css({left:(i+d-u)/2,top:(h+y-c)/3}).show(),$("#luckysheet-moreFormat-dialog .listbox .listItem").eq(0).addClass("on")},init:function(){$(document).on("click","#luckysheet-moreFormat-dialog .listbox .listItem",function(){$(this).addClass("on").siblings().removeClass("on")}),$(document).off("click.moreFormatConfirm").on("click.moreFormatConfirm","#luckysheet-moreFormat-dialog #luckysheet-moreFormat-dialog-confirm",function(){$("#luckysheet-moreFormat-dialog").hide(),$("#luckysheet-modal-dialog-mask").hide();var e=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),t=$("#luckysheet-moreFormat-dialog .listbox .listItem.on .value").text(),l=$(this).parents("#luckysheet-moreFormat-dialog").find(".box").attr("id");if("morecurrency"==l){if(-1!=t.indexOf("?"))return;var r=parseInt($("#luckysheet-moreFormat-dialog .decimal input").val().trim());if("NaN"==r.toString()||r<0||9<r)return void(luckysheet.isEditMode()?alert("小数位数必须在0-9之间！"):luckysheet.tooltip.info("小数位数必须在0-9之间！",""));var a="";if(0<r){for(var s=1;s<=r;s++)a+="0";a="0."+a}else a="#";var n=$("#luckysheet-moreFormat-dialog .listbox .listItem.on input:hidden").val();"before"==n?a='"'+t+'" '+a:"after"==n&&(a=a+' "'+t+'"'),luckysheet.menuButton.updateFormat(e,"ct",a)}else("moredatetime"==l||"moredigit"==l)&&luckysheet.menuButton.updateFormat(e,"ct",t)})}},luckysheet.searchReplace={createDialog:function(e){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-search-replace").remove();$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-search-replace",addclass:"luckysheet-search-replace",title:"",content:'<div class="tabBox"><span id="searchTab">查找</span><span id="replaceTab">替换</span></div><div class="ctBox"><div class="inputBox"><div class="textboxs" id="searchInput">查找内容：<input class="formulaInputFocus" spellcheck="false" value=""/></div><div class="textboxs" id="replaceInput">替换内容：<input class="formulaInputFocus" spellcheck="false" value=""/></div><div class="checkboxs"><div id="regCheck"><input type="checkbox"/><span>正则表达式匹配</span></div><div id="wordCheck"><input type="checkbox"/><span>整词匹配</span></div><div id="caseCheck"><input type="checkbox"/><span>区分大小写匹配</span></div></div></div><div class="btnBox"><button id="replaceAllBtn" class="btn btn-default">全部替换</button><button id="replaceBtn" class="btn btn-default">替换</button><button id="searchAllBtn" class="btn btn-default">查找全部</button><button id="searchNextBtn" class="btn btn-default">查找下一个</button></div></div>',botton:'<button class="btn btn-default luckysheet-model-close-btn">关闭</button>',style:"z-index:100003"}));var t=$("#luckysheet-search-replace").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),l=t.outerHeight(),r=t.outerWidth(),a=$(window).width(),s=$(window).height(),n=$(document).scrollLeft(),o=$(document).scrollTop();$("#luckysheet-search-replace").css({left:(a+n-r)/2,top:(s+o-l)/3}).show(),"0"==e?($("#luckysheet-search-replace #searchTab").addClass("on").siblings().removeClass("on"),$("#luckysheet-search-replace #replaceInput").hide(),$("#luckysheet-search-replace #replaceAllBtn").hide(),$("#luckysheet-search-replace #replaceBtn").hide()):"1"==e&&($("#luckysheet-search-replace #replaceTab").addClass("on").siblings().removeClass("on"),$("#luckysheet-search-replace #replaceInput").show(),$("#luckysheet-search-replace #replaceAllBtn").show(),$("#luckysheet-search-replace #replaceBtn").show())},init:function(){$(document).off("click.SRtabBoxspan").on("click.SRtabBoxspan","#luckysheet-search-replace .tabBox span",function(){$(this).addClass("on").siblings().removeClass("on");var e=$(this).attr("id");"searchTab"==e?($("#luckysheet-search-replace #replaceInput").hide(),$("#luckysheet-search-replace #replaceAllBtn").hide(),$("#luckysheet-search-replace #replaceBtn").hide(),$("#luckysheet-search-replace #searchInput input").focus()):"replaceTab"==e&&($("#luckysheet-search-replace #replaceInput").show(),$("#luckysheet-search-replace #replaceAllBtn").show(),$("#luckysheet-search-replace #replaceBtn").show(),$("#luckysheet-search-replace #replaceInput input").focus())}),$(document).off("keyup.SRsearchInput").on("keyup.SRsearchInput","#luckysheet-search-replace #searchInput input",function(e){e.keyCode==keycode.ENTER&&luckysheet.searchReplace.searchNext()}),$(document).off("click.SRsearchNextBtn").on("click.SRsearchNextBtn","#luckysheet-search-replace #searchNextBtn",function(){luckysheet.searchReplace.searchNext()}),$(document).off("click.SRsearchAllBtn").on("click.SRsearchAllBtn","#luckysheet-search-replace #searchAllBtn",function(){luckysheet.searchReplace.searchAll()}),$(document).off("click.SRsearchAllboxItem").on("click.SRsearchAllboxItem","#luckysheet-search-replace #searchAllbox .boxItem",function(){$(this).addClass("on").siblings().removeClass("on");var e=$(this).attr("data-row"),t=$(this).attr("data-col"),l=$(this).attr("data-sheetIndex");l!=luckysheet.currentSheetIndex&&luckysheet.sheetmanage.changeSheetExec(l),luckysheet_select_save=[{row:[e,e],column:[t,t]}],luckysheet.selectHightlightShow();var r=$("#luckysheet-cell-main").scrollLeft(),a=$("#luckysheet-cell-main").scrollTop(),s=$("#luckysheet-cell-main").height(),n=$("#luckysheet-cell-main").width(),o=visibledatarow[e],c=e-1==-1?0:visibledatarow[e-1],u=visibledatacolumn[t],i=t-1==-1?0:visibledatacolumn[t-1];0<u-r-n+20?$("#luckysheet-scrollbar-x").scrollLeft(u-n+20):i-r-20<0&&$("#luckysheet-scrollbar-x").scrollLeft(i-20),0<o-a-s+20?$("#luckysheet-scrollbar-y").scrollTop(o-s+20):c-a-20<0&&$("#luckysheet-scrollbar-y").scrollTop(c-20)}),$(document).off("click.SRreplaceBtn").on("click.SRreplaceBtn","#luckysheet-search-replace #replaceBtn",function(){luckysheet.searchReplace.replace()}),$(document).off("click.SRreplaceAllBtn").on("click.SRreplaceAllBtn","#luckysheet-search-replace #replaceAllBtn",function(){luckysheet.searchReplace.replaceAll()})},searchNext:function(){var e,t=$("#luckysheet-search-replace #searchInput input").val();if(""!=t&&null!=t){e=0==luckysheet_select_save.length||1==luckysheet_select_save.length&&luckysheet_select_save[0].row[0]==luckysheet_select_save[0].row[1]&&luckysheet_select_save[0].column[0]==luckysheet_select_save[0].column[1]?[{row:[0,luckysheet.flowdata.length-1],column:[0,luckysheet.flowdata[0].length-1]}]:$.extend(!0,[],luckysheet_select_save);var l=luckysheet.searchReplace.getSearchIndexArr(t,e);if(0!=l.length){var r=0;if(0==luckysheet_select_save.length||1==luckysheet_select_save.length&&luckysheet_select_save[0].row[0]==luckysheet_select_save[0].row[1]&&luckysheet_select_save[0].column[0]==luckysheet_select_save[0].column[1]){if(0==luckysheet_select_save.length)r=0;else for(var a=0;a<l.length;a++)if(l[a].r==luckysheet_select_save[0].row[0]&&l[a].c==luckysheet_select_save[0].column[0]){r=a==l.length-1?0:a+1;break}luckysheet_select_save=[{row:[l[r].r,l[r].r],column:[l[r].c,l[r].c]}]}else{for(var s=e[e.length-1].row_focus,n=e[e.length-1].column_focus,a=0;a<l.length;a++)if(l[a].r==s&&l[a].c==n){r=a==l.length-1?0:a+1;break}for(var o=0;o<e.length;o++){var c=e[o].row[0],u=e[o].row[1],i=e[o].column[0],h=e[o].column[1];if(l[r].r>=c&&l[r].r<=u&&l[r].c>=i&&l[r].c<=h){var d=e[o];d.row_focus=l[r].r,d.column_focus=l[r].c,e.splice(o,1),e.push(d);break}}luckysheet_select_save=e}luckysheet.selectHightlightShow();var y=$("#luckysheet-cell-main").scrollLeft(),f=$("#luckysheet-cell-main").scrollTop(),m=$("#luckysheet-cell-main").height(),k=$("#luckysheet-cell-main").width(),p=visibledatarow[l[r].r],g=l[r].r-1==-1?0:visibledatarow[l[r].r-1],v=visibledatacolumn[l[r].c],b=l[r].c-1==-1?0:visibledatacolumn[l[r].c-1];0<v-y-k+20?$("#luckysheet-scrollbar-x").scrollLeft(v-k+20):b-y-20<0&&$("#luckysheet-scrollbar-x").scrollLeft(b-20),0<p-f-m+20?$("#luckysheet-scrollbar-y").scrollTop(p-m+20):g-f-20<0&&$("#luckysheet-scrollbar-y").scrollTop(g-20),$("#searchAllbox").is(":visible")&&$("#luckysheet-search-replace #searchAllbox .boxItem").removeClass("on")}else luckysheet.isEditMode()?alert("没有查找到该内容"):luckysheet.tooltip.info("没有查找到该内容","")}},searchAll:function(){$("#luckysheet-search-replace #searchAllbox").remove();var e,t=$("#luckysheet-search-replace #searchInput input").val();if(""!=t&&null!=t){e=0==luckysheet_select_save.length||1==luckysheet_select_save.length&&luckysheet_select_save[0].row[0]==luckysheet_select_save[0].row[1]&&luckysheet_select_save[0].column[0]==luckysheet_select_save[0].column[1]?[{row:[0,luckysheet.flowdata.length-1],column:[0,luckysheet.flowdata[0].length-1]}]:$.extend(!0,[],luckysheet_select_save);var l=luckysheet.searchReplace.getSearchIndexArr(t,e);if(0!=l.length){for(var r="",a=0;a<l.length;a++){var s=luckysheet.mask.valueShowEs(l[a].r,l[a].c,luckysheet.flowdata).toString();-1<s.indexOf("</")&&-1<s.indexOf(">")?r+='<div class="boxItem" data-row="'+l[a].r+'" data-col="'+l[a].c+'" data-sheetIndex="'+luckysheet.currentSheetIndex+'"><span>'+luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].name+"</span><span>"+luckysheet.luckysheetchatatABC(l[a].c)+(l[a].r+1)+"</span><span>"+s+"</span></div>":r+='<div class="boxItem" data-row="'+l[a].r+'" data-col="'+l[a].c+'" data-sheetIndex="'+luckysheet.currentSheetIndex+'"><span>'+luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].name+"</span><span>"+luckysheet.luckysheetchatatABC(l[a].c)+(l[a].r+1)+'</span><span title="'+s+'">'+s+"</span></div>"}$('<div id="searchAllbox"><div class="boxTitle"><span>工作表</span><span>单元格</span><span>值</span></div><div class="boxMain">'+r+"</div></div>").appendTo($("#luckysheet-search-replace")),$("#luckysheet-search-replace #searchAllbox .boxItem").eq(0).addClass("on").siblings().removeClass("on"),luckysheet_select_save=[{row:[l[0].r,l[0].r],column:[l[0].c,l[0].c]}],luckysheet.selectHightlightShow()}else luckysheet.isEditMode()?alert("没有查找到该内容"):luckysheet.tooltip.info("没有查找到该内容","")}},getSearchIndexArr:function(e,t){var l=[],r={},a=!1;$("#luckysheet-search-replace #regCheck input[type='checkbox']").is(":checked")&&(a=!0);var s=!1;$("#luckysheet-search-replace #wordCheck input[type='checkbox']").is(":checked")&&(s=!0);var n=!1;$("#luckysheet-search-replace #caseCheck input[type='checkbox']").is(":checked")&&(n=!0);for(var o=0;o<t.length;o++)for(var c=t[o].row[0],u=t[o].row[1],i=t[o].column[0],h=t[o].column[1],d=c;d<=u;d++)for(var y,f=i;f<=h;f++){null!=luckysheet.flowdata[d][f]&&(0==(y=luckysheet.mask.valueShowEs(d,f,luckysheet.flowdata))&&(y=y.toString()),null!=y&&""!=y&&(y=y.toString(),s?n?e==y&&(d+"_"+f in r||(r[d+"_"+f]=0,l.push({r:d,c:f}))):e.toLowerCase()==y.toLowerCase()&&(d+"_"+f in r||(r[d+"_"+f]=0,l.push({r:d,c:f}))):a?(n?new RegExp(luckysheet.func_methods.getRegExpStr(e),"g"):new RegExp(luckysheet.func_methods.getRegExpStr(e),"ig")).test(y)&&(d+"_"+f in r||(r[d+"_"+f]=0,l.push({r:d,c:f}))):n?new RegExp(luckysheet.func_methods.getRegExpStr(e),"g").test(y)&&(d+"_"+f in r||(r[d+"_"+f]=0,l.push({r:d,c:f}))):new RegExp(luckysheet.func_methods.getRegExpStr(e),"ig").test(y)&&(d+"_"+f in r||(r[d+"_"+f]=0,l.push({r:d,c:f})))))}return l},replace:function(){var e,t=$("#luckysheet-search-replace #searchInput input").val();if(""!=t&&null!=t){e=0==luckysheet_select_save.length||1==luckysheet_select_save.length&&luckysheet_select_save[0].row[0]==luckysheet_select_save[0].row[1]&&luckysheet_select_save[0].column[0]==luckysheet_select_save[0].column[1]?[{row:[0,luckysheet.flowdata.length-1],column:[0,luckysheet.flowdata[0].length-1]}]:$.extend(!0,[],luckysheet_select_save);var l=luckysheet.searchReplace.getSearchIndexArr(t,e);if(0!=l.length){for(var r=null,a=luckysheet_select_save[luckysheet_select_save.length-1].row_focus,s=luckysheet_select_save[luckysheet_select_save.length-1].column_focus,n=0;n<l.length;n++)if(l[n].r==a&&l[n].c==s){r=n;break}if(null==r){if(0==l.length)return void(luckysheet.isEditMode()?alert("找不到匹配项"):luckysheet.tooltip.info("找不到匹配项",""));r=0}$("#luckysheet-search-replace #regCheck input[type='checkbox']").is(":checked");var o=!1;$("#luckysheet-search-replace #wordCheck input[type='checkbox']").is(":checked")&&(o=!0);var c=!1;$("#luckysheet-search-replace #caseCheck input[type='checkbox']").is(":checked")&&(c=!0);var u,i,h,d,y=$("#luckysheet-search-replace #replaceInput input").val(),f=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata);d=o?(i=l[r].r,h=l[r].c,y):(u=c?new RegExp(luckysheet.func_methods.getRegExpStr(t),"g"):new RegExp(luckysheet.func_methods.getRegExpStr(t),"ig"),i=l[r].r,h=l[r].c,luckysheet.mask.valueShowEs(i,h,f).toString().replace(u,y)),luckysheet.setcellvalue(i,h,f,d),luckysheet_select_save=[{row:[i,i],column:[h,h]}],$("#luckysheet-search-replace #searchAllbox").is(":visible")&&$("#luckysheet-search-replace #searchAllbox").hide(),luckysheet.jfrefreshgrid(f,luckysheet_select_save),luckysheet.selectHightlightShow();var m=$("#luckysheet-cell-main").scrollLeft(),k=$("#luckysheet-cell-main").scrollTop(),p=$("#luckysheet-cell-main").height(),g=$("#luckysheet-cell-main").width(),v=visibledatarow[i],b=i-1==-1?0:visibledatarow[i-1],_=visibledatacolumn[h],w=h-1==-1?0:visibledatacolumn[h-1];0<_-m-g+20?$("#luckysheet-scrollbar-x").scrollLeft(_-g+20):w-m-20<0&&$("#luckysheet-scrollbar-x").scrollLeft(w-20),0<v-k-p+20?$("#luckysheet-scrollbar-y").scrollTop(v-p+20):b-k-20<0&&$("#luckysheet-scrollbar-y").scrollTop(b-20)}else luckysheet.isEditMode()?alert("没有可替换的内容"):luckysheet.tooltip.info("没有可替换的内容","")}else luckysheet.isEditMode()?alert("请输入查找内容"):luckysheet.tooltip.info("请输入查找内容","")},replaceAll:function(){var e=$("#luckysheet-search-replace #searchInput input").val();if(""!=e&&null!=e){o=0==luckysheet_select_save.length||1==luckysheet_select_save.length&&luckysheet_select_save[0].row[0]==luckysheet_select_save[0].row[1]&&luckysheet_select_save[0].column[0]==luckysheet_select_save[0].column[1]?[{row:[0,luckysheet.flowdata.length-1],column:[0,luckysheet.flowdata[0].length-1]}]:$.extend(!0,[],luckysheet_select_save);var t=luckysheet.searchReplace.getSearchIndexArr(e,o);if(0!=t.length){$("#luckysheet-search-replace #regCheck input[type='checkbox']").is(":checked");var l=!1;$("#luckysheet-search-replace #wordCheck input[type='checkbox']").is(":checked")&&(l=!0);var r=!1;$("#luckysheet-search-replace #caseCheck input[type='checkbox']").is(":checked")&&(r=!0);var a,s=$("#luckysheet-search-replace #replaceInput input").val(),n=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),o=[];if(l)for(var c=0;c<t.length;c++){var u=t[c].r,i=t[c].c,h=s;luckysheet.setcellvalue(u,i,n,h),o.push({row:[u,u],column:[i,i]})}else{a=r?new RegExp(luckysheet.func_methods.getRegExpStr(e),"g"):new RegExp(luckysheet.func_methods.getRegExpStr(e),"ig");for(c=0;c<t.length;c++){u=t[c].r,i=t[c].c,h=luckysheet.mask.valueShowEs(u,i,n).toString().replace(a,s);luckysheet.setcellvalue(u,i,n,h),o.push({row:[u,u],column:[i,i]})}}$("#luckysheet-search-replace #searchAllbox").is(":visible")&&$("#luckysheet-search-replace #searchAllbox").hide(),luckysheet.jfrefreshgrid(n,o),luckysheet_select_save=$.extend(!0,[],o),luckysheet.selectHightlightShow(),luckysheet.isEditMode()?alert("已经帮您搜索并进行了"+t.length+"处替换"):luckysheet.tooltip.info("已经帮您搜索并进行了"+t.length+"处替换","")}else luckysheet.isEditMode()?alert("没有可替换的内容"):luckysheet.tooltip.info("没有可替换的内容","")}else luckysheet.isEditMode()?alert("请输入查找内容"):luckysheet.tooltip.info("请输入查找内容","")}},luckysheet.splitColumn={createDialog:function(){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-splitColumn-dialog").remove();$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-splitColumn-dialog",addclass:"luckysheet-splitColumn-dialog",title:"文本分列",content:'<div class="box"><div class="boxTitle">分割符号</div><div class="boxMain"><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_01" type="checkbox"/><label for="splitColumn_type_01">Tab 键</label></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_02" type="checkbox"/><label for="splitColumn_type_02">分号</label></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_03" type="checkbox"/><label for="splitColumn_type_03">逗号</label></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_04" type="checkbox"/><label for="splitColumn_type_04">空格</label></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_05" type="checkbox"/><label for="splitColumn_type_05">其它</label><input type="text" class="formulaInputFocus" maxlength="1"/></div></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_06" type="checkbox"/><label for="splitColumn_type_06">连续分隔符号视为单个处理</label></div><div class="boxTitle" style="margin-top: 10px;">数据预览</div><div class="boxMain" id="splitColumnData"></div></div>',botton:'<button id="luckysheet-splitColumn-dialog-confirm" class="btn btn-primary">确定</button><button class="btn btn-default luckysheet-model-close-btn">关闭</button>',style:"z-index:100003"}));var e=$("#luckysheet-splitColumn-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),t=e.outerHeight(),l=e.outerWidth(),r=$(window).width(),a=$(window).height(),s=$(document).scrollLeft(),n=$(document).scrollTop();$("#luckysheet-splitColumn-dialog").css({left:(r+s-l)/2,top:(a+n-t)/3}).show();var o=luckysheet.splitColumn.getDataArr();luckysheet.splitColumn.dataPreview(o)},init:function(){$(document).off("change.SPCinpcheckbox").on("change.SPCcheckbox","#luckysheet-splitColumn-dialog .box input[type='checkbox']",function(){var e=luckysheet.splitColumn.getRegStr(),t=luckysheet.splitColumn.getDataArr(e);luckysheet.splitColumn.dataPreview(t)}),$(document).off("keyup.SPCinptext").on("keyup.SPCinptext","#luckysheet-splitColumn-dialog .box input[type='text']",function(){var e,t;$(this).siblings("input[type='checkbox']").is(":checked")&&(e=luckysheet.splitColumn.getRegStr(),t=luckysheet.splitColumn.getDataArr(e),luckysheet.splitColumn.dataPreview(t))}),$(document).off("click.SPCconfirm").on("click.SPCconfirm","#luckysheet-splitColumn-dialog #luckysheet-splitColumn-dialog-confirm",function(){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-splitColumn-dialog").hide();var e=luckysheet.splitColumn.getRegStr(),t=luckysheet.splitColumn.getDataArr(e),l=luckysheet_select_save[0].row[0],r=luckysheet_select_save[0].column[0];if(1!=t[0].length){for(var a=!1,s=0;s<t.length;s++)for(var n=1;n<t[0].length;n++){var o=luckysheet.flowdata[l+s][r+n];if(null!=o&&null!=o.v){a=!0;break}}a?luckysheet.tooltip.confirm("提示","此处已有数据，是否替换它？",function(){luckysheet.splitColumn.update(l,r,t)}):luckysheet.splitColumn.update(l,r,t)}})},update:function(e,t,l){for(var r=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),a=0;a<l.length;a++)for(var s=0;s<l[0].length;s++){var n=l[a][s];luckysheet.setcellvalue(e+a,t+s,r,n)}var o=luckysheet_select_save[0].row[0],c=luckysheet_select_save[0].column[0],u=[{row:[o,o+l.length-1],column:[c,c+l[0].length-1]}];luckysheet.jfrefreshgrid(r,u),luckysheet.selectHightlightShow()},dataPreview:function(e){$("#luckysheet-splitColumn-dialog #splitColumnData").empty();for(var t="",l=0;l<e.length;l++){for(var r="",a=0;a<e[0].length;a++)r+="<td>"+e[l][a]+"</td>";t+="<tr>"+r+"</tr>"}var s="<table>"+t+"</table>";$("#luckysheet-splitColumn-dialog #splitColumnData").append(s)},getRegStr:function(){var a="",s=0;return $("#luckysheet-splitColumn-dialog .box input[type='checkbox']:checked").each(function(e,t){var l,r=$(t).attr("id");"splitColumn_type_01"==r?(a+="\\t",s++):"splitColumn_type_02"==r?(0<s&&(a+="|"),a+=";",s++):"splitColumn_type_03"==r?(0<s&&(a+="|"),a+=",",s++):"splitColumn_type_04"==r?(0<s&&(a+="|"),a+="\\s",s++):"splitColumn_type_05"==r?""!=(l=$(t).siblings("input[type='text']").val().trim())&&(0<s&&(a+="|"),a+=l):"splitColumn_type_06"==r&&(a="["+a+"]+")}),a},getDataArr:function(e){var t=[],l=luckysheet_select_save[0].row[0],r=luckysheet_select_save[0].row[1],a=luckysheet_select_save[0].column[0];if(null!=e&&""!=e){for(var s=new RegExp(e,"g"),n=[],o=l;o<=r;o++){var c=[];c=(f=null!=(y=luckysheet.flowdata[o][a])&&null!=y.m?y.m:luckysheet.getcellvalue(o,a,luckysheet.flowdata)).toString().split(s),n.push(c)}for(var u=n.length,i=0,h=0;h<u;h++)n[h].length>i&&(i=n[h].length);t=luckysheet.splitColumn.getNullData(u,i);for(h=0;h<t.length;h++)for(var d=0;d<t[0].length;d++)null!=n[h][d]&&(t[h][d]=n[h][d])}else for(o=l;o<=r;o++){var y,f,c=[];f=null!=(y=luckysheet.flowdata[o][a])&&null!=y.m?y.m:luckysheet.getcellvalue(o,a,luckysheet.flowdata),c.push(f),t.push(c)}return t},getNullData:function(e,t){for(var l=[],r=0;r<e;r++){for(var a=[],s=0;s<t;s++)a.push("");l.push(a)}return l}},luckysheet.postil={defaultWidth:144,defaultHeight:84,currentObj:null,currentWinW:null,currentWinH:null,resize:null,resizeXY:null,move:!1,moveXY:null,init:function(){$("#luckysheet-postil-showBoxs").off("mousedown.showPs").on("mousedown.showPs",".luckysheet-postil-show",function(e){luckysheet.postil.currentObj=$(this).find(".luckysheet-postil-show-main"),$(this).hasClass("luckysheet-postil-show-active")||(luckysheet.postil.removeActivePs(),$(this).addClass("luckysheet-postil-show-active"),$(this).find(".luckysheet-postil-dialog-resize").show(),$(this).find(".arrowCanvas").css("z-index",200),$(this).find(".luckysheet-postil-show-main").css("z-index",200)),e.stopPropagation()}),$("#luckysheet-postil-showBoxs").off("mouseup.showPs").on("mouseup.showPs",".luckysheet-postil-show",function(e){"3"==e.which&&e.stopPropagation()}),$("#luckysheet-postil-showBoxs").off("mousedown.resize").on("mousedown.resize",".luckysheet-postil-show .luckysheet-postil-dialog-resize .luckysheet-postil-dialog-resize-item",function(e){luckysheet.postil.currentObj=$(this).closest(".luckysheet-postil-show-main"),luckysheet.postil.currentWinW=$("#luckysheet-cell-main")[0].scrollWidth,luckysheet.postil.currentWinH=$("#luckysheet-cell-main")[0].scrollHeight,luckysheet.postil.resize=$(this).data("type");var t=$("#luckysheet-cell-main").scrollTop(),l=$("#luckysheet-cell-main").scrollLeft(),r=luckysheet.mouseposition(e.pageX,e.pageY),a=r[0]+l,s=r[1]+t,n=luckysheet.postil.currentObj.position(),o=luckysheet.postil.currentObj.width(),c=luckysheet.postil.currentObj.height();luckysheet.postil.resizeXY=[a,s,o,c,n.left+l,n.top+t,l,t],luckysheet.setluckysheet_scroll_status(!0),$(this).closest(".luckysheet-postil-show").hasClass("luckysheet-postil-show-active")||(luckysheet.postil.removeActivePs(),$(this).closest(".luckysheet-postil-show").addClass("luckysheet-postil-show-active"),$(this).closest(".luckysheet-postil-show").find(".luckysheet-postil-dialog-resize").show(),$(this).closest(".luckysheet-postil-show").find(".arrowCanvas").css("z-index",200),$(this).closest(".luckysheet-postil-show").find(".luckysheet-postil-show-main").css("z-index",200)),e.stopPropagation()}),$("#luckysheet-postil-showBoxs").off("mousedown.move").on("mousedown.move",".luckysheet-postil-show .luckysheet-postil-dialog-move .luckysheet-postil-dialog-move-item",function(e){luckysheet.postil.currentObj=$(this).closest(".luckysheet-postil-show-main"),luckysheet.postil.currentWinW=$("#luckysheet-cell-main")[0].scrollWidth,luckysheet.postil.currentWinH=$("#luckysheet-cell-main")[0].scrollHeight,luckysheet.postil.move=!0;var t=$("#luckysheet-cell-main").scrollTop(),l=$("#luckysheet-cell-main").scrollLeft(),r=luckysheet.postil.currentObj.offset(),a=luckysheet.postil.currentObj.position();luckysheet.postil.moveXY=[e.pageX-r.left,e.pageY-r.top,a.left,a.top,l,t],luckysheet.setluckysheet_scroll_status(!0),$(this).closest(".luckysheet-postil-show").hasClass("luckysheet-postil-show-active")||(luckysheet.postil.removeActivePs(),$(this).closest(".luckysheet-postil-show").addClass("luckysheet-postil-show-active"),$(this).closest(".luckysheet-postil-show").find(".luckysheet-postil-dialog-resize").show(),$(this).closest(".luckysheet-postil-show").find(".arrowCanvas").css("z-index",200),$(this).closest(".luckysheet-postil-show").find(".luckysheet-postil-show-main").css("z-index",200)),e.stopPropagation()})},overshow:function(e){var t,l,r,a,s,n,o,c,u,i,h,d,y,f,m,k;$("#luckysheet-postil-overshow").remove(),0!=$(e.target).closest("#luckysheet-cell-main").length&&(t=luckysheet.mouseposition(e.pageX,e.pageY),l=$("#luckysheet-cell-main").scrollLeft(),r=$("#luckysheet-cell-main").scrollTop(),a=t[0]+l,s=t[1]+r,null!=luckysheet.freezen.freezenverticaldata&&t[0]<luckysheet.freezen.freezenverticaldata[0]-luckysheet.freezen.freezenverticaldata[2]||null!=luckysheet.freezen.freezenhorizontaldata&&t[1]<luckysheet.freezen.freezenhorizontaldata[0]-luckysheet.freezen.freezenhorizontaldata[2]||(n=luckysheet.rowLocation(s)[2],o=luckysheet.colLocation(a)[2],null!=luckysheet.flowdata[n]&&null!=luckysheet.flowdata[n][o]&&null!=luckysheet.flowdata[n][o].ps&&((c=luckysheet.flowdata[n][o].ps).isshow||0<$("#luckysheet-postil-show_"+n+"_"+o).length||(u=null==c.value?"":c.value,d=(i=visibledatacolumn[o])+18,(y=(h=0==n?0:visibledatarow[n-1])-18)<0&&(y=2),m='<div id="luckysheet-postil-overshow"><canvas class="arrowCanvas" width="'+(f=luckysheet.postil.getArrowCanvasSize(d,y,i,h))[2]+'" height="'+f[3]+'" style="position:absolute;left:'+f[0]+"px;top:"+f[1]+'px;z-index:100;"></canvas><div style="width:132px;min-height:72px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:'+d+"px;top:"+y+'px;z-index:100;">'+u+"</div></div>",$(m).appendTo($("#luckysheet-cell-main")),k=$("#luckysheet-postil-overshow .arrowCanvas").get(0).getContext("2d"),luckysheet.postil.drawArrow(k,f[4],f[5],f[6],f[7])))))},getArrowCanvasSize:function(e,t,l,r){var a=l-5;e<l&&(a=e-5);var s=r-5;t<r&&(s=t-5);var n=Math.abs(e-l)+10,o=Math.abs(t-r)+10,c=n-5,u=5;e<l&&(u=n-(c=5));var i=o-5,h=5;return t<r&&(h=o-(i=5)),[a,s,n,o,c,i,u,h]},drawArrow:function(e,t,l,r,a,s,n,o,c){s="undefined"==luckysheet.getObjType(s)?30:s,n="undefined"==luckysheet.getObjType(n)?6:n,o="undefined"==luckysheet.getObjType(o)?1:o,c="undefined"==luckysheet.getObjType(c)?"#000":c;var u=180*Math.atan2(l-a,t-r)/Math.PI,i=(u+s)*Math.PI/180,h=(u-s)*Math.PI/180,d=n*Math.cos(i),y=n*Math.sin(i),f=n*Math.cos(h),m=n*Math.sin(h);e.save(),e.beginPath();var k=t-d,p=l-y;e.moveTo(k,p),e.moveTo(t,l),e.lineTo(r,a),e.lineWidth=o,e.strokeStyle=c,e.stroke(),k=r+d,p=a+y,e.moveTo(k,p),e.lineTo(r,a),k=r+f,p=a+m,e.lineTo(k,p),e.fillStyle=c,e.fill(),e.restore()},buildAllPs:function(e){$("#luckysheet-cell-main #luckysheet-postil-showBoxs").empty();for(var t=0;t<e.length;t++)for(var l,r=0;r<e[0].length;r++){null!=e[t][r]&&null!=e[t][r].ps&&(l=e[t][r].ps,luckysheet.postil.buildPs(t,r,l))}luckysheet.postil.init()},buildPs:function(e,t,l){var r,a,s,n,o,c,u,i,h,d,y;0<$("#luckysheet-postil-show_"+e+"_"+t).length&&$("#luckysheet-postil-show_"+e+"_"+t).remove(),null!=l&&null!=l.isshow&&l.isshow&&(visibledatarow[e],r=e-1==-1?0:visibledatarow[e-1],a=visibledatacolumn[t],t-1==-1||visibledatacolumn[t-1],(s=luckysheet.menuButton.mergeborer(luckysheet.flowdata,e,t))&&(s.row[1],r=s.row[0],a=s.column[1],s.column[0]),n=null==l.left?a+18:l.left,o=null==l.top?r-18:l.top,c=null==l.width?luckysheet.postil.defaultWidth:l.width,u=null==l.height?luckysheet.postil.defaultHeight:l.height,i=null==l.value?"":l.value,o<0&&(o=2),d='<div id="luckysheet-postil-show_'+e+"_"+t+'" class="luckysheet-postil-show"><canvas class="arrowCanvas" width="'+(h=luckysheet.postil.getArrowCanvasSize(n,o,a,r))[2]+'" height="'+h[3]+'" style="position:absolute;left:'+h[0]+"px;top:"+h[1]+'px;z-index:100;"></canvas><div class="luckysheet-postil-show-main" style="width:'+c+"px;height:"+u+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+n+"px;top:"+o+'px;box-sizing:border-box;z-index:100;"><div class="luckysheet-postil-dialog-move"><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-t" data-type="t"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-r" data-type="r"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-b" data-type="b"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-l" data-type="l"></div></div><div class="luckysheet-postil-dialog-resize" style="display:none;"><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lt" data-type="lt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mt" data-type="mt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lm" data-type="lm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rm" data-type="rm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rt" data-type="rt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lb" data-type="lb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mb" data-type="mb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:'+(c-12)+"px;height:"+(u-12)+'px;line-height:18px;word-break:break-all;" spellcheck="false" contenteditable="true">'+i+"</div></div></div></div>",$(d).appendTo($("#luckysheet-cell-main #luckysheet-postil-showBoxs")),y=$("#luckysheet-postil-show_"+e+"_"+t+" .arrowCanvas").get(0).getContext("2d"),luckysheet.postil.drawArrow(y,h[4],h[5],h[6],h[7]))},newPs:function(e,t){var l=visibledatacolumn[t],r=0==e?0:visibledatarow[e-1],a=l+18,s=r-18;s<0&&(s=2);var n=luckysheet.postil.getArrowCanvasSize(a,s,l,r),o='<div id="luckysheet-postil-show_'+e+"_"+t+'" class="luckysheet-postil-show luckysheet-postil-show-active"><canvas class="arrowCanvas" width="'+n[2]+'" height="'+n[3]+'" style="position:absolute;left:'+n[0]+"px;top:"+n[1]+'px;z-index:100;"></canvas><div class="luckysheet-postil-show-main" style="width:144px;height:84px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:'+a+"px;top:"+s+'px;box-sizing:border-box;z-index:100;"><div class="luckysheet-postil-dialog-move"><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-t" data-type="t"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-r" data-type="r"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-b" data-type="b"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-l" data-type="l"></div></div><div class="luckysheet-postil-dialog-resize"><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lt" data-type="lt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mt" data-type="mt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lm" data-type="lm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rm" data-type="rm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rt" data-type="rt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lb" data-type="lb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mb" data-type="mb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:132px;height:72px;line-height:18px;word-break:break-all;" spellcheck="false" contenteditable="true"></div></div></div></div>';$(o).appendTo($("#luckysheet-cell-main #luckysheet-postil-showBoxs"));var c=$("#luckysheet-postil-show_"+e+"_"+t+" .arrowCanvas").get(0).getContext("2d");luckysheet.postil.drawArrow(c,n[4],n[5],n[6],n[7]),$("#luckysheet-postil-show_"+e+"_"+t+" .formulaInputFocus").focus(),luckysheet.postil.init();var u=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),i=[];null==u[e][t]&&(u[e][t]={}),u[e][t].ps={left:null,top:null,width:null,height:null,value:"",isshow:!1},i.push(e+"_"+t),luckysheet.postil.ref(u,i)},editPs:function(e,t){var l,r,a,s,n,o,c,u,i,h,d,y;0<$("#luckysheet-postil-show_"+e+"_"+t).length?($("#luckysheet-postil-show_"+e+"_"+t).show(),$("#luckysheet-postil-show_"+e+"_"+t).addClass("luckysheet-postil-show-active"),$("#luckysheet-postil-show_"+e+"_"+t).find(".luckysheet-postil-dialog-resize").show()):(l=luckysheet.flowdata[e][t].ps,visibledatarow[e],r=e-1==-1?0:visibledatarow[e-1],a=visibledatacolumn[t],t-1==-1||visibledatacolumn[t-1],(s=luckysheet.menuButton.mergeborer(luckysheet.flowdata,e,t))&&(s.row[1],r=s.row[0],a=s.column[1],s.column[0]),n=null==l.left?a+18:l.left,o=null==l.top?r-18:l.top,c=null==l.width?luckysheet.postil.defaultWidth:l.width,u=null==l.height?luckysheet.postil.defaultHeight:l.height,i=null==l.value?"":l.value,o<0&&(o=2),d='<div id="luckysheet-postil-show_'+e+"_"+t+'" class="luckysheet-postil-show luckysheet-postil-show-active"><canvas class="arrowCanvas" width="'+(h=luckysheet.postil.getArrowCanvasSize(n,o,a,r))[2]+'" height="'+h[3]+'" style="position:absolute;left:'+h[0]+"px;top:"+h[1]+'px;z-index:100;"></canvas><div class="luckysheet-postil-show-main" style="width:'+c+"px;height:"+u+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+n+"px;top:"+o+'px;box-sizing:border-box;z-index:100;"><div class="luckysheet-postil-dialog-move"><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-t" data-type="t"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-r" data-type="r"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-b" data-type="b"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-l" data-type="l"></div></div><div class="luckysheet-postil-dialog-resize"><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lt" data-type="lt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mt" data-type="mt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lm" data-type="lm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rm" data-type="rm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rt" data-type="rt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lb" data-type="lb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mb" data-type="mb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:'+(c-12)+"px;height:"+(u-12)+'px;line-height:18px;word-break:break-all;" spellcheck="false" contenteditable="true">'+i+"</div></div></div></div>",$(d).appendTo($("#luckysheet-cell-main #luckysheet-postil-showBoxs")),y=$("#luckysheet-postil-show_"+e+"_"+t+" .arrowCanvas").get(0).getContext("2d"),luckysheet.postil.drawArrow(y,h[4],h[5],h[6],h[7])),$("#luckysheet-postil-show_"+e+"_"+t+" .formulaInputFocus").focus(),luckysheet.luckysheetRangeLast($("#luckysheet-postil-show_"+e+"_"+t+" .formulaInputFocus").get(0)),luckysheet.postil.init()},delPs:function(e,t){0<$("#luckysheet-postil-show_"+e+"_"+t).length&&$("#luckysheet-postil-show_"+e+"_"+t).remove();var l=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),r=[];delete l[e][t].ps,r.push(e+"_"+t),luckysheet.postil.ref(l,r)},showHidePs:function(e,t){var l,r,a,s,n,o,c,u,i,h,d,y=luckysheet.flowdata[e][t].ps,f=y.isshow,m=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),k=[];f?(m[e][t].ps.isshow=!1,$("#luckysheet-postil-show_"+e+"_"+t).remove()):(m[e][t].ps.isshow=!0,visibledatarow[e],l=e-1==-1?0:visibledatarow[e-1],r=visibledatacolumn[t],t-1==-1||visibledatacolumn[t-1],(a=luckysheet.menuButton.mergeborer(luckysheet.flowdata,e,t))&&(a.row[1],l=a.row[0],r=a.column[1],a.column[0]),s=null==y.left?r+18:y.left,n=null==y.top?l-18:y.top,o=null==y.width?luckysheet.postil.defaultWidth:y.width,c=null==y.height?luckysheet.postil.defaultHeight:y.height,u=null==y.value?"":y.value,n<0&&(n=2),h='<div id="luckysheet-postil-show_'+e+"_"+t+'" class="luckysheet-postil-show"><canvas class="arrowCanvas" width="'+(i=luckysheet.postil.getArrowCanvasSize(s,n,r,l))[2]+'" height="'+i[3]+'" style="position:absolute;left:'+i[0]+"px;top:"+i[1]+'px;z-index:100;"></canvas><div class="luckysheet-postil-show-main" style="width:'+o+"px;height:"+c+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+s+"px;top:"+n+'px;box-sizing:border-box;z-index:100;"><div class="luckysheet-postil-dialog-move"><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-t" data-type="t"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-r" data-type="r"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-b" data-type="b"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-l" data-type="l"></div></div><div class="luckysheet-postil-dialog-resize" style="display:none;"><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lt" data-type="lt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mt" data-type="mt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lm" data-type="lm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rm" data-type="rm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rt" data-type="rt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lb" data-type="lb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mb" data-type="mb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:'+(o-12)+"px;height:"+(c-12)+'px;line-height:18px;word-break:break-all;" spellcheck="false" contenteditable="true">'+u+"</div></div></div></div>",$(h).appendTo($("#luckysheet-cell-main #luckysheet-postil-showBoxs")),d=$("#luckysheet-postil-show_"+e+"_"+t+" .arrowCanvas").get(0).getContext("2d"),luckysheet.postil.drawArrow(d,i[4],i[5],i[6],i[7]),luckysheet.postil.init()),k.push(e+"_"+t),luckysheet.postil.ref(m,k)},showHideAllPs:function(){for(var e=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),t=!0,l=[],r=0;r<e.length;r++)for(var a=0;a<e[0].length;a++)null!=e[r]&&null!=e[r][a]&&null!=e[r][a].ps&&(l.push(r+"_"+a),e[r][a].ps.isshow||(t=!1));if(0<l.length){var s=[];if(t){$("#luckysheet-cell-main #luckysheet-postil-showBoxs").empty();for(var n=0;n<l.length;n++){var o=l[n].split("_")[0],c=l[n].split("_")[1];(u=e[o][c].ps).isshow&&(e[o][c].ps.isshow=!1,s.push(l[n]))}}else for(n=0;n<l.length;n++){var u,i,h,d,y,f,m,k,p,g,v,b,o=l[n].split("_")[0],c=l[n].split("_")[1];(u=e[o][c].ps).isshow||(visibledatarow[o],i=o-1==-1?0:visibledatarow[o-1],h=visibledatacolumn[c],c-1==-1||visibledatacolumn[c-1],(d=luckysheet.menuButton.mergeborer(luckysheet.flowdata,o,c))&&(d.row[1],i=d.row[0],h=d.column[1],d.column[0]),y=null==u.left?h+18:u.left,f=null==u.top?i-18:u.top,m=null==u.width?luckysheet.postil.defaultWidth:u.width,k=null==u.height?luckysheet.postil.defaultHeight:u.height,p=null==u.value?"":u.value,f<0&&(f=2),v='<div id="luckysheet-postil-show_'+o+"_"+c+'" class="luckysheet-postil-show"><canvas class="arrowCanvas" width="'+(g=luckysheet.postil.getArrowCanvasSize(y,f,h,i))[2]+'" height="'+g[3]+'" style="position:absolute;left:'+g[0]+"px;top:"+g[1]+'px;z-index:100;"></canvas><div class="luckysheet-postil-show-main" style="width:'+m+"px;height:"+k+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+y+"px;top:"+f+'px;box-sizing:border-box;z-index:100;"><div class="luckysheet-postil-dialog-move"><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-t" data-type="t"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-r" data-type="r"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-b" data-type="b"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-l" data-type="l"></div></div><div class="luckysheet-postil-dialog-resize" style="display:none;"><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lt" data-type="lt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mt" data-type="mt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lm" data-type="lm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rm" data-type="rm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rt" data-type="rt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lb" data-type="lb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mb" data-type="mb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:'+(m-12)+"px;height:"+(k-12)+'px;line-height:18px;word-break:break-all;" spellcheck="false" contenteditable="true">'+p+"</div></div></div></div>",$(v).appendTo($("#luckysheet-cell-main #luckysheet-postil-showBoxs")),b=$("#luckysheet-postil-show_"+o+"_"+c+" .arrowCanvas").get(0).getContext("2d"),luckysheet.postil.drawArrow(b,g[4],g[5],g[6],g[7]),e[o][c].ps.isshow=!0,s.push(l[n]))}}luckysheet.postil.ref(e,s),luckysheet.postil.init()},removeActivePs:function(){var e,t,l,r,a,s;0<$("#luckysheet-postil-showBoxs .luckysheet-postil-show-active").length&&(e=$("#luckysheet-postil-showBoxs .luckysheet-postil-show-active").attr("id"),$("#"+e).removeClass("luckysheet-postil-show-active"),$("#"+e).find(".luckysheet-postil-dialog-resize").hide(),$("#"+e).find(".arrowCanvas").css("z-index",100),$("#"+e).find(".luckysheet-postil-show-main").css("z-index",100),t=e.split("luckysheet-postil-show_")[1].split("_")[0],l=e.split("luckysheet-postil-show_")[1].split("_")[1],r=$("#"+e).find(".formulaInputFocus").text(),s=[],(a=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata))[t][l].ps.value=r,s.push(t+"_"+l),luckysheet.postil.ref(a,s),a[t][l].ps.isshow||$("#"+e).remove())},ref:function(e,t){if(clearjfundo&&(luckysheet.jfundo=[],luckysheet.jfredo.push({type:"postil",data:luckysheet.flowdata,curdata:e,sheetIndex:luckysheet.currentSheetIndex,rc:t})),luckysheet.flowdata=e,luckysheet.editor.webWorkerFlowDataCache(luckysheet.flowdata),luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].data=luckysheet.flowdata,luckysheet.formula.execFunctionGroupData=luckysheet.flowdata,luckysheet.server.allowUpdate)for(var l=0;l<t.length;l++){var r=t[l].split("_")[0],a=t[l].split("_")[1];luckysheet.server.saveParam("v",luckysheet.currentSheetIndex,luckysheet.flowdata[r][a],{r:r,c:a})}setTimeout(function(){luckysheet.luckysheetrefreshgrid()},1)},positionSync:function(){$("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(e,t){var l=$(t).attr("id"),r=l.split("luckysheet-postil-show_")[1].split("_")[0],a=l.split("luckysheet-postil-show_")[1].split("_")[1];luckysheet.postil.buildPs(r,a,luckysheet.flowdata[r][a].ps)})}},luckysheet.hasChinaword=function(e){return!!/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]/gi.exec(e)},luckysheet.getdatabyselectionD=function(e,t){if(null==t||null==t.row||0==t.row.length)return[];for(var l=luckysheet.dynamicArray_compute(luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].dynamicArray),r=[],a=t.row[0];a<=t.row[1];a++)if(null!=e[a]&&(null==config.rowhidden||null==config.rowhidden[a])){for(var s=[],n=t.column[0];n<=t.column[1];n++){var o=a+"_"+n in l?l[a+"_"+n]:e[a][n];s.push(o)}r.push(s)}return r},luckysheet.getdatabyselection=function(e,t){if(null==e&&(e=luckysheet_select_save[0]),null==e.row||0==e.row.length)return[];var l,r;r=null!=t&&t!=luckysheet.currentSheetIndex?(l=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(t)].data,luckysheetfile[luckysheet.sheetmanage.getSheetIndex(t)].config):(l=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),config);for(var a=[],s=e.row[0];s<=e.row[1];s++)if(null!=l[s]&&(null==r.rowhidden||null==r.rowhidden[s])){for(var n=[],o=e.column[0];o<=e.column[1];o++)n.push(l[s][o]);a.push(n)}return a},luckysheet.rowlenByRange=function(e,t,l,r){var a=$.extend(!0,{},r);null==a.rowlen&&(a.rowlen={});for(var s=$("#luckysheetTableContent").get(0).getContext("2d"),n=t;n<=l;n++)if(null==a.rowhidden||null==a.rowhidden[n]){var o=defaultrowlen;null!=a.rowlen[n]&&(o=a.rowlen[n]);for(var c=0;c<e[n].length;c++)if(null!=e[n][c]&&null!=e[n][c].v&&null!=e[n][c].tb&&"2"==e[n][c].tb){var u=luckysheetfontformat(e[n][c]);s.font=u;var i,h=luckysheet.menuButton.getTextSize("田",u)[1],d=luckysheet.getcellvalue(n,c,e).toString(),y=s.measureText(d).width,f=luckysheet.colLocationByIndex(c)[1]-luckysheet.colLocationByIndex(c)[0]-8;if(f<y){for(var m=[],k=1;k<=d.length;k++){var p=d.substring(m.join("").length,k),g=s.measureText(p).width;f<g?(m.push(d.substring(m.join("").length,k-1)),k-=2):g<=f&&k==d.length&&m.push(p)}i=h*m.length}else i=h;o<i&&(o=i)}else{null!=e[n][c]&&null!=e[n][c].v&&null!=e[n][c].tr?(u=luckysheetfontformat(e[n][c]),s.font=u,h=luckysheet.menuButton.getTextSize("田",u)[1],d=luckysheet.getcellvalue(n,c,e).toString(),y=s.measureText(d).width,"0"==e[n][c].tr?i=h:"1"==e[n][c].tr||"2"==e[n][c].tr?i=.707*(y+h)+4:"3"==e[n][c].tr?i=d.length*h+4:"4"!=e[n][c].tr&&"5"!=e[n][c].tr||(i=y+4),o<(i=Math.round(i))&&(o=i)):(u=luckysheetfontformat(e[n][c]),o<(h=luckysheet.menuButton.getTextSize("田",u)[1])&&(o=h))}o!=defaultrowlen&&(a.rowlen[n]=o)}return a},luckysheet.computeRowlenArr=function(e,t){for(var l=[],r=0,a=0;a<e;a++){var s=defaultrowlen;null!=t.rowlen&&null!=t.rowlen[a]&&(s=t.rowlen[a]),null==t.rowhidden||null==t.rowhidden[a]?(r+=s+1,l.push(r)):(s=t.rowhidden[a],l.push(r))}return l},luckysheet.getdatabyselectionNoCopy=function(e){if(null==e||null==e.row||0==e.row.length)return[];for(var t=[],l=e.row[0];l<=e.row[1];l++){var r=[];if(null==config.rowhidden||null==config.rowhidden[l]){for(var a=e.column[0];a<=e.column[1];a++){var s="";null!=luckysheet.flowdata[l]&&null!=luckysheet.flowdata[l][a]&&(s=luckysheet.flowdata[l][a]),r.push(s)}t.push(r)}}return t},luckysheet.datagridgrowth=function(e,t,l,r){if(t<=0&&l<=0)return e;t<=0&&(t=0),l<=0&&(l=0);for(var a=0,a=0==e.length?(e=[],0):e[0].length,s=[],n=0;n<l;n++)s.push(null);for(var o=[],c=0;c<a+l;c++)o.push(null);for(c=0;c<e.length;c++)e[c]=[].concat(e[c].concat(s));for(c=0;c<t;c++)e.push([].concat(o));return r&&(luckysheet.server.saveParam("all",luckysheet.currentSheetIndex,e.length,{k:"row"}),luckysheet.server.saveParam("all",luckysheet.currentSheetIndex,e[0].length,{k:"column"})),e},luckysheet.cleargridelement=function(e){$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cell-selected-boxs .luckysheet-cell-selected").hide(),$("#luckysheet-cols-h-selected .luckysheet-cols-h-selected").hide(),$("#luckysheet-rows-h-selected .luckysheet-rows-h-selected").hide(),$("#luckysheet-cell-selected-focus").hide(),$("#luckysheet-rows-h-hover").hide(),$("#luckysheet-selection-copy .luckysheet-selection-copy").hide(),$("#luckysheet-cols-menu-btn").hide(),$("#luckysheet-row-count-show, #luckysheet-column-count-show").hide(),e||luckysheet.selection.clearcopy(e),$("#luckysheet-dropCell-icon").is(":visible")&&e&&$("#luckysheet-dropCell-icon").remove(),luckysheet.menuButton.luckysheetPaintModelOn&&!e&&luckysheet.menuButton.cancelPaintModel()},luckysheet.orderbydata=function(e,a,t){null==t&&(t=!0);return t?e.sort(function(e,t){var l=e[a],r=t[a];return"object"==luckysheet.getObjType(e[a])&&(l=e[a].v),"object"==luckysheet.getObjType(t[a])&&(r=t[a].v),luckysheet.func_methods.isRealNull(l)?1:luckysheet.func_methods.isRealNull(r)?-1:luckysheet.datecontroll.isdatetime(l)&&luckysheet.datecontroll.isdatetime(r)?luckysheet.datecontroll.diff(l,r):luckysheet.func_methods.isRealNum(l)&&luckysheet.func_methods.isRealNum(r)?numeral(l).value()-numeral(r).value():luckysheet.func_methods.isRealNum(l)||luckysheet.func_methods.isRealNum(r)?luckysheet.func_methods.isRealNum(l)?luckysheet.func_methods.isRealNum(r)?void 0:-1:1:l.localeCompare(r,"zh")}):e.sort(function(e,t){var l=e[a],r=t[a];return"object"==luckysheet.getObjType(e[a])&&(l=e[a].v),"object"==luckysheet.getObjType(t[a])&&(r=t[a].v),luckysheet.func_methods.isRealNull(l)?1:luckysheet.func_methods.isRealNull(r)?-1:luckysheet.datecontroll.isdatetime(l)&&luckysheet.datecontroll.isdatetime(r)?luckysheet.datecontroll.diff(r,l):luckysheet.func_methods.isRealNum(l)&&luckysheet.func_methods.isRealNum(r)?numeral(r).value()-numeral(l).value():luckysheet.func_methods.isRealNum(l)||luckysheet.func_methods.isRealNum(r)?luckysheet.func_methods.isRealNum(l)?luckysheet.func_methods.isRealNum(r)?void 0:1:-1:r.localeCompare(l,"zh")})},luckysheet.orderbydata1D=function(e,t){null==t&&(t=!0);return t?e.sort(function(e,t){var l=e,r=t;return"object"==luckysheet.getObjType(e)&&(l=e.v),"object"==luckysheet.getObjType(t)&&(r=t.v),null==l&&(l=""),null==r&&(r=""),luckysheet.datecontroll.isdatetime(l)&&luckysheet.datecontroll.isdatetime(r)?luckysheet.datecontroll.diff(l,r):luckysheet.func_methods.isRealNum(l)&&luckysheet.func_methods.isRealNum(r)?numeral(l).value()-numeral(r).value():luckysheet.func_methods.isRealNum(l)||luckysheet.func_methods.isRealNum(r)?luckysheet.func_methods.isRealNum(l)?luckysheet.func_methods.isRealNum(r)?void 0:-1:1:l.localeCompare(r,"zh")}):e.sort(function(e,t){var l=e,r=t;return"object"==luckysheet.getObjType(e)&&(l=e.v),"object"==luckysheet.getObjType(t)&&(r=t.v),null==l&&(l=""),null==r&&(r=""),luckysheet.datecontroll.isdatetime(l)&&luckysheet.datecontroll.isdatetime(r)?luckysheet.datecontroll.diff(r,l):luckysheet.func_methods.isRealNum(l)&&luckysheet.func_methods.isRealNum(r)?numeral(r).value()-numeral(l).value():luckysheet.func_methods.isRealNum(l)||luckysheet.func_methods.isRealNum(r)?luckysheet.func_methods.isRealNum(l)?luckysheet.func_methods.isRealNum(r)?void 0:1:-1:r.localeCompare(l,"zh")})},luckysheet.sortSelection=function(e){if(1<luckysheet_select_save.length)luckysheet.isEditMode()?alert("不能对多重选择区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选择区域执行此操作，请选择单个区域，然后再试","");else{null==e&&(e=!0);for(var t,l,r=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),a=luckysheet_select_save[0].row[0],s=luckysheet_select_save[0].row[1],n=luckysheet_select_save[0].column[0],o=luckysheet_select_save[0].column[1],c=a;c<=s;c++)if(null!=r[c]&&null!=r[c][n]){var u=r[c][n];if(null!=u.mc||luckysheet.func_methods.isRealNull(u.v))continue;if(null==t&&/[\u4e00-\u9fa5]+/g.test(u.v)){l=t=c+1;continue}null==t&&(t=c),l=c}if(!(null==t||s<t)){for(var i=!1,h=[],c=t;c<=l;c++){for(var d=[],y=n;y<=o;y++){if(null!=r[c][y]&&null!=r[c][y].mc){i=!0;break}d.push(r[c][y])}h.push(d)}if(i)luckysheet.isEditMode()?alert("选区有合并单元格，无法执行此操作！"):luckysheet.tooltip.info("选区有合并单元格，无法执行此操作！","");else{h=luckysheet.orderbydata(h,0,e);for(var f,c=t;c<=l;c++)for(y=n;y<=o;y++)r[c][y]=h[c-t][y-n];null!=config.rowlen?(f=$.extend(!0,{},config),f=luckysheet.rowlenByRange(r,t,l,f),luckysheet.jfrefreshgrid(r,[{row:[t,l],column:[n,o]}],f,null,!0)):luckysheet.jfrefreshgrid(r,[{row:[t,l],column:[n,o]}])}}}},luckysheet.sortColumnSeletion=function(e,t){null==t&&(t=!0);for(var l,r,a=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),s=a.length-1,n=a[0].length-1,o=0;o<=s;o++)null!=a[o][e]&&null!=a[o][e].mc||(null==a[o][e]||luckysheet.func_methods.isRealNull(a[o][e].v)||!/[\u4e00-\u9fa5]+/g.test(a[o][e].v)||null!=l?(null==l&&(l=o),null==a[o][e]||luckysheet.func_methods.isRealNull(a[o][e].v)||(r=o)):r=l=o+1);if(!(null==l||s<l)){for(var c=!1,u=[],o=l;o<=r;o++){for(var i=[],h=0;h<=n;h++){if(null!=a[o][h]&&null!=a[o][h].mc){c=!0;break}i.push(a[o][h])}u.push(i)}if(c)luckysheet.isEditMode()?alert("列排序会扩展至整个表格选区，选区有合并单元格，无法执行此操作，请选择功能栏排序功能！"):luckysheet.tooltip.info("列排序会扩展至整个表格选区，选区有合并单元格，无法执行此操作，请选择功能栏排序功能！","");else{u=luckysheet.orderbydata(u,e,t);for(var d,o=l;o<=r;o++)for(h=0;h<=n;h++)a[o][h]=u[o-l][+h];null!=config.rowlen?(d=$.extend(!0,{},config),d=luckysheet.rowlenByRange(a,l,r,d),luckysheet.jfrefreshgrid(a,[{row:[l,r],column:[0,n]}],d,null,!0)):luckysheet.jfrefreshgrid(a,[{row:[l,r],column:[0,n]}])}}};var luckysheetfile=null,container=null,defaultcolumnNum=60,defaultrowNum=84,fullscreenmode=!0;luckysheet.getluckysheetfile=function(){return luckysheetfile},luckysheet.setluckysheetfile=function(e){luckysheetfile=e},luckysheet.getconfig=function(){return config},luckysheet.setconfig=function(e){config=e,null!=luckysheetfile&&(luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].config=e)},luckysheet.getvisibledatarow=function(){return visibledatarow},luckysheet.setvisibledatarow=function(e){visibledatarow=e,null!=luckysheetfile&&(luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].visibledatarow=e)},luckysheet.getvisibledatacolumn=function(){return visibledatacolumn},luckysheet.setvisibledatacolumn=function(e){visibledatacolumn=e,null!=luckysheetfile&&(luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].visibledatacolumn=e)},luckysheet.sheetmanage={generateRandomSheetIndex:function(e){null==e&&(e="Sheet");for(var t=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),l="",r=0;r<12;r++)l+=t[Math.round(Math.random()*(t.length-1))];return e+"_"+l+"_"+(new Date).getTime()},generateRandomSheetName:function(e,t){for(var l,r=e.length,a=0;a<e.length;a++){!(-1<e[a].name.indexOf("Sheet")||-1<e[a].name.indexOf("数据透视表"))||"NaN"!=(l=parseFloat(e[a].name.replace("Sheet","").replace("数据透视表","")))&&Math.ceil(l)>r&&(r=Math.ceil(l))}return t?"数据透视表"+(r+1):"Sheet"+(r+1)},generateCopySheetName:function(e,t){var l="";if(-1<t.toString().indexOf("(副本")){for(var r=t.toString().indexOf("(副本"),a=t.toString().substring(0,r)+"(副本",s=null,n=0;n<e.length;n++){-1<(c=(o=e[n].name.toString()).indexOf(a))&&(u=o.indexOf(")",c+a.length),i=o.substring(c+a.length,u),luckysheet.func_methods.isRealNum(i)&&(null==s||parseInt(i)>s)&&(s=parseInt(i)))}l=null==s?a+"2)":a+ ++s+")"}else{for(var o,c,u,i,s=null,h=!1,a=t+"(副本",n=0;n<e.length;n++){-1<(c=(o=e[n].name.toString()).indexOf(a))&&(h=!0,u=o.indexOf(")",c+a.length),i=o.substring(c+a.length,u),luckysheet.func_methods.isRealNum(i)&&(null==s||parseInt(i)>s)&&(s=parseInt(i)))}l=h?null==s?t+"(副本2)":t+"(副本"+ ++s+")":t+"(副本)"}return l},getSheetByIndex:function(e){try{null==e&&(e=luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex));var t=this.getSheetIndex(e);return luckysheetfile[t]}catch(e){}},getCurSheetnoset:function(){for(var e=0,t=0;t<luckysheetfile.length;t++)if(1==luckysheetfile[t].status){e=luckysheetfile[t].index;break}return e},getCurSheet:function(){luckysheet.currentSheetIndex=luckysheetfile[0].index;for(var e=0;e<luckysheetfile.length;e++)if(1==luckysheetfile[e].status){luckysheet.currentSheetIndex=luckysheetfile[e].index;break}return luckysheet.currentSheetIndex},addNewSheet:function(e,t){var l,r,a,s,n;luckysheet.isEditMode()||(l=luckysheetfile.length,r=luckysheet.sheetmanage.generateRandomSheetIndex(),a=luckysheet.sheetmanage.generateRandomSheetName(luckysheet.getluckysheetfile(),t),$("#luckysheet-sheet-container-c").append(luckysheet.replaceHtml(sheetHTML,{index:r,active:"",name:a,style:"",colorset:""})),s={name:a,color:"",status:"0",order:l,index:r,celldata:[],row:defaultrowNum,column:defaultcolumnNum,config:{},pivotTable:null,isPivotTable:!!t},luckysheetfile.push(s),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+r).addClass("luckysheet-sheets-item-active"),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+r+'" class="luckysheet-datavisual-selection-set"></div>'),luckysheet.cleargridelement(e),luckysheet.server.saveParam("sha",null,$.extend(!0,{},s)),clearjfundo&&(n={type:"addSheet"},luckysheet.jfundo=[],n.sheetconfig=$.extend(!0,{},s),n.index=r,n.currentSheetIndex=luckysheet.currentSheetIndex,luckysheet.jfredo.push(n)),this.changeSheetExec(r,t,!0))},setSheetHide:function(e){luckysheetfile[this.getSheetIndex(e)].hide=1;var t=$("#luckysheet-sheets-item"+e);t.hide(),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active");var l=t.nextAll(":visible"),l=0<t.nextAll(":visible").length?l.eq(0).data("index"):t.prevAll(":visible").eq(0).data("index");$("#luckysheet-sheets-item"+l).addClass("luckysheet-sheets-item-active"),this.changeSheetExec(l),luckysheet.server.saveParam("sh",t.data("index"),1,{op:"hide",cur:l})},setSheetShow:function(e){luckysheetfile[this.getSheetIndex(e)].hide=0,this.changeSheetExec(e),luckysheet.server.saveParam("sh",e,0,{op:"show",cur:null})},sheetMaxIndex:0,ordersheet:function(l){return function(e,t){return e[l]-t[l]}},getCurrentOrder:function(){var r={};return $("#luckysheet-sheet-area div.luckysheet-sheets-item").each(function(e){for(var t=$(this).data("index"),l=0;l<luckysheetfile.length;l++)if(luckysheetfile[l].index==t){r[t.toString()]=e;break}}),r},reOrderAllSheet:function(){var r={};$("#luckysheet-sheet-area div.luckysheet-sheets-item").each(function(e){for(var t=$(this).data("index"),l=0;l<luckysheetfile.length;l++)if(luckysheetfile[l].index==t){luckysheetfile[l].order=e,r[t.toString()]=e;break}}),luckysheet.server.saveParam("shr",null,r)},createSheet:function(){var e=[],t={},l=[];luckysheetfile.forEach(function(e){t[e.index]||(t[e.index]=!0,l.push(e))}),luckysheetfile=(luckysheetfile=l).sort(this.ordersheet("order"));for(var r=0;r<luckysheetfile.length;r++){var a="",s=luckysheetfile[r].index,n="";null!=luckysheetfile[r].color&&(n='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+luckysheetfile[r].color+';"></div>'),luckysheet.currentSheetIndex==s?e.push(luckysheet.replaceHtml(sheetHTML,{index:s,active:"luckysheet-sheets-item-active",name:luckysheetfile[r].name,style:"",colorset:n})):(1==luckysheetfile[r].hide?e.push(luckysheet.replaceHtml(sheetHTML,{index:s,active:"",name:luckysheetfile[r].name,style:"display:none;",colorset:n})):e.push(luckysheet.replaceHtml(sheetHTML,{index:s,active:"",name:luckysheetfile[r].name,style:"",colorset:n})),a="style='display:none;'"),$("#luckysheet-cell-main").append("<div "+a+' id="luckysheet-datavisual-selection-set-'+s+'" class="luckysheet-datavisual-selection-set"></div>')}$("#luckysheet-sheet-container-c").append(e.join("")),this.locationSheet()},locationSheet:function(){var e=$("#luckysheet-sheet-container-c"),t=$("#"+container).width(),l=($("#luckysheet-sheet-container-c > div.luckysheet-sheets-item-active").eq(0),0),r=0;$("#luckysheet-sheet-container-c > div.luckysheet-sheets-item:visible").each(function(){$(this).hasClass("luckysheet-sheets-item-active")&&(l=r),r+=$(this).outerWidth()}),setTimeout(function(){e.scrollLeft(l-10),.7*t<=r&&($("#luckysheet-sheet-area .luckysheet-sheets-scroll").css("display","inline-block"),$("#luckysheet-sheet-container .docs-sheet-fade-left").show())},1)},copySheet:function(e,t){var l,r,a,s,n,o,c;luckysheet.isEditMode()||(l=luckysheetfile.length,r=luckysheet.sheetmanage.generateRandomSheetIndex(),a=this.getSheetIndex(e),(s=$.extend(!0,{},luckysheetfile[a])).order=l,s.index=r,s.name=this.generateCopySheetName(luckysheetfile,s.name),n="",null!=s.color&&(n='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+s.color+';"></div>'),o=$("#luckysheet-sheets-item"+e),$("#luckysheet-sheet-container-c").append(luckysheet.replaceHtml(sheetHTML,{index:s.index,active:"",name:s.name,order:s.order,style:"",colorset:n})),$("#luckysheet-sheets-item"+s.index).insertAfter(o),luckysheetfile.splice(e+1,0,s),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+r).addClass("luckysheet-sheets-item-active"),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+r+'" class="luckysheet-datavisual-selection-set"></div>'),luckysheet.cleargridelement(t),luckysheet.server.saveParam("shc",r,{copyindex:e,name:s.name}),this.changeSheetExec(r),this.reOrderAllSheet(),clearjfundo?luckysheet.jfredo.push({type:"copySheet",copyindex:e,index:s.index,sheetIndex:s.index}):0<luckysheet.jfredo.length&&("copySheet"==(c=luckysheet.jfredo[luckysheet.jfredo.length-1]).type&&(c.index=s.index,c.sheetIndex=s.index)))},hasSheet:function(e){return null!=e&&null!=(e=this.getSheetIndex(e))},createSheetbydata:function(e,t){var l="";null!=e.color&&(l='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+e.color+';"></div>'),$("#luckysheet-sheet-container-c").append(luckysheet.replaceHtml(sheetHTML,{index:e.index,active:"",name:e.name,order:e.order,style:"",colorset:l}));var r=e.order;r>=luckysheetfile.length?(r=luckysheetfile.length-1,$("#luckysheet-sheets-item"+e.index).insertAfter($("#luckysheet-sheets-item"+luckysheetfile[r].index))):$("#luckysheet-sheets-item"+e.index).insertBefore($("#luckysheet-sheets-item"+luckysheetfile[r].index)),luckysheetfile.push(e),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+e.index).addClass("luckysheet-sheets-item-active"),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+e.index+'" class="luckysheet-datavisual-selection-set"></div>'),luckysheet.cleargridelement(),null!=t?(luckysheet.server.saveParam("shre",null,{reIndex:e.index}),e.hide=0,luckysheet.server.saveParam("sh",e.index,0,{op:"show",cur:null})):luckysheet.server.saveParam("sha",null,e),this.changeSheetExec(e.index,e.isPivotTable,!0),this.reOrderAllSheet()},deleteSheet:function(e){var t=this.getSheetIndex(e);this.setSheetHide(e),$("#luckysheet-sheets-item"+e).remove(),$("#luckysheet-datavisual-selection-set-"+e).remove();var l=luckysheetfile.splice(t,1);this.reOrderAllSheet(),luckysheet.server.saveParam("shd",null,{deleIndex:e}),clearjfundo&&(l[0].type="deleteSheet",luckysheet.jfredo.push(l[0]))},nulldata:null,getGridData:function(e){for(var t=[],l=0;l<e.length;l++)for(var r=0;r<e[0].length;r++)null!=e[l][r]&&t.push({r:l,c:r,v:e[l][r]});return t},buildGridData:function(e){var t=null==e.row?defaultrowNum:e.row,l=null==e.column?defaultcolumnNum:e.column,r=luckysheet.datagridgrowth([],t,l),a=e.celldata;if(null!=a)for(var s=0;s<a.length;s++){var n=a[s],o=n.r,c=n.c,u=n.v;o>=r.length&&(r=luckysheet.datagridgrowth(r,o-r.length+1,0)),c>=r[0].length&&(r=luckysheet.datagridgrowth(r,0,c-r[0].length+1)),luckysheet.setcellvalue(o,c,r,u)}return luckysheetConfigsetting.autoFormatw=!1,luckysheetConfigsetting.accuracy=void 0,r},cutGridData:function(e){for(var t=0,l=e.length-1;0<=l;l--){for(var r=!0,a=0;a<e[0].length;a++){var s=luckysheet.getcellvalue(l,a);if(null!=s&&0<$.trim(s).length){r=!1;break}}if(!r)break;t=l}return e.slice(0,t)},addGridData:function(e,t,l){var r=luckysheet.datagridgrowth([],t,l);if(null!=e)for(var a=0;a<e.length;a++){var s=e[a],n=s.r,o=s.c,c=s.v;n>=r.length&&(r=luckysheet.datagridgrowth(r,n-r.length+1,0)),o>=r[0].length&&(r=luckysheet.datagridgrowth(r,0,o-r[0].length+1)),luckysheet.setcellvalue(n,o,r,c)}return r},initialjfFile:function(menu,title){var _this=this;this.getCurSheet();var file=luckysheetfile[_this.getSheetIndex(luckysheet.currentSheetIndex)];this.nulldata=luckysheet.datagridgrowth([],defaultrowNum,defaultcolumnNum);var data=_this.buildGridData(file);luckysheet_select_save=file.luckysheet_select_save,null!=luckysheet_select_save&&0!=luckysheet_select_save.length||(luckysheet_select_save=null!=data[0]&&null!=data[0][0]&&null!=data[0][0].mc?[{row:[0,data[0][0].mc.rs-1],column:[0,data[0][0].mc.cs-1]}]:[{row:[0,0],column:[0,0]}]),luckysheet_selection_range=null==file.luckysheet_selection_range?[]:file.luckysheet_selection_range,config=null==file.config?{}:file.config;var r2=luckysheet_select_save[0].row[1],c2=luckysheet_select_save[0].column[1];if(1<luckysheet_select_save.length)for(var i=0;i<luckysheet_select_save.length;i++)luckysheet_select_save[i].row[1]>r2&&(r2=luckysheet_select_save[i].row[1]),luckysheet_select_save[i].column[1]>c2&&(c2=luckysheet_select_save[i].column[1]);file.data=data;var rowheight=data.length;rowheight-1<r2&&(rowheight=r2+1);var colwidth=data[0].length;colwidth-1<c2&&(colwidth=c2+1),luckysheet.luckysheetcreatedom(colwidth,rowheight,data,menu,title),setTimeout(function(){luckysheet.tooltip.createHoverTip("#luckysheet_info_detail",".luckysheet_info_detail_title, .luckysheet_info_detail_input, .luckysheet_info_detail_update"),luckysheet.tooltip.createHoverTip("#luckysheet-wa-editor",".luckysheet-toolbar-menu-button, .luckysheet-toolbar-button, .luckysheet-toolbar-combo-button"),luckysheetTableContentHW=[$("#luckysheet-cell-main").width()+rowHeaderWidth-cellMainSrollBarSize,$("#luckysheet-cell-main").height()+columeHeaderHeight-cellMainSrollBarSize],$("#luckysheetTableContent, #luckysheetTableContentF").attr({width:Math.ceil(luckysheetTableContentHW[0]*devicePixelRatio),height:Math.ceil(luckysheetTableContentHW[1]*devicePixelRatio)}).css({width:luckysheetTableContentHW[0],height:luckysheetTableContentHW[1]}).get(0).getContext("2d");var key=luckysheet.server.gridKey,cahce_key=key+"__qkcache",ini=function(){file.load="1",_this.createSheet();for(var sheetindexset=_this.checkLoadSheetIndex(file),sheetindex=[],i=0;i<sheetindexset.length;i++){var item=sheetindexset[i];item!=file.index&&sheetindex.push(item)}var execF=function(){_this.storeSheetParam(),_this.restoreselect(),luckysheet.sheetmanage.CacheNotLoadControll=[],luckysheet.sheetmanage.restoreCache(),luckysheet.formula.execFunctionGroup(),luckysheet.sheetmanage.restoreSheetAll(luckysheet.currentSheetIndex),luckysheet.luckysheetrefreshgrid(0,0),$("#luckysheet_info_detail_save").html("已恢复本地缓存"),file.isPivotTable?(luckysheetcurrentisPivotTable=!0,luckysheet.pivotTable.changePivotTable(luckysheet.currentSheetIndex)):(luckysheetcurrentisPivotTable=!1,$("#luckysheet-modal-dialog-slider-pivot").hide(),luckysheet.luckysheetsizeauto()),"function"==typeof luckysheet.luckysheetConfigsetting.beforeCreateDom&&luckysheet.luckysheetConfigsetting.beforeCreateDom(luckysheet),luckysheetConfigsetting.pointEdit?setTimeout(function(){$("#luckysheetloadingdata").remove()},0):setTimeout(function(){$("#luckysheetloadingdata").fadeOut().remove()},500)},loadSheetUrl=luckysheet.server.loadSheetUrl;0==sheetindex.length||""==loadSheetUrl?execF():$.post(loadSheetUrl,{gridKey:luckysheet.server.gridKey,index:sheetindex.join(",")},function(d){var dataset=eval("("+d+")"),otherfile;for(var item in dataset){item!=file.index&&(otherfile=luckysheetfile[_this.getSheetIndex(item)],null!=otherfile.load&&"0"!=otherfile.load||(otherfile.celldata=dataset[item.toString()],otherfile.data=_this.buildGridData(otherfile),otherfile.load="1"))}execF()})};try{localforage.getItem(cahce_key).then(function(e){null!=e&&(luckysheet.sheetmanage.CacheNotLoadControll=e),luckysheet.server.clearcachelocaldata(function(){ini()})})}catch(e){ini()}},1)},storeSheetParam:function(){var e=this.getSheetIndex(luckysheet.currentSheetIndex),t=luckysheetfile[e];t.visibledatarow=visibledatarow,t.visibledatacolumn=visibledatacolumn,t.rowsplit=rowsplit,t.ch_width=ch_width,t.rh_height=rh_height,t.luckysheet_select_save=$.extend(!0,[],luckysheet_select_save),t.luckysheet_selection_range=$.extend(!0,[],luckysheet_selection_range),t.scrollLeft=$("#luckysheet-cell-main").scrollLeft(),t.scrollTop=$("#luckysheet-cell-main").scrollTop()},setSheetParam:function(e){var t=this.getSheetIndex(luckysheet.currentSheetIndex),l=luckysheetfile[t];luckysheet.flowdata=l.data,luckysheet.editor.webWorkerFlowDataCache(luckysheet.flowdata),luckysheet.postil.buildAllPs(luckysheet.flowdata),config=l.config,luckysheet_select_save=null==l.luckysheet_select_save?[]:l.luckysheet_select_save,luckysheet_selection_range=null==l.luckysheet_selection_range?[]:l.luckysheet_selection_range,null==l.freezen?(luckysheet.freezen.freezenhorizontaldata=null,luckysheet.freezen.freezenverticaldata=null):(luckysheet.freezen.freezenhorizontaldata=null==l.freezen.horizontal?null:l.freezen.horizontal.freezenhorizontaldata,luckysheet.freezen.freezenverticaldata=null==l.freezen.vertical?null:l.freezen.vertical.freezenverticaldata),luckysheet.createFilterOptions(l.filter_select,l.filter),luckysheet.jfrefreshgrid_rhcw(luckysheet.flowdata.length,luckysheet.flowdata[0]?luckysheet.flowdata[0].length:60)},restoreselect:function(){var e=this.getSheetIndex(luckysheet.currentSheetIndex),t=luckysheetfile[e];luckysheet.selectHightlightShow(),luckysheet.selectionCopyShow(),null!=t.scrollLeft&&0<t.scrollLeft?$("#luckysheet-scrollbar-x").scrollLeft(t.scrollLeft):$("#luckysheet-scrollbar-x").scrollLeft(0),null!=t.scrollTop&&0<t.scrollTop?$("#luckysheet-scrollbar-y").scrollTop(t.scrollTop):$("#luckysheet-scrollbar-y").scrollTop(0)},storeSheetParamALL:function(){this.storeSheetParam();var e=this.getSheetIndex(luckysheet.currentSheetIndex);luckysheetfile[e].data=luckysheet.flowdata,luckysheetfile[e].config=$.extend(!0,{},config)},changeSheet:function(index,isPivotInitial,isNewSheet){luckysheet.isEditMode(),luckysheet.server.allowUpdate&&($("#luckysheet-cell-main #luckysheet-multipleRange-show").empty(),luckysheet.server.multipleIndex=0),$("#luckysheet-filter-selected-sheet"+luckysheet.currentSheetIndex+", #luckysheet-filter-options-sheet"+luckysheet.currentSheetIndex).hide(),$("#luckysheet-filter-selected-sheet"+index+", #luckysheet-filter-options-sheet"+index).show(),this.storeSheetParamALL(),this.setCurSheet(index);var file=luckysheetfile[this.getSheetIndex(index)],data=file.data,cfg=file.config;file.isPivotTable?(luckysheetcurrentisPivotTable=!0,isPivotInitial||luckysheet.pivotTable.changePivotTable(index)):(luckysheetcurrentisPivotTable=!1,$("#luckysheet-modal-dialog-slider-pivot").hide(),luckysheet.luckysheetsizeauto());var _this=this,load=file.load,loadSheetUrl,data,sheetindex;null!=load?(_this.setSheetParam(!0),_this.showSheet(),setTimeout(function(){luckysheet.formula.execFunctionGroup(),luckysheet.luckysheetrefreshgrid(),luckysheet.server.saveParam("shs",null,luckysheet.currentSheetIndex)},1)):(loadSheetUrl=luckysheet.server.loadSheetUrl,""==loadSheetUrl||luckysheetcurrentisPivotTable||isNewSheet?(data=_this.buildGridData(file),file.data=data,file.load="1",_this.setSheetParam(),_this.showSheet(),setTimeout(function(){luckysheet.sheetmanage.restoreCache(),luckysheet.formula.execFunctionGroup(),luckysheet.sheetmanage.restoreSheetAll(luckysheet.currentSheetIndex),luckysheet.luckysheetrefreshgrid()},1),luckysheet.server.saveParam("shs",null,luckysheet.currentSheetIndex)):($("#luckysheet-grid-window-1").append('<div id="luckysheetloadingdata" style="width:100%;text-align:center;position:absolute;top:0px;height:100%;font-size: 16px;z-index:1000000000;background:#fff;"><div style="position:relative;top:45%;width:100%;"> <div class="luckysheetLoaderGif"></div> <span>渲染中...</span></div></div>'),sheetindex=this.checkLoadSheetIndex(file),$.post(loadSheetUrl,{gridKey:luckysheet.server.gridKey,index:sheetindex.join(",")},function(d){var dataset=eval("("+d+")");file.celldata=dataset[index.toString()];var data=_this.buildGridData(file),otherfile;for(var item in setTimeout(function(){$("#luckysheetloadingdata").fadeOut().remove()},500),dataset){item!=index&&(otherfile=luckysheetfile[_this.getSheetIndex(item)],null!=otherfile.load&&"0"!=otherfile.load||(otherfile.celldata=dataset[item.toString()],otherfile.data=_this.buildGridData(otherfile),otherfile.load="1"))}file.data=data,file.load="1",_this.setSheetParam(),_this.showSheet(),setTimeout(function(){luckysheet.sheetmanage.restoreCache(),luckysheet.formula.execFunctionGroup(),luckysheet.sheetmanage.restoreSheetAll(luckysheet.currentSheetIndex),luckysheet.luckysheetrefreshgrid()},1),luckysheet.server.saveParam("shs",null,luckysheet.currentSheetIndex)}))),$("#luckysheet-cell-main .luckysheet-datavisual-selection-set").hide(),$("#luckysheet-datavisual-selection-set-"+index).show(),window.generator&&generator.renderChartShow(index),luckysheet.freezen.initialFreezen(index),this.restoreselect()},checkLoadSheetIndex:function(e){var t=e.calcChain,l=e.chart,r=e.pivotTable,a=[],s={};if(a.push(e.index),s[e.index.toString()]=1,null!=t)for(var n=0;n<t.length;n++){null!=(o=t[n].index)&&null==s[o.toString()]&&(a.push(o),s[o.toString()]=1)}if(null!=l)for(var o,n=0;n<l.length;n++){null!=(o=l[n].dataSheetIndex)&&null==s[o.toString()]&&(a.push(o),s[o.toString()]=1)}return null!=r&&null!=(o=r.pivotDataSheetIndex)&&null==s[o.toString()]&&(a.push(o),s[o.toString()]=1),a},showSheet:function(){$("#luckysheet-cell-flow_0").css({width:ch_width,top:"-1px"}),$("#luckysheet-sheettable_0").css({width:ch_width-1,height:rh_height}),$("#luckysheetrowHeader_0").css("height",rh_height),$("#luckysheet-cols-h-cells_0").css("width",ch_width),$("#luckysheet-scrollbar-x div").width(ch_width),$("#luckysheet-scrollbar-y div").height(rh_height-30)},setCurSheet:function(e){for(var t=0;t<luckysheetfile.length;t++)luckysheetfile[t].index==e?luckysheetfile[t].status=1:luckysheetfile[t].status=0;luckysheet.currentSheetIndex=e},getSheetIndex:function(e){for(var t=0;t<luckysheetfile.length;t++)if(luckysheetfile[t].index==e)return t;return null},changeSheetExec:function(e,t,l){var r=$("#luckysheet-sheets-item"+e);window.luckysheet_getcelldata_cache=null,$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),r.addClass("luckysheet-sheets-item-active").show(),luckysheet.cleargridelement(),this.changeSheet(e,t,l),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide(),luckysheet.formula.rangestart&&luckysheet.formula.createRangeHightlight();var a=$("#luckysheet-sheet-container-c");a.scrollLeft(r.offset().left);var s=a.width(),n=a[0].scrollWidth,o=a.scrollLeft();o<=0?$("#luckysheet-sheet-container .docs-sheet-fade-left").hide():$("#luckysheet-sheet-container .docs-sheet-fade-left").show(),n<=s+o?$("#luckysheet-sheet-container .docs-sheet-fade-right").hide():$("#luckysheet-sheet-container .docs-sheet-fade-right").show()},delChart:function(e,t){var l=this.getSheetIndex(t),r=luckysheetfile[l];if(null==r.chart)r.chart=[];else for(var a=0;a<r.chart.length;a++)if(r.chart[a].chart_id==e){luckysheetfile[l].chart.splice(a,1);break}},saveChart:function(e){var t=this.getSheetIndex(e.sheetIndex),l=luckysheetfile[t];if(null==l.chart)l.chart=[],l.chart.push(e);else{for(var r=0;r<l.chart.length;r++)if(l.chart[r].chart_id==e.chart_id){var a=$.extend(!0,{},l.chart[r]);return void(l.chart[r]=$.extend(!0,{},a,e))}l.chart.push(e)}},getChart:function(e,t){var l=getSheetIndex(e),r=luckysheetfile[l];if(null==r.chart)return null;for(var a=0;a<r.chart.length;a++)if(r.chart[a].chart_id==t)return r.chart[a];return null},restoreChart:function(e){if(-1==luckysheet.chartparam.luckysheet_chartIns_index)for(var t=luckysheet.chartparam.luckysheet_chartIns_index=0;t<luckysheetfile.length;t++){var l=luckysheetfile[t].chart;null!=l&&(luckysheet.chartparam.luckysheet_chartIns_index+=l.length)}var r=this.getSheetIndex(e),a=luckysheetfile[r];if(null!=a.chart)for(t=0;t<a.chart.length;t++){var s,n,o,c,u,i=a.chart[t];null!=i.sheetIndex&&null!=i.dataSheetIndex&&null!=i.row&&null!=i.column&&0==$("#"+i.chart_id).length&&((o=n=s=null)!=i.chart_id?(n=i.chart_id,c=parseInt(n),isNaN(c)?c=luckysheet.chartparam.luckysheet_chartIns_index++:c>luckysheet.chartparam.luckysheet_chartIns_index&&(luckysheet.chartparam.luckysheet_chartIns_index=c),s=luckysheet.jfcolor[c],o=n+"_selection"):(s=luckysheet.jfcolor[luckysheet.chartparam.luckysheet_chartIns_index],o=(n="luckysheet-datav-chart-"+luckysheet.chartparam.luckysheet_chartIns_index++)+"_selection",i.chart_id=n),u=null==(u=i.chartTheme)?"default0000":u,luckysheet.insertChartTosheet(i.sheetIndex,i.dataSheetIndex,i.option,i.chartType,i.selfOption,i.defaultOption,i.row,i.column,s,n,o,i.chartStyle,i.rangeConfigCheck,i.rangeRowCheck,i.rangeColCheck,i.chartMarkConfig,i.chartTitleConfig,i.winWidth,i.winHeight,i.scrollLeft,i.scrollTop,u,i.myWidth,i.myHeight,null!=i.myLeft?parseFloat(i.myLeft):null,null!=i.myTop?parseFloat(i.myTop):null,i.myindexrank,!0))}},getRangetxt:function(e,t,l){var r="";null==l&&(l=luckysheet.currentSheetIndex),e!=l&&(r=luckysheetfile[this.getSheetIndex(e)].name+"!");var a=t.row[0],s=t.row[1],n=t.column[0],o=t.column[1];return null==a&&null==s?r+luckysheet.luckysheetchatatABC(n)+":"+luckysheet.luckysheetchatatABC(o):null==n&&null==o?r+(a+1)+":"+(s+1):n==o&&a==s?r+luckysheet.luckysheetchatatABC(n)+(a+1):r+luckysheet.luckysheetchatatABC(n)+(a+1)+":"+luckysheet.luckysheetchatatABC(o)+(s+1)},getSheetName:function(e){return null==e&&(e=luckysheet.currentSheetIndex),luckysheetfile[this.getSheetIndex(e)].name},getSheetMerge:function(){return null==config.merge?null:config.merge},getSheetData:function(e){return null==e&&(e=luckysheet.currentSheetIndex),luckysheetfile[this.getSheetIndex(e)].data},getSheetConfig:function(e){return null==e&&(e=luckysheet.currentSheetIndex),null==luckysheetfile[this.getSheetIndex(e)].config&&(luckysheetfile[this.getSheetIndex(e)].config={}),luckysheetfile[this.getSheetIndex(e)].config},restoreFilter:function(e){var r,t=this.getSheetIndex(e),a=luckysheetfile[t];0<$("#luckysheet-filter-selected-sheet"+e).length||null==a.filter_select||"{}"==JSON.stringify(a.filter_select)?null!=a.config&&null!=a.config.rowhidden&&(a.config.rowhidden={},config=a.config,luckysheet.jfrefreshgrid_rhcw(luckysheet.flowdata.length,luckysheet.flowdata[0].length)):("object"!=luckysheet.getObjType(a.filter_select)&&(a.filter_select=JSON.parse(a.filter_select)),null!=a.filter_select&&null!=a.filter_select.row&&null!=a.filter_select.column&&(luckysheet.createFilterOptions(a.filter_select),"object"!=luckysheet.getObjType(a.filter)&&null!=a.filter&&"string"==luckysheet.getObjType(a.filter)&&(a.filter=JSON.parse(a.filter)),r={},null!=a.config&&null!=a.config.rowhidden&&(r=a.config.rowhidden),$("#luckysheet-filter-options-sheet"+e+" .luckysheet-filter-options").each(function(e){if(null==a.filter)return!1;var t=$(this),l=a.filter[e];if(null==l)return!0;"object"!=luckysheet.getObjType(l)&&(l=JSON.parse(l)),luckysheet.labelFilterOptionState(t,l.optionstate,l.rowhidden,l.caljs,!1,l.st_r,l.ed_r,l.cindex,l.st_c,l.ed_c),r=$.extend(!0,r,l.rowhidden)}),null==a.config&&(a.config={}),a.config.rowhidden=r,config=a.config,luckysheet.jfrefreshgrid_rhcw(luckysheet.flowdata.length,luckysheet.flowdata[0].length)))},restorePivot:function(e){var t=this.getSheetIndex(e);luckysheetfile[t].isPivotTable&&(luckysheet.pivotTable.getCellData(e),luckysheet.pivotTable.initialPivotManage(!0),luckysheet.pivotTable.refreshPivotTable())},restoreSheetAll:function(e){this.restorePivot(e),this.restoreFilter(e),this.restoreFreezen(e)},restoreFreezen:function(e){luckysheet.freezen.initialFreezen(e)},restoreCache:function(){luckysheet.server.gridKey;var e=this.CacheNotLoadControll;if(this.CacheNotLoadControll=[],0!=e.length)for(var t=0;t<e.length;t++){var l=e[t];this.execCache(l)}},CacheNotLoadControll:[],execCache:function(item){var type=item.t,index=item.i,value=item.v,_this=this,file=luckysheetfile[_this.getSheetIndex(index)];if("sha"==type)luckysheetfile.push(value);else if("shc"==type){var copyjson=$.extend(!0,{},luckysheetfile[_this.getSheetIndex(value.copyindex)]);copyjson.index=index,luckysheetfile.push(copyjson)}else if("shd"==type)luckysheetfile.splice(value.deleIndex,1);else if("shr"==type)for(var pos in value)luckysheetfile[_this.getSheetIndex(pos)].order=value[pos];if(null!=file&&"1"==file.load||type in{sha:0,shc:0,shd:0,shr:0})if("v"==type){var r=item.r,c=item.c,v=item.v,data=_this.getSheetData(index);file.data[r][c]=v}else if("fc"==type){var op=item.op,pos=item.pos;"object"!=luckysheet.getObjType(value)&&(value=eval("("+value+")"));var r=value.r,c=value.c,func=value.func;"del"==op?luckysheet.formula.delFunctionGroup(r,c,index):luckysheet.formula.insertUpdateFunctionGroup(r,c,func,index)}else if("cg"==type){var v=value,k=item.k,config1=_this.getSheetConfig(index);for(var key in k in config1||(config1[k]={}),v)config1[k][key]=v[key];config=config1}else if("f"==type){var v=value,op=item.op,pos=item.pos,filter=file.filter;null==filter&&(filter={}),"upOrAdd"==op?filter[pos]=v:"del"==op&&delete filter[pos]}else if("fsc"==type)file.filter=null,file.filter_select=null;else if("fsr"==type){var v=value;file.filter=v.filter,file.filter_select=v.filter_select}else if("sh"==type){var op=item.op,cur=item.cur,v=value;if("hide"==op)file.status=0,luckysheetfile[_this.getSheetIndex(cur)].status=1;else if("show"==op){for(var i=0;i<luckysheetfile.length;i++)luckysheetfile[i].status=0;file.status=1}}else if("all"==type){var k=item.k,s=item.s;s&&"object"!=luckysheet.getObjType(value)?file[k]=JSON.stringify(value):file[k]=value}else if("c"==type){var op=item.op,cid=item.cid;if("add"==op)file.chart.push(value);else if("xy"==op||"wh"==op||"update"==op){for(var i=0;i<file.chart.length;i++)if(file.chart[i].chart_id==cid){for(var item in file.chart[i])for(var vitem in value)item==vitem&&(file.chart[i][item]=value[vitem]);return}}else if("del"==op)for(var i=0;i<file.chart.length;i++)if(file.chart[i].chart_id==cid)return void file.chart.splice(i,1)}else if("drc"==type){var rc=item.rc,index=value.index,len=value.len,celldata=file.celldata;if("r"==rc){for(var i=0;0==celldata.length;i++){var cell=celldata[i];cell.r>=index&&cell.r<index+len?delete cell:cell.r>=index+len&&(cell.r-=len)}file.row-=len}else{for(var i=0;0==celldata.length;i++){var cell=celldata[i];cell.c>=index&&cell.c<index+len?delete cell:cell.c>=index+len&&(cell.c-=len)}file.column-=len}for(var ret=[],i=0,mtype,mst,med;i<celldata.length;i++)null!=celldata[i]&&ret.push(celldata[i]);file.celldata=ret,mtype="r"==rc?"row":"column",mst=index,med=index+len-1,luckysheet.luckysheetdeletetable(mtype,mst,med,!0)}else if("arc"==type){var rc=item.rc,index=value.index,len=value.len,celldata=file.celldata,mtype;if("r"==rc){for(var i=0;i<celldata.length;i++){var cell=celldata[i];cell.r>index&&(cell.r+=len)}file.row+=len}else{for(var i=0;i<celldata.length;i++){var cell=celldata[i];cell.c>index&&(cell.c+=len)}file.column+=len}mtype="r"==rc?"row":"column",luckysheet.luckysheetextendtable(mtype,index,len,!0)}else"na"==type?luckysheet.server.saveParam("na",null,value):"thumb"==type&&setTimeout(function(){_this.imageRequest()},2e3);else _this.CacheNotLoadControll.push(item)}};var common_extend=function(e,t){var l={};for(var r in e)l[r]=e[r];for(var r in t)l[r]=t[r];return l};luckysheet.create=function(setting){var extendsetting=common_extend(defaultSetting,setting);luckysheet.rptSetting=setting;var loadurl=extendsetting.loadUrl,menu=extendsetting.menu,title=extendsetting.title;container=extendsetting.container,luckysheetfile=extendsetting.data,defaultcolumnNum=extendsetting.column,defaultrowNum=extendsetting.row,fullscreenmode=extendsetting.fullscreenmode,luckysheet.server.gridKey=extendsetting.gridKey,luckysheet.mode=extendsetting.mode,luckysheet.server.loadUrl=extendsetting.loadUrl,luckysheet.server.updateUrl=extendsetting.updateUrl,luckysheet.server.updateImageUrl=extendsetting.updateImageUrl,luckysheet.server.title=extendsetting.title,luckysheet.server.loadSheetUrl=extendsetting.loadSheetUrl,luckysheet.server.allowUpdate=extendsetting.allowUpdate,luckysheetConfigsetting.autoFormatw=extendsetting.autoFormatw,luckysheetConfigsetting.accuracy=extendsetting.accuracy,luckysheetConfigsetting.total=luckysheetfile[0].total,luckysheetConfigsetting.allowCopy=extendsetting.allowCopy,luckysheetConfigsetting.showtoolbar=extendsetting.showtoolbar,luckysheetConfigsetting.showinfobar=extendsetting.showinfobar,luckysheetConfigsetting.showsheetbar=extendsetting.showsheetbar,luckysheetConfigsetting.showstatisticBar=extendsetting.showstatisticBar,luckysheetConfigsetting.pointEdit=extendsetting.pointEdit,luckysheetConfigsetting.pointEditUpdate=extendsetting.pointEditUpdate,luckysheetConfigsetting.pointEditZoom=extendsetting.pointEditZoom,luckysheetConfigsetting.userInfo=extendsetting.userInfo,luckysheetConfigsetting.userMenuItem=extendsetting.userMenuItem,luckysheetConfigsetting.myFolderUrl=extendsetting.myFolderUrl,luckysheetConfigsetting.functionButton=extendsetting.functionButton,luckysheetConfigsetting.showConfigWindowResize=extendsetting.showConfigWindowResize,luckysheetConfigsetting.enableAddRow=extendsetting.enableAddRow,luckysheetConfigsetting.enableAddCol=extendsetting.enableAddCol,luckysheetConfigsetting.enablePage=extendsetting.enablePage,luckysheetConfigsetting.pageInfo=extendsetting.pageInfo,luckysheetConfigsetting.editMode=extendsetting.editMode,luckysheetConfigsetting.chartConfigChange=extendsetting.chartConfigChange,luckysheetConfigsetting.beforeCreateDom=extendsetting.beforeCreateDom,luckysheetConfigsetting.fireMousedown=extendsetting.fireMousedown,devicePixelRatio=extendsetting.devicePixelRatio,null==devicePixelRatio&&(devicePixelRatio=1),devicePixelRatio=Math.ceil(devicePixelRatio),$("#"+container).append('<div id="luckysheetloadingdata" style="width:100%;text-align:center;position:absolute;top:0px;height:100%;font-size: 16px;z-index:1000000000;background:#fff;"><div style="position:relative;top:45%;width:100%;"> <div class="luckysheetLoaderGif"> </div> <span>渲染中...</span></div></div>'),luckysheetConfigsetting.pointEdit&&($("#"+container).attr("tabindex",0).focus(),$("#luckysheetloadingdata .luckysheetLoaderGif").css({width:"4em",height:"4em"}));var data=[];return""==loadurl?(luckysheet.sheetmanage.initialjfFile(menu,title),luckysheet.luckysheetsizeauto(),luckysheet.luckysheetHandler(),luckysheet.chartInitial()):$.post(loadurl,{gridKey:luckysheet.server.gridKey},function(d){var data=eval("("+d+")");luckysheetfile=data,luckysheet.sheetmanage.initialjfFile(menu,title),luckysheet.luckysheetsizeauto(),luckysheet.luckysheetHandler(),luckysheet.chartInitial(),luckysheet.server.allowUpdate&&luckysheet.server.openWebSocket()}),luckysheet};var gridW=0,gridH=0,cellmainHeight=0,cellmainWidth=0;luckysheet.luckysheetsizeauto=function(){luckysheetConfigsetting.showinfobar?(infobarHeight=30,$("#luckysheet_info_detail").show()):(infobarHeight=0,$("#luckysheet_info_detail").hide()),toolbarHeight=luckysheetConfigsetting.showtoolbar?($("#"+container).find(".luckysheet-wa-editor, .luckysheet-share-logo").show(),35):($("#"+container).find(".luckysheet-wa-editor, .luckysheet-share-logo").hide(),0),sheetBarHeight=luckysheetConfigsetting.showsheetbar?($("#"+container).find("#luckysheet-sheet-area").show(),27):($("#"+container).find("#luckysheet-sheet-area").hide(),0),statisticBarHeight=luckysheetConfigsetting.showstatisticBar?($("#"+container).find(".luckysheet-stat-area").show(),23):($("#"+container).find(".luckysheet-stat-area").hide(),0),luckysheetConfigsetting.pointEdit&&(cellMainSrollBarSize=0),$("#"+container).find(".luckysheet-grid-container").css("top",toolbarHeight+infobarHeight+calculatebarHeight),gridW=$("#"+container).width(),gridH=$("#"+container).height(),luckysheetConfigsetting.showConfigWindowResize&&($("#luckysheet-modal-dialog-slider-pivot").is(":visible")?gridW-=$("#luckysheet-modal-dialog-slider-pivot").outerWidth():$("#luckysheet-data-visualization").is(":visible")?gridW-=$("#luckysheet-data-visualization").outerWidth():$("#luckysheet-modal-dialog-slider-alternateformat").is(":visible")&&(gridW-=$("#luckysheet-modal-dialog-slider-alternateformat").outerWidth())),$("#"+container).find(".luckysheet").height(gridH-2).width(gridW-2),cellmainHeight=gridH-(infobarHeight+toolbarHeight+calculatebarHeight+columeHeaderHeight+sheetBarHeight+statisticBarHeight),cellmainWidth=gridW-rowHeaderWidth,$("#luckysheet-cols-h-c, #luckysheet-cell-main, #luckysheet-scrollbar-x").width(cellmainWidth),$("#luckysheet-cell-main").height(cellmainHeight),$("#luckysheet-rows-h").height(cellmainHeight-cellMainSrollBarSize),$("#luckysheet-scrollbar-y").height(cellmainHeight+6),$("#luckysheet-scrollbar-x").height(cellMainSrollBarSize),$("#luckysheet-scrollbar-y").width(cellMainSrollBarSize),luckysheetTableContentHW=[cellmainWidth+rowHeaderWidth-cellMainSrollBarSize,cellmainHeight+columeHeaderHeight-cellMainSrollBarSize],$("#luckysheetTableContent, #luckysheetTableContentF").attr({width:Math.ceil(luckysheetTableContentHW[0]*devicePixelRatio),height:Math.ceil(luckysheetTableContentHW[1]*devicePixelRatio)}).css({width:luckysheetTableContentHW[0],height:luckysheetTableContentHW[1]}),$("#"+container).find("#luckysheet-grid-window-1").css("bottom",sheetBarHeight),$("#"+container).find(".luckysheet-grid-window").css("bottom",statisticBarHeight);var e=$("#luckysheet-grid-window-1").width();$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css({width:e-10}).end().find(".luckysheet-freezebar-horizontal-drop").css({width:e-10});var t=$("#luckysheet-grid-window-1").height();$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css({height:t-10}).end().find(".luckysheet-freezebar-vertical-drop").css({height:t-10}),luckysheet.freezen.createAssistCanvas(),luckysheet.luckysheetrefreshgrid($("#luckysheet-cell-main").scrollLeft(),$("#luckysheet-cell-main").scrollTop());var l=!1,r=0,a='<div id="luckysheet-icon-morebtn-div" class="luckysheet-wa-editor" style="position:absolute;top:'+(infobarHeight+toolbarHeight+2+$("#"+container).offset().top+$("body").scrollTop())+'px; right:0px;z-index:1003;padding-left:0px;display:none;height:auto;white-space:initial;"></div>';0==$("#luckysheet-icon-morebtn-div").length&&$("body").append(a),$("#luckysheet-icon-morebtn-div").hide(),$("#luckysheet-icon-morebtn-div > div").appendTo($("#luckysheet-wa-editor")),$("#luckysheet-icon-morebtn").prev().remove().end().remove(),$("#luckysheet-wa-editor > div").each(function(){var e=$(this);r+=e.outerWidth(),!l&&gridW-120<r&&(l=!0),l&&$("#luckysheet-icon-morebtn-div").append($(this))}),l&&($("#luckysheet-wa-editor").append('<div class="luckysheet-toolbar-separator luckysheet-inline-block" style="user-select: none;"> </div><div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="更多按钮" id="luckysheet-icon-morebtn" role="button" style="user-select: none;"> <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block" style="user-select: none;"> <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;color:#0188fb;"><i class="fa fa-list-ul"></i> 更多... </div> </div> </div> </div>'),$("#luckysheet-icon-morebtn").click(function(){var e=$(window).width()-$("#luckysheet-icon-morebtn").offset().left-$("#luckysheet-icon-morebtn").width()+$("body").scrollLeft();$("#luckysheet-icon-morebtn-div").toggle().css("right",e<0?0:e),-1<$(this).find(".luckysheet-toolbar-menu-button-caption").text().indexOf("更多")?$(this).find(".luckysheet-toolbar-menu-button-caption").html('<i class="fa fa-list-ul"></i> 收起... '):$(this).find(".luckysheet-toolbar-menu-button-caption").html('<i class="fa fa-list-ul"></i> 更多... ')}),$("#luckysheet-icon-morebtn-div .luckysheet-toolbar-menu-button").css("margin-right",-1),$("#luckysheet-icon-morebtn-div .luckysheet-toolbar-button-split-left").css("margin-right",-3)),$("#"+container+" .luckysheet-wa-editor .luckysheet-toolbar-button-split-left").off("hover").hover(function(){$(this).next(".luckysheet-toolbar-button-split-right").addClass("luckysheet-toolbar-button-split-right-hover")},function(){$(this).next(".luckysheet-toolbar-button-split-right").removeClass("luckysheet-toolbar-button-split-right-hover")}),$("#"+container+" .luckysheet-wa-editor .luckysheet-toolbar-button-split-right").off("hover").hover(function(){$(this).prev(".luckysheet-toolbar-button-split-left").addClass("luckysheet-toolbar-button-hover")},function(){$(this).prev(".luckysheet-toolbar-button-split-left").removeClass("luckysheet-toolbar-button-hover")})},luckysheet.filterseletedbyindex=function(e,t,l,r){var a=visibledatarow[t],s=e-1==-1?0:visibledatarow[e-1],n=visibledatacolumn[r],o=l-1==-1?0:visibledatacolumn[l-1];$("#luckysheet-filter-selected-sheet"+luckysheet.currentSheetIndex).css({left:o,width:n-o-1,top:s,height:a-s-1}),$option=$("#luckysheet-filter-options-sheet"+luckysheet.currentSheetIndex).find(".luckysheet-filter-options");for(var c=l;c<=r;c++)$option.eq(c-l).css({left:visibledatacolumn[c]-20,top:visibledatarow[e-1]})},luckysheet.seletedHighlistByindex=function(e,t,l,r,a){var s=visibledatarow[l],n=t-1==-1?0:visibledatarow[t-1],o=visibledatacolumn[a],c=r-1==-1?0:visibledatacolumn[r-1];$("#"+e).css({left:c,width:o-c-1,top:n,height:s-n-1})},luckysheet.selectHightlightShow=function(){if($("#luckysheet-cell-selected-boxs").show(),$("#luckysheet-cell-selected-boxs #luckysheet-cell-selected").siblings(".luckysheet-cell-selected").remove(),0<luckysheet_select_save.length){for(var e=0;e<luckysheet_select_save.length;e++){var t,l,r=luckysheet_select_save[e].row[0],a=luckysheet_select_save[e].row[1],s=luckysheet_select_save[e].column[0],n=luckysheet_select_save[e].column[1];t=null==luckysheet_select_save[e].row_focus?r:luckysheet_select_save[e].row_focus,l=null==luckysheet_select_save[e].column_focus?s:luckysheet_select_save[e].column_focus;var o=visibledatarow[a],c=r-1==-1?0:visibledatarow[r-1],u=visibledatacolumn[n],i=s-1==-1?0:visibledatacolumn[s-1],h=visibledatarow[t],d=t-1==-1?0:visibledatarow[t-1],y=visibledatacolumn[l],f=l-1==-1?0:visibledatacolumn[l-1],m=luckysheet.menuButton.mergeborer(luckysheet.flowdata,t,l);m&&(h=m.row[1],d=m.row[0],y=m.column[1],f=m.column[0]),luckysheet_select_save[e].row=[r,a],luckysheet_select_save[e].column=[s,n],luckysheet_select_save[e].row_focus=t,luckysheet_select_save[e].column_focus=l,luckysheet_select_save[e].left=f,luckysheet_select_save[e].width=y-f-1,luckysheet_select_save[e].top=d,luckysheet_select_save[e].height=h-d-1,luckysheet_select_save[e].left_move=i,luckysheet_select_save[e].width_move=u-i-1,luckysheet_select_save[e].top_move=c,luckysheet_select_save[e].height_move=o-c-1,0==e?1==luckysheet_select_save.length?mobilecheck?$("#luckysheet-cell-selected-boxs #luckysheet-cell-selected").css({left:luckysheet_select_save[e].left_move,width:luckysheet_select_save[e].width_move,top:luckysheet_select_save[e].top_move,height:luckysheet_select_save[e].height_move,display:"block",border:"1px solid #0188fb"}).find(".luckysheet-cs-draghandle").css("display","block").end().find(".luckysheet-cs-fillhandle").css("display","none").end().find(".luckysheet-cs-touchhandle").css("display","block"):$("#luckysheet-cell-selected-boxs #luckysheet-cell-selected").css({left:luckysheet_select_save[e].left_move,width:luckysheet_select_save[e].width_move,top:luckysheet_select_save[e].top_move,height:luckysheet_select_save[e].height_move,display:"block",border:"1px solid #0188fb"}).find(".luckysheet-cs-draghandle").css("display","block").end().find(".luckysheet-cs-fillhandle").css("display","block").end().find(".luckysheet-cs-touchhandle").css("display","none"):$("#luckysheet-cell-selected-boxs #luckysheet-cell-selected").css({left:luckysheet_select_save[e].left_move,width:luckysheet_select_save[e].width_move,top:luckysheet_select_save[e].top_move,height:luckysheet_select_save[e].height_move,display:"block",border:"1px solid rgba(1, 136, 251, 0.15)"}).find(".luckysheet-cs-draghandle").css("display","none").end().find(".luckysheet-cs-fillhandle").css("display","none"):$("#luckysheet-cell-selected-boxs").append('<div class="luckysheet-cell-selected" style="left: '+luckysheet_select_save[e].left_move+"px; width: "+luckysheet_select_save[e].width_move+"px; top: "+luckysheet_select_save[e].top_move+"px; height: "+luckysheet_select_save[e].height_move+'px; border: 1px solid rgba(1, 136, 251, 0.15); display: block;"></div>'),e==luckysheet_select_save.length-1&&($("#luckysheet-cell-selected-focus").css({left:luckysheet_select_save[e].left,width:luckysheet_select_save[e].width,top:luckysheet_select_save[e].top,height:luckysheet_select_save[e].height,display:"block"}),luckysheet.luckysheet_count_show(luckysheet_select_save[e].left_move,luckysheet_select_save[e].top_move,luckysheet_select_save[e].width_move,luckysheet_select_save[e].height_move,[r,a],[s,n]),luckysheet.formula.fucntionboxshow(t,l))}luckysheet.selectTitlesShow(luckysheet_select_save),$("#luckysheet-helpbox-cell").text(luckysheet.sheetmanage.getRangetxt(luckysheet.currentSheetIndex,luckysheet_select_save[luckysheet_select_save.length-1])),1==luckysheet_select_save.length&&luckysheet_select_save[0].row[0]==luckysheet_select_save[0].row[1]&&luckysheet_select_save[0].column[0]==luckysheet_select_save[0].column[1]&&luckysheet.dynamicArray_hightShow(luckysheet_select_save[0].row[0],luckysheet_select_save[0].column[0])}luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_select_save=luckysheet_select_save},luckysheet.selectTitlesShow=function(e){for(var t=$.extend(!0,[],e),l={},r={},a=0;a<t.length;a++)var s=t[a].row[0],n=t[a].row[1],o=t[a].column[0],c=t[a].column[1],l=luckysheet.selectTitlesMap(l,s,n),r=luckysheet.selectTitlesMap(r,o,c);$("#luckysheet-rows-h-selected").empty();for(var u=luckysheet.selectTitlesRange(l),a=0;a<u.length;a++){var s=u[a][0],n=u[a][u[a].length-1],i=luckysheet.rowLocationByIndex(n)[1],h=luckysheet.rowLocationByIndex(s)[0];$("#luckysheet-rows-h-selected").append('<div class="luckysheet-rows-h-selected" style="top: '+h+"px; height: "+(i-h-1)+'px; display: block; background-color: rgba(76, 76, 76, 0.1);"></div>')}$("#luckysheet-cols-h-selected").empty();for(var d=luckysheet.selectTitlesRange(r),y=0;y<d.length;y++){var o=d[y][0],c=d[y][d[y].length-1],f=luckysheet.colLocationByIndex(c)[1],m=luckysheet.colLocationByIndex(o)[0];$("#luckysheet-cols-h-selected").append('<div class="luckysheet-cols-h-selected" style="left: '+m+"px; width: "+(f-m-1)+'px; display: block; background-color: rgba(76, 76, 76, 0.1);"></div>')}},luckysheet.selectTitlesMap=function(e,t,l){for(var r=$.extend(!0,{},e),a=t;a<=l;a++)a in r||(r[a]=0);return r},luckysheet.selectTitlesRange=function(e){var t=[];for(var l in e)t.push(l);t.sort(function(e,t){return e-t});var r=[],a=[];if(1<t.length)for(var s=1;s<t.length;s++)t[s]-t[s-1]==1?(a.push(t[s-1]),s==t.length-1&&(a.push(t[s]),r.push(a))):1==s?s==t.length-1?(a.push(t[s-1]),r.push(a),r.push([t[s]])):r.push(t[0]):s==t.length-1?(a.push(t[s-1]),r.push(a),r.push([t[s]])):(a.push(t[s-1]),r.push(a),a=[]);else r.push([t[0]]);return r},luckysheet.selectIsOverlap=function(){for(var e=!1,t={},l=0;l<luckysheet_select_save.length;l++)for(var r=luckysheet_select_save[l].row[0],a=luckysheet_select_save[l].row[1],s=luckysheet_select_save[l].column[0],n=luckysheet_select_save[l].column[1],o=r;o<=a;o++)for(var c=s;c<=n;c++){if(o+"_"+c in t){e=!0;break}t[o+"_"+c]=0}return e},luckysheet.selectionCopyShow=function(e){if($("#luckysheet-selection-copy").empty(),null==e&&(e=luckysheet_selection_range),0<e.length)for(var t=0;t<e.length;t++){var l=e[t].row[0],r=e[t].row[1],a=e[t].column[0],s=e[t].column[1],n=visibledatarow[r],o=l-1==-1?0:visibledatarow[l-1],c=visibledatacolumn[s],u=a-1==-1?0:visibledatacolumn[a-1],i='<div class="luckysheet-selection-copy" style="display: block; left: '+u+"px; width: "+(c-u-1)+"px; top: "+o+"px; height: "+(n-o-1)+'px;"><div class="luckysheet-selection-copy-top luckysheet-copy"></div><div class="luckysheet-selection-copy-right luckysheet-copy"></div><div class="luckysheet-selection-copy-bottom luckysheet-copy"></div><div class="luckysheet-selection-copy-left luckysheet-copy"></div><div class="luckysheet-selection-copy-hc"></div></div>';$("#luckysheet-selection-copy").append(i)}},luckysheet.hasPartMC=function(e,t,l,r,a){var s=!1;for(x in config.merge){var n=e.merge[x];if(t<n.r){if(l>=n.r&&l<n.r+n.rs-1){if(r>=n.c&&r<=n.c+n.cs-1){s=!0;break}if(a>=n.c&&a<=n.c+n.cs-1){s=!0;break}if(r<n.c&&a>n.c+n.cs-1){s=!0;break}}else if(l>=n.r&&l==n.r+n.rs-1){if(r>n.c&&r<n.c+n.cs-1){s=!0;break}if(a>n.c&&a<n.c+n.cs-1){s=!0;break}if(r==n.c&&a<n.c+n.cs-1){s=!0;break}if(r>n.c&&a==n.c+n.cs-1){s=!0;break}}else if(l>n.r+n.rs-1){if(r>n.c&&r<=n.c+n.cs-1){s=!0;break}if(a>=n.c&&a<n.c+n.cs-1){s=!0;break}if(r==n.c&&a<n.c+n.cs-1){s=!0;break}if(r>n.c&&a==n.c+n.cs-1){s=!0;break}}}else if(t==n.r){if(l<n.r+n.rs-1){if(r>=n.c&&r<=n.c+n.cs-1){s=!0;break}if(a>=n.c&&a<=n.c+n.cs-1){s=!0;break}if(r<n.c&&a>n.c+n.cs-1){s=!0;break}}else if(l>=n.r+n.rs-1){if(r>n.c&&r<=n.c+n.cs-1){s=!0;break}if(a>=n.c&&a<n.c+n.cs-1){s=!0;break}if(r==n.c&&a<n.c+n.cs-1){s=!0;break}if(r>n.c&&a==n.c+n.cs-1){s=!0;break}}}else if(t<=n.r+n.rs-1){if(r>=n.c&&r<=n.c+n.cs-1){s=!0;break}if(a>=n.c&&a<=n.c+n.cs-1){s=!0;break}if(r<n.c&&a>n.c+n.cs-1){s=!0;break}}}return s},luckysheet.dynamicArray_rangeIsAllNull=function(e,t){for(var l=e.row[0],r=e.row[1],a=e.column[0],s=e.column[1],n=!0,o=l;o<=r;o++)for(var c=a;c<=s;c++)if((o!=l||c!=a)&&null!=t[o][c]&&null!=t[o][c].v&&""!=t[o][c].v.toString()){n=!1;break}return n},luckysheet.dynamicArray_spillEditCompute=function(e,t,l){var r=e[t+"_"+l].r,a=e[t+"_"+l].c;for(x in e)x==r+"_"+a?e[x].v="#SPILL!":e[x].r==r&&e[x].c==a&&delete e[x];return e},luckysheet.dynamicArray_hightShow=function(e,t){var l=null==luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].dynamicArray?[]:luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].dynamicArray,r=luckysheet.dynamicArray_compute(l);if(e+"_"+t in r&&"#SPILL!"!=r[e+"_"+t].v){for(var a,s,n=r[e+"_"+t].r,o=r[e+"_"+t].c,c=luckysheet.flowdata[n][o].f,u=0;u<l.length;u++)l[u].f==c&&(a=l[u].data.length,s="array"==luckysheet.getObjType(l[u].data[0])?l[u].data[0].length:1);var i=o+s-1,h=visibledatarow[n+a-1],d=n-1==-1?0:visibledatarow[n-1],y=visibledatacolumn[i],f=o-1==-1?0:visibledatacolumn[o-1];$("#luckysheet-dynamicArray-hightShow").css({left:f,width:y-f-1,top:d,height:h-d-1,display:"block"})}else $("#luckysheet-dynamicArray-hightShow").hide()},luckysheet.dynamicArray_compute=function(e){var t={};if("array"==luckysheet.getObjType(e))for(var l=0;l<e.length;l++){var r=e[l].r,a=e[l].c,s=e[l].f;if(null!=luckysheet.flowdata[r][a]&&null!=luckysheet.flowdata[r][a].f&&luckysheet.flowdata[r][a].f==s){r+"_"+a in t&&(t=luckysheet.dynamicArray_spillEditCompute(t,r,a));var n=e[l].data,o=n.length,c=1;if("array"==luckysheet.getObjType(n[0])&&(c=n[0].length),luckysheet.dynamicArray_rangeIsAllNull({row:[r,r+o-1],column:[a,a+c-1]},luckysheet.flowdata))for(var u=0;u<o;u++)for(var i=0;i<c;i++){var h=r+u,d=a+i;"array"==luckysheet.getObjType(n[0])?t[h+"_"+d]={v:n[u][i],r:r,c:a}:t[h+"_"+d]={v:n[u],r:r,c:a}}else t[r+"_"+a]={v:"#SPILL!",r:r,c:a}}}return t},luckysheet.rowHasMerge=function(e,t,l){for(var r=!1,a=t;a<=l;a++){var s=luckysheet.flowdata[e][a];if("object"==luckysheet.getObjType(s)&&"mc"in s){r=!0;break}}return r},luckysheet.colHasMerge=function(e,t,l){for(var r=!1,a=t;a<=l;a++){var s=luckysheet.flowdata[a][e];if("object"==luckysheet.getObjType(s)&&"mc"in s){r=!0;break}}return r},luckysheet.getRowMerge=function(e,t,l){var r=luckysheet.flowdata.length-1,a=null;if(0<e)for(var s=e;0<=s;s--){for(var n=t;n<=l;n++){var o=luckysheet.flowdata[s][n];"object"==luckysheet.getObjType(o)&&"mc"in o&&(u=config.merge[o.mc.r+"_"+o.mc.c],(null==a||u.r<a)&&(a=u.r))}if(!(luckysheet.rowHasMerge(a-1,t,l)&&0<a))break;s=a-1}else a=0;var c=null;if(e<r)for(s=e;s<=r;s++){for(n=t;n<=l;n++){var u,o=luckysheet.flowdata[s][n];"object"==luckysheet.getObjType(o)&&"mc"in o&&(u=config.merge[o.mc.r+"_"+o.mc.c],(null==c||u.r+u.rs-1>c)&&(c=u.r+u.rs-1))}if(!(luckysheet.rowHasMerge(c+1,t,l)&&c<r))break;s=c+1}else c=r;return[a,c]},luckysheet.getColMerge=function(e,t,l){var r=luckysheet.flowdata[0].length-1,a=null;if(0<e)for(var s=e;0<=s;s--){for(var n=t;n<=l;n++){var o=luckysheet.flowdata[n][s];"object"==luckysheet.getObjType(o)&&"mc"in o&&(u=config.merge[o.mc.r+"_"+o.mc.c],(null==a||u.c<a)&&(a=u.c))}if(!(luckysheet.colHasMerge(a-1,t,l)&&0<a))break;s=a-1}else a=0;var c=null;if(e<r)for(s=e;s<=r;s++){for(n=t;n<=l;n++){var u,o=luckysheet.flowdata[n][s];"object"==luckysheet.getObjType(o)&&"mc"in o&&(u=config.merge[o.mc.r+"_"+o.mc.c],(null==c||u.c+u.cs-1>c)&&(c=u.c+u.cs-1))}if(!(luckysheet.colHasMerge(c+1,t,l)&&c<r))break;s=c+1}else c=r;return[a,c]},luckysheet.getNextIndex=function(e,t,l,r){var a=null;if("down"==e)for(var s=luckysheet.flowdata[l][t],n=("object"!=luckysheet.getObjType(s)||!luckysheet.func_methods.isRealNull(s.v))&&!luckysheet.func_methods.isRealNull(s),o=[],c=0,u=l+1;u<=r;u++){var i=luckysheet.flowdata[u][t];if("object"==luckysheet.getObjType(i)&&luckysheet.func_methods.isRealNull(i.v)||luckysheet.func_methods.isRealNull(i)?o.push(!1):o.push(!0),1==o.length&&n&&0==o[c]){a=l+c+1;break}if(1<o.length){if(n&&0==o[c]){a=l+c+1;break}if(!n){if(0==o[c]&&1==o[c-1]){a=l+c+1;break}if(1==o[c]&&0==o[c-1]){a=l+c;break}}}u==r&&(a=r),c++}else if("up"==e){s=luckysheet.flowdata[r][t];n=("object"!=luckysheet.getObjType(s)||!luckysheet.func_methods.isRealNull(s.v))&&!luckysheet.func_methods.isRealNull(s);for(o=[],c=0,u=r-1;l<=u;u--){i=luckysheet.flowdata[u][t];if("object"==luckysheet.getObjType(i)&&luckysheet.func_methods.isRealNull(i.v)||luckysheet.func_methods.isRealNull(i)?o.push(!1):o.push(!0),1==o.length&&n&&0==o[c]){a=r-(c+1);break}if(1<o.length){if(n&&0==o[c]){a=r-(c+1);break}if(!n){if(0==o[c]&&1==o[c-1]){a=r-(c+1);break}if(1==o[c]&&0==o[c-1]){a=r-c;break}}}u==l&&(a=l),c++}}else if("right"==e){s=luckysheet.flowdata[t][l];n=("object"!=luckysheet.getObjType(s)||!luckysheet.func_methods.isRealNull(s.v))&&!luckysheet.func_methods.isRealNull(s);for(var o=[],c=0,h=l+1;h<=r;h++){i=luckysheet.flowdata[t][h];if("object"==luckysheet.getObjType(i)&&luckysheet.func_methods.isRealNull(i.v)||luckysheet.func_methods.isRealNull(i)?o.push(!1):o.push(!0),1==o.length&&n&&0==o[c]){a=l+c+1;break}if(1<o.length){if(n&&0==o[c]){a=l+c+1;break}if(!n){if(0==o[c]&&1==o[c-1]){a=l+c+1;break}if(1==o[c]&&0==o[c-1]){a=l+c;break}}}h==r&&(a=r),c++}}else if("left"==e){s=luckysheet.flowdata[t][r];n=("object"!=luckysheet.getObjType(s)||!luckysheet.func_methods.isRealNull(s.v))&&!luckysheet.func_methods.isRealNull(s);for(o=[],c=0,h=r-1;l<=h;h--){i=luckysheet.flowdata[t][h];if("object"==luckysheet.getObjType(i)&&luckysheet.func_methods.isRealNull(i.v)||luckysheet.func_methods.isRealNull(i)?o.push(!1):o.push(!0),1==o.length&&n&&0==o[c]){a=r-(c+1);break}if(1<o.length){if(n&&0==o[c]){a=r-(c+1);break}if(!n){if(0==o[c]&&1==o[c-1]){a=r-(c+1);break}if(1==o[c]&&0==o[c-1]){a=r-c;break}}}h==l&&(a=l),c++}}return a},luckysheet.getBorderInfoCompute=function(e){var t,l,r={};l=null==e?(t=config,luckysheet.flowdata):(t=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(e)].config,luckysheetfile[luckysheet.sheetmanage.getSheetIndex(e)].data);var a=t.borderInfo;if(null!=a&&0<a.length)for(var s=0;s<a.length;s++){var n=a[s].rangeType;if("range"==n)for(var o=a[s].borderType,c=a[s].color,u=a[s].style,i=a[s].range,h=0;h<i.length;h++){var d=i[h].row[0],y=i[h].row[1],f=i[h].column[0],m=i[h].column[1];if("border-left"==o)for(var k=d;k<=y;k++){null!=t.rowhidden&&null!=t.rowhidden[k]||(null==r[k+"_"+f]&&(r[k+"_"+f]={}),r[k+"_"+f].l={color:c,style:u},0<=(b=f-1)&&r[k+"_"+b]&&(null!=l[k]&&"object"==luckysheet.getObjType(l[k][b])&&null!=l[k][b].mc?(_=l[k][b],(v=t.merge[_.mc.r+"_"+_.mc.c]).c+v.cs-1==b&&(r[k+"_"+b].r={color:c,style:u})):r[k+"_"+b].r={color:c,style:u}))}else if("border-right"==o)for(k=d;k<=y;k++){null!=t.rowhidden&&null!=t.rowhidden[k]||(null==r[k+"_"+m]&&(r[k+"_"+m]={}),r[k+"_"+m].r={color:c,style:u},(x=m+1)<l[0].length&&r[k+"_"+x]&&(null!=l[k]&&"object"==luckysheet.getObjType(l[k][x])&&null!=l[k][x].mc?(C=l[k][x],(v=t.merge[C.mc.r+"_"+C.mc.c]).c==x&&(r[k+"_"+x].l={color:c,style:u})):r[k+"_"+x].l={color:c,style:u}))}else if("border-top"==o){if(null!=t.rowhidden&&null!=t.rowhidden[d])continue;for(var p=f;p<=m;p++){null==r[d+"_"+p]&&(r[d+"_"+p]={}),r[d+"_"+p].t={color:c,style:u},0<=(T=d-1)&&r[T+"_"+p]&&(null!=l[T]&&"object"==luckysheet.getObjType(l[T][p])&&null!=l[T][p].mc?(I=l[T][p],(v=t.merge[I.mc.r+"_"+I.mc.c]).r+v.rs-1==T&&(r[T+"_"+p].b={color:c,style:u})):r[T+"_"+p].b={color:c,style:u})}}else if("border-bottom"==o){if(null!=t.rowhidden&&null!=t.rowhidden[y])continue;for(p=f;p<=m;p++){null==r[y+"_"+p]&&(r[y+"_"+p]={}),r[y+"_"+p].b={color:c,style:u},(R=y+1)<l.length&&r[R+"_"+p]&&(null!=l[R]&&"object"==luckysheet.getObjType(l[R][p])&&null!=l[R][p].mc?(S=l[R][p],(v=t.merge[S.mc.r+"_"+S.mc.c]).r==R&&(r[R+"_"+p].t={color:c,style:u})):r[R+"_"+p].t={color:c,style:u})}}else if("border-all"==o){for(k=d;k<=y;k++)if(null==t.rowhidden||null==t.rowhidden[k])for(p=f;p<=m;p++){null!=l[k]&&"object"==luckysheet.getObjType(l[k][p])&&null!=l[k][p].mc?(g=l[k][p],(v=t.merge[g.mc.r+"_"+g.mc.c]).r==k&&(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].t={color:c,style:u}),v.r+v.rs-1==k&&(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].b={color:c,style:u}),v.c==p&&(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].l={color:c,style:u}),v.c+v.cs-1==p&&(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].r={color:c,style:u})):(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].l={color:c,style:u},r[k+"_"+p].r={color:c,style:u},r[k+"_"+p].t={color:c,style:u},r[k+"_"+p].b={color:c,style:u}),k==d&&0<=(T=d-1)&&r[T+"_"+p]&&(null!=l[T]&&"object"==luckysheet.getObjType(l[T][p])&&null!=l[T][p].mc?(I=l[T][p],(v=t.merge[I.mc.r+"_"+I.mc.c]).r+v.rs-1==T&&(r[T+"_"+p].b={color:c,style:u})):r[T+"_"+p].b={color:c,style:u}),k==y&&(R=y+1)<l.length&&r[R+"_"+p]&&(null!=l[R]&&"object"==luckysheet.getObjType(l[R][p])&&null!=l[R][p].mc?(S=l[R][p],(v=t.merge[S.mc.r+"_"+S.mc.c]).r==R&&(r[R+"_"+p].t={color:c,style:u})):r[R+"_"+p].t={color:c,style:u}),p==f&&0<=(b=f-1)&&r[k+"_"+b]&&(null!=l[k]&&"object"==luckysheet.getObjType(l[k][b])&&null!=l[k][b].mc?(_=l[k][b],(v=t.merge[_.mc.r+"_"+_.mc.c]).c+v.cs-1==b&&(r[k+"_"+b].r={color:c,style:u})):r[k+"_"+b].r={color:c,style:u}),p==m&&(x=m+1)<l[0].length&&r[k+"_"+x]&&(null!=l[k]&&"object"==luckysheet.getObjType(l[k][x])&&null!=l[k][x].mc?(C=l[k][x],(v=t.merge[C.mc.r+"_"+C.mc.c]).c==x&&(r[k+"_"+x].l={color:c,style:u})):r[k+"_"+x].l={color:c,style:u})}}else if("border-outside"==o){for(k=d;k<=y;k++)if(null==t.rowhidden||null==t.rowhidden[k])for(p=f;p<=m;p++){k!=d&&k!=y&&p!=f&&p!=m||(k==d&&(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].t={color:c,style:u},0<=(T=d-1)&&r[T+"_"+p]&&(null!=l[T]&&"object"==luckysheet.getObjType(l[T][p])&&null!=l[T][p].mc?(I=l[T][p],(v=t.merge[I.mc.r+"_"+I.mc.c]).r+v.rs-1==T&&(r[T+"_"+p].b={color:c,style:u})):r[T+"_"+p].b={color:c,style:u})),k==y&&(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].b={color:c,style:u},(R=y+1)<l.length&&r[R+"_"+p]&&(null!=l[R]&&"object"==luckysheet.getObjType(l[R][p])&&null!=l[R][p].mc?(S=l[R][p],(v=t.merge[S.mc.r+"_"+S.mc.c]).r==R&&(r[R+"_"+p].t={color:c,style:u})):r[R+"_"+p].t={color:c,style:u})),p==f&&(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].l={color:c,style:u},0<=(b=f-1)&&r[k+"_"+b]&&(null!=l[k]&&"object"==luckysheet.getObjType(l[k][b])&&null!=l[k][b].mc?(_=l[k][b],(v=t.merge[_.mc.r+"_"+_.mc.c]).c+v.cs-1==b&&(r[k+"_"+b].r={color:c,style:u})):r[k+"_"+b].r={color:c,style:u})),p==m&&(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].r={color:c,style:u},(x=m+1)<l[0].length&&r[k+"_"+x]&&(null!=l[k]&&"object"==luckysheet.getObjType(l[k][x])&&null!=l[k][x].mc?(C=l[k][x],(v=t.merge[C.mc.r+"_"+C.mc.c]).c==x&&(r[k+"_"+x].l={color:c,style:u})):r[k+"_"+x].l={color:c,style:u})))}}else if("border-inside"==o){for(k=d;k<=y;k++)if(null==t.rowhidden||null==t.rowhidden[k])for(p=f;p<=m;p++){k==d&&p==f?null!=l[k]&&"object"==luckysheet.getObjType(l[k][p])&&null!=l[k][p].mc||(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].r={color:c,style:u},r[k+"_"+p].b={color:c,style:u}):k==y&&p==f?null!=l[k]&&"object"==luckysheet.getObjType(l[k][p])&&null!=l[k][p].mc||(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].r={color:c,style:u},r[k+"_"+p].t={color:c,style:u}):k==d&&p==m?null!=l[k]&&"object"==luckysheet.getObjType(l[k][p])&&null!=l[k][p].mc||(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].l={color:c,style:u},r[k+"_"+p].b={color:c,style:u}):k==y&&p==m?null!=l[k]&&"object"==luckysheet.getObjType(l[k][p])&&null!=l[k][p].mc||(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].l={color:c,style:u},r[k+"_"+p].t={color:c,style:u}):k==d?null!=l[k]&&"object"==luckysheet.getObjType(l[k][p])&&null!=l[k][p].mc?(g=l[k][p],(v=t.merge[g.mc.r+"_"+g.mc.c]).c==p?(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].l={color:c,style:u}):v.c+v.cs-1==p&&(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].r={color:c,style:u})):(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].l={color:c,style:u},r[k+"_"+p].r={color:c,style:u},r[k+"_"+p].b={color:c,style:u}):k==y?null!=l[k]&&"object"==luckysheet.getObjType(l[k][p])&&null!=l[k][p].mc?(g=l[k][p],(v=t.merge[g.mc.r+"_"+g.mc.c]).c==p?(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].l={color:c,style:u}):v.c+v.cs-1==p&&(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].r={color:c,style:u})):(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].l={color:c,style:u},r[k+"_"+p].r={color:c,style:u},r[k+"_"+p].t={color:c,style:u}):p==f?null!=l[k]&&"object"==luckysheet.getObjType(l[k][p])&&null!=l[k][p].mc?(g=l[k][p],(v=t.merge[g.mc.r+"_"+g.mc.c]).r==k?(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].t={color:c,style:u}):v.r+v.rs-1==k&&(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].b={color:c,style:u})):(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].r={color:c,style:u},r[k+"_"+p].t={color:c,style:u},r[k+"_"+p].b={color:c,style:u}):p==m?null!=l[k]&&"object"==luckysheet.getObjType(l[k][p])&&null!=l[k][p].mc?(g=l[k][p],(v=t.merge[g.mc.r+"_"+g.mc.c]).r==k?(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].t={color:c,style:u}):v.r+v.rs-1==k&&(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].b={color:c,style:u})):(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].l={color:c,style:u},r[k+"_"+p].t={color:c,style:u},r[k+"_"+p].b={color:c,style:u}):null!=l[k]&&"object"==luckysheet.getObjType(l[k][p])&&null!=l[k][p].mc?(g=l[k][p],(v=t.merge[g.mc.r+"_"+g.mc.c]).r==k?(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].t={color:c,style:u}):v.r+v.rs-1==k&&(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].b={color:c,style:u}),v.c==p?(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].l={color:c,style:u}):v.c+v.cs-1==p&&(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].r={color:c,style:u})):(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].l={color:c,style:u},r[k+"_"+p].r={color:c,style:u},r[k+"_"+p].t={color:c,style:u},r[k+"_"+p].b={color:c,style:u})}}else if("border-horizontal"==o){for(k=d;k<=y;k++)if(null==t.rowhidden||null==t.rowhidden[k])for(p=f;p<=m;p++){k==d?null!=l[k]&&"object"==luckysheet.getObjType(l[k][p])&&null!=l[k][p].mc||(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].b={color:c,style:u}):k==y?null!=l[k]&&"object"==luckysheet.getObjType(l[k][p])&&null!=l[k][p].mc||(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].t={color:c,style:u}):null!=l[k]&&"object"==luckysheet.getObjType(l[k][p])&&null!=l[k][p].mc?(g=l[k][p],(v=t.merge[g.mc.r+"_"+g.mc.c]).r==k?(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].t={color:c,style:u}):v.r+v.rs-1==k&&(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].b={color:c,style:u})):(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].t={color:c,style:u},r[k+"_"+p].b={color:c,style:u})}}else if("border-vertical"==o){for(k=d;k<=y;k++)if(null==t.rowhidden||null==t.rowhidden[k])for(p=f;p<=m;p++){p==f?null!=l[k]&&"object"==luckysheet.getObjType(l[k][p])&&null!=l[k][p].mc||(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].r={color:c,style:u}):p==m?null!=l[k]&&"object"==luckysheet.getObjType(l[k][p])&&null!=l[k][p].mc||(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].l={color:c,style:u}):null!=l[k]&&"object"==luckysheet.getObjType(l[k][p])&&null!=l[k][p].mc?(g=l[k][p],(v=t.merge[g.mc.r+"_"+g.mc.c]).c==p?(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].l={color:c,style:u}):v.c+v.cs-1==p&&(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].r={color:c,style:u})):(null==r[k+"_"+p]&&(r[k+"_"+p]={}),r[k+"_"+p].l={color:c,style:u},r[k+"_"+p].r={color:c,style:u})}}else if("border-none"==o)for(k=d;k<=y;k++)if(null==t.rowhidden||null==t.rowhidden[k])for(p=f;p<=m;p++){null!=r[k+"_"+p]&&delete r[k+"_"+p],k==d&&0<=(T=d-1)&&r[T+"_"+p]&&delete r[T+"_"+p].b,k==y&&(R=y+1)<l.length&&r[R+"_"+p]&&delete r[R+"_"+p].t,p==f&&0<=(b=f-1)&&r[k+"_"+b]&&delete r[k+"_"+b].r,p==m&&(x=m+1)<l[0].length&&r[k+"_"+x]&&delete r[k+"_"+x].l}}else if("cell"==n){var g,v,b,_,w,x,C,T,I,$,R,S,A=a[s].value,k=A.row_index,p=A.col_index;if(null!=t.rowhidden&&null!=t.rowhidden[k])continue;null!=A.l||null!=A.r||null!=A.t||null!=A.b?(null==r[k+"_"+p]&&(r[k+"_"+p]={}),null!=l[k]&&"object"==luckysheet.getObjType(l[k][p])&&null!=l[k][p].mc?(g=l[k][p],v=t.merge[g.mc.r+"_"+g.mc.c],null!=A.l&&p==v.c?(r[k+"_"+p].l={color:A.l.color,style:A.l.style},0<=(b=p-1)&&r[k+"_"+b]&&(null!=l[k]&&"object"==luckysheet.getObjType(l[k][b])&&null!=l[k][b].mc?(_=l[k][b],(w=t.merge[_.mc.r+"_"+_.mc.c]).c+w.cs-1==b&&(r[k+"_"+b].r={color:A.l.color,style:A.l.style})):r[k+"_"+b].r={color:A.l.color,style:A.l.style})):r[k+"_"+p].l=null,null!=A.r&&p==v.c+v.cs-1?(r[k+"_"+p].r={color:A.r.color,style:A.r.style},(x=p+1)<l[0].length&&r[k+"_"+x]&&(null!=l[k]&&"object"==luckysheet.getObjType(l[k][x])&&null!=l[k][x].mc?(C=l[k][x],t.merge[C.mc.r+"_"+C.mc.c].c==x&&(r[k+"_"+x].l={color:A.r.color,style:A.r.style})):r[k+"_"+x].l={color:A.r.color,style:A.r.style})):r[k+"_"+p].r=null,null!=A.t&&k==v.r?(r[k+"_"+p].t={color:A.t.color,style:A.t.style},0<=(T=k-1)&&r[T+"_"+p]&&(null!=l[T]&&"object"==luckysheet.getObjType(l[T][p])&&null!=l[T][p].mc?(I=l[T][p],($=t.merge[I.mc.r+"_"+I.mc.c]).r+$.rs-1==T&&(r[T+"_"+p].b={color:A.t.color,style:A.t.style})):r[T+"_"+p].b={color:A.t.color,style:A.t.style})):r[k+"_"+p].t=null,null!=A.b&&k==v.r+v.rs-1?(r[k+"_"+p].b={color:A.b.color,style:A.b.style},(R=k+1)<l.length&&r[R+"_"+p]&&(null!=l[R]&&"object"==luckysheet.getObjType(l[R][p])&&null!=l[R][p].mc?(S=l[R][p],t.merge[S.mc.r+"_"+S.mc.c].r==R&&(r[R+"_"+p].t={color:A.b.color,style:A.b.style})):r[R+"_"+p].t={color:A.b.color,style:A.b.style})):r[k+"_"+p].b=null):(null!=A.l?(r[k+"_"+p].l={color:A.l.color,style:A.l.style},0<=(b=p-1)&&r[k+"_"+b]&&(null!=l[k]&&"object"==luckysheet.getObjType(l[k][b])&&null!=l[k][b].mc?(_=l[k][b],(w=t.merge[_.mc.r+"_"+_.mc.c]).c+w.cs-1==b&&(r[k+"_"+b].r={color:A.l.color,style:A.l.style})):r[k+"_"+b].r={color:A.l.color,style:A.l.style})):r[k+"_"+p].l=null,null!=A.r?(r[k+"_"+p].r={color:A.r.color,style:A.r.style},(x=p+1)<l[0].length&&r[k+"_"+x]&&(null!=l[k]&&"object"==luckysheet.getObjType(l[k][x])&&null!=l[k][x].mc?(C=l[k][x],t.merge[C.mc.r+"_"+C.mc.c].c==x&&(r[k+"_"+x].l={color:A.r.color,style:A.r.style})):r[k+"_"+x].l={color:A.r.color,style:A.r.style})):r[k+"_"+p].r=null,null!=A.t?(r[k+"_"+p].t={color:A.t.color,style:A.t.style},0<=(T=k-1)&&r[T+"_"+p]&&(null!=l[T]&&"object"==luckysheet.getObjType(l[T][p])&&null!=l[T][p].mc?(I=l[T][p],($=t.merge[I.mc.r+"_"+I.mc.c]).r+$.rs-1==T&&(r[T+"_"+p].b={color:A.t.color,style:A.t.style})):r[T+"_"+p].b={color:A.t.color,style:A.t.style})):r[k+"_"+p].t=null,null!=A.b?(r[k+"_"+p].b={color:A.b.color,style:A.b.style},(R=k+1)<l.length&&r[R+"_"+p]&&(null!=l[R]&&"object"==luckysheet.getObjType(l[R][p])&&null!=l[R][p].mc?(S=l[R][p],t.merge[S.mc.r+"_"+S.mc.c].r==R&&(r[R+"_"+p].t={color:A.b.color,style:A.b.style})):r[R+"_"+p].t={color:A.b.color,style:A.b.style})):r[k+"_"+p].b=null)):delete r[k+"_"+p]}}return r};var luckysheetbinary_search=function(e,t){for(var l=0,r=e.length-1;l<=r;){var a=parseInt((r+l)/2);if(t<e[a]&&(0==a||t>=e[a-1]))return a;if(t>=e[a])l=a+1;else{if(!(t<e[a]))return-1;r=a-1}}},luckysheetorder_search=function(e,t){for(var l=0,r=0,a=-1,s=e.length-1;l<e.length&&0<=s&&l<=s;){if(r=e[s],(0==s?0:e[s-1])<=t&&t<r){a=s;break}if(r=e[l],(0==l?0:e[l-1])<=t&&t<r){a=l;break}l++,s--}return a},luckysheet_searcharray=function(e,t){if(luckysheetConfigsetting.pointEdit){e=$.extend(!0,[],e);for(var l=0;l<e.length;l++)e[l]=e[l]*luckysheetConfigsetting.pointEditZoom}var r=e.length-1;return r=(e.length<40||t<=e[20]||t>=e[r-20]?luckysheetorder_search:luckysheetbinary_search)(e,t)};luckysheet.luckysheetHandler=function(){luckysheet.luckysheetscrollevent=function(e){var t=$("#luckysheet-cell-main"),l=$("#luckysheet-scrollbar-x").scrollLeft(),r=$("#luckysheet-scrollbar-y").scrollTop();return null!=luckysheet.freezen.freezenhorizontaldata&&r<luckysheet.freezen.freezenhorizontaldata[2]?(r=luckysheet.freezen.freezenhorizontaldata[2],void $("#luckysheet-scrollbar-y").scrollTop(r)):null!=luckysheet.freezen.freezenverticaldata&&l<luckysheet.freezen.freezenverticaldata[2]?(l=luckysheet.freezen.freezenverticaldata[2],void $("#luckysheet-scrollbar-x").scrollLeft(l)):($("#luckysheet-cols-h-c").scrollLeft(l),$("#luckysheet-rows-h").scrollTop(r),luckysheetautoscrollp=[l,r],t.scrollLeft(l).scrollTop(r),$("#luckysheet-input-box-index").css({left:$("#luckysheet-input-box").css("left"),top:parseInt($("#luckysheet-input-box").css("top"))-20+"px","z-index":$("#luckysheet-input-box").css("z-index")}).show(),luckysheet.luckysheetrefreshgrid(l,r),$("#luckysheet-bottom-controll-row").css("left",l+10),void(null==luckysheet.freezen.freezenhorizontaldata&&null==luckysheet.freezen.freezenverticaldata||luckysheet.freezen.scrollAdapt()))},$("#luckysheet-cell-main").scroll(function(){}).mousewheel(function(e,t){e.preventDefault()}),$("#luckysheet-grid-window-1").mousewheel(function(e,t){var l=$("#luckysheet-scrollbar-x").scrollLeft(),r=$("#luckysheet-scrollbar-y").scrollTop(),a=visibledatacolumn,s=visibledatarow;null!=luckysheet.freezen.freezenhorizontaldata&&(s=luckysheet.freezen.freezenhorizontaldata[3]),null!=luckysheet.freezen.freezenverticaldata&&(a=luckysheet.freezen.freezenverticaldata[3]),a=luckysheet.ArrayUnique(a),s=luckysheet.ArrayUnique(s);var n,o,c,u,i=luckysheet_searcharray(a,l),h=luckysheet_searcharray(s,r);0!=e.deltaX&&(e.deltaX<0?(c=i+3)>=a.length&&(c=a.length-1):(c=i-3)<0&&(c=0),n=0==c?0:a[c-1],$("#luckysheet-scrollbar-x").scrollLeft(n)),0!=e.deltaY&&(e.deltaY<0?(u=h+3)>=s.length&&(u=s.length-1):(u=h-3)<0&&(u=0),o=0==u?0:s[u-1],$("#luckysheet-scrollbar-y").scrollTop(o))}),$("#luckysheet-scrollbar-x").scroll(function(){setTimeout(function(){luckysheet.luckysheetscrollevent(!0)},10)}).mousewheel(function(e,t){e.preventDefault()}),$("#luckysheet-scrollbar-y").scroll(function(){setTimeout(function(){luckysheet.luckysheetscrollevent(!0)},10)}).mousewheel(function(e,t){e.preventDefault()}),$(window).resize(function(){iscopyself=!1,document.getElementById("luckysheet")&&luckysheet.luckysheetsizeauto()}),luckysheet.ArrayUnique=function(e){var t=[];if(0<e.length)for(var l=0;l<e.length;l++)-1==t.indexOf(e[l])&&t.push(e[l]);return t},luckysheet.rowLocationByIndex=function(e){var t=visibledatarow[e];return[0==e?0:visibledatarow[e-1],t,e]},luckysheet.rowLocation=function(e){var t=luckysheet_searcharray(visibledatarow,e);return-1==t&&0<e?t=visibledatarow.length-1:-1==t&&e<=0&&(t=0),luckysheet.rowLocationByIndex(t)},luckysheet.colLocationByIndex=function(e){var t=visibledatacolumn[e];return[0==e?0:visibledatacolumn[e-1],t,e]},luckysheet.colLocation=function(e){var t=luckysheet_searcharray(visibledatacolumn,e);return-1==t&&0<e?t=visibledatacolumn.length-1:-1==t&&e<=0&&(t=0),luckysheet.colLocationByIndex(t)};var mouseposition=function(e,t){var l,r,a=$("#"+container).offset();return r=luckysheetConfigsetting.pointEdit?(l=e-a.left-rowHeaderWidth*luckysheetConfigsetting.pointEditZoom,t-a.top-(infobarHeight+toolbarHeight+calculatebarHeight+columeHeaderHeight)*luckysheetConfigsetting.pointEditZoom):(l=e-a.left-rowHeaderWidth,t-a.top-infobarHeight-toolbarHeight-calculatebarHeight-columeHeaderHeight),[l,r]};luckysheet.mouseposition=mouseposition;var luckysheet_cell_selected_move=!1,luckysheet_cell_selected_move_index=[];$("#luckysheet-cell-main div.luckysheet-cs-draghandle").mousedown(function(e){var t,l,r,a,s,n,o,c,u,i,h;luckysheet.isEditMode()||($("#luckysheet-cell-selected").find(".luckysheet-cs-fillhandle").css("cursor","move").end().find(".luckysheet-cs-draghandle").css("cursor","move"),$("#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0").css("cursor","move"),luckysheet_scroll_status=luckysheet_cell_selected_move=!0,l=(t=mouseposition(e.pageX,e.pageY))[0]+$("#luckysheet-cell-main").scrollLeft(),r=t[1]+$("#luckysheet-cell-main").scrollTop(),s=(a=luckysheet.rowLocation(r))[0],n=a[1],o=a[2],u=(c=luckysheet.colLocation(l))[0],i=c[1],h=c[2],luckysheet_cell_selected_move_index=[o,h],$("#luckysheet-cell-selected-move").css({left:u,width:i-u-1,top:s,height:n-s-1,display:"block"}),e.stopPropagation())});var luckysheet_cell_selected_extend=!1,luckysheet_cell_selected_extend_index=[],luckysheet_cell_selected_extend_time=null;$("#luckysheet-cell-main div.luckysheet-cs-fillhandle").mousedown(function(h){luckysheet.isEditMode()||($("#luckysheet-cell-selected").find(".luckysheet-cs-fillhandle").css("cursor","crosshair").end().find(".luckysheet-cs-draghandle").css("cursor","crosshair"),$("#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0").css("cursor","crosshair"),luckysheet_cell_selected_extend_time=setTimeout(function(){luckysheet_scroll_status=luckysheet_cell_selected_extend=!0;var e=mouseposition(h.pageX,h.pageY),t=e[0]+$("#luckysheet-cell-main").scrollLeft()-5,l=e[1]+$("#luckysheet-cell-main").scrollTop()-5,r=luckysheet.rowLocation(l),a=r[0],s=r[1],n=r[2],o=luckysheet.colLocation(t),c=o[0],u=o[1],i=o[2];luckysheet_cell_selected_extend_index=[n,i],$("#luckysheet-cell-selected-extend").css({left:c,width:u-c-1,top:a,height:s-a-1,display:"block"})},100),h.stopPropagation())}).click(function(){clearTimeout(luckysheet_cell_selected_extend_time),event.stopPropagation()}).dblclick(function(){var e=luckysheet_select_save[0],t=e.row[0],l=e.row[1],r=e.column[0],a=e.column[1];if(!luckysheet.pivotTable.isPivotRange(t,r)){for(var s,n=!1,o=0,c=l+1;c<luckysheet.flowdata.length;c++)if(0<=r-1&&a+1<luckysheet.flowdata[0].length){var u=luckysheet.flowdata[c][r-1],i=luckysheet.flowdata[c][a+1];if(c==l+1){if((null==u||luckysheet.func_methods.isRealNull(u.v))&&(null==i||luckysheet.func_methods.isRealNull(i.v))){n=!1;break}n=!0,o++}else{if((null==u||luckysheet.func_methods.isRealNull(u.v))&&(null==i||luckysheet.func_methods.isRealNull(i.v)))break;o++}}else if(0<=r-1){var h=luckysheet.flowdata[c][r-1];if(c==l+1){if(null==h||luckysheet.func_methods.isRealNull(h.v)){n=!1;break}n=!0,o++}else{if(null==h||luckysheet.func_methods.isRealNull(h.v))break;o++}}else if(a+1<luckysheet.flowdata[0].length){h=luckysheet.flowdata[c][a+1];if(c==l+1){if(null==h||luckysheet.func_methods.isRealNull(h.v)){n=!1;break}n=!0,o++}else{if(null==h||luckysheet.func_methods.isRealNull(h.v))break;o++}}n&&0!=o&&(luckysheet.dropCell.copyRange={row:[t,l],column:[r,a]},(s=luckysheet.dropCell.typeItemHide())[0]||s[1]||s[2]||s[3]||s[4]||s[5]||s[6]?luckysheet.dropCell.applyType="1":luckysheet.dropCell.applyType="0",luckysheet.dropCell.applyRange={row:[l+1,l+o],column:[r,a]},luckysheet.dropCell.direction="down",luckysheet_select_save=[{row:[t,l+o],column:[r,a]}],luckysheet.dropCell.update(),luckysheet.dropCell.createIcon(),$("#luckysheet-cell-selected-move").hide(),$("#luckysheet-sheettable").css("cursor","default"),clearTimeout(jfcountfuncTimeout),jfcountfuncTimeout=setTimeout(function(){jfcountfunc()},500)),event.stopPropagation()}}),$("#luckysheet-cell-main, #luckysheetTableContent").mousedown(function(e){$("#luckysheet-cell-selected").find(".luckysheet-cs-fillhandle").css("cursor","default").end().find(".luckysheet-cs-draghandle").css("cursor","default"),$("#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0").css("cursor","default"),luckysheet.postil.removeActivePs();var t=mouseposition(e.pageX,e.pageY);if(!(t[0]>=cellmainWidth-cellMainSrollBarSize||t[1]>=cellmainHeight-cellMainSrollBarSize)){var l=t[0]+$("#luckysheet-cell-main").scrollLeft(),r=t[1]+$("#luckysheet-cell-main").scrollTop();null!=luckysheet.freezen.freezenverticaldata&&t[0]<luckysheet.freezen.freezenverticaldata[0]-luckysheet.freezen.freezenverticaldata[2]&&(l=t[0]+luckysheet.freezen.freezenverticaldata[2]),null!=luckysheet.freezen.freezenhorizontaldata&&t[1]<luckysheet.freezen.freezenhorizontaldata[0]-luckysheet.freezen.freezenhorizontaldata[2]&&(r=t[1]+luckysheet.freezen.freezenhorizontaldata[2]);var a=luckysheet.rowLocation(r),s=a[1],n=a[0],o=a[2],c=luckysheet.colLocation(l),u=c[1],i=c[0],h=c[2],d=o,y=h,f=luckysheet.menuButton.mergeborer(luckysheet.flowdata,o,h);if(f&&(s=f.row[1],n=f.row[0],o=f.row[2],d=f.row[3],u=f.column[1],i=f.column[0],h=f.column[2],y=f.column[3]),i<$("#luckysheet-cell-main").scrollLeft()&&$("#luckysheet-scrollbar-x").scrollLeft(i),n<$("#luckysheet-cell-main").scrollTop()&&$("#luckysheet-scrollbar-y").scrollTop(n),"3"==e.which){for(var m=!1,k=0;k<luckysheet_select_save.length;k++)if(null!=luckysheet_select_save[k].row&&o>=luckysheet_select_save[k].row[0]&&o<=luckysheet_select_save[k].row[1]&&h>=luckysheet_select_save[k].column[0]&&h<=luckysheet_select_save[k].column[1]){m=!0;break}if(m)return}if(null==luckysheet.flowdata[o]||null==luckysheet.flowdata[o][h]||null==luckysheet.flowdata[o][h].dd||null==luckysheetConfigsetting.fireMousedown||"function"!=luckysheet.getObjType(luckysheetConfigsetting.fireMousedown)){luckysheet_scroll_status=!0;var p=$("#luckysheet-input-box");if(0<parseInt(p.css("top"))){if(luckysheet.formula.rangestart||luckysheet.formula.rangedrag_column_start||luckysheet.formula.rangedrag_row_start||luckysheet.formula.israngeseleciton()){var g,v,b,_,w,x=[o,d],C=[h,y],T=i,I=u-i-1,R=n,S=s-n-1;return e.shiftKey?(S=R=0,x=[],x=(g=luckysheet.formula.func_selectedrange).top>n?(R=n,S=g.top+g.height-n,g.row[1]>g.row_focus&&(g.row[1]=g.row_focus),[o,g.row[1]]):g.top==n?(R=n,S=g.top+g.height-n,[o,g.row[0]]):(R=g.top,S=s-g.top-1,g.row[0]<g.row_focus&&(g.row[0]=g.row_focus),[g.row[0],o]),I=T=0,C=[],C=g.left>i?(T=i,I=g.left+g.width-i,g.column[1]>g.column_focus&&(g.column[1]=g.column_focus),[h,g.column[1]]):g.left==i?(T=i,I=g.left+g.width-i,[h,g.column[0]]):(T=g.left,I=u-g.left-1,g.column[0]<g.column_focus&&(g.column[0]=g.column_focus),[g.column[0],h]),null!=(v=luckysheet.menuButton.mergeMoveMain(C,x,g,R,S,T,I))&&(C=v[0],x=v[1],R=v[2],S=v[3],T=v[4],I=v[5]),luckysheet.luckysheet_count_show(T,R,I,S,x,C),g.row=x,g.column=C,g.left_move=T,g.width_move=I,g.top_move=R,g.height_move=S,luckysheet.formula.func_selectedrange=g):(e.ctrlKey&&","!=$("#luckysheet-rich-text-editor").find("span").last().text()&&(0<(w=$("#luckysheet-rich-text-editor").text()+",").length&&"="==w.substr(0,1)&&(w=luckysheet.formula.functionHTMLGenerate(w),window.getSelection?(b=window.getSelection(),luckysheet.formula.functionRangeIndex=[$(b.anchorNode).parent().index(),b.anchorOffset]):(_=document.selection.createRange(),luckysheet.formula.functionRangeIndex=_),$("#luckysheet-rich-text-editor").html(w),luckysheet.formula.canceFunctionrangeSelected(),luckysheet.formula.createRangeHightlight()),luckysheet.formula.rangestart=!1,luckysheet.formula.rangedrag_column_start=!1,luckysheet.formula.rangedrag_row_start=!1,$("#luckysheet-functionbox-cell").html(w),luckysheet.formula.rangeHightlightselected($("#luckysheet-rich-text-editor")),luckysheet.formula.israngeseleciton()),luckysheet.formula.func_selectedrange={left:T,width:I,top:R,height:S,left_move:T,width_move:I,top_move:R,height_move:S,row:x,column:C,row_focus:o,column_focus:h}),luckysheet.formula.rangeSetValue({row:x,column:C}),luckysheet.formula.rangestart=!0,luckysheet.formula.rangedrag_column_start=!1,luckysheet.formula.rangedrag_row_start=!1,$("#luckysheet-formula-functionrange-select").css({left:T,width:I,top:R,height:S}).show(),$("#luckysheet-formula-help-c").hide(),luckysheet.luckysheet_count_show(T,R,I,S,x,C),void setTimeout(function(){var e=window.getSelection().anchorNode;$("#luckysheet-search-formula-parm").is(":visible")||$("#luckysheet-search-formula-parm-select").is(":visible")?($editor=$("#luckysheet-rich-text-editor"),luckysheet.formula.rangechangeindex=luckysheet.formula.data_parm_index):$editor=$(e).closest("div");var t=$editor.find("span[rangeindex='"+luckysheet.formula.rangechangeindex+"']");luckysheet.formula.setCaretPosition(t.get(0),0,t.html().length)},1)}luckysheet.formula.updatecell(luckysheetCellUpdate[0],luckysheetCellUpdate[1]),luckysheet_select_status=!0,$("#luckysheet-info").is(":visible")&&(luckysheet_select_status=!1)}else luckysheet_select_status=!0;if($("#luckysheet-multiRange-dialog").is(":visible")){luckysheet.conditionformat.selectStatus=!0,luckysheet_select_status=!1,e.shiftKey?(S=R=0,x=[],x=(g=luckysheet.conditionformat.selectRange[luckysheet.conditionformat.selectRange.length-1]).top>n?(R=n,S=g.top+g.height-n,g.row[1]>g.row_focus&&(g.row[1]=g.row_focus),[o,g.row[1]]):g.top==n?(R=n,S=g.top+g.height-n,[o,g.row[0]]):(R=g.top,S=s-g.top-1,g.row[0]<g.row_focus&&(g.row[0]=g.row_focus),[g.row[0],o]),I=T=0,C=[],C=g.left>i?(T=i,I=g.left+g.width-i,g.column[1]>g.column_focus&&(g.column[1]=g.column_focus),[h,g.column[1]]):g.left==i?(T=i,I=g.left+g.width-i,[h,g.column[0]]):(T=g.left,I=u-g.left-1,g.column[0]<g.column_focus&&(g.column[0]=g.column_focus),[g.column[0],h]),null!=(v=luckysheet.menuButton.mergeMoveMain(C,x,g,R,S,T,I))&&(C=v[0],x=v[1],R=v[2],S=v[3],T=v[4],I=v[5]),g.row=x,g.column=C,g.left_move=T,g.width_move=I,g.top_move=R,g.height_move=S,luckysheet.conditionformat.selectRange[luckysheet.conditionformat.selectRange.length-1]=g):(e.ctrlKey||(luckysheet.conditionformat.selectRange=[]),luckysheet.conditionformat.selectRange.push({left:i,width:u-i-1,top:n,height:s-n-1,left_move:i,width_move:u-i-1,top_move:n,height_move:s-n-1,row:[o,d],column:[h,y],row_focus:o,column_focus:h})),luckysheet.selectionCopyShow(luckysheet.conditionformat.selectRange);var A=luckysheet.conditionformat.getTxtByRange(luckysheet.conditionformat.selectRange);$("#luckysheet-multiRange-dialog input").val(A)}else if(luckysheet.conditionformat.selectStatus=!1,luckysheet.conditionformat.selectRange=[],$("#luckysheet-singleRange-dialog").is(":visible")){luckysheet_select_status=!1,luckysheet.selectionCopyShow([{row:[o,o],column:[h,h]}]);A=luckysheet.sheetmanage.getRangetxt(luckysheet.currentSheetIndex,{row:[o,o],column:[h,h]},luckysheet.currentSheetIndex);$("#luckysheet-singleRange-dialog input").val(A)}else if(luckysheet.ifFormulaGenerator.singleRangeFocus&&$("#luckysheet-ifFormulaGenerator-dialog .singRange").click(),$("#luckysheet-ifFormulaGenerator-singleRange-dialog").is(":visible")){luckysheet_select_status=!1,luckysheet.formula.rangestart=!1,$("#luckysheet-formula-functionrange-select").css({left:i,width:u-i-1,top:n,height:s-n-1}).show(),$("#luckysheet-formula-help-c").hide();A=luckysheet.sheetmanage.getRangetxt(luckysheet.currentSheetIndex,{row:[o,o],column:[h,h]},luckysheet.currentSheetIndex);$("#luckysheet-ifFormulaGenerator-singleRange-dialog input").val(A)}else{if($("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){luckysheet_select_status=!1,luckysheet.formula.func_selectedrange={left:i,width:u-i-1,top:n,height:s-n-1,left_move:i,width_move:u-i-1,top_move:n,height_move:s-n-1,row:[o,o],column:[h,h],row_focus:o,column_focus:h},luckysheet.formula.rangestart=!0,$("#luckysheet-formula-functionrange-select").css({left:i,width:u-i-1,top:n,height:s-n-1}).show(),$("#luckysheet-formula-help-c").hide();A=luckysheet.sheetmanage.getRangetxt(luckysheet.currentSheetIndex,{row:[o,o],column:[h,h]},luckysheet.currentSheetIndex);return $("#luckysheet-ifFormulaGenerator-multiRange-dialog input").val(A),$("#luckysheet-row-count-show").hide(),void $("#luckysheet-column-count-show").hide()}luckysheet_select_status&&(e.shiftKey?(S=R=0,x=[],x=(g=$.extend(!0,{},luckysheet_select_save[luckysheet_select_save.length-1])).top>n?(R=n,S=g.top+g.height-n,g.row[1]>g.row_focus&&(g.row[1]=g.row_focus),[o,g.row[1]]):g.top==n?(R=n,S=g.top+g.height-n,[o,g.row[0]]):(R=g.top,S=s-g.top-1,g.row[0]<g.row_focus&&(g.row[0]=g.row_focus),[g.row[0],o]),I=T=0,C=[],C=g.left>i?(T=i,I=g.left+g.width-i,g.column[1]>g.column_focus&&(g.column[1]=g.column_focus),[h,g.column[1]]):g.left==i?(T=i,I=g.left+g.width-i,[h,g.column[0]]):(T=g.left,I=u-g.left-1,g.column[0]<g.column_focus&&(g.column[0]=g.column_focus),[g.column[0],h]),null!=(v=luckysheet.menuButton.mergeMoveMain(C,x,g,R,S,T,I))&&(C=v[0],x=v[1],R=v[2],S=v[3],T=v[4],I=v[5]),g.row=x,g.column=C,g.left_move=T,g.width_move=I,g.top_move=R,g.height_move=S,luckysheet_select_save[luckysheet_select_save.length-1]=g,$("#luckysheet-alternateformat-rangeDialog").is(":visible")&&$("#luckysheet-alternateformat-rangeDialog input").val(luckysheet.sheetmanage.getRangetxt(luckysheet.currentSheetIndex,luckysheet_select_save)),luckysheet.chartparam.luckysheet_chart_data_select_state&&$("#luckysheet-datavisual-range-selection-input").val(luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].name+"!"+luckysheet.luckysheetchatatABC(luckysheet_select_save[0].column[0])+(luckysheet_select_save[0].row[0]+1)+":"+luckysheet.luckysheetchatatABC(luckysheet_select_save[0].column[1])+(luckysheet_select_save[0].row[1]+1)),luckysheet.pivotTable.luckysheet_pivotTable_select_state&&$("#luckysheet-pivotTable-range-selection-input").val(luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].name+"!"+luckysheet.luckysheetchatatABC(luckysheet_select_save[0].column[0])+(luckysheet_select_save[0].row[0]+1)+":"+luckysheet.luckysheetchatatABC(luckysheet_select_save[0].column[1])+(luckysheet_select_save[0].row[1]+1))):e.ctrlKey?luckysheet_select_save.push({left:i,width:u-i-1,top:n,height:s-n-1,left_move:i,width_move:u-i-1,top_move:n,height_move:s-n-1,row:[o,d],column:[h,y],row_focus:o,column_focus:h}):((luckysheet_select_save=[]).push({left:i,width:u-i-1,top:n,height:s-n-1,left_move:i,width_move:u-i-1,top_move:n,height_move:s-n-1,row:[o,d],column:[h,y],row_focus:o,column_focus:h}),luckysheet.menuButton.menuButtonFocus(luckysheet.flowdata,o,h),luckysheet.formula.fucntionboxshow(o,h)),luckysheet.selectHightlightShow(),null==luckysheet.freezen.freezenhorizontaldata&&null==luckysheet.freezen.freezenverticaldata||luckysheet.freezen.scrollAdaptOfselect(),mobilecheck||luckysheetactiveCell(),luckysheet.server.allowUpdate&&luckysheet.server.saveParam("mv",luckysheet.currentSheetIndex,luckysheet_select_save)),clearTimeout(luckysheet.chartparam.luckysheet_chart_rangefocus_timeout),luckysheet.chartparam.luckysheet_chart_rangefocus&&(luckysheet.chartparam.luckysheet_chart_rangefocus=!1,$("#luckysheet-datavisual-range-button").click()),luckysheet.alternateformat.rangefocus&&(luckysheet.alternateformat.rangefocus=!1,$("#luckysheet-alternateformat-range .fa-table").click()),$("#luckysheet-row-count-show, #luckysheet-column-count-show").hide(),luckysheet.isEditMode()||window.store&&store.commit("hideAllNeedRangeShow"),$("#luckysheet-helpbox-cell").text(luckysheet.sheetmanage.getRangetxt(luckysheet.currentSheetIndex,luckysheet_select_save[luckysheet_select_save.length-1])),luckysheet.pivotTable.pivotclick(o,h,luckysheet.currentSheetIndex),$("#"+container).attr("tabindex",0).focus()}}else luckysheetConfigsetting.fireMousedown(luckysheet.flowdata[o][h].dd)}}).mouseup(function(e){if("3"==e.which){if(luckysheet.isEditMode())return;var t,l=e.pageX,r=e.pageY,a=(luckysheet.flowdata,luckysheet_select_save[0]);if($("#luckysheet-cols-rows-data").show(),$("#luckysheet-cols-rows-add, #luckysheet-cols-rows-shift").hide(),null!=a.row&&0==a.row[0]&&a.row[1]==luckysheet.flowdata.length-1){luckysheetRightHeadClickIs="column",$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word").text("列"),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-size").text("宽"),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left").text("左"),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right").text("右"),$("#luckysheet-cols-rows-add").show(),$("#luckysheet-cols-rows-data").show(),$("#luckysheet-cols-rows-shift").hide(),luckysheet_cols_menu_status=!0,null==(t=$.extend(!0,{},config)).columlen&&(t.columlen={});for(var s=null==t.columlen[luckysheet_select_save[0].column[0]]?luckysheet.defaultcollen:t.columlen[luckysheet_select_save[0].column[0]],n=!0,o=0;o<luckysheet_select_save.length;o++)for(var c=(d=luckysheet_select_save[o]).column[0],u=d.column[1],i=c;i<=u;i++){if((null==t.columlen[i]?luckysheet.defaultcollen:t.columlen[i])!=s){n=!1;break}}n?$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val(s):$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val("")}else if(null!=a.column&&0==a.column[0]&&a.column[1]==luckysheet.flowdata[0].length-1){luckysheetRightHeadClickIs="row",$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word").text("行"),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-size").text("高"),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left").text("上"),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right").text("下"),$("#luckysheet-cols-rows-add").show(),$("#luckysheet-cols-rows-data").show(),$("#luckysheet-cols-rows-shift").hide(),luckysheet_cols_menu_status=!0,null==(t=$.extend(!0,{},config)).rowlen&&(t.rowlen={});for(var h=null==t.rowlen[luckysheet_select_save[0].row[0]]?luckysheet.defaultrowlen:t.rowlen[luckysheet_select_save[0].row[0]],n=!0,o=0;o<luckysheet_select_save.length;o++)for(var d,y=(d=luckysheet_select_save[o]).row[0],f=d.row[1],m=y;m<=f;m++){if((null==t.rowlen[m]?luckysheet.defaultrowlen:t.rowlen[m])!=h){n=!1;break}}n?$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val(h):$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val("")}showrightclickmenu($("#luckysheet-rightclick-menu"),l,r)}}).dblclick(function(e){if(!(0<parseInt($("#luckysheet-input-box").css("top")))){var t=mouseposition(e.pageX,e.pageY);if(!(t[0]>=cellmainWidth-cellMainSrollBarSize||t[1]>=cellmainHeight-cellMainSrollBarSize)){var l=$("#luckysheet-cell-main").scrollLeft(),r=$("#luckysheet-cell-main").scrollTop(),a=t[0]+l,s=t[1]+r,n=luckysheet.rowLocation(s),o=n[1],c=n[0],u=n[2],i=luckysheet.colLocation(a),h=i[1],d=i[0],y=i[2];if(luckysheet.pivotTable.isPivotRange(u,y)){if(!(null!=luckysheet.pivotTable.filter&&0!=luckysheet.pivotTable.filter.length||null!=luckysheet.pivotTable.row&&0!=luckysheet.pivotTable.row.length||null!=luckysheet.pivotTable.column&&0!=luckysheet.pivotTable.column.length||null!=luckysheet.pivotTable.values&&0!=luckysheet.pivotTable.values.length))return;if(null==luckysheet.pivotTable.values||0==luckysheet.pivotTable.values.length)return;if(0==u||0==y)return;if(null!=luckysheet.pivotTable.column&&0<luckysheet.pivotTable.column.length)if(2<=luckysheet.pivotTable.values.length&&"column"==luckysheet.pivotTable.showType){if(u<=luckysheet.pivotTable.column.length||y>=luckysheet.pivotTable.pivotDatas[0].length-luckysheet.pivotTable.values.length)return}else if(u<=luckysheet.pivotTable.column.length-1||y>=luckysheet.pivotTable.pivotDatas[0].length-1)return;if(null!=luckysheet.pivotTable.row&&0<luckysheet.pivotTable.row.length)if(2<=luckysheet.pivotTable.values.length&&"row"==luckysheet.pivotTable.showType){if(y<=luckysheet.pivotTable.row.length||u>=luckysheet.pivotTable.pivotDatas.length-luckysheet.pivotTable.values.length)return}else if(y<=luckysheet.pivotTable.row.length-1||u>=luckysheet.pivotTable.pivotDatas.length-1)return;return luckysheet.sheetmanage.addNewSheet(e),void luckysheet.pivotTable.drillDown(u,y)}var f=luckysheet.menuButton.mergeborer(luckysheet.flowdata,u,y);if(f&&(o=f.row[1],c=f.row[0],u=f.row[2],h=f.column[1],d=f.column[0],y=f.column[2]),$("#luckysheet-search-formula-parm").is(":visible")||$("#luckysheet-search-formula-parm-select").is(":visible"))$("#luckysheet-cell-selected").hide();else{if($("#luckysheet-conditionformat-dialog").is(":visible")||$("#luckysheet-administerRule-dialog").is(":visible")||$("#luckysheet-newConditionRule-dialog").is(":visible")||$("#luckysheet-editorConditionRule-dialog").is(":visible")||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;if($("#luckysheet-modal-dialog-slider-alternateformat").is(":visible")||$("#luckysheet-alternateformat-rangeDialog").is(":visible"))return;luckysheet.menuButton.luckysheetPaintModelOn&&luckysheet.menuButton.cancelPaintModel(),luckysheet.luckysheetupdateCell(o,c,u,h,d,y,luckysheet.flowdata)}}}}),$("#luckysheet-bottom-add-row, #luckysheet-bottom-add-row-input, #luckysheet-bottom-return-top").on("mousedown dblclick mouseup",function(e){e.stopPropagation()}),$("#luckysheet-bottom-add-row").on("click",function(e){$("#luckysheet-rightclick-menu").hide(),$("#"+container).attr("tabindex",0).focus();$(this);var t=$("#luckysheet-bottom-add-row-input").val();""==t&&(t=100),isNaN(parseInt(t))?luckysheet.isEditMode()?alert("请输入数字"):luckysheet.tooltip.info("增加错误","请输入数字"):(t=parseInt(t))<1||100<t?luckysheet.isEditMode()?alert("增加范围限制在1-100"):luckysheet.tooltip.info("增加错误","增加范围限制在1-100"):luckysheetextendtable("row",luckysheet.flowdata.length-1,t)}),$("#luckysheet-bottom-return-top").on("click",function(e){$("#luckysheet-scrollbar-y").scrollTop(0)});var luckysheetactiveCell=function(){fullscreenmode&&setTimeout(function(){$("#luckysheet-rich-text-editor").focus().select()},50)};luckysheet.luckysheetactiveCell=luckysheetactiveCell,luckysheet.luckysheetupdateCell=function(e,t,l,r,a,s,n,o,c){var u,i,h,d,y,f,m,k,p,g,v,b,_,w;luckysheet.isEditMode()||($("#luckysheet-dropCell-icon").is(":visible")&&$("#luckysheet-dropCell-icon").remove(),u=$(window).height(),i=$(window).width(),h=$("#"+container).offset(),d=$("#luckysheet-cell-main").scrollLeft(),y=$("#luckysheet-cell-main").scrollTop(),m=luckysheetConfigsetting.pointEdit?(f=a*luckysheetConfigsetting.pointEditZoom+h.left+rowHeaderWidth*luckysheetConfigsetting.pointEditZoom-d,t*luckysheetConfigsetting.pointEditZoom+h.top+(infobarHeight+toolbarHeight+calculatebarHeight+columeHeaderHeight)*luckysheetConfigsetting.pointEditZoom-y):(f=a+h.left+rowHeaderWidth-d,t+h.top+infobarHeight+toolbarHeight+calculatebarHeight+columeHeaderHeight-y),luckysheet.pivotTable.isPivotRange(l,s)||(luckysheetCellUpdate=[l,s],c||$("#luckysheet-rich-text-editor").focus().select(),luckysheetConfigsetting.pointEdit?$("#luckysheet-input-box").removeAttr("style").css({"background-color":"rgb(255, 255, 255)",padding:"0px 2px","font-size":"13px","max-width":i+d-a-20-rowHeaderWidth,"max-height":u+y-t-20-15-toolbarHeight-infobarHeight-calculatebarHeight-sheetBarHeight-statisticBarHeight,"min-width":r-a+1-8,"min-height":e-t+1-4,left:f-2*luckysheetConfigsetting.pointEditZoom,top:m-2*luckysheetConfigsetting.pointEditZoom,right:"auto","overflow-y":"auto","box-sizing":"initial","transform-origin":"0 0",transform:"scale("+luckysheetConfigsetting.pointEditZoom+")","z-index":1e3}):$("#luckysheet-input-box").removeAttr("style").css({"background-color":"rgb(255, 255, 255)",padding:"0px 2px","font-size":"13px","max-width":i+d-a-20-rowHeaderWidth,"max-height":u+y-t-20-15-toolbarHeight-infobarHeight-calculatebarHeight-sheetBarHeight-statisticBarHeight,"min-width":r-a+1-8,"min-height":e-t+1-4,left:f-2,top:m-2,right:"auto","overflow-y":"auto","box-sizing":"initial"}),null==luckysheet.freezen.freezenverticaldata&&null==luckysheet.freezen.freezenhorizontaldata||$("#luckysheet-input-box").css("z-index",10002),$("#luckysheet-input-box-index").html(luckysheet.luckysheetchatatABC(s)+(l+1)).hide(),$("#luckysheet-wa-functionbox-cancel, #luckysheet-wa-functionbox-confirm").addClass("luckysheet-wa-calculate-active"),k="",null!=n[l]&&null!=n[l][s]?(p=n[l][s],o||(k=null!=p.f?luckysheet.getcellvalue(l,s,n,"f"):luckysheet.mask.valueShowEs(l,s,n)),g=luckysheet.menuButton.getStyleByCell(n,l,s),g=$("#luckysheet-input-box").get(0).style.cssText+g,$("#luckysheet-input-box").get(0).style.cssText=g,"rgba(0, 0, 0, 0)"==$("#luckysheet-input-box").get(0).style.backgroundColor&&($("#luckysheet-input-box").get(0).style.background="rgb(255,255,255)")):(v=luckysheet.alternateformat.getComputeMap(),b=luckysheet.alternateformat.checksAF(l,s,v),_=luckysheet.conditionformat.getComputeMap(),null!=(w=luckysheet.conditionformat.checksCF(l,s,_))&&null!=w.cellColor?$("#luckysheet-input-box").get(0).style.background=w.cellColor:null!=b&&($("#luckysheet-input-box").get(0).style.background=b[1])),null!=k&&""!=k.toString()||o||(k="<br/>"),$("#luckysheet-rich-text-editor").html(k),c||luckysheetRangeLast($("#luckysheet-rich-text-editor")[0]),luckysheet.formula.rangetosheet=luckysheet.currentSheetIndex,luckysheet.formula.createRangeHightlight(),luckysheet.formula.rangeResizeTo=$("#luckysheet-rich-text-editor"),luckysheet.cleargridelement()))},$("#luckysheet-input-box").click(function(){luckysheet.formula.rangeHightlightselected($("#luckysheet-rich-text-editor"))}).add("#"+container).on("keydown",function(e){if(!($("#luckysheet-modal-dialog-mask").is(":visible")||$(e.target).hasClass("luckysheet-mousedown-cancel")||$(e.target).hasClass("formulaInputFocus"))){var t=e.ctrlKey,l=e.altKey,r=e.shiftKey,a=e.keyCode;if($("#luckysheet-modal-dialog-mask").is(":visible")||$(e.target).hasClass("luckysheet-mousedown-cancel")||$(e.target).hasClass("sp-input")||0<parseInt($("#luckysheet-input-box").css("top"))&&0<$(e.target).closest(".luckysheet-input-box").length&&a!=keycode.ENTER&&a!=keycode.TAB&&a!=keycode.UP&&a!=keycode.DOWN&&a!=keycode.LEFT&&a!=keycode.RIGHT){var s,n,o,c,u,i,h=$(window.getSelection().anchorNode);(h.parent().is("#luckysheet-helpbox-cell")||h.is("#luckysheet-helpbox-cell"))&&a==keycode.ENTER&&(s=$("#luckysheet-helpbox-cell").text(),luckysheet.formula.iscelldata(s)&&(n=luckysheet.formula.getcellrange(s),luckysheet_select_save=[{row:n.row,column:n.column,row_focus:n.row[0],column_focus:n.column[0]}],luckysheet.selectHightlightShow(),$("#luckysheet-helpbox-cell").blur(),o=$("#luckysheet-cell-main").scrollLeft(),c=$("#luckysheet-cell-main").scrollTop(),u=$("#luckysheet-cell-main").height(),i=$("#luckysheet-cell-main").width(),p=visibledatarow[n.row[1]],g=n.row[0]-1==-1?0:visibledatarow[n.row[0]-1],v=visibledatacolumn[n.column[1]],b=n.column[0]-1==-1?0:visibledatacolumn[n.column[0]-1],0<v-o-i+20?$("#luckysheet-scrollbar-x").scrollLeft(v-i+20):b-o-20<0&&$("#luckysheet-scrollbar-x").scrollLeft(b-20),0<p-c-u+20?$("#luckysheet-scrollbar-y").scrollTop(p-u+20):g-c-20<0&&$("#luckysheet-scrollbar-y").scrollTop(g-20)))}else{var d,y=$("#luckysheet-input-box");if(a==keycode.ENTER&&0<parseInt(y.css("top")))$("#luckysheet-formula-search-c").is(":visible")&&null!=luckysheet.formula.searchFunctionCell?luckysheet.formula.searchFunctionEnter($("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active")):(luckysheet.formula.updatecell(luckysheetCellUpdate[0],luckysheetCellUpdate[1]),luckysheet_select_save=[{row:[luckysheetCellUpdate[0],luckysheetCellUpdate[0]],column:[luckysheetCellUpdate[1],luckysheetCellUpdate[1]],row_focus:luckysheetCellUpdate[0],column_focus:luckysheetCellUpdate[1]}],luckysheetMoveHighlightCell("down",1,"rangeOfSelect")),$("#luckysheet-search-formula-parm").is(":visible")&&$("#luckysheet-search-formula-parm").hide(),$("#luckysheet-search-formula-parm-select").is(":visible")&&$("#luckysheet-search-formula-parm-select").hide(),e.preventDefault();else if(a==keycode.TAB){if(0<parseInt(y.css("top")))return;luckysheetMoveHighlightCell("right",1,"rangeOfSelect"),e.preventDefault()}else if(a==keycode.F2){if(0<parseInt(y.css("top")))return;var f,m=(f=luckysheet_select_save[luckysheet_select_save.length-1]).row_focus,k=f.column_focus,p=visibledatarow[m],g=m-1==-1?0:visibledatarow[m-1],v=visibledatacolumn[k],b=k-1==-1?0:visibledatacolumn[k-1];luckysheet.luckysheetupdateCell(p,g,m,v,b,k,luckysheet.flowdata),e.preventDefault()}else if(a==keycode.F4&&0<parseInt(y.css("top")))luckysheet.formula.setfreezonFuc(e),e.preventDefault();else if(a==keycode.ESC&&0<parseInt(y.css("top")))luckysheet.formula.dontupdate(),luckysheetMoveHighlightCell("down",0,"rangeOfSelect"),e.preventDefault();else if(a==keycode.ENTER){if($(e.target).hasClass("formulaInputFocus")||$("#luckysheet-conditionformat-dialog").is(":visible"))return;null!=String.fromCharCode(a)&&$("#luckysheet-cell-selected").is(":visible")&&(m=(f=luckysheet_select_save[luckysheet_select_save.length-1]).row_focus,k=f.column_focus,p=visibledatarow[m],g=m-1==-1?0:visibledatarow[m-1],v=visibledatacolumn[k],b=k-1==-1?0:visibledatacolumn[k-1],(d=luckysheet.menuButton.mergeborer(luckysheet.flowdata,m,k))&&(p=d.row[1],g=d.row[0],m=d.row[2],v=d.column[1],b=d.column[0],k=d.column[2]),luckysheet.luckysheetupdateCell(p,g,m,v,b,k,luckysheet.flowdata),e.preventDefault())}else{if(t||e.metaKey){if(r){if(luckysheet_shiftkeydown||(luckysheet.luckysheet_shiftpositon=$.extend(!0,{},luckysheet_select_save[luckysheet_select_save.length-1]),luckysheet_shiftkeydown=!0),a==keycode.UP){if(0<parseInt(y.css("top"))||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;luckysheetMoveHighlightRange2("up","rangeOfSelect")}else if(a==keycode.DOWN){if(0<parseInt(y.css("top"))||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;luckysheetMoveHighlightRange2("down","rangeOfSelect")}else if(a==keycode.LEFT){if(0<parseInt(y.css("top"))||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;luckysheetMoveHighlightRange2("left","rangeOfSelect")}else if(a==keycode.RIGHT){if(0<parseInt(y.css("top"))||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;luckysheetMoveHighlightRange2("right","rangeOfSelect")}}else if(66==a)$("#luckysheet-icon-bold").click();else{if(67==a){if(luckysheet.menuButton.luckysheetPaintModelOn&&luckysheet.menuButton.cancelPaintModel(),0==luckysheet_select_save.length)return;if(null!=config.merge){for(var _=!1,w=0;w<luckysheet_select_save.length;w++){var x=luckysheet_select_save[w].row[0],C=luckysheet_select_save[w].row[1],T=luckysheet_select_save[w].column[0],I=luckysheet_select_save[w].column[1];if(_=luckysheet.hasPartMC(config,x,C,T,I))break}if(_)return void(luckysheet.isEditMode()?alert("无法对部分合并单元格执行此操作"):luckysheet.tooltip.info("无法对部分合并单元格执行此操作",""))}var R=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_conditionformat_save;if(1<luckysheet_select_save.length&&null!=R&&0<R.length){var S=!1,A=luckysheet.conditionformat.getComputeMap();e:for(w=0;w<luckysheet_select_save.length&&!S;w++)for(var x=luckysheet_select_save[w].row[0],C=luckysheet_select_save[w].row[1],T=luckysheet_select_save[w].column[0],I=luckysheet_select_save[w].column[1],F=x;F<=C;F++)for(var N=T;N<=I;N++)if(null!=luckysheet.conditionformat.checksCF(F,N,A)){S=!0;continue e}if(S)return void(luckysheet.isEditMode()?alert("无法对多重选择区域执行此操作"):luckysheet.tooltip.info("无法对多重选择区域执行此操作",""))}if(1<luckysheet_select_save.length){for(var M=!0,E=luckysheet_select_save[0].row[0],O=luckysheet_select_save[0].row[1],j=!0,z=luckysheet_select_save[0].column[0],D=luckysheet_select_save[0].column[1],w=1;w<luckysheet_select_save.length;w++)luckysheet_select_save[w].row[0]==E&&luckysheet_select_save[w].row[1]==O||(M=!1),luckysheet_select_save[w].column[0]==z&&luckysheet_select_save[w].column[1]==D||(j=!1);if(!M&&!j||luckysheet.selectIsOverlap())return void(luckysheet.isEditMode()?alert("无法对多重选择区域执行此操作"):luckysheet.tooltip.info("无法对多重选择区域执行此操作",""))}return luckysheet.selection.copy(e),luckysheet_paste_iscut=!1,luckysheetactiveCell(),void e.stopPropagation()}if(70==a)luckysheet.searchReplace.createDialog(0),luckysheet.searchReplace.init(),$("#luckysheet-search-replace #searchInput input").focus();else if(72==a)luckysheet.searchReplace.createDialog(1),luckysheet.searchReplace.init(),$("#luckysheet-search-replace #searchInput input").focus();else if(73==a)$("#luckysheet-icon-italic").click();else{if(86==a){if(luckysheet.isEditMode())return;if($(e.target).hasClass("formulaInputFocus"))return;return 1<luckysheet_select_save.length?void(luckysheet.isEditMode()?alert("无法在此处粘贴此内容，请选择粘贴区域的一个单元格，然后再次尝试粘贴"):luckysheet.tooltip.info("无法在此处粘贴此内容，请选择粘贴区域的一个单元格，然后再次尝试粘贴","")):(luckysheet.selection.isPasteAction=!0,luckysheetactiveCell(),void e.stopPropagation())}if(88==a){if(luckysheet.menuButton.luckysheetPaintModelOn&&luckysheet.menuButton.cancelPaintModel(),0==luckysheet_select_save.length)return;if(null!=config.merge){for(_=!1,w=0;w<luckysheet_select_save.length;w++){x=luckysheet_select_save[w].row[0],C=luckysheet_select_save[w].row[1],T=luckysheet_select_save[w].column[0],I=luckysheet_select_save[w].column[1];if(_=luckysheet.hasPartMC(config,x,C,T,I))break}if(_)return void(luckysheet.luckysheetConfigsetting.editMode?alert("无法对合并单元格执行此操作"):luckysheet.tooltip.info("无法对合并单元格执行此操作",""))}return 1<luckysheet_select_save.length?void(luckysheet.isEditMode()?alert("不能对多重选择区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选择区域执行此操作，请选择单个区域，然后再试","")):(luckysheet.selection.copy(e),luckysheet_paste_iscut=!0,luckysheetactiveCell(),void e.stopPropagation())}if(90==a)return luckysheet.controlHistory.redo(e),luckysheetactiveCell(),void e.stopPropagation();if(89==a)return luckysheet.controlHistory.undo(e),luckysheetactiveCell(),void e.stopPropagation();if(a==keycode.UP){if(0<parseInt(y.css("top"))||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;luckysheetMoveHighlightCell2("up","rangeOfSelect")}else if(a==keycode.DOWN){if(0<parseInt(y.css("top"))||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;luckysheetMoveHighlightCell2("down","rangeOfSelect")}else if(a==keycode.LEFT){if(0<parseInt(y.css("top"))||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;luckysheetMoveHighlightCell2("left","rangeOfSelect")}else if(a==keycode.RIGHT){if(0<parseInt(y.css("top"))||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;luckysheetMoveHighlightCell2("right","rangeOfSelect")}else"A"==String.fromCharCode(a).toLocaleUpperCase()&&($("#luckysheet-left-top").trigger("mousedown"),$(document).trigger("mouseup"))}}return void e.preventDefault()}if(r&&(a==keycode.UP||a==keycode.DOWN||a==keycode.LEFT||a==keycode.RIGHT||l&&(53==a||101==a))){if(0<parseInt(y.css("top"))||$(e.target).hasClass("formulaInputFocus"))return;if(luckysheet_shiftkeydown||(luckysheet.luckysheet_shiftpositon=$.extend(!0,{},luckysheet_select_save[luckysheet_select_save.length-1]),luckysheet_shiftkeydown=!0),a==keycode.UP){if($("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;luckysheetMoveHighlightRange("down",-1,"rangeOfSelect")}else if(a==keycode.DOWN){if($("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;luckysheetMoveHighlightRange("down",1,"rangeOfSelect")}else if(a==keycode.LEFT){if($("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;luckysheetMoveHighlightRange("right",-1,"rangeOfSelect")}else if(a==keycode.RIGHT){if($("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;luckysheetMoveHighlightRange("right",1,"rangeOfSelect")}else!l||53!=a&&101!=a||$("#luckysheet-icon-strikethrough").click();e.preventDefault()}else if(a==keycode.ESC)luckysheet.menuButton.luckysheetPaintModelOn?luckysheet.menuButton.cancelPaintModel():(luckysheet.cleargridelement(e),e.preventDefault()),luckysheet.selectHightlightShow();else if(a==keycode.DELETE)luckysheet.chartparam.luckysheetCurrentChartActive&&!luckysheet.isEditMode()?luckysheet.chartparam.luckysheetCurrentChartMoveObj.find(".luckysheet-modal-controll-del").click():$("#luckysheet-delete-text").click(),e.preventDefault();else if(a==keycode.UP){if(0<parseInt(y.css("top"))||$(e.target).hasClass("formulaInputFocus")||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;luckysheetMoveHighlightCell("down",-1,"rangeOfSelect"),e.preventDefault()}else if(a==keycode.DOWN){if(0<parseInt(y.css("top"))||$(e.target).hasClass("formulaInputFocus")||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;luckysheetMoveHighlightCell("down",1,"rangeOfSelect"),e.preventDefault()}else if(a==keycode.LEFT){if(0<parseInt(y.css("top"))||$(e.target).hasClass("formulaInputFocus")||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;luckysheetMoveHighlightCell("right",-1,"rangeOfSelect"),e.preventDefault()}else if(a==keycode.RIGHT){if(0<parseInt(y.css("top"))||$(e.target).hasClass("formulaInputFocus")||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;luckysheetMoveHighlightCell("right",1,"rangeOfSelect"),e.preventDefault()}else{(!(112<=a&&a<=123||a<=46||144==a||108==a||e.ctrlKey||e.altKey||e.shiftKey&&(37==a||38==a||39==a||40==a))||8==a||32==a||46==a||0==a||e.ctrlKey&&86==a)&&null!=String.fromCharCode(a)&&$("#luckysheet-cell-selected").is(":visible")&&a!=keycode.CAPSLOCK&&a!=keycode.WIN&&18!=a&&(m=(f=luckysheet_select_save[luckysheet_select_save.length-1]).row_focus,k=f.column_focus,p=visibledatarow[m],g=m-1==-1?0:visibledatarow[m-1],v=visibledatacolumn[k],b=k-1==-1?0:visibledatacolumn[k-1],(d=luckysheet.menuButton.mergeborer(luckysheet.flowdata,m,k))&&(p=d.row[1],g=d.row[0],m=d.row[2],v=d.column[1],b=d.column[0],k=d.column[2]),luckysheet.luckysheetupdateCell(p,g,m,v,b,k,luckysheet.flowdata,!0),8==a&&$("#luckysheet-rich-text-editor").html("<br/>"),luckysheet.formula.functionInputHanddler($("#luckysheet-functionbox-cell"),$("#luckysheet-rich-text-editor"),a))}}luckysheetactiveCell(),e.stopPropagation()}}});var luckysheetMoveEndCell=function(e,t,l,r,a){null==l&&(l=!0),e=e||"down",t=t||"cell",null==a&&(a=!1);var s,n,o,c,u=luckysheet_select_save[luckysheet_select_save.length-1],i=null==u.row?0:u.row[0],h=null==u.column?0:u.column[0],d=null==u.row?0:u.row[0],y=null==u.column?0:u.column[0],f=null==u.row?0:u.row[1],m=null==u.column?0:u.column[1];luckysheet.formula.fucntionboxshow(i,h),"range"==t&&(s=luckysheet.luckysheet_shiftpositon.row[0],n=luckysheet.luckysheet_shiftpositon.column[0],o=luckysheet.luckysheet_shiftpositon.row[1],c=luckysheet.luckysheet_shiftpositon.column[1],"down"==e||"up"==e?o<f?i=null==u.row?0:u.row[1]:d<s?i=null==u.row?0:u.row[0]:o==f&&s==d&&(i="down"==e?null==u.row?0:u.row[1]:null==u.row?0:u.row[0]):"right"!=e&&"left"!=e||(c<m?h=null==u.column?0:u.column[1]:y<n?h=null==u.column?0:u.column[0]:c==m&&n==y&&(h="right"==e?null==u.column?0:u.column[1]:null==u.column?0:u.column[0])));var k=luckysheet.flowdata.length,p=luckysheet.flowdata[0].length,g=luckysheet.flowdata,v="",b=0;if("up"==e){if(0==i)return;for(var _=[],w=null,x=0,C=null,T=y;T<=m;T++){_=[],x=0;for(var I=i-1;0<=I;I--){var $=g[I][T];if("object"==luckysheet.getObjType($)&&luckysheet.func_methods.isRealNull($.v)||luckysheet.func_methods.isRealNull($)?_.push(!1):_.push(!0),1<_.length){if(1==_[x]&&0==_[x-1]){w=I;break}if(0==_[x]&&1==_[x-1]){w=I+1;break}}x++}null==w&&(w=0),(null==C||w<C)&&(C=w)}v="down",b=C-i}else if("down"==e){if(i==k-1)return;for(_=[],w=null,x=0,C=null,T=y;T<=m;T++){_=[],x=0;for(I=i+1;I<g.length;I++){$=g[I][T];if("object"==luckysheet.getObjType($)&&luckysheet.func_methods.isRealNull($.v)||luckysheet.func_methods.isRealNull($)?_.push(!1):_.push(!0),1<_.length){if(1==_[x]&&0==_[x-1]){w=I;break}if(0==_[x]&&1==_[x-1]){w=I-1;break}}x++}null==w&&(w=g.length-1),(null==C||C<w)&&(C=w)}v="down",b=C-i}else if("left"==e){if(0==h)return;for(_=[],w=null,x=0,C=null,I=d;I<=f;I++){_=[],x=0;for(T=h-1;0<=T;T--){$=g[I][T];if("object"==luckysheet.getObjType($)&&luckysheet.func_methods.isRealNull($.v)||luckysheet.func_methods.isRealNull($)?_.push(!1):_.push(!0),1<_.length){if(1==_[x]&&0==_[x-1]){w=T;break}if(0==_[x]&&1==_[x-1]){w=T+1;break}}x++}null==w&&(w=0),(null==C||w<C)&&(C=w)}v="right",b=C-h}else if("right"==e){if(h==p-1)return;for(_=[],w=null,x=0,C=null,I=d;I<=f;I++){_=[],x=0;for(T=h+1;T<g[0].length;T++){$=g[I][T];if("object"==luckysheet.getObjType($)&&luckysheet.func_methods.isRealNull($.v)||luckysheet.func_methods.isRealNull($)?_.push(!1):_.push(!0),1<_.length){if(1==_[x]&&0==_[x-1]){w=T;break}if(0==_[x]&&1==_[x-1]){w=T-1;break}}x++}null==w&&(w=g[0].length-1),(null==C||C<w)&&(C=w)}v="right",b=C-h}if("range"==t&&("up"==e?o<f&&b+i<o&&(b=o-i):"down"==e?d<s&&s<b+i&&(b=s-i):"left"==e?c<m&&b+h<c&&(b=c-h):"right"==e&&y<n&&n<b+h&&(b=n-h),null!=r&&Math.abs(b)>Math.abs(r)&&(b=r)),a)return b;"cell"==t?luckysheetMoveHighlightCell(v,b,"rangeOfSelect",l):"range"==t&&luckysheetMoveHighlightRange(v,b,"rangeOfSelect",l)};luckysheet.luckysheetMoveEndCell=luckysheetMoveEndCell;var luckysheetMoveHighlightCell=function(e,t,l,r){null==r&&(r=!0);var a,s,n,o,c,u,i,h,d,y,f,m,k,p,g,v,b,_,w,x=luckysheet.flowdata.length,C=luckysheet.flowdata[0].length;"rangeOfSelect"==l?(s=null==(a=luckysheet_select_save[luckysheet_select_save.length-1]).row_focus?a.row[0]:a.row_focus,n=null==a.column_focus?a.column[0]:a.column_focus,(o=luckysheet.menuButton.mergeborer(luckysheet.flowdata,s,n))&&(c=o.row[2],u=o.row[3],i=o.column[2],h=o.column[3],0<t?"down"==e?(s=u,n=i):"right"==e&&(s=c,n=h):(s=c,n=i)),d=null==a.moveXY?s:a.moveXY.x,y=null==a.moveXY?n:a.moveXY.y,"down"==e?d=s+=t:"right"==e&&(y=n+=t),x<=s&&(d=s=x-1),s<0&&(d=s=0),C<=n&&(y=n=C-1),n<0&&(y=n=0),w=(f=luckysheet.menuButton.mergeborer(luckysheet.flowdata,s,n))?(m=f.row[1],k=f.row[0],v=f.row[2],b=f.row[3],p=f.column[1],g=f.column[0],_=f.column[2],f.column[3]):(m=visibledatarow[d],k=d-1==-1?0:visibledatarow[d-1],p=visibledatacolumn[y],g=y-1==-1?0:visibledatacolumn[y-1],b=v=d,_=y),a.row=[v,b],a.column=[_,w],a.row_focus=v,a.column_focus=_,a.moveXY={x:d,y:y},luckysheet.selectHightlightShow(),luckysheet.pivotTable.pivotclick(v,_),luckysheet.formula.fucntionboxshow(v,_),luckysheet.chartparam.luckysheet_chart_data_select_state&&$("#luckysheet-datavisual-range-selection-input").val(luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].name+"!"+luckysheet.luckysheetchatatABC(a.column[0])+(a.row[0]+1)+":"+luckysheet.luckysheetchatatABC(a.column[1])+(a.row[1]+1))):"rangeOfFormula"==l&&(s=null==(a=luckysheet.formula.func_selectedrange).row_focus?a.row[0]:a.row_focus,n=null==a.column_focus?a.column[0]:a.column_focus,(o=luckysheet.menuButton.mergeborer(luckysheet.flowdata,s,n))&&(c=o.row[2],u=o.row[3],i=o.column[2],h=o.column[3],0<t?"down"==e?(s=u,n=i):"right"==e&&(s=c,n=h):(s=c,n=i)),d=null==a.moveXY?s:a.moveXY.x,y=null==a.moveXY?n:a.moveXY.y,"down"==e?d=s+=t:"right"==e&&(y=n+=t),x<=s&&(d=s=x-1),s<0&&(d=s=0),C<=n&&(y=n=C-1),n<0&&(y=n=0),w=(f=luckysheet.menuButton.mergeborer(luckysheet.flowdata,s,n))?(m=f.row[1],k=f.row[0],v=f.row[2],b=f.row[3],p=f.column[1],g=f.column[0],_=f.column[2],f.column[3]):(m=visibledatarow[d],k=d-1==-1?0:visibledatarow[d-1],p=visibledatacolumn[y],g=y-1==-1?0:visibledatacolumn[y-1],b=v=d,_=y),luckysheet.formula.func_selectedrange={left:g,width:p-g-1,top:k,height:m-k-1,left_move:g,width_move:p-g-1,top_move:k,height_move:m-k-1,row:[v,b],column:[_,w],row_focus:v,column_focus:_,moveXY:{x:d,y:y}},$("#luckysheet-formula-functionrange-select").css({left:g,width:p-g-1,top:k,height:m-k-1}).show(),luckysheet.formula.rangeSetValue({row:[v,b],column:[_,w]}));var T=$("#luckysheet-cell-main").scrollLeft(),I=$("#luckysheet-cell-main").scrollTop(),R=$("#luckysheet-cell-main").height(),S=$("#luckysheet-cell-main").width(),A=0,F=0;0<p-T-S+20?(A=p-S+20,r&&$("#luckysheet-scrollbar-x").scrollLeft(A)):g-T-20<0&&(A=g-20,r&&$("#luckysheet-scrollbar-x").scrollLeft(A)),0<m-I-R+20?(F=m-R+20,r&&$("#luckysheet-scrollbar-y").scrollTop(F)):k-I-20<0&&(F=k-20,r&&$("#luckysheet-scrollbar-y").scrollTop(F)),clearTimeout(jfcountfuncTimeout),jfcountfunc()},luckysheetMoveHighlightCell2=function(e,t,l){if(l=l||!0,"rangeOfSelect"==t){var r=(h=luckysheet_select_save[luckysheet_select_save.length-1]).row_focus,a=h.column_focus;if(null!=config.merge&&r+"_"+a in config.merge?(y=!0,d=config.merge[r+"_"+a]):y=!1,"down"==e){if(r==luckysheet.flowdata.length-1)return;r=y?luckysheet.getNextIndex("down",a,d.r+d.rs-1,luckysheet.flowdata.length-1):luckysheet.getNextIndex("down",a,r,luckysheet.flowdata.length-1)}else if("up"==e){if(0==r)return;r=y?luckysheet.getNextIndex("up",a,0,d.r):luckysheet.getNextIndex("up",a,0,r)}else if("right"==e){if(a==luckysheet.flowdata[0].length-1)return;a=y?luckysheet.getNextIndex("right",r,d.c+d.cs-1,luckysheet.flowdata[0].length-1):luckysheet.getNextIndex("right",r,a,luckysheet.flowdata[0].length-1)}else if("left"==e){if(0==a)return;a=y?luckysheet.getNextIndex("left",r,0,d.c):luckysheet.getNextIndex("left",r,0,a)}var s=[r,r],n=[a,a],o=visibledatarow[r],c=r-1==-1?0:visibledatarow[r-1],u=visibledatacolumn[a],i=a-1==-1?0:visibledatacolumn[a-1];null!=(f=luckysheet.menuButton.mergeMoveMain(n,s,h,c,o-c-1,i,u-i-1))&&(n=f[0],s=f[1]),luckysheet_select_save=[{row:s,column:n}],luckysheet.selectHightlightShow(),luckysheet.pivotTable.pivotclick(r,a),luckysheet.formula.fucntionboxshow(r,a),luckysheet.chartparam.luckysheet_chart_data_select_state&&$("#luckysheet-datavisual-range-selection-input").val(luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].name+"!"+luckysheet.luckysheetchatatABC(n[0])+(s[0]+1)+":"+luckysheet.luckysheetchatatABC(n[1])+(s[1]+1))}else if("rangeOfFormula"==t){var h,d,y,r=(h=luckysheet.formula.func_selectedrange).row_focus,a=h.column_focus;if(null!=config.merge&&r+"_"+a in config.merge?(y=!0,d=config.merge[r+"_"+a]):y=!1,"down"==e){if(r==luckysheet.flowdata.length-1)return;r=y?luckysheet.getNextIndex("down",a,d.r+d.rs-1,luckysheet.flowdata.length-1):luckysheet.getNextIndex("down",a,r,luckysheet.flowdata.length-1)}else if("up"==e){if(0==r)return;r=y?luckysheet.getNextIndex("up",a,0,d.r):luckysheet.getNextIndex("up",a,0,r)}else if("right"==e){if(a==luckysheet.flowdata[0].length-1)return;a=y?luckysheet.getNextIndex("right",r,d.c+d.cs-1,luckysheet.flowdata[0].length-1):luckysheet.getNextIndex("right",r,a,luckysheet.flowdata[0].length-1)}else if("left"==e){if(0==a)return;a=y?luckysheet.getNextIndex("left",r,0,d.c):luckysheet.getNextIndex("left",r,0,a)}var f,s=[r,r],n=[a,a],o=visibledatarow[r],c=r-1==-1?0:visibledatarow[r-1],u=visibledatacolumn[a],m=c,k=o-c-1,p=i=a-1==-1?0:visibledatacolumn[a-1],g=u-i-1;null!=(f=luckysheet.menuButton.mergeMoveMain(n,s,h,m,k,p,g))&&(n=f[0],s=f[1],m=f[2],k=f[3],p=f[4],g=f[5]),luckysheet.formula.func_selectedrange={left:p,width:g,top:m,height:k,left_move:p,width_move:g,top_move:m,height_move:k,row:s,column:n,row_focus:r,column_focus:a},$("#luckysheet-formula-functionrange-select").css({left:p,width:g,top:m,height:k}).show(),luckysheet.formula.rangeSetValue({row:s,column:n})}var v=$("#luckysheet-cell-main").scrollLeft(),b=$("#luckysheet-cell-main").scrollTop(),_=$("#luckysheet-cell-main").height(),w=$("#luckysheet-cell-main").width(),x=0,C=0;0<u-v-w+20?(x=u-w+20,l&&$("#luckysheet-scrollbar-x").scrollLeft(x)):i-v-20<0&&(x=i-20,l&&$("#luckysheet-scrollbar-x").scrollLeft(x)),0<o-b-_+20?(C=o-_+20,l&&$("#luckysheet-scrollbar-y").scrollTop(C)):c-b-20<0&&(C=c-20,l&&$("#luckysheet-scrollbar-y").scrollTop(C)),clearTimeout(jfcountfuncTimeout),jfcountfunc()},luckysheetMoveHighlightRange=function(e,t,l,r){var a,s,n,o,c,u,i,h,d,y,f,m,k,p,g,v,b,_,w,x,C,T,I,R,S,A;null==r&&(r=!0),"rangeOfSelect"==l?(s=(a=luckysheet_select_save[luckysheet_select_save.length-1]).row[0],n=a.row[1],o=a.column[0],c=a.column[1],u=a.row_focus,i=a.column_focus,h=luckysheet.flowdata.length,d=luckysheet.flowdata[0].length,"down"==e?(luckysheet.rowHasMerge(u,o,c)?(f=(y=luckysheet.getRowMerge(u,o,c))[0],m=y[1],s<f&&m==n?(0<t&&luckysheet.rowHasMerge(s,o,c)&&(s=luckysheet.getRowMerge(s,o,c)[1]),s+=t):m<n&&f==s?(t<0&&luckysheet.rowHasMerge(n,o,c)&&(n=luckysheet.getRowMerge(n,o,c)[0]),n+=t):0<t?n+=t:s+=t):s<u&&u==n?(0<t&&luckysheet.rowHasMerge(s,o,c)&&(s=luckysheet.getRowMerge(s,o,c)[1]),s+=t):u<n&&u==s?(t<0&&luckysheet.rowHasMerge(n,o,c)&&(n=luckysheet.getRowMerge(n,o,c)[0]),n+=t):u==s&&u==n&&(0<t?n+=t:s+=t),h<=n&&(n=h-1),n<0&&(n=0),h<=s&&(s=h-1),s<0&&(s=0)):(luckysheet.colHasMerge(i,s,n)?(p=(k=luckysheet.getColMerge(i,s,n))[0],g=k[1],o<p&&g==c?(0<t&&luckysheet.colHasMerge(o,s,n)&&(o=luckysheet.getColMerge(o,s,n)[1]),o+=t):g<c&&p==o?(t<0&&luckysheet.colHasMerge(c,s,n)&&(c=luckysheet.getColMerge(c,s,n)[0]),c+=t):0<t?c+=t:o+=t):o<i&&i==c?(0<t&&luckysheet.colHasMerge(o,s,n)&&(o=luckysheet.getColMerge(o,s,n)[1]),o+=t):i<c&&i==o?(t<0&&luckysheet.colHasMerge(c,s,n)&&(c=luckysheet.getColMerge(c,s,n)[0]),c+=t):i==o&&i==c&&(0<t?c+=t:o+=t),d<=c&&(c=d-1),c<0&&(c=0),d<=o&&(o=d-1),o<0&&(o=0)),v=[s,n],b=[o,c],_=visibledatarow[n],w=s-1==-1?0:visibledatarow[s-1],x=visibledatacolumn[c],C=o-1==-1?0:visibledatacolumn[o-1],null!=(A=luckysheet.menuButton.mergeMoveMain(b,v,a,w,_-w-1,C,x-C-1))&&(b=A[0],v=A[1]),a.row=v,a.column=b,luckysheet.selectHightlightShow(),luckysheet.chartparam.luckysheet_chart_data_select_state&&$("#luckysheet-datavisual-range-selection-input").val(luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].name+"!"+luckysheet.luckysheetchatatABC(a.column[0])+(a.row[0]+1)+":"+luckysheet.luckysheetchatatABC(a.column[1])+(a.row[1]+1))):"rangeOfFormula"==l&&(s=(a=luckysheet.formula.func_selectedrange).row[0],n=a.row[1],o=a.column[0],c=a.column[1],u=a.row_focus,i=a.column_focus,h=luckysheet.flowdata.length,d=luckysheet.flowdata[0].length,"down"==e?(luckysheet.rowHasMerge(u,o,c)?(f=(y=luckysheet.getRowMerge(u,o,c))[0],m=y[1],s<f&&m==n?(0<t&&luckysheet.rowHasMerge(s,o,c)&&(s=luckysheet.getRowMerge(s,o,c)[1]),s+=t):m<n&&f==s?(t<0&&luckysheet.rowHasMerge(n,o,c)&&(n=luckysheet.getRowMerge(n,o,c)[0]),n+=t):0<t?n+=t:s+=t):s<u&&u==n?(0<t&&luckysheet.rowHasMerge(s,o,c)&&(s=luckysheet.getRowMerge(s,o,c)[1]),s+=t):u<n&&u==s?(t<0&&luckysheet.rowHasMerge(n,o,c)&&(n=luckysheet.getRowMerge(n,o,c)[0]),n+=t):u==s&&u==n&&(0<t?n+=t:s+=t),h<=n&&(n=h-1),n<0&&(n=0),h<=s&&(s=h-1),s<0&&(s=0)):(luckysheet.colHasMerge(i,s,n)?(p=(k=luckysheet.getColMerge(i,s,n))[0],g=k[1],o<p&&g==c?(0<t&&luckysheet.colHasMerge(o,s,n)&&(o=luckysheet.getColMerge(o,s,n)[1]),o+=t):g<c&&p==o?(t<0&&luckysheet.colHasMerge(c,s,n)&&(c=luckysheet.getColMerge(c,s,n)[0]),c+=t):0<t?c+=t:o+=t):o<i&&i==c?(0<t&&luckysheet.colHasMerge(o,s,n)&&(o=luckysheet.getColMerge(o,s,n)[1]),o+=t):i<c&&i==o?(t<0&&luckysheet.colHasMerge(c,s,n)&&(c=luckysheet.getColMerge(c,s,n)[0]),c+=t):i==o&&i==c&&(0<t?c+=t:o+=t),d<=c&&(c=d-1),c<0&&(c=0),d<=o&&(o=d-1),o<0&&(o=0)),v=[s,n],b=[o,c],_=visibledatarow[n],w=s-1==-1?0:visibledatarow[s-1],x=visibledatacolumn[c],I=_-(T=w)-1,R=C=o-1==-1?0:visibledatacolumn[o-1],S=x-C-1,null!=(A=luckysheet.menuButton.mergeMoveMain(b,v,a,T,I,R,S))&&(b=A[0],v=A[1],T=A[2],I=A[3],R=A[4],S=A[5]),luckysheet.formula.func_selectedrange={left:R,width:S,top:T,height:I,left_move:R,width_move:S,top_move:T,height_move:I,row:v,column:b,row_focus:u,column_focus:i},$("#luckysheet-formula-functionrange-select").css({left:R,width:S,top:T,height:I}).show(),luckysheet.formula.rangeSetValue({row:v,column:b}));var F=$("#luckysheet-cell-main").scrollLeft(),N=$("#luckysheet-cell-main").scrollTop(),M=$("#luckysheet-cell-main").height(),E=$("#luckysheet-cell-main").width(),O=0,j=0;0<x-F-E+20?(O=x-E+20,r&&$("#luckysheet-scrollbar-x").scrollLeft(O)):C-F-20<0&&(O=C-20,r&&$("#luckysheet-scrollbar-x").scrollLeft(O)),0<_-N-M+20?(j=_-M+20,r&&$("#luckysheet-scrollbar-y").scrollTop(j)):w-N-20<0&&(j=w-20,r&&$("#luckysheet-scrollbar-y").scrollTop(j)),clearTimeout(jfcountfuncTimeout),jfcountfunc()},luckysheetMoveHighlightRange2=function(e,t,l){if(l=l||!0,"rangeOfSelect"==t){var r=(m=luckysheet_select_save[luckysheet_select_save.length-1]).row_focus,a=m.column_focus,s=m.row[0],n=m.row[1],o=m.column[0],c=m.column[1];if("down"==e){if(n==luckysheet.flowdata.length-1)return;luckysheet.rowHasMerge(r,o,c)?(p=(k=luckysheet.getRowMerge(r,o,c))[0],g=k[1],s<p&&g==n?s=luckysheet.getNextIndex("down",a,s,n):n=luckysheet.getNextIndex("down",a,n,luckysheet.flowdata.length-1)):s<r&&r==n?s=luckysheet.getNextIndex("down",a,s,n):n=luckysheet.getNextIndex("down",a,n,luckysheet.flowdata.length-1)}else if("up"==e){if(0==s)return;luckysheet.rowHasMerge(r,o,c)?(p=(k=luckysheet.getRowMerge(r,o,c))[0],(g=k[1])<n&&p==s?n=luckysheet.getNextIndex("up",a,s,n):s=luckysheet.getNextIndex("up",a,0,s)):r<n&&r==s?n=luckysheet.getNextIndex("up",a,s,n):s=luckysheet.getNextIndex("up",a,0,s)}else if("right"==e){if(c==luckysheet.flowdata[0].length-1)return;luckysheet.colHasMerge(a,s,n)?(b=(v=luckysheet.getColMerge(a,s,n))[0],_=v[1],o<b&&_==c?o=luckysheet.getNextIndex("right",r,o,c):c=luckysheet.getNextIndex("right",r,c,luckysheet.flowdata[0].length-1)):o<a&&a==c?o=luckysheet.getNextIndex("right",r,o,c):c=luckysheet.getNextIndex("right",r,c,luckysheet.flowdata[0].length-1)}else if("left"==e){if(0==o)return;luckysheet.colHasMerge(a,s,n)?(b=(v=luckysheet.getColMerge(a,s,n))[0],(_=v[1])<c&&b==o?c=luckysheet.getNextIndex("left",r,o,c):o=luckysheet.getNextIndex("left",r,0,o)):a<c&&a==o?c=luckysheet.getNextIndex("left",r,o,c):o=luckysheet.getNextIndex("left",r,0,o)}var u=[s,n],i=[o,c],h=visibledatarow[n],d=s-1==-1?0:visibledatarow[s-1],y=visibledatacolumn[c],f=o-1==-1?0:visibledatacolumn[o-1];null!=(w=luckysheet.menuButton.mergeMoveMain(i,u,m,d,h-d-1,f,y-f-1))&&(i=w[0],u=w[1]),m.row=u,m.column=i,luckysheet.selectHightlightShow(),luckysheet.chartparam.luckysheet_chart_data_select_state&&$("#luckysheet-datavisual-range-selection-input").val(luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].name+"!"+luckysheet.luckysheetchatatABC(m.column[0])+(m.row[0]+1)+":"+luckysheet.luckysheetchatatABC(m.column[1])+(m.row[1]+1))}else if("rangeOfFormula"==t){var m,k,p,g,v,b,_,r=(m=luckysheet.formula.func_selectedrange).row_focus,a=m.column_focus,s=m.row[0],n=m.row[1],o=m.column[0],c=m.column[1];if("down"==e){if(n==luckysheet.flowdata.length-1)return;luckysheet.rowHasMerge(r,o,c)?(p=(k=luckysheet.getRowMerge(r,o,c))[0],g=k[1],s<p&&g==n?s=luckysheet.getNextIndex("down",a,s,n):n=luckysheet.getNextIndex("down",a,n,luckysheet.flowdata.length-1)):s<r&&r==n?s=luckysheet.getNextIndex("down",a,s,n):n=luckysheet.getNextIndex("down",a,n,luckysheet.flowdata.length-1)}else if("up"==e){if(0==s)return;luckysheet.rowHasMerge(r,o,c)?(p=(k=luckysheet.getRowMerge(r,o,c))[0],(g=k[1])<n&&p==s?n=luckysheet.getNextIndex("up",a,s,n):s=luckysheet.getNextIndex("up",a,0,s)):r<n&&r==s?n=luckysheet.getNextIndex("up",a,s,n):s=luckysheet.getNextIndex("up",a,0,s)}else if("right"==e){if(c==luckysheet.flowdata[0].length-1)return;luckysheet.colHasMerge(a,s,n)?(b=(v=luckysheet.getColMerge(a,s,n))[0],_=v[1],o<b&&_==c?o=luckysheet.getNextIndex("right",r,o,c):c=luckysheet.getNextIndex("right",r,c,luckysheet.flowdata[0].length-1)):o<a&&a==c?o=luckysheet.getNextIndex("right",r,o,c):c=luckysheet.getNextIndex("right",r,c,luckysheet.flowdata[0].length-1)}else if("left"==e){if(0==o)return;luckysheet.colHasMerge(a,s,n)?(b=(v=luckysheet.getColMerge(a,s,n))[0],(_=v[1])<c&&b==o?c=luckysheet.getNextIndex("left",r,o,c):o=luckysheet.getNextIndex("left",r,0,o)):a<c&&a==o?c=luckysheet.getNextIndex("left",r,o,c):o=luckysheet.getNextIndex("left",r,0,o)}var w,u=[s,n],i=[o,c],h=visibledatarow[n],d=s-1==-1?0:visibledatarow[s-1],y=visibledatacolumn[c],x=d,C=h-d-1,T=f=o-1==-1?0:visibledatacolumn[o-1],I=y-f-1;null!=(w=luckysheet.menuButton.mergeMoveMain(i,u,m,x,C,T,I))&&(i=w[0],u=w[1],x=w[2],C=w[3],T=w[4],I=w[5]),luckysheet.formula.func_selectedrange={left:T,width:I,top:x,height:C,left_move:T,width_move:I,top_move:x,height_move:C,row:u,column:i,row_focus:r,column_focus:a},$("#luckysheet-formula-functionrange-select").css({left:T,width:I,top:x,height:C}).show(),luckysheet.formula.rangeSetValue({row:u,column:i})}var R=$("#luckysheet-cell-main").scrollLeft(),S=$("#luckysheet-cell-main").scrollTop(),A=$("#luckysheet-cell-main").height(),F=$("#luckysheet-cell-main").width(),N=0,M=0;0<y-R-F+20?(N=y-F+20,l&&$("#luckysheet-scrollbar-x").scrollLeft(N)):f-R-20<0&&(N=f-20,l&&$("#luckysheet-scrollbar-x").scrollLeft(N)),0<h-S-A+20?(M=h-A+20,l&&$("#luckysheet-scrollbar-y").scrollTop(M)):d-S-20<0&&(M=d-20,l&&$("#luckysheet-scrollbar-y").scrollTop(M)),clearTimeout(jfcountfuncTimeout),jfcountfunc()};luckysheet.luckysheetMoveHighlightRange2=luckysheetMoveHighlightRange2;var luckysheetRangeLast=function(e){var t,l,r;document.createRange?e.innerHTML!=e.innerText||""==e.innerHTML?(e.focus(),(l=window.getSelection()).selectAllChildren(e),l.collapseToEnd()):(t=e.innerText.length,(l=document.createRange()).selectNodeContents(e),l.setStart(e.childNodes[0],t),l.collapse(!0),(r=window.getSelection()).removeAllRanges(),r.addRange(l)):document.selection&&((l=document.body.createTextRange()).moveToElementText(e),l.collapse(!1),l.select())};function getCursortPosition(e){var t,l=0;return document.selection?(e.focus(),(t=document.selection.createRange()).moveStart("character",-e.value.length),l=t.text.length):!e.selectionStart&&"0"!=e.selectionStart||(l=e.selectionStart),l}luckysheet.luckysheetRangeLast=luckysheetRangeLast,$("#luckysheet-copy-btn, #luckysheet-cols-copy-btn, #luckysheet-paste-btn-title").click(function(e){if($(this).parent().hide(),null!=config.merge){for(var t=!1,l=0;l<luckysheet_select_save.length;l++){var r=luckysheet_select_save[l].row[0],a=luckysheet_select_save[l].row[1],s=luckysheet_select_save[l].column[0],n=luckysheet_select_save[l].column[1];if(t=luckysheet.hasPartMC(config,r,a,s,n))break}if(t)return void(luckysheet.isEditMode()?alert("无法对部分合并单元格执行此操作"):luckysheet.tooltip.info("无法对部分合并单元格执行此操作",""))}var o=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_conditionformat_save;if(1<luckysheet_select_save.length&&null!=o&&0<o.length){var c=!1,u=luckysheet.conditionformat.getComputeMap();e:for(l=0;l<luckysheet_select_save.length&&!c;l++)for(var r=luckysheet_select_save[l].row[0],a=luckysheet_select_save[l].row[1],s=luckysheet_select_save[l].column[0],n=luckysheet_select_save[l].column[1],i=r;i<=a;i++)for(var h=s;h<=n;h++)if(null!=luckysheet.conditionformat.checksCF(i,h,u)){c=!0;continue e}if(c)return void(luckysheet.isEditMode()?alert("无法对多重选择区域执行此操作"):luckysheet.tooltip.info("无法对多重选择区域执行此操作",""))}if(1<luckysheet_select_save.length){for(var d=!0,y=luckysheet_select_save[0].row[0],f=luckysheet_select_save[0].row[1],m=!0,k=luckysheet_select_save[0].column[0],p=luckysheet_select_save[0].column[1],l=1;l<luckysheet_select_save.length;l++)luckysheet_select_save[l].row[0]==y&&luckysheet_select_save[l].row[1]==f||(d=!1),luckysheet_select_save[l].column[0]==k&&luckysheet_select_save[l].column[1]==p||(m=!1);if(!d&&!m||luckysheet.selectIsOverlap())return void(luckysheet.isEditMode()?alert("无法对多重选择区域执行此操作"):luckysheet.tooltip.info("无法对多重选择区域执行此操作",""))}luckysheet.selection.copy(e)}),$("#luckysheet-copy-paste, #luckysheet-cols-paste-btn, #luckysheet-paste-btn-title").click(function(e){luckysheet.selection.paste(e,"btn"),$(this).parent().hide()}),$("#luckysheet-chart-btn-title").click(function(){$("#luckysheetdatavisual").click()}),$("#luckysheet-pivot-btn-title").click(function(e){luckysheet.pivotTable.createPivotTable(e)}),$("#luckysheet-selectall-btn-title").click(function(){$("#luckysheet-left-top").trigger("mousedown"),$(document).trigger("mouseup")}),$("#luckysheet-download-btn-title").click(function(){luckysheet.isEditMode()?alert("正在下载！"):luckysheet.tooltip.info("正在下载！","")}),$("#luckysheet-chart-btn-screenshot").click(function(){if(0!=luckysheet_select_save.length)if(1<luckysheet_select_save.length)luckysheet.isEditMode()?alert("无法对多重选择区域执行此操作"):luckysheet.tooltip.info("提示！","无法对多重选择区域执行此操作");else{if(null!=config.merge){for(var e=!1,t=0;t<luckysheet_select_save.length;t++){var l=luckysheet_select_save[t].row[0],r=luckysheet_select_save[t].row[1],a=luckysheet_select_save[t].column[0],s=luckysheet_select_save[t].column[1];if(e=luckysheet.hasPartMC(config,l,r,a,s))break}if(e)return void(luckysheet.isEditMode()?alert("无法对合并单元格执行此操作"):luckysheet.tooltip.info("提示！","无法对合并单元格执行此操作"))}for(var n,o,c,u,i=luckysheet_select_save[0].row[0],h=luckysheet_select_save[0].row[1],d=luckysheet_select_save[0].column[0],y=luckysheet_select_save[0].column[1],f=luckysheet.datagridgrowth([],h+1,y+1),m=i;m<=h;m++)for(var k=d;k<=y;k++)f[m][k]=luckysheet.flowdata[m][k];o=i-1<0?(n=0,visibledatarow[h]):(n=visibledatarow[i-1],visibledatarow[h]-visibledatarow[i-1]),u=d-1<0?(c=0,visibledatacolumn[y]):(c=visibledatacolumn[d-1],visibledatacolumn[y]-visibledatacolumn[d-1]);var p=$("<canvas>").attr({width:Math.ceil(u*devicePixelRatio),height:Math.ceil(o*devicePixelRatio)}).css({width:u,height:o}),g=luckysheet.flowdata;luckysheet.flowdata=f,luckysheetDrawMain(c,n,u,o,1,1,null,null,p),luckysheet.flowdata=g,luckysheet.editor.webWorkerFlowDataCache(luckysheet.flowdata);var v=new Image,b=p.get(0).toDataURL("image/png");v.src=b,o<u?v.style.width="100%":v.style.height="100%";var _=$(window).height()-200;luckysheet.tooltip.screenshot("截取成功！",'<div id="luckysheet-confirm-screenshot-save" style="height:'+_+'px;overflow:auto;"></div>',b),$("#luckysheet-confirm-screenshot-save").append(v),p.remove()}else luckysheet.isEditMode()?alert("请框选需要截图的范围"):luckysheet.tooltip.info("提示！","请框选需要截图的范围")}),$(document).on("click","a.download",function(){for(var e=$("#luckysheet-confirm-screenshot-save img").attr("src"),t=atob(e.split(",")[1]),l=t.length,r=new Uint8Array(l),a=0;a<l;a++)r[a]=t.charCodeAt(a);var s,n=new Blob([r]),o=document.createElement("a");o.setAttribute("href",URL.createObjectURL(n)),o.setAttribute("download","截图.png"),o.style.display="none",document.body.appendChild(o),o.click(),o.addEventListener("click",s=function(){requestAnimationFrame(function(){URL.revokeObjectURL(o.href)}),o.removeAttribute("href"),o.removeEventListener("click",s)}),document.body.removeChild(o)}),$("#luckysheet-share-btn-title").click(function(){for(var savedata=[],i=0;i<luckysheetfile.length;i++){var charts=luckysheetfile[i].chart;if(null!=charts)for(var c=0;c<charts.length;c++){var chart=charts[c],data=luckysheet.getdatabyselectionD(luckysheetfile[i].data,{row:eval("("+chart.row+")"),column:eval("("+chart.column+")")});savedata.push([chart.defaultOption,chart.selfOption,chart.chartType,chart.chartStyle,chart.chartMarkConfig,chart.chartTitleConfig,data])}}luckysheet.tooltip.info("正在发布数据",'<div style="width:100%;text-align:center;position:relative;top:45%;font-size: 16px;"> <div class="luckysheetLoaderGif"> </div><span>渲染中...</span></div>'),$.post("../Home/seth5js",{text:JSON.stringify(savedata)},function(e){"0"==e?luckysheet.isEditMode()?alert("发布数据失败, 请稍后再试！"):luckysheet.tooltip.info("发布数据失败","请稍后再试！"):luckysheet.tooltip.info("发布成功！请扫二维码",'<img src = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAYAAAB5fY51AAAgAElEQVR4nO3df2wk91038PfaPt8P3+R+5JJLd5IrKTTZhOOg5DZP9unzUFq3txS1OiOsCKEsaKEV4gTxI6qni2DFH4/8qM+W53kk949FKUhLZQRIWGAkquIjBtRSuWQDBfUaljbJNUl3Q5pr4rtJfD7bO8Mf9m721jO7M975fma+6/dLihTvrec7M9/5fjzf3wnHcRwQEWlgJOoTICLyiwGLiLTBgEVE2mDAIiJtMGARkTYYsIhIGwxYRKQNBiwi0gYDFhFpgwGLiLTBgEVE2mDAIiJtMGARkTYYsIhIGwxYRKQNBiwi0gYDFhFpgwGLiLTBgEVE2mDAIiJtMGARkTYYsIhIGwxYRKSNMdUJnD17tu93rly5Eug4uVwOhUIhULpzc3OYnJz0/H61WkU+n2//vLS0BNM0e6ZRLpdRLpcBAIZhYGVlpef3Z2ZmsLy83P45nU6jUqn0/J1sNot6vd7+ud+9siwLmUym/XOlUkE6ne75O933ql8andft5/vdaVy6dAmXLl0KdE5B829lZQWGYfRMo/M6TNPE0tJSz+/n83lUq9X2z5OTk5ibm+v5O5lMBpZltX/ud6/q9Tqy2Wz7ZxX5VyqVMD8/7/v7bmm48XOug9LyDavzofHr2Wef7fnvnUEBAGq1Wt9jNhqN9v9blrXrGN26j9n5+278HLPbM8880zPNMOzl/g/6+/3yr/s6u++Dm877X6/Xbwss/b7vlmY3P8fs1n3MoPnvx6D5F6VYBKxsNuuZsZZl3fYXB9jO1M6/pt3cHqTOvyhuisXibT/PzMz0zNhSqYTFxcXbPpuenu6ZRvfD1+9hvHDhQt/z7FStVjEzM7PrPHtde+ebUkuvguh2X4Lmn9t59ku/X/6VSqW+59mpWCzuyj+3+90paP65PQ/d59nJ7b64nWenoPmXz+d3/XvQ/ItSLAJWvV73DED5fN71wfB6GGu1mmdh8Mp4r2M9+eSTnoXHrQB5vRFZluUZaIrFouvDYlmW6+eLi4uehffJJ590/dyrkCwuLro+8G4PdUtnlbZlL/nndhyg9x8jr/zz+twr/8rlsuvveN3zveSf19uV17PTOl83QfNvZmbGM//cnvW95F9UEo7jOCoT8FP37ZZKpQJVZdLpNBqNRqAbm06nA70aG4YR+PU+6HWkUikAwapxpmkGvu5areb7WkzTRDKZDHSvVOefYRhIpVKxzL+g1fhhyL8WiTasWAYsItIPG92JiDowYBGRNhiwiEgbytuwWroHQBKR/vwMuA2T2BvWwsJCuxeMiPSXSqWwsLAgmqbYG1ZLr15DP1MEiEhO3Mor27CISBviAYvVQiL9RVWOxQOWism4RCQrqnLMKiERaUMsYFmW1Xc1AyLSx/T0dOD5mYMSC1jT09OsDhINkVqtJv4SEosVR4lIT/V6vV3GOfmZiKgDAxYRaUN5wMrlchx7RTTEUqkUcrkcksmk8rTEpuZ07zjiJshQ/0QiMegpKeN1S4Oc86DZ4pWWqnMLkl7Qc1Nl0HMO415KC3qP+7VB+9n5KUzKG91bWhfFRnii4cC5hEREPYgHLNXdnkSkXlTlWDxg9ds8lIjiL6pyLNaG1aJy1VHpRltg8AbWoOfsN72gDcJBzkPVNUt2SoR1HmGkp4rKxv+oVg8WfcPi1Byi4RFFeRYLWL12ZCYi/fTaYVqVWG2kOug4rLhUCYNUNYa9ShiH4wYVh3schjCetyDll3MJiYg6MGARkTYYsIhIG8qHNczNzeHZZ5/F/Py86qR6kh5+4JeqrmfpuYRBzsPr94OcWxjnG8b8x0GFcdwo2m475XI5nD9/XmSRA9F9CRcXF1EsFj3/XWWju+TYoThPio1zwApyjCBUBay4BEKVnTy9Gt1nZ2cxNTUV6HiDEq0SSl8cEakTRXkWb8MyDEM6SSIaEtxIlYgCi2rys/hcwn6L+A2zMAZR+j2GdHuZysGSg7b9xKHtcNhEVY45rIGItCEasPbz2xXRsImiPCuvElarVdTr9Z7DGYhIP/l8HsD28AbTNJFKpZR3qu2byc9xGIcVhKo2rDhsQhEGle1SHIf1jrhNfhZvdKfbxaWgBylMgzZ4x2XxvahHiFNwbHQnIm0of8NaWlri4n1EQ2xubg6pVAqmaSpPS/kblmmamJycRKVS4Sh3oiFiGAYqlQomJydFghUgWCWU3iGWiNSSaGTvJtqGxWk5RMMjivIs3ktommYkWwTFoUcojC5sv71ucV/CJQhVQy7CSG9QcXgu9yKq5h3xXsKo9jMjovBYlhVJuhzWQETaEA1YUS+TTEThiaI8iwWsUqmEUqkklRwRKRZFmVbe6F4ul9FoNLC4uKg6KSISNj8/D8uykEwmcfHiReXjsUQClhQdF2rTcYMEye96UbkpiKpJyjo+n360XkbS6bTygMVGdyLShvKAxek4RMPPMAyRsq68SriysoJ6vY7p6enIxm4QkRqGYWBhYUFsLqHISHfTNNuBK5vNSiRJRIotLS2JBaoW0ak5YV6crlMauoWxMqh0Y3UQ0rvbxOG5iMM5SJAOVgAb3YlII9xIlYgCi6ociwesWq0mnSQRhSyqciwasNhLSDQ8oijPogGLcwmJhkcU5Vn5voQzMzOo1Wq+1sEKsi9hUHHYl1By2kgYC/gN856CQY/hRrpXM4peVD/7ErY2Uf30pz+t/9Sc5eVlLtpHNMTq9TqWl5fRaDSUp8VhDUSkDQYsItKG8pHu6XQajUaD1UKiIWWaJpLJpMjkZ+WN7p2KxWLPhfyCNLrHpSFV1dpJQdJzE8aUnyBU7poz6D1WtYOQyo4NldcXRK9G96mpKczOzipL241olbBQKEgmR0QKRVGeRQMW18YiGh5RlGfOJSSiwPbNXEJOzyGiveLOz0QUWFSTn0UX8FP9dhVGb4mqHiWvY0vvxhKX3W2GmXR+RNWjaFmWeDuWSMCyLAsXLlxgdZBoiGQyGRiGgcuXL4sFLuVVwmw2i0wmw2BFNIQsy0Imk0E2mxWpJioPWGyzIhp+9Xpd5KWEcwmJSBsMWESkDeWN7q35gf3mEarmdx5X0J6xQRdgCzqXbNB5btI9SqrSU3luqno2pedESpCeTyg2rGF2dhbJZBLlclkqSSJSqFAoIJfLiaYpuloD0Hv296CrNfS6FFVvWEGomq3vJoyll8MQ5zcIVfdCeqybSmGV17CwDYuItCEesLhiA5H+otimHhCemgOonZ4TtBolvdtMGFWCOOz+4/f3wzgHlecR5BiSDfFe5xDWscMQ1fhKVgmJSBtiAatarSKTyUglR0SKZTIZVKtV0TSVByzLsrC8vIx8Ps/5hERDxLIs5PN5LC8vi5Vt5cMa/Owc26JyEwq/pHdMVtWGFZfrcBP3NixV5xD3XZ7dBCm/lUoF6XR64DR7EW90D0sc1pYKeh6SAUB6958gQUjl/ZEMCmH8sYnLeCtdsNGdiLSh/A2rUqmgVquhVCqpToqIIlAoFJBKpUQ2phDZ+TmdTsMwDBSLRdXJkRC/VRmV44woetLzCbWdS+gmikIwaBtWHHZGDnKMsB+XzjTi3IalatBv3AeOxm0uobaN7iRL9UhvvnGRH+IBK51OKxtsFnS1hjCOHdeenyh2EAorre57Kj28QtXvq0ovyNppYeWp6uELXsR7CaPaz4yIwhNVOebOzxQ7juPE4i2VvEVVjkUDVpRLJJN+GLjiLYryLBawyuUyhzUQDZFisSi+5Lm2cwmDimuje1y6r3Uz7PdN1RCIoNfMuYQhicMk1718P+zf9xLntdT3aq95rmoieBhj3aS/qzvOJdzHdGsj0ulcSQ0GLNIKg9b+JraRaq1W4yJ+MaJzwXcchyPjY8AwDFQqFZFJzy1ib1ipVAqVSkUqOepB52DVMgzXoDvpYAUIN7qrvjjprdXDIL0y6DAVdL/XEue3sThMlN8r6WAFRNBLaJpmZFsEUfzYjoOXrQ389dVVvP72BlbXN3H84CjMiXGcu3sC504fxfgom1rjZt/sS5hMJhmw9rG/uHodf/L8KpZfXoXTtAEHMEaAT/34aXz43cdw7q4JTIyPRn2a1EcymYwkXfGAJb0tEL0jyurgtfUtPFV7E6V/fg0jdhMJx0HugZP42P3H8d+SR9G0Hbywuo6nr76J515/C6vrmxgFcPLQGN5/5jjO3WNgYlzbYYNDJ6pyzCeAlPufz7yGLzy/irVbWxizm/jJ5FH84oMn8dg9E/iH797Ab3/lJSw89z1sbNmA7cCxmxhxHIw4Nhzbwf9t2jgyCrz/zAnM//wjUV8ORUgsYM3MzGB5eVkqOeoi/Xb1J1dv4Hf++Xt45e0tHLSb+IUfOo5fTp3Ab3z5FXzllRv4h5dWMWY3AWcnSG3ZsB0bCcfBmN2EYzuwbQdwHBx0bPzS+TP4jQ+8V/QaqLezZ89icnISc3NzYmkqn0tYLpdRrVZ9vULGYV/CoKS3+dprz5hkwPrWjQ2c+8urgOMg4Tj4fOYefKVh4a9efBPrmzZG7O3/Rp3twOTYDuzmdjVxxHGQaG5/jp23rL/7lf+KB+86uufzUZUfKnt447IwpJ+5hK19Gy5evKi8MV7byc8MWP5/f9Asfu2WjW/e2MJz1hb+5j/W8craFlY3bKze2oTj2Gg6QMoYxZnDozh1cAR//OINbGw0cWp8BB++5zAWn38DiZ3gNdLcCVhwgFZg6qoG2ls2joyNYOqhu/GJR8/g4dPGQOfPgLV3nPxMsWdtOfj4167jxbeb2MB2QIHjoGnbWN+yAceB49jYbDbRtB3YjoN/uraBrzsORne+O9Zs4sbaFhafv4kRe7s3cMS2MWY3kdhpm2pVA4+OJfBL70visfuO47H7jsM4yMeS3PHJoLYN28EfvXILv3f1Jl67ZW8HK2f7L7tt29jYCUZwbMCx28EKO1W5VrBqVe1avYHG2AiOHxjBOBz8gHEYx8ZH8a6JcbzfvAM/dPIwzhw7xLFW5IvYXMJsNsvxVzE39TULtbe20ASwge3YhI5gZdvbb1ZwbGzaDh6/7wgevmMcZ46M4r4jo9hoOnh1bQtff30NX3ju9XY18NjYCL78+EM4xjenoWOaJpaWlsTSE9uX0LIs5PP5novX69iG5UblQmsq2jY+/52b+Oy317G5s9xMqxro7FQDb23ZGIWDx+89jM+fP+nrmI/86Tdx9frGTjVwC7mH78LvfvA9A53nXoWxf2AY4rqHZS+92rBa84MNY7A2xiDE3sMNw8DCwoJUcuTTX756C5/99jrsdrBCuxrYtG1sNB3cf2QEl3/ilO9gtWU77WA1Ym8PVfiRUxNKr4PkLSwsiAYrgG1Y+9oLbzVR/Lc12A46qoHb1bhWsHIcB3/7gbtx6qC/6TL/em0Nha9+tx2sRmDjA/fegZ97+C6l10L7g3jASqVS3JswJv73t9bw9hbQhPPO6qOtN62dYDUKx1ew+uqrb+GpK6/ji1dX4TjA2E6wGoWDP/xYio3qQyaKlRqACAIWg1V8LF/bhO042MRO24Ztt9+sbNtGwrHxgHF7sPr9b6/iu29t4sUbG/jSS9exsWVjxG62hy4chIPzdx3BUxfuR/LowWgujJSLqhyzSriPbQcrp90b2A5WO0MXHMfGv642b/udn7nvKL7+xjpOHxrFyTFgbbMJYyyBcycP473HD+LcqSMwuNoCKSIWsFq9hFEZtNdFeusuCZ3BCh3VwNZYq03bQdN28OmvX8Nv/fAJHB8fxalDY/hI8ig+EmB1kX/87ipeevMm0uYx3H/yiJJrad1zVbMJVPXwBhHGyPowTU9Pi/cSig1r8DMOS+WwBt0ClsSwhnu+9PptvYGOvT3Gyna2hzK0BoWO2k2M2tsj3A80bRw/kMBd4wnceWBku5G+6eDaW+tY39zC6voWbNtB7VfSOPt7X4PdbOIT70vi46m78ei9x/d0nn70ClhxeVakt14L41npNzVHehyW8jesIHORSNZtwWrnrcreebNqBauE806wSjhAwnFgrW/hrZsOvmPbGGluz/87lLAxPpLAe44dwrm7J3Di8AFc+dXHAAAnDh9wTf/VGzfx9L+/hofvuQOP3OdvyATFS71eb5dxziUkpZrN7RHsrWqg3VEN3A5QNkZ2qoyJnZ6/wwkb5Q+ewYPHD+HQaAITB0aQAGAcGL1tpdAX3ljD899fw8urN/HJ9H270m5cv4nH/v/TeHtjE0+cfzcDFvnCgLWPzaeP4/GV77ffrNa37Pab1qht31YNTOzMDdy0bXzy6asYaToYc7baE6O/8YlH8Jmvfgef/6c6Rh0bP376KH70tIH0vccAAOtbTTz78ps4f98JPPyZL6HZdPD3v/5BvOfU3peNof1HecC6dOmS7/WwgpBuq5Buwwjzu17n89F7DuGT9x/BUy/cwKb9TrUw4di7qoGticxwnHY18GPvOQHjwAiOHhjFnYcPYPaDP4hL5+/FCIB7jIOwHQcvfP9t/Nqf/wue/tb3cGNtA43/9TFUP/URHBwbxVEFcwsHXcIl6DFUCeN5kzrn1npYEuu8iwQsgCuORimRSHg+vP/n3HE0bm7iz15+ux2suquBrWCV6AhWI7DxBx994LZjXV/fxGvWOmrX1vAX33gVz/3Hdbzx9i0kbBuHRoGffug0AODOCY7PGhZDt+Jot16N8EF6Cd30+qskuYed9KRaP/xcf3LhBbxxc3NXNXDEtnHq4BgeOj6OxvU13FjfwvpmE81NG5l7DfzZ9I/A/Ozf4UAigdMTB/DAnRN44seSeOTeYzg1cRAvv7mGv//29/DFb9bxmx95GO+790To17eXvI9Dr10YVBZhleV1L9iGtU/0estqufLxH8DvfuP7+P1/fwMbW7dXA2cfS+LxB+8EsD25eaNpAwAOjW1PufnW//jvSCQSOHJgu+H9+vomvvriNXz5hWv4wjMvYqvpYHwsgffeFf6YHV3GvdHgxANWOp3mVl8xdfLgKD5z/m586uxJfPyLL6D2xhYSjoPRpoNff/pFPPUvDfzUu4/h+MEx3DE+ihEACThIAHhjbQOHRkfwE/efxLtPHMEj/28Za7e2AMfBhx84jY8+9C589OF3KWm3Inmqhy94EX96Go2GdJK0w89bFgCcOjSGlZ99sP2z7Ti4traJq9fXsfLKdby0ehOrNzexvrG5vfio4+DMHQfx3jsn2gHp+d/+KWXX0YlvV9GIqhyLB6ywVh2Nw6YAe0nTr0HbXcI8r5FEAndPjOPuiXH8l+QdoR03DCru/6DtnUHOSWXbmMq2rahWDxZd84MrNRANjyjKs1jAqtVqkU5+JqJw9VvyXAXOJSSiPbEsC9PT0+2fJeYSchlIItIGAxYRaWNfD4oJYz6i9KJsqo4xLCTnfAa973GYj6j7s6L8DWtubg65XE51MkQUkVwuh0qlIrIxhehcwsXFRRSLRc9/H3TF0TjP9/KicuzYfhTnNyxVVM6J7NVpNjs7i6mpqUDHG5RoG5b0xRGROlGUZ/FGd+mdYokofFGV40g2UlU1+TmKpWFUVQuiTi8u1Z0whJGnbt8NmkfS1XmVx943G6lypQY9dBauYQpeFI6oyjHHYVFfXBGB4kI0YC0uLkomRyFKJBIMXHSbKMqz8mEN1WoVtVoNpVKp73dVbqTqF9uw9iYu7TaqlgxSNVwi7svL+JkLXCgUkEqlkEqllDfGKw9YQSY/M2DFLz2/GLD2lt4wBKwWbqTaQ9CHatCeHy/SU3PiMKhx0GOHsR1bGOnFIfiHETTj8sdCAhvdiUgbygPWysqK6L5lRCRrbm4OKysrIhtTKA9YhmFgcnISlUqFo9yJhohhGKhUKpicnBQr22JVwnQ6jUqlIpUcESkm0cjeTbTRPczh/EEbFAdtgFTVo6SqAVplQ/OgPWYqz03V9Uk3gqucZhaWKKbniDe6m6YpnSQRhSyq5h3xgBXVfmZEFB7LsiJJl8MaiEgbogFrfn5eMjkiUqhcLounKdboXiwWOfmZaIiUy2U0Gg3Mzs6Kpak8YLUuKupgJTk/TCW/PU1x39EliDisEhGHxfe87oPKNd37aZXrZDKJixcvKu9UEwlYRDS8WkErnU4rD1hsdCcibSgPWBx3RTT8TNMUGZulvEq4tLQEy7Jw4cKFyMZuEJEahmHg8uXLYgNJRXoJDcPAysoKLMtCJpORSJKIFFtZWREf8S46l1CH1RrisuLooFT2rKmaHyg9f046T1X1VEclivLMRnci0oZ4wIpqA0YiCk9U5Vg8YNVqNekkiShkUZVj0YDFXkKi4RFFeRYNWH72JlSltRFo539+v9erYdTr+0GOMSi3tBzHCfSfmzC+G8a5+T2HIPdnL7sjqfhP5TmoFkV5Vr4vYT6fR6PR8LUO1qD7EgZdcVSa5LZSYWwfJrl6ZxjH9Tp2GKu6xuH5CUpqX0LTNJFMJtsbqqqkfFhDtVpVnQQRRaher6Ner4tUETmsgYi0wYBFRNpQXiWcnJxErVYLfS13Hdd7khzJLT3yvFdj/CDH9TqGyh12/J6fdFtcXJmmiVQqhWQyqTwt5Y3unfqtOhqk0V1HqgJWHBYiVDkFZ9BHNIztuIL8fhBxD1i9Gt2npqZEVxsFhKuEhUJBMjkiUiiK8iwasHSY/ExE/uyLyc+cS0ikv30zl5DTc4j0F1U5Fl0PCwhv5+c4jzwOo8csSIOwdM+fZAO9V3px2cUoyDkMmk9hXHNYjflR7eAu+obFbeqJhkcU5VkkYNXrdWQyGWSzWYnkiEhANptFJpMRDVzKq4SZTIbtVkRDyrKs9ovIwsKC8sZ45W9YDFZE+wMnPxMRdRDvJVQpiukM0r1Sg15jkJ4mVWtOSeeTdI+iynmOqtLThfI3rCtXruDKlSvI5XKqkyIiYblcrl3G0+m08vTEqoSFQoFzCYmGSBRlWrQNi29ZRMMjivLMRnci0oZ4o7thGJEMdZCeTjLoOcRhnSRVDb/SHRWq1sPS8TrCen5M0wzlOEFx8jMRBbYv5hISEQ1CLGBVq1VkMhmp5IhIsUwmI76Nn/KAVa/Xsby8jHw+z+og0RCxLAv5fB7Ly8tiVUTlm1D42Tm2Jc47P4fRsCm5a05QKhto/aQVlMq1oeKwplYc1k4DgpXfSqWifPDoUE3N0VFctpQfVFyCUJDjhvX9bmFMadJt0UIpbHQnIm0of8OqVCqo1+soFouqkyKiCMzOzrY3U1VNecBKp9Ptem2pVGLDO9GQMAwDhUIBU1NTYmmK7vwM9G7E24+N7nFpw5Lc3MJLXO7xoKSX5VG5tE9Y5TUsbHSPmPQOK0GEcW6DNjQHTU+VIPdYei2r/dQYL97oLrFmDhGpFVU5Fg9Y0iNjiSh8tVotknQ5rIGIAouq80w0YC0uLkomR0QKRVGexQJWuVzmWCyiIVIsFlEul0XT3DdzCVVRNRxg0J4fHeczeonDsAbpXYHiMgQmbnMJ2YZFRNpgwCIibTBgEZE2lI90b7VL1Wo1zMzMRLYWNBGFyzRNzM3NiUx6bhF7w0qlUpibm5NKjogUkw5WgPBcQtUXN4xzp/xQtTqllzjMXZTeMi2MOZGDnkPcnm/pYAVE0IYV1X5mRBSefbMvYTKZlE6SiEIWVTnm5GciCiyqcsxhDUSkDbFG93w+H2pUjsOibmFQtaOL9E4xYZBe+G5QKs8hDtfXz9mzZ5FOp1GpVMTSVD6XsFQqoVqt+lo/J4olV4nIm5+5hKlUCul0Gk888YTyxnjlb1jz8/OqkyCiCNVqNdRqNXzoQx9SHrDYhkVE2mDAIiJtiM0lzGaznEdINGRM08TS0pJYemJvWAsLC5EM5SciNVKpFBYWFkTT1HYjVSJSL27llW1YRKQN8YDFaiGR/qIqx+IBK6oNGIkoPNxIlYioD7FGd8uykM/n+YZFNCRSqRQqlQoMwxBLUyxgcRwW0fCRHocVq41UiUhf3EiViKgDAxYRaYMBi4i0EcuAFXRQWjqdDrQOj2EYgevae1nnJ+h1pFKpwOkE7aFJp9OBfsc0zcD3ivnn317yLwiJ/JMkui9hL14TKaenpz2HQrjNZeq1w/Ts7CympqZ2fV6tVpHP53d9bhgGKpXKrgycn59HqVRyPaelpSXXh7ZYLGJxcXHX51NTUygUCrseXMuykMlkXNO4dOkSLl26tOvzTCYDy7Jcf8ftXi0uLqJYLO763Ou6Ae9OlDDzL5/Pu16HV/4FvY5e+beysuKaF6VSKVD+1et1ZLNZ1zQKhQJyudyuz73yzzAMrKys7Prc67p77cgcZv5FIRZvWKZpeq4LXalUXAOA11+NXjtMuz3svY71uc99zjXTc7mc6wNnGIbnX9jZ2VnPz93+yhqG4fr51NSUa7BqnW+QtL2O5RWsAGBycnLXZ3vJP7fjAO+M7fE63yCf98o/t9/xuueGYQTOP9M0XT/3enZa5+umUCi4fu6Vf712ZHZ71veSf1GJRcBaWlryfDU2DGPXOI9eD3Xr37t5PSQt3Q/k3Nxcz1fpQqGw66Hvt9RGd8b3exAuX77c9zw7pdPpXcHa7Tw7uT3wvaoEbvclaP65nWe/9PvlX3eh7pd/bm9rbve7U9D8c3sevIIP4H5fvN4qW4Lmn9sfo6D5F6VYBKyg9jLW4/z58z3/vfvh81OP79xMstfbldcx+21G6eeY3R599NGeaYZh0LE2KvKv+zq774Obzvvv9Ubk9X23NLv5OWa37mOqeLtRPVZKJeUDR/1s7eXnBnYeJ5lM9s3I7nRTqVTPh8eyrNvq6n7OqV6vo9FoANgOLv0e4M7v+/2dWq12W7tG0HvV77q7v+8nje7r2C/5150Xfq5jGPPPi59zHZT4An5ERHulZZWQiPYnBiwi0gYDFhFpgwGLiLTBgEVE2mDAIiJtMGARkTYYsIhIGwxYRKQNBiwi0gYDFhFpgwGLiLTBgEVE2mDAIiJtMGARkTYYsIhIGwxYRKQNBiwi0gYDFgsBXbcAAAAcSURBVBFpgwGLiLTBgEVE2mDAIiJtMGARkTb+E290dzfWDONJAAAAAElFTkSuQmCC" />')})}),$("#luckysheet-splitColumn-btn-title").click(function(){null!=luckysheet_select_save&&0!=luckysheet_select_save.length&&(1<luckysheet_select_save.length?luckysheet.tooltip.info("不能对多重选择区域执行此操作，请选择单个区域，然后再试",""):luckysheet_select_save[0].column[0]==luckysheet_select_save[0].column[1]?(luckysheet.splitColumn.createDialog(),luckysheet.splitColumn.init()):luckysheet.tooltip.info("一次只能转换一列数据，选定区域可以有多行，但不能有多列，请在选定单列区域以后再试",""))}),$("#luckysheet-freezen-btn-horizontal").click(function(){"取消冻结"==$.trim($(this).text())?(null!=luckysheet.freezen.freezenverticaldata&&(luckysheet.freezen.cancelFreezenVertical(),luckysheet.freezen.createAssistCanvas(),luckysheet.luckysheetrefreshgrid()),null!=luckysheet.freezen.freezenhorizontaldata&&(luckysheet.freezen.cancelFreezenHorizontal(),luckysheet.freezen.createAssistCanvas(),luckysheet.luckysheetrefreshgrid()),luckysheet.freezen.scrollAdapt()):(null!=luckysheet.freezen.freezenverticaldata&&(luckysheet.freezen.cancelFreezenVertical(),luckysheet.freezen.createAssistCanvas(),luckysheet.luckysheetrefreshgrid()),null==luckysheet.freezen.freezenhorizontaldata&&(luckysheet.freezen.createFreezenHorizontal(),luckysheet.freezen.createAssistCanvas()))}),$("#luckysheet-freezen-btn-vertical").click(function(){null!=luckysheet.freezen.freezenverticaldata?(luckysheet.freezen.cancelFreezenVertical(),luckysheet.luckysheetrefreshgrid()):luckysheet.freezen.createFreezenVertical(),luckysheet.freezen.createAssistCanvas()});var submenuhide=null,rightclickmenu=null;$(".luckysheet-cols-menu .luckysheet-cols-submenu").hover(function(){var e=$(this),t=e.attr("id"),l=$("#"+t+"_sub"),r=e.parent(),a=$(window).width(),s=$(window).height(),n=r.width(),o=l.height()+25,c=l.width()+5,u=e.offset(),i=u.top,h=u.left+n;a<h+c&&(h=u.left-c),s<i+o&&(i=s-o),l.css({top:i,left:h}).show(),rightclickmenu=e},function(){var e=$(this).attr("id"),t=$("#"+e+"_sub");submenuhide=setTimeout(function(){t.hide()},200)}),$(".luckysheet-rightgclick-menu-sub").hover(function(){rightclickmenu.addClass("luckysheet-cols-menuitem-hover"),clearTimeout(submenuhide)},function(){rightclickmenu.removeClass("luckysheet-cols-menuitem-hover"),$(this).hide()}),$(".luckysheet-grid-container, #luckysheet-rightclick-menu").on("contextmenu",function(e){e.preventDefault()}),$("#luckysheet-rightclick-menu input").on("keydown",function(e){e.stopPropagation()});var copychange=function(){(document.hidden||document.webkitHidden||document.msHidden)&&(iscopyself=!1)};$("#luckysheet-modal-dialog-mask").on("click dbclick mousedown mousemove mouseup",function(e){e.stopPropagation(),e.preventDefault()}),$(document).on("visibilitychange webkitvisibilitychange msvisibilitychange",copychange).mouseleave(function(){iscopyself=!1}).mousedown(function(e){luckysheet.postil.removeActivePs(),$(e.target).hasClass("luckysheet-mousedown-cancel")||0!=$(e.target).filter("[class*='sp-palette']").length||0!=$(e.target).filter("[class*='sp-thumb']").length||0!=$(e.target).filter("[class*='sp-']").length||($("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu, #luckysheet-user-menu").hide(),$("body > .luckysheet-filter-menu, body > .luckysheet-filter-submenu, body > .luckysheet-cols-menu").hide(),luckysheet_cols_menu_status=!1),0<$(e.target).closest("#luckysheet-wa-editor").length&&0<parseInt($("#luckysheet-input-box").css("top"))&&(luckysheet.formula.updatecell(luckysheetCellUpdate[0],luckysheetCellUpdate[1]),luckysheetMoveHighlightCell("down",0,"rangeOfSelect"))}),$("#"+container).add("#luckysheet-input-box").keydown(function(e){var t,l,r,a,s,n,o,c,u,i,h,d,y,f,m,k,p;$("#luckysheet-modal-dialog-mask").is(":visible")||$(e.target).hasClass("luckysheet-mousedown-cancel")||$(e.target).hasClass("formulaInputFocus")||(t=e.ctrlKey,e.altKey,l=e.shiftKey,r=e.keyCode,a=$("#luckysheet-input-box"),r==keycode.ESC&&0<parseInt($("#luckysheet-input-box").css("top"))?(luckysheet.formula.dontupdate(),luckysheetMoveHighlightCell("down",0,"rangeOfSelect"),e.preventDefault()):r==keycode.ENTER&&0<parseInt(a.css("top"))?$("#luckysheet-formula-search-c").is(":visible")&&null!=luckysheet.formula.searchFunctionCell&&(luckysheet.formula.searchFunctionEnter($("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active")),e.preventDefault()):r==keycode.TAB&&0<parseInt(a.css("top"))?($("#luckysheet-formula-search-c").is(":visible")&&null!=luckysheet.formula.searchFunctionCell?luckysheet.formula.searchFunctionEnter($("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active")):(luckysheet.formula.updatecell(luckysheetCellUpdate[0],luckysheetCellUpdate[1]),luckysheetMoveHighlightCell("right",1,"rangeOfSelect")),e.preventDefault()):r==keycode.F4&&0<parseInt(a.css("top"))?(luckysheet.formula.setfreezonFuc(e),e.preventDefault()):r==keycode.UP&&0<parseInt(a.css("top"))?$("#luckysheet-formula-search-c").is(":visible")?(0==(s=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active").prev()).length&&(s=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").last()),$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").removeClass("luckysheet-formula-search-item-active"),s.addClass("luckysheet-formula-search-item-active"),e.preventDefault()):t&&l?$("#luckysheet-formula-functionrange-select").is(":visible")?luckysheetMoveHighlightRange2("up","rangeOfFormula"):luckysheet.formula.israngeseleciton()&&(null!=(k=$(window.getSelection().anchorNode)).parent().next().text()&&""!=k.parent().next().text()||(n=$("#luckysheet-input-box #luckysheet-input-box-index").text(),null==(o=luckysheet.formula.getcellrange(n))&&(o=luckysheet.formula.getcellrange($("#luckysheet-input-box-index").text())),c=o.row[0],u=o.row[1],i=o.column[0],h=o.column[1],d=visibledatarow[u],y=c-1==-1?0:visibledatarow[c-1],f=visibledatacolumn[h],m=i-1==-1?0:visibledatacolumn[i-1],luckysheet.formula.func_selectedrange={left:m,width:f-m-1,top:y,height:d-y-1,left_move:m,width_move:f-m-1,top_move:y,height_move:d-y-1,row:[c,u],column:[i,h],row_focus:c,column_focus:i},luckysheet.formula.rangeSetValue({row:[c,u],column:[i,h]}),luckysheet.formula.rangestart=!0,luckysheet.formula.rangedrag_column_start=!1,luckysheet.formula.rangedrag_row_start=!1,luckysheetMoveHighlightRange2("up","rangeOfFormula")),e.preventDefault()):t?($("#luckysheet-formula-functionrange-select").is(":visible")?luckysheetMoveHighlightCell2("up","rangeOfFormula"):luckysheet.formula.israngeseleciton()&&(null!=(k=$(window.getSelection().anchorNode)).parent().next().text()&&""!=k.parent().next().text()||(n=$("#luckysheet-input-box #luckysheet-input-box-index").text(),null==(o=luckysheet.formula.getcellrange(n))&&(o=luckysheet.formula.getcellrange($("#luckysheet-input-box-index").text())),c=o.row[0],u=o.row[1],i=o.column[0],h=o.column[1],d=visibledatarow[u],y=c-1==-1?0:visibledatarow[c-1],f=visibledatacolumn[h],m=i-1==-1?0:visibledatacolumn[i-1],luckysheet.formula.func_selectedrange={left:m,width:f-m-1,top:y,height:d-y-1,left_move:m,width_move:f-m-1,top_move:y,height_move:d-y-1,row:[c,u],column:[i,h],row_focus:c,column_focus:i},luckysheet.formula.rangeSetValue({row:[c,u],column:[i,h]}),luckysheet.formula.rangestart=!0,luckysheet.formula.rangedrag_column_start=!1,luckysheet.formula.rangedrag_row_start=!1,luckysheetMoveHighlightCell2("up","rangeOfFormula"))),e.preventDefault()):l?($("#luckysheet-formula-functionrange-select").is(":visible")?luckysheetMoveHighlightRange("down",-1,"rangeOfFormula"):luckysheet.formula.israngeseleciton()&&(null!=(k=$(window.getSelection().anchorNode)).parent().next().text()&&""!=k.parent().next().text()||(n=$("#luckysheet-input-box #luckysheet-input-box-index").text(),null==(o=luckysheet.formula.getcellrange(n))&&(o=luckysheet.formula.getcellrange($("#luckysheet-input-box-index").text())),c=o.row[0],u=o.row[1],i=o.column[0],h=o.column[1],d=visibledatarow[u],y=c-1==-1?0:visibledatarow[c-1],f=visibledatacolumn[h],m=i-1==-1?0:visibledatacolumn[i-1],luckysheet.formula.func_selectedrange={left:m,width:f-m-1,top:y,height:d-y-1,left_move:m,width_move:f-m-1,top_move:y,height_move:d-y-1,row:[c,u],column:[i,h],row_focus:c,column_focus:i},luckysheet.formula.rangeSetValue({row:[c,u],column:[i,h]}),luckysheet.formula.rangestart=!0,luckysheet.formula.rangedrag_column_start=!1,luckysheet.formula.rangedrag_row_start=!1,luckysheetMoveHighlightRange("down",-1,"rangeOfFormula"))),e.preventDefault()):$("#luckysheet-formula-functionrange-select").is(":visible")?(luckysheetMoveHighlightCell("down",-1,"rangeOfFormula"),e.preventDefault()):luckysheet.formula.israngeseleciton()?null!=(k=$(window.getSelection().anchorNode)).parent().next().text()&&""!=k.parent().next().text()||(n=$("#luckysheet-input-box #luckysheet-input-box-index").text(),null==(o=luckysheet.formula.getcellrange(n))&&(o=luckysheet.formula.getcellrange($("#luckysheet-input-box-index").text())),c=o.row[0],u=o.row[1],i=o.column[0],h=o.column[1],d=visibledatarow[u],y=c-1==-1?0:visibledatarow[c-1],f=visibledatacolumn[h],m=i-1==-1?0:visibledatacolumn[i-1],luckysheet.formula.func_selectedrange={left:m,width:f-m-1,top:y,height:d-y-1,left_move:m,width_move:f-m-1,top_move:y,height_move:d-y-1,row:[c,u],column:[i,h],row_focus:c,column_focus:i},luckysheet.formula.rangeSetValue({row:[c,u],column:[i,h]}),luckysheet.formula.rangestart=!0,luckysheet.formula.rangedrag_column_start=!1,luckysheet.formula.rangedrag_row_start=!1,luckysheetMoveHighlightCell("down",-1,"rangeOfFormula"),e.preventDefault()):(k=$(window.getSelection().anchorNode),p=window.getSelection().anchorOffset,(k.parent().is("span")&&0==k.parent().next().length&&0<p||k.is("#luckysheet-rich-text-editor")&&k.context.childElementCount==p||k.parent().is("#luckysheet-rich-text-editor")&&k.context.length==p)&&(luckysheet.formula.updatecell(luckysheetCellUpdate[0],luckysheetCellUpdate[1]),luckysheetMoveHighlightCell("down",-1,"rangeOfSelect"),e.preventDefault())):r==keycode.DOWN&&0<parseInt(a.css("top"))?$("#luckysheet-formula-search-c").is(":visible")?(0==(s=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active").next()).length&&(s=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").first()),$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").removeClass("luckysheet-formula-search-item-active"),s.addClass("luckysheet-formula-search-item-active"),e.preventDefault()):t&&l?($("#luckysheet-formula-functionrange-select").is(":visible")?luckysheetMoveHighlightRange2("down","rangeOfFormula"):luckysheet.formula.israngeseleciton()&&(null!=(k=$(window.getSelection().anchorNode)).parent().next().text()&&""!=k.parent().next().text()||(n=$("#luckysheet-input-box #luckysheet-input-box-index").text(),null==(o=luckysheet.formula.getcellrange(n))&&(o=luckysheet.formula.getcellrange($("#luckysheet-input-box-index").text())),c=o.row[0],u=o.row[1],i=o.column[0],h=o.column[1],d=visibledatarow[u],y=c-1==-1?0:visibledatarow[c-1],f=visibledatacolumn[h],m=i-1==-1?0:visibledatacolumn[i-1],luckysheet.formula.func_selectedrange={left:m,width:f-m-1,top:y,height:d-y-1,left_move:m,width_move:f-m-1,top_move:y,height_move:d-y-1,row:[c,u],column:[i,h],row_focus:c,column_focus:i},luckysheet.formula.rangeSetValue({row:[c,u],column:[i,h]}),luckysheet.formula.rangestart=!0,luckysheet.formula.rangedrag_column_start=!1,luckysheet.formula.rangedrag_row_start=!1,luckysheetMoveHighlightRange2("down","rangeOfFormula"))),e.preventDefault()):t?($("#luckysheet-formula-functionrange-select").is(":visible")?luckysheetMoveHighlightCell2("down","rangeOfFormula"):luckysheet.formula.israngeseleciton()&&(null!=(k=$(window.getSelection().anchorNode)).parent().next().text()&&""!=k.parent().next().text()||(n=$("#luckysheet-input-box #luckysheet-input-box-index").text(),null==(o=luckysheet.formula.getcellrange(n))&&(o=luckysheet.formula.getcellrange($("#luckysheet-input-box-index").text())),c=o.row[0],u=o.row[1],i=o.column[0],h=o.column[1],d=visibledatarow[u],y=c-1==-1?0:visibledatarow[c-1],f=visibledatacolumn[h],m=i-1==-1?0:visibledatacolumn[i-1],luckysheet.formula.func_selectedrange={left:m,width:f-m-1,top:y,height:d-y-1,left_move:m,width_move:f-m-1,top_move:y,height_move:d-y-1,row:[c,u],column:[i,h],row_focus:c,column_focus:i},luckysheet.formula.rangeSetValue({row:[c,u],column:[i,h]}),luckysheet.formula.rangestart=!0,luckysheet.formula.rangedrag_column_start=!1,luckysheet.formula.rangedrag_row_start=!1,luckysheetMoveHighlightCell2("down","rangeOfFormula"))),e.preventDefault()):l?($("#luckysheet-formula-functionrange-select").is(":visible")?luckysheetMoveHighlightRange("down",1,"rangeOfFormula"):luckysheet.formula.israngeseleciton()&&(null!=(k=$(window.getSelection().anchorNode)).parent().next().text()&&""!=k.parent().next().text()||(n=$("#luckysheet-input-box #luckysheet-input-box-index").text(),null==(o=luckysheet.formula.getcellrange(n))&&(o=luckysheet.formula.getcellrange($("#luckysheet-input-box-index").text())),c=o.row[0],u=o.row[1],i=o.column[0],h=o.column[1],d=visibledatarow[u],y=c-1==-1?0:visibledatarow[c-1],f=visibledatacolumn[h],m=i-1==-1?0:visibledatacolumn[i-1],luckysheet.formula.func_selectedrange={left:m,width:f-m-1,top:y,height:d-y-1,left_move:m,width_move:f-m-1,top_move:y,height_move:d-y-1,row:[c,u],column:[i,h],row_focus:c,column_focus:i},luckysheet.formula.rangeSetValue({row:[c,u],column:[i,h]}),luckysheet.formula.rangestart=!0,luckysheet.formula.rangedrag_column_start=!1,luckysheet.formula.rangedrag_row_start=!1,luckysheetMoveHighlightRange("down",1,"rangeOfFormula"))),e.preventDefault()):$("#luckysheet-formula-functionrange-select").is(":visible")?(luckysheetMoveHighlightCell("down",1,"rangeOfFormula"),e.preventDefault()):luckysheet.formula.israngeseleciton()?null!=(k=$(window.getSelection().anchorNode)).parent().next().text()&&""!=k.parent().next().text()||(n=$("#luckysheet-input-box #luckysheet-input-box-index").text(),null==(o=luckysheet.formula.getcellrange(n))&&(o=luckysheet.formula.getcellrange($("#luckysheet-input-box-index").text())),c=o.row[0],u=o.row[1],i=o.column[0],h=o.column[1],d=visibledatarow[u],y=c-1==-1?0:visibledatarow[c-1],f=visibledatacolumn[h],m=i-1==-1?0:visibledatacolumn[i-1],luckysheet.formula.func_selectedrange={left:m,width:f-m-1,top:y,height:d-y-1,left_move:m,width_move:f-m-1,top_move:y,height_move:d-y-1,row:[c,u],column:[i,h],row_focus:c,column_focus:i},luckysheet.formula.rangeSetValue({row:[c,u],column:[i,h]}),luckysheet.formula.rangestart=!0,luckysheet.formula.rangedrag_column_start=!1,luckysheet.formula.rangedrag_row_start=!1,luckysheetMoveHighlightCell("down",1,"rangeOfFormula"),e.preventDefault()):(k=$(window.getSelection().anchorNode),p=window.getSelection().anchorOffset,(k.parent().is("span")&&0==k.parent().next().length&&0<p||k.is("#luckysheet-rich-text-editor")&&k.context.childElementCount==p||k.parent().is("#luckysheet-rich-text-editor")&&k.context.length==p)&&(luckysheet.formula.updatecell(luckysheetCellUpdate[0],luckysheetCellUpdate[1]),luckysheetMoveHighlightCell("down",1,"rangeOfSelect"),e.preventDefault())):r==keycode.LEFT&&0<parseInt(a.css("top"))?$("#luckysheet-formula-search-c").is(":visible")?e.preventDefault():t&&l?($("#luckysheet-formula-functionrange-select").is(":visible")?luckysheetMoveHighlightRange2("left","rangeOfFormula"):luckysheet.formula.israngeseleciton()&&(null!=(k=$(window.getSelection().anchorNode)).parent().next().text()&&""!=k.parent().next().text()||(n=$("#luckysheet-input-box #luckysheet-input-box-index").text(),null==(o=luckysheet.formula.getcellrange(n))&&(o=luckysheet.formula.getcellrange($("#luckysheet-input-box-index").text())),c=o.row[0],u=o.row[1],i=o.column[0],h=o.column[1],d=visibledatarow[u],y=c-1==-1?0:visibledatarow[c-1],f=visibledatacolumn[h],m=i-1==-1?0:visibledatacolumn[i-1],luckysheet.formula.func_selectedrange={left:m,width:f-m-1,top:y,height:d-y-1,left_move:m,width_move:f-m-1,top_move:y,height_move:d-y-1,row:[c,u],column:[i,h],row_focus:c,column_focus:i},luckysheet.formula.rangeSetValue({row:[c,u],column:[i,h]}),luckysheet.formula.rangestart=!0,luckysheet.formula.rangedrag_column_start=!1,luckysheet.formula.rangedrag_row_start=!1,luckysheetMoveHighlightRange2("left","rangeOfFormula"))),e.preventDefault()):t?($("#luckysheet-formula-functionrange-select").is(":visible")?luckysheetMoveHighlightCell2("left","rangeOfFormula"):luckysheet.formula.israngeseleciton()&&(null!=(k=$(window.getSelection().anchorNode)).parent().next().text()&&""!=k.parent().next().text()||(n=$("#luckysheet-input-box #luckysheet-input-box-index").text(),null==(o=luckysheet.formula.getcellrange(n))&&(o=luckysheet.formula.getcellrange($("#luckysheet-input-box-index").text())),c=o.row[0],u=o.row[1],i=o.column[0],h=o.column[1],d=visibledatarow[u],y=c-1==-1?0:visibledatarow[c-1],f=visibledatacolumn[h],m=i-1==-1?0:visibledatacolumn[i-1],luckysheet.formula.func_selectedrange={left:m,width:f-m-1,top:y,height:d-y-1,left_move:m,width_move:f-m-1,top_move:y,height_move:d-y-1,row:[c,u],column:[i,h],row_focus:c,column_focus:i},luckysheet.formula.rangeSetValue({row:[c,u],column:[i,h]}),luckysheet.formula.rangestart=!0,luckysheet.formula.rangedrag_column_start=!1,luckysheet.formula.rangedrag_row_start=!1,luckysheetMoveHighlightCell2("left","rangeOfFormula"))),e.preventDefault()):l?$("#luckysheet-formula-functionrange-select").is(":visible")?(luckysheetMoveHighlightRange("right",-1,"rangeOfFormula"),e.preventDefault()):luckysheet.formula.israngeseleciton()&&(null!=(k=$(window.getSelection().anchorNode)).parent().next().text()&&""!=k.parent().next().text()||(n=$("#luckysheet-input-box #luckysheet-input-box-index").text(),null==(o=luckysheet.formula.getcellrange(n))&&(o=luckysheet.formula.getcellrange($("#luckysheet-input-box-index").text())),c=o.row[0],u=o.row[1],i=o.column[0],h=o.column[1],d=visibledatarow[u],y=c-1==-1?0:visibledatarow[c-1],f=visibledatacolumn[h],m=i-1==-1?0:visibledatacolumn[i-1],luckysheet.formula.func_selectedrange={left:m,width:f-m-1,top:y,height:d-y-1,left_move:m,width_move:f-m-1,top_move:y,height_move:d-y-1,row:[c,u],column:[i,h],row_focus:c,column_focus:i},luckysheet.formula.rangeSetValue({row:[c,u],column:[i,h]}),luckysheet.formula.rangestart=!0,luckysheet.formula.rangedrag_column_start=!1,luckysheet.formula.rangedrag_row_start=!1,luckysheetMoveHighlightRange("right",-1,"rangeOfFormula"),e.preventDefault())):$("#luckysheet-formula-functionrange-select").is(":visible")?(luckysheetMoveHighlightCell("right",-1,"rangeOfFormula"),e.preventDefault()):luckysheet.formula.israngeseleciton()?null!=(k=$(window.getSelection().anchorNode)).parent().next().text()&&""!=k.parent().next().text()||(n=$("#luckysheet-input-box #luckysheet-input-box-index").text(),null==(o=luckysheet.formula.getcellrange(n))&&(o=luckysheet.formula.getcellrange($("#luckysheet-input-box-index").text())),c=o.row[0],u=o.row[1],i=o.column[0],h=o.column[1],d=visibledatarow[u],y=c-1==-1?0:visibledatarow[c-1],f=visibledatacolumn[h],m=i-1==-1?0:visibledatacolumn[i-1],luckysheet.formula.func_selectedrange={left:m,width:f-m-1,top:y,height:d-y-1,left_move:m,width_move:f-m-1,top_move:y,height_move:d-y-1,row:[c,u],column:[i,h],row_focus:c,column_focus:i},luckysheet.formula.rangeSetValue({row:[c,u],column:[i,h]}),luckysheet.formula.rangestart=!0,luckysheet.formula.rangedrag_column_start=!1,luckysheet.formula.rangedrag_row_start=!1,luckysheetMoveHighlightCell("right",-1,"rangeOfFormula"),e.preventDefault()):(k=$(window.getSelection().anchorNode),p=window.getSelection().anchorOffset,(k.parent().is("span")&&0==k.parent().prev().length&&0==p||k.is("#luckysheet-rich-text-editor")&&1==p||k.parent().is("#luckysheet-rich-text-editor")&&0==p)&&(luckysheet.formula.updatecell(luckysheetCellUpdate[0],luckysheetCellUpdate[1]),luckysheetMoveHighlightCell("right",-1,"rangeOfSelect"),e.preventDefault())):r==keycode.RIGHT&&0<parseInt(a.css("top"))?$("#luckysheet-formula-search-c").is(":visible")?e.preventDefault():t&&l?($("#luckysheet-formula-functionrange-select").is(":visible")?luckysheetMoveHighlightRange2("right","rangeOfFormula"):luckysheet.formula.israngeseleciton()&&(null!=(k=$(window.getSelection().anchorNode)).parent().next().text()&&""!=k.parent().next().text()||(n=$("#luckysheet-input-box #luckysheet-input-box-index").text(),null==(o=luckysheet.formula.getcellrange(n))&&(o=luckysheet.formula.getcellrange($("#luckysheet-input-box-index").text())),c=o.row[0],u=o.row[1],i=o.column[0],h=o.column[1],d=visibledatarow[u],y=c-1==-1?0:visibledatarow[c-1],f=visibledatacolumn[h],m=i-1==-1?0:visibledatacolumn[i-1],luckysheet.formula.func_selectedrange={left:m,width:f-m-1,top:y,height:d-y-1,left_move:m,width_move:f-m-1,top_move:y,height_move:d-y-1,row:[c,u],column:[i,h],row_focus:c,column_focus:i},luckysheet.formula.rangeSetValue({row:[c,u],column:[i,h]}),luckysheet.formula.rangestart=!0,luckysheet.formula.rangedrag_column_start=!1,luckysheet.formula.rangedrag_row_start=!1,luckysheetMoveHighlightRange2("right","rangeOfFormula"))),e.preventDefault()):t?($("#luckysheet-formula-functionrange-select").is(":visible")?luckysheetMoveHighlightCell2("right","rangeOfFormula"):luckysheet.formula.israngeseleciton()&&(null!=(k=$(window.getSelection().anchorNode)).parent().next().text()&&""!=k.parent().next().text()||(n=$("#luckysheet-input-box #luckysheet-input-box-index").text(),null==(o=luckysheet.formula.getcellrange(n))&&(o=luckysheet.formula.getcellrange($("#luckysheet-input-box-index").text())),c=o.row[0],u=o.row[1],i=o.column[0],h=o.column[1],d=visibledatarow[u],y=c-1==-1?0:visibledatarow[c-1],f=visibledatacolumn[h],m=i-1==-1?0:visibledatacolumn[i-1],luckysheet.formula.func_selectedrange={left:m,width:f-m-1,top:y,height:d-y-1,left_move:m,width_move:f-m-1,top_move:y,height_move:d-y-1,row:[c,u],column:[i,h],row_focus:c,column_focus:i},luckysheet.formula.rangeSetValue({row:[c,u],column:[i,h]}),luckysheet.formula.rangestart=!0,luckysheet.formula.rangedrag_column_start=!1,luckysheet.formula.rangedrag_row_start=!1,luckysheetMoveHighlightCell2("right","rangeOfFormula"))),e.preventDefault()):l?$("#luckysheet-formula-functionrange-select").is(":visible")?(luckysheetMoveHighlightRange("right",1,"rangeOfFormula"),e.preventDefault()):luckysheet.formula.israngeseleciton()&&(null!=(k=$(window.getSelection().anchorNode)).parent().next().text()&&""!=k.parent().next().text()||(n=$("#luckysheet-input-box #luckysheet-input-box-index").text(),null==(o=luckysheet.formula.getcellrange(n))&&(o=luckysheet.formula.getcellrange($("#luckysheet-input-box-index").text())),c=o.row[0],u=o.row[1],i=o.column[0],h=o.column[1],d=visibledatarow[u],y=c-1==-1?0:visibledatarow[c-1],f=visibledatacolumn[h],m=i-1==-1?0:visibledatacolumn[i-1],luckysheet.formula.func_selectedrange={left:m,width:f-m-1,top:y,height:d-y-1,left_move:m,width_move:f-m-1,top_move:y,height_move:d-y-1,row:[c,u],column:[i,h],row_focus:c,column_focus:i},luckysheet.formula.rangeSetValue({row:[c,u],column:[i,h]}),luckysheet.formula.rangestart=!0,luckysheet.formula.rangedrag_column_start=!1,luckysheet.formula.rangedrag_row_start=!1,luckysheetMoveHighlightRange("right",1,"rangeOfFormula"),e.preventDefault())):$("#luckysheet-formula-functionrange-select").is(":visible")?(luckysheetMoveHighlightCell("right",1,"rangeOfFormula"),e.preventDefault()):luckysheet.formula.israngeseleciton()?null!=(k=$(window.getSelection().anchorNode)).parent().next().text()&&""!=k.parent().next().text()||(n=$("#luckysheet-input-box #luckysheet-input-box-index").text(),null==(o=luckysheet.formula.getcellrange(n))&&(o=luckysheet.formula.getcellrange($("#luckysheet-input-box-index").text())),c=o.row[0],u=o.row[1],i=o.column[0],h=o.column[1],d=visibledatarow[u],y=c-1==-1?0:visibledatarow[c-1],f=visibledatacolumn[h],m=i-1==-1?0:visibledatacolumn[i-1],luckysheet.formula.func_selectedrange={left:m,width:f-m-1,top:y,height:d-y-1,left_move:m,width_move:f-m-1,top_move:y,height_move:d-y-1,row:[c,u],column:[i,h],row_focus:c,column_focus:i},luckysheet.formula.rangeSetValue({row:[c,u],column:[i,h]}),luckysheet.formula.rangestart=!0,luckysheet.formula.rangedrag_column_start=!1,luckysheet.formula.rangedrag_row_start=!1,luckysheetMoveHighlightCell("right",1,"rangeOfFormula"),e.preventDefault()):(k=$(window.getSelection().anchorNode),p=window.getSelection().anchorOffset,(k.parent().is("span")&&0==k.parent().next().length&&0<p||k.is("#luckysheet-rich-text-editor")&&k.context.childElementCount==p||k.parent().is("#luckysheet-rich-text-editor")&&k.context.length==p)&&(luckysheet.formula.updatecell(luckysheetCellUpdate[0],luckysheetCellUpdate[1]),luckysheetMoveHighlightCell("right",1,"rangeOfSelect"),e.preventDefault())):(!(112<=r&&r<=123||r<=46||144==r||108==r||e.ctrlKey||e.altKey||e.shiftKey&&(37==r||38==r||39==r||40==r))||8==r||32==r||46==r||e.ctrlKey&&86==r)&&luckysheet.formula.functionInputHanddler($("#luckysheet-functionbox-cell"),$("#luckysheet-rich-text-editor"),r))}).keyup(function(e){var t=e.keyCode;e.shiftKey||16!=t||(luckysheet_shiftkeydown=!1,luckysheet.luckysheet_shiftpositon=null),0<parseInt($("#luckysheet-input-box").css("top"))&&(13==t||16==t||32==t)&&luckysheet.formula.functionInputHanddler($("#luckysheet-functionbox-cell"),$("#luckysheet-rich-text-editor"),t),e.preventDefault()});var jfcountfunc=function(){if(0!=luckysheet_select_save.length){for(var e=1/0,t=-1/0,l=0,r=0,a=0;a<luckysheet_select_save.length;a++)for(var s=luckysheet.getdatabyselectionNoCopy(luckysheet_select_save[a]),n=0;n<s.length;n++)for(var o,c=0;c<s[0].length;c++){luckysheet.func_methods.isRealNull(s[n][c])||(r++,null!=s[n][c].ct&&"d"==s[n][c].ct.t||(o=s[n][c].v,luckysheet.func_methods.isRealNum(o)&&(l+=o=parseFloat(o),o<e&&(e=o),t<o&&(t=o))))}var u="";u+="<span>计数:"+r+"</span>",(isFinite(t)||isFinite(e))&&(u+="<span>求和:"+luckysheet.mask.update("w",l)+"</span>",u+="<span>平均值:"+luckysheet.mask.update("w",Math.round(l/r*1e4)/1e4)+"</span>"),isFinite(t)&&(u+="<span>最大值:"+luckysheet.mask.update("w",t)+"</span>"),isFinite(e)&&(u+="<span>最小值:"+luckysheet.mask.update("w",e)+"</span>"),$("#luckysheet-sta-content").html(u)}};luckysheet.jfcountfunc=jfcountfunc,$(document).mousemove(function(L){if(luckysheet.postil.overshow(L),clearInterval(jfautoscrollTimeout),luckysheet.formula.functionResizeStatus){var e=(o=L.pageY)-luckysheet.formula.functionResizeData.y,t=luckysheet.formula.functionResizeData.calculatebarHeight+e,l=Math.round($(window).height()/2);if(t<=28){if(t<=20)return;t=28}else if(l<=t){if(l+8<=t)return;t=l}calculatebarHeight=t,$("#luckysheet-wa-calculate").css("height",calculatebarHeight-2),$("#luckysheet-wa-calculate-size").css({background:"#5e5e5e",cursor:"ns-resize"}),clearTimeout(luckysheet.formula.functionResizeTimeout),luckysheet.formula.functionResizeTimeout=setTimeout(function(){luckysheet.luckysheetsizeauto()},15)}else if(luckysheet.freezen.horizontalmovestate){var r=mouseposition(L.pageX,L.pageY),a=$("#luckysheet-cell-main").scrollLeft(),s=$("#luckysheet-cell-main").scrollTop(),n=r[0]+a,o=r[1]+s,c=luckysheet.rowLocation(o),u=c[1],i=c[0],h=c[2];(v=r[1]+columeHeaderHeight)<columeHeaderHeight&&(v=columeHeaderHeight),v>luckysheet.freezen.windowHeight-4&&(v=luckysheet.freezen.windowHeight-4),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css({top:v}),i+(u-i)/2<=v+s-columeHeaderHeight?(v=u-2-s+columeHeaderHeight,luckysheet.freezen.freezenhorizontaldata=[u,h+1,s,luckysheet.freezen.cutVolumn(visibledatarow,h+1),v]):(v=i-2-s+columeHeaderHeight,luckysheet.freezen.freezenhorizontaldata=[i,h,s,luckysheet.freezen.cutVolumn(visibledatarow,h),v]),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-drop").css({top:v}),luckysheet.freezen.saveFreezen(luckysheet.freezen.freezenhorizontaldata,v,null,null)}else if(luckysheet.freezen.verticalmovestate){var r=mouseposition(L.pageX,L.pageY),a=$("#luckysheet-cell-main").scrollLeft(),s=$("#luckysheet-cell-main").scrollTop(),n=r[0]+a,o=r[1]+s,d=luckysheet.colLocation(n),y=d[1],f=d[0],m=d[2];(_=r[0]+rowHeaderWidth)<rowHeaderWidth&&(_=rowHeaderWidth),_>luckysheet.freezen.windowWidth-4&&(_=luckysheet.freezen.windowWidth-4),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css({left:_}),f+(y-f)/2<=_+a-rowHeaderWidth?(_=y-2-a+rowHeaderWidth,luckysheet.freezen.freezenverticaldata=[y,m+1,a,luckysheet.freezen.cutVolumn(visibledatacolumn,m+1),_]):(_=f-2-a+rowHeaderWidth,luckysheet.freezen.freezenverticaldata=[f,m,a,luckysheet.freezen.cutVolumn(visibledatacolumn,m),_]),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-drop").css({left:_}),luckysheet.freezen.saveFreezen(null,null,luckysheet.freezen.freezenverticaldata,_),luckysheet.luckysheetsizeauto()}else if(luckysheet.pivotTable&&luckysheet.pivotTable.movestate){n=L.pageX,o=L.pageY;$("#luckysheet-modal-dialog-slider-pivot-move").css({left:n-luckysheet.pivotTable.movesave.width/2,top:o-luckysheet.pivotTable.movesave.height})}else if(luckysheet.chartparam.luckysheet_chart_point_config&&luckysheet.chartparam.luckysheet_chart_point_config.movestart){for(var n=L.pageX,o=L.pageY,k=luckysheet.chartparam.luckysheet_chart_point_config.container,p=n-k.offset().left+k.scrollLeft(),g=o-k.offset().top+k.scrollTop(),v=0,b=0,b=luckysheet.chartparam.luckysheet_chart_point_config.top>g||luckysheet.chartparam.luckysheet_chart_point_config.top==g?(v=g,luckysheet.chartparam.luckysheet_chart_point_config.top-g):(v=luckysheet.chartparam.luckysheet_chart_point_config.top,g-luckysheet.chartparam.luckysheet_chart_point_config.top-1),_=0,w=0,w=luckysheet.chartparam.luckysheet_chart_point_config.left>p||luckysheet.chartparam.luckysheet_chart_point_config.left==p?(_=p,luckysheet.chartparam.luckysheet_chart_point_config.left-p):(_=luckysheet.chartparam.luckysheet_chart_point_config.left,p-luckysheet.chartparam.luckysheet_chart_point_config.left-1),x=0;x<luckysheet.chartparam.luckysheet_chart_point_config.objectIndicator.length;x++){var C=luckysheet.chartparam.luckysheet_chart_point_config.objectIndicator[x];C.left+C.width+k.scrollLeft()<=_||C.top+C.height+k.scrollTop()<=v||C.left+k.scrollLeft()>=_+w||C.top+k.scrollTop()>=v+b?C.isselected||C.item.removeClass("luckysheet-chart-point-searchitem-active"):C.isselected?C.item.removeClass("luckysheet-chart-point-searchitem-active"):C.item.addClass("luckysheet-chart-point-searchitem-active")}$("#luckysheet-chart-point-selectedhelp").css({left:_,width:w,top:v,height:b})}else if(luckysheet_sheet_move_status){a=$("#luckysheet-sheet-container-c").scrollLeft(),n=L.pageX+a;if(Math.abs(L.pageX-luckysheet_sheet_move_data.pageX)<3)return;var T=$("#luckysheet-sheet-container").width(),_=n-luckysheet_sheet_move_data.curleft-$("#luckysheet-sheet-container").offset().left;luckysheet_sheet_move_data.activeobject.css({left:_});h=luckysheet_searcharray(luckysheet_sheet_move_data.widthlist,_+luckysheet_sheet_move_data.curleft);luckysheet_sheet_move_data.cursorobject.css({cursor:"move"}),_-a<=6&&$("#luckysheet-sheets-leftscroll").click(),T-40<=_-a&&$("#luckysheet-sheets-rightscroll").click(),h!=luckysheet_sheet_move_data.curindex&&(-1==h&&0<_?(h=luckysheet_sheet_move_data.widthlist.length-1,$("#luckysheet-sheets-item-clone").insertAfter($("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").eq(h))):-1==h&&_<=0?$("#luckysheet-sheets-item-clone").insertBefore($("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").eq(0)):$("#luckysheet-sheets-item-clone").insertAfter($("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").eq(h)),luckysheet_sheet_move_data.widthlist=[],$("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").each(function(e){0==e?luckysheet_sheet_move_data.widthlist.push(parseInt($(this).outerWidth())):luckysheet_sheet_move_data.widthlist.push(parseInt($(this).outerWidth())+luckysheet_sheet_move_data.widthlist[e-1])}),luckysheet_sheet_move_data.curindex=$("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").index($("#luckysheet-sheets-item-clone")))}else{var I,R,S;luckysheet_model_move_state?(s=$(document).scrollTop(),a=$(document).scrollLeft(),o=L.pageY+s,n=L.pageX+a,I=$(window).height(),T=$(window).width(),R=luckysheet_model_move_obj.height(),S=luckysheet_model_move_obj.width(),(v=o-luckysheet_model_xy[1])<0&&(v=0),I<v+R+62&&(v=I-R-62),(_=n-luckysheet_model_xy[0])<0&&(_=0),T<_+S+86&&(_=T-S-86),luckysheet_model_move_obj.css({top:v,left:_}),L.preventDefault()):(luckysheet_scroll_status||luckysheet_select_status||luckysheet_rows_selected_status||luckysheet_cols_selected_status||luckysheet_cell_selected_move||luckysheet_cell_selected_move||luckysheet_cell_selected_extend||luckysheet_cols_change_size||luckysheet_rows_change_size||luckysheet.chartparam.luckysheetCurrentChartMove||luckysheet.chartparam.luckysheetCurrentChartResize||luckysheet.formula.rangeResize||luckysheet.formula.rangeMove)&&(luckysheet_select_status&&(clearTimeout(jfcountfuncTimeout),jfcountfuncTimeout=setTimeout(function(){jfcountfunc()},500)),jfautoscrollTimeout=setInterval(function(){var e,t;if(!luckysheet_scroll_status||luckysheet_cols_change_size||luckysheet_rows_change_size||(v=mouseposition(L.pageX,L.pageY),y=$("#luckysheet-scrollbar-x").scrollLeft(),i=$("#luckysheet-scrollbar-y").scrollTop(),l=v[0],r=v[1],w=$("#luckysheet-cell-main").height()-20,x=$("#luckysheet-cell-main").width()-60,(r<0||w<r)&&(e=r<0?i+r/2:i+(r-w)/2,$("#luckysheet-scrollbar-y").scrollTop(e)),(l<0||x<l)&&(t=l<0?y+l/2:y+(l-x)/2,$("#luckysheet-scrollbar-x").scrollLeft(t))),luckysheet_select_status){var l=(v=mouseposition(L.pageX,L.pageY))[0]+$("#luckysheet-cell-main").scrollLeft(),r=v[1]+$("#luckysheet-cell-main").scrollTop(),a=(N=luckysheet.rowLocation(r))[1],s=N[0],n=N[2],o=(F=luckysheet.colLocation(l))[1],c=F[0],u=F[2],i=0,h=0,d=[];d=(g=$.extend(!0,{},luckysheet_select_save[luckysheet_select_save.length-1])).top>s?(i=s,h=g.top+g.height-s,g.row[1]>g.row_focus&&(g.row[1]=g.row_focus),[n,g.row[1]]):g.top==s?(i=s,h=g.top+g.height-s,[n,g.row[0]]):(i=g.top,h=a-g.top-1,g.row[0]<g.row_focus&&(g.row[0]=g.row_focus),[g.row[0],n]);var y=0,f=0,m=[];m=g.left>c?(y=c,f=g.left+g.width-c,g.column[1]>g.column_focus&&(g.column[1]=g.column_focus),[u,g.column[1]]):g.left==c?(y=c,f=g.left+g.width-c,[u,g.column[0]]):(y=g.left,f=o-g.left-1,g.column[0]<g.column_focus&&(g.column[0]=g.column_focus),[g.column[0],u]),null!=(k=luckysheet.menuButton.mergeMoveMain(m,d,g,i,h,y,f))&&(m=k[0],d=k[1],i=k[2],h=k[3],y=k[4],f=k[5]),g.row=d,g.column=m,g.left_move=y,g.width_move=f,g.top_move=i,g.height_move=h,luckysheet_select_save[luckysheet_select_save.length-1]=g,luckysheet.selectHightlightShow(),luckysheet.freezen.scrollFreezen(),$("#luckysheet-helpbox-cell").text(luckysheet.sheetmanage.getRangetxt(luckysheet.currentSheetIndex,luckysheet_select_save[luckysheet_select_save.length-1])),$("#luckysheet-alternateformat-rangeDialog").is(":visible")&&$("#luckysheet-alternateformat-rangeDialog input").val(luckysheet.sheetmanage.getRangetxt(luckysheet.currentSheetIndex,luckysheet_select_save[luckysheet_select_save.length-1])),luckysheet.chartparam.luckysheet_chart_data_select_state&&$("#luckysheet-datavisual-range-selection-input").val(luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].name+"!"+luckysheet.luckysheetchatatABC(luckysheet_select_save[0].column[0])+(luckysheet_select_save[0].row[0]+1)+":"+luckysheet.luckysheetchatatABC(luckysheet_select_save[0].column[1])+(luckysheet_select_save[0].row[1]+1)),luckysheet.pivotTable.luckysheet_pivotTable_select_state&&$("#luckysheet-pivotTable-range-selection-input").val(luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].name+"!"+luckysheet.luckysheetchatatABC(luckysheet_select_save[0].column[0])+(luckysheet_select_save[0].row[0]+1)+":"+luckysheet.luckysheetchatatABC(luckysheet_select_save[0].column[1])+(luckysheet_select_save[0].row[1]+1))}else if(luckysheet.conditionformat.selectStatus){var l=(v=mouseposition(L.pageX,L.pageY))[0]+$("#luckysheet-cell-main").scrollLeft(),r=v[1]+$("#luckysheet-cell-main").scrollTop(),a=(N=luckysheet.rowLocation(r))[1],s=N[0],n=N[2],o=(F=luckysheet.colLocation(l))[1],c=F[0],u=F[2],i=0,h=0,d=[];d=(g=luckysheet.conditionformat.selectRange[luckysheet.conditionformat.selectRange.length-1]).top>s?(i=s,h=g.top+g.height-s,g.row[1]>g.row_focus&&(g.row[1]=g.row_focus),[n,g.row[1]]):g.top==s?(i=s,h=g.top+g.height-s,[n,g.row[0]]):(i=g.top,h=a-g.top-1,g.row[0]<g.row_focus&&(g.row[0]=g.row_focus),[g.row[0],n]);var k,y=0,f=0,m=[];m=g.left>c?(y=c,f=g.left+g.width-c,g.column[1]>g.column_focus&&(g.column[1]=g.column_focus),[u,g.column[1]]):g.left==c?(y=c,f=g.left+g.width-c,[u,g.column[0]]):(y=g.left,f=o-g.left-1,g.column[0]<g.column_focus&&(g.column[0]=g.column_focus),[g.column[0],u]),null!=(k=luckysheet.menuButton.mergeMoveMain(m,d,g,i,h,y,f))&&(m=k[0],d=k[1],i=k[2],h=k[3],y=k[4],f=k[5]),g.row=d,g.column=m,g.left_move=y,g.width_move=f,g.top_move=i,g.height_move=h,luckysheet.conditionformat.selectRange[luckysheet.conditionformat.selectRange.length-1]=g,luckysheet.selectionCopyShow(luckysheet.conditionformat.selectRange);var p=luckysheet.conditionformat.getTxtByRange(luckysheet.conditionformat.selectRange);$("#luckysheet-multiRange-dialog input").val(p)}else if(luckysheet.formula.rangestart)luckysheet.formula.rangedrag(L);else if(luckysheet.formula.rangedrag_row_start)luckysheet.formula.rangedrag_row(L);else if(luckysheet.formula.rangedrag_column_start)luckysheet.formula.rangedrag_column(L);else if(luckysheet_rows_selected_status){if((r=(v=mouseposition(L.pageX,L.pageY))[1]+$("#luckysheet-rows-h").scrollTop())<0)return!1;a=(N=luckysheet.rowLocation(r))[1],s=N[0],n=N[2],u=visibledatacolumn.length-1,o=visibledatacolumn[u],c=0,i=0,h=0,d=[];d=(g=$.extend(!0,{},luckysheet_select_save[luckysheet_select_save.length-1])).top>s?(i=s,h=g.top+g.height-s,g.row[1]>g.row_focus&&(g.row[1]=g.row_focus),[n,g.row[1]]):g.top==s?(i=s,h=g.top+g.height-s,[n,g.row[0]]):(i=g.top,h=a-g.top-1,g.row[0]<g.row_focus&&(g.row[0]=g.row_focus),[g.row[0],n]),g.row=d,g.top_move=i,g.height_move=h,luckysheet_select_save[luckysheet_select_save.length-1]=g,luckysheet.selectHightlightShow(),clearTimeout(jfcountfuncTimeout),jfcountfuncTimeout=setTimeout(function(){jfcountfunc()},500)}else if(luckysheet_cols_selected_status){if((l=(v=mouseposition(L.pageX,L.pageY))[0]+$("#luckysheet-cols-h-c").scrollLeft())<0)return!1;var g,n=visibledatarow.length-1,a=visibledatarow[n],s=0,o=(F=luckysheet.colLocation(l))[1],c=F[0],u=F[2],y=0,f=0,m=[];m=(g=$.extend(!0,{},luckysheet_select_save[luckysheet_select_save.length-1])).left>c?(y=c,f=g.left+g.width-c,g.column[1]>g.column_focus&&(g.column[1]=g.column_focus),[u,g.column[1]]):g.left==c?(y=c,f=g.left+g.width-c,[u,g.column[0]]):(y=g.left,f=o-g.left-1,g.column[0]<g.column_focus&&(g.column[0]=g.column_focus),[g.column[0],u]),g.column=m,g.left_move=y,g.width_move=f,luckysheet_select_save[luckysheet_select_save.length-1]=g,luckysheet.selectHightlightShow(),clearTimeout(jfcountfuncTimeout),jfcountfuncTimeout=setTimeout(function(){jfcountfunc()},500)}else if(luckysheet_cell_selected_move){var v=mouseposition(L.pageX,L.pageY),b=$("#luckysheet-cell-main").scrollLeft(),_=$("#luckysheet-cell-main").scrollTop(),l=v[0]+b,r=v[1]+_,w=$(window).height()+_-sheetBarHeight-statisticBarHeight,x=$(window).width()+b,a=(N=luckysheet.rowLocation(r))[1],s=N[0],n=N[2],o=(F=luckysheet.colLocation(l))[1],c=F[0],u=F[2],C=luckysheet_cell_selected_move_index[0],T=luckysheet_cell_selected_move_index[1],I=luckysheet_select_save[0].row[0]-C+n,R=luckysheet_select_save[0].row[1]-C+n,S=luckysheet_select_save[0].column[0]-T+u,A=luckysheet_select_save[0].column[1]-T+u;(I<0||r<0)&&(R=luckysheet_select_save[I=0].row[1]-luckysheet_select_save[0].row[0]),(S<0||l<0)&&(A=luckysheet_select_save[S=0].column[1]-luckysheet_select_save[0].column[0]),(R>=visibledatarow[visibledatarow.length-1]||w<r)&&(I=visibledatarow.length-1-luckysheet_select_save[0].row[1]+luckysheet_select_save[0].row[0],R=visibledatarow.length-1),(A>=visibledatacolumn[visibledatacolumn.length-1]||x<l)&&(S=visibledatacolumn.length-1-luckysheet_select_save[0].column[1]+luckysheet_select_save[0].column[0],A=visibledatacolumn.length-1);c=S-1==-1?0:visibledatacolumn[S-1],o=visibledatacolumn[A],s=I-1==-1?0:visibledatarow[I-1],a=visibledatarow[R];$("#luckysheet-cell-selected-move").css({left:c,width:o-c-2,top:s,height:a-s-2,display:"block"})}else if(luckysheet_cell_selected_extend){v=mouseposition(L.pageX,L.pageY),b=$("#luckysheet-cell-main").scrollLeft()-5,_=$("#luckysheet-cell-main").scrollTop()-5,l=v[0]+b,r=v[1]+_,w=$(window).height()+_-sheetBarHeight-statisticBarHeight,x=$(window).width()+b,a=(N=luckysheet.rowLocation(r))[1],s=N[0],n=N[2],o=(F=luckysheet.colLocation(l))[1],c=F[0],u=F[2],C=luckysheet_cell_selected_extend_index[0],T=luckysheet_cell_selected_extend_index[1],I=luckysheet_select_save[0].row[0],R=luckysheet_select_save[0].row[1],S=luckysheet_select_save[0].column[0],A=luckysheet_select_save[0].column[1];(I<0||r<0)&&(R=luckysheet_select_save[I=0].row[1]-luckysheet_select_save[0].row[0]),(S<0||l<0)&&(A=luckysheet_select_save[S=0].column[1]-luckysheet_select_save[0].column[0]),(R>=visibledatarow[visibledatarow.length-1]||w<r)&&(I=visibledatarow.length-1-luckysheet_select_save[0].row[1]+luckysheet_select_save[0].row[0],R=visibledatarow.length-1),(A>=visibledatacolumn[visibledatacolumn.length-1]||x<l)&&(S=visibledatacolumn.length-1-luckysheet_select_save[0].column[1]+luckysheet_select_save[0].column[0],A=visibledatacolumn.length-1);i=luckysheet_select_save[0].top_move,h=luckysheet_select_save[0].height_move,y=luckysheet_select_save[0].left_move,f=luckysheet_select_save[0].width_move;Math.abs(C-n)>Math.abs(T-u)?I<=n&&n<=R||(h=luckysheet_select_save[0].top_move>=s?(i=s,luckysheet_select_save[0].top_move+luckysheet_select_save[0].height_move-s):(i=luckysheet_select_save[0].top_move,a-luckysheet_select_save[0].top_move-1)):S<=u&&u<=A||(f=luckysheet_select_save[0].left_move>=c?(y=c,luckysheet_select_save[0].left_move+luckysheet_select_save[0].width_move-c):(y=luckysheet_select_save[0].left_move,o-luckysheet_select_save[0].left_move-1)),$("#luckysheet-cell-selected-extend").css({left:y,width:f,top:i,height:h,display:"block"})}else if(luckysheet_cols_change_size){var F,v=mouseposition(L.pageX,L.pageY),b=$("#luckysheet-cols-h-c").scrollLeft(),l=v[0]+b,x=$(window).width(),n=visibledatarow.length-1,a=visibledatarow[n],s=0,o=(F=luckysheet.colLocation(l))[1],c=F[0],u=F[2];luckysheetConfigsetting.pointEdit?30<(l+3)/luckysheetConfigsetting.pointEditZoom-luckysheet_cols_change_size_start[0]&&l/luckysheetConfigsetting.pointEditZoom<x+b-100&&($("#luckysheet-change-size-line").css({left:l/luckysheetConfigsetting.pointEditZoom}),$("#luckysheet-cols-change-size").css({left:(l-2)/luckysheetConfigsetting.pointEditZoom})):30<l+3-luckysheet_cols_change_size_start[0]&&l<x+b-100&&($("#luckysheet-change-size-line").css({left:l}),$("#luckysheet-cols-change-size").css({left:l-2}))}else if(luckysheet_rows_change_size){var N,v=mouseposition(L.pageX,L.pageY),_=$("#luckysheet-rows-h").scrollTop(),r=v[1]+_,w=$(window).height(),a=(N=luckysheet.rowLocation(r))[1],s=N[0],n=N[2];luckysheetConfigsetting.pointEdit?19<(r+3)/luckysheetConfigsetting.pointEditZoom-luckysheet_rows_change_size_start[0]&&r/luckysheetConfigsetting.pointEditZoom<w+_-200&&($("#luckysheet-change-size-line").css({top:r/luckysheetConfigsetting.pointEditZoom}),$("#luckysheet-rows-change-size").css({top:r/luckysheetConfigsetting.pointEditZoom})):19<r+3-luckysheet_rows_change_size_start[0]&&r<w+_-200&&($("#luckysheet-change-size-line").css({top:r}),$("#luckysheet-rows-change-size").css({top:r}))}else if(luckysheet.chartparam.luckysheetCurrentChartMove){var M,E,l=(v=mouseposition(L.pageX,L.pageY))[0]+$("#luckysheet-cell-main").scrollLeft(),r=v[1]+$("#luckysheet-cell-main").scrollTop(),O=luckysheet.chartparam.luckysheetCurrentChartMoveObj.height(),j=luckysheet.chartparam.luckysheetCurrentChartMoveObj.width(),i=r-luckysheet.chartparam.luckysheetCurrentChartMoveXy[1],y=l-luckysheet.chartparam.luckysheetCurrentChartMoveXy[0];i<0&&(i=0),i+O+42+6>luckysheet.chartparam.luckysheetCurrentChartMoveWinH&&(i=luckysheet.chartparam.luckysheetCurrentChartMoveWinH-O-42-6),y<0&&(y=0),y+j+22+36>luckysheet.chartparam.luckysheetCurrentChartMoveWinW&&(y=luckysheet.chartparam.luckysheetCurrentChartMoveWinW-j-22-36),luckysheet.chartparam.luckysheetCurrentChartMoveObj.css({top:i,left:y}),null==luckysheet.freezen.freezenhorizontaldata&&null==luckysheet.freezen.freezenverticaldata||(luckysheet.freezen.scrollAdapt(),M=luckysheet.chartparam.luckysheetCurrentChartMoveObj.offset(),E=luckysheet.chartparam.luckysheetCurrentChartMoveObj.position(),luckysheet.chartparam.luckysheetCurrentChartMoveXy=[L.pageX-M.left,L.pageY-M.top,E.left,E.top,$("#luckysheet-scrollbar-x").scrollLeft(),$("#luckysheet-scrollbar-y").scrollTop()])}else if(luckysheet.chartparam.luckysheetCurrentChartResize){_=$("#luckysheet-cell-main").scrollTop(),b=$("#luckysheet-cell-main").scrollLeft(),l=(v=mouseposition(L.pageX,L.pageY))[0]+b,r=v[1]+_;if(l<0||r<0)return!1;var O=luckysheet.chartparam.luckysheetCurrentChartResizeObj.height(),j=luckysheet.chartparam.luckysheetCurrentChartResizeObj.width(),z=r-luckysheet.chartparam.luckysheetCurrentChartResizeXy[1],D=l-luckysheet.chartparam.luckysheetCurrentChartResizeXy[0],i=luckysheet.chartparam.luckysheetCurrentChartResizeXy[5],h=luckysheet.chartparam.luckysheetCurrentChartResizeXy[3],y=luckysheet.chartparam.luckysheetCurrentChartResizeXy[4],f=luckysheet.chartparam.luckysheetCurrentChartResizeXy[2];"lm"!=luckysheet.chartparam.luckysheetCurrentChartResize&&"lt"!=luckysheet.chartparam.luckysheetCurrentChartResize&&"lb"!=luckysheet.chartparam.luckysheetCurrentChartResize||(y=l,f=luckysheet.chartparam.luckysheetCurrentChartResizeXy[2]-D,y>luckysheet.chartparam.luckysheetCurrentChartResizeXy[2]+luckysheet.chartparam.luckysheetCurrentChartResizeXy[4]-60?(y=luckysheet.chartparam.luckysheetCurrentChartResizeXy[2]+luckysheet.chartparam.luckysheetCurrentChartResizeXy[4]-60,f=luckysheet.chartparam.luckysheetCurrentChartResizeXy[2]-(luckysheet.chartparam.luckysheetCurrentChartResizeXy[2]+luckysheet.chartparam.luckysheetCurrentChartResizeXy[4]-60-luckysheet.chartparam.luckysheetCurrentChartResizeXy[0])):y<=0&&(y=0,f=luckysheet.chartparam.luckysheetCurrentChartResizeXy[2]+luckysheet.chartparam.luckysheetCurrentChartResizeXy[0])),"rm"!=luckysheet.chartparam.luckysheetCurrentChartResize&&"rt"!=luckysheet.chartparam.luckysheetCurrentChartResize&&"rb"!=luckysheet.chartparam.luckysheetCurrentChartResize||((f=luckysheet.chartparam.luckysheetCurrentChartResizeXy[2]+D)<60?f=60:f>=luckysheet.chartparam.luckysheetCurrentChartResizeWinW-luckysheet.chartparam.luckysheetCurrentChartResizeXy[4]-22-36&&(f=luckysheet.chartparam.luckysheetCurrentChartResizeWinW-luckysheet.chartparam.luckysheetCurrentChartResizeXy[4]-22-36)),"mt"!=luckysheet.chartparam.luckysheetCurrentChartResize&&"lt"!=luckysheet.chartparam.luckysheetCurrentChartResize&&"rt"!=luckysheet.chartparam.luckysheetCurrentChartResize||(i=r,h=luckysheet.chartparam.luckysheetCurrentChartResizeXy[3]-z,i>luckysheet.chartparam.luckysheetCurrentChartResizeXy[3]+luckysheet.chartparam.luckysheetCurrentChartResizeXy[5]-60?(i=luckysheet.chartparam.luckysheetCurrentChartResizeXy[3]+luckysheet.chartparam.luckysheetCurrentChartResizeXy[5]-60,h=luckysheet.chartparam.luckysheetCurrentChartResizeXy[3]-(luckysheet.chartparam.luckysheetCurrentChartResizeXy[3]+luckysheet.chartparam.luckysheetCurrentChartResizeXy[5]-60-luckysheet.chartparam.luckysheetCurrentChartResizeXy[1])):i<=0&&(i=0,h=luckysheet.chartparam.luckysheetCurrentChartResizeXy[3]+luckysheet.chartparam.luckysheetCurrentChartResizeXy[1])),"mb"!=luckysheet.chartparam.luckysheetCurrentChartResize&&"lb"!=luckysheet.chartparam.luckysheetCurrentChartResize&&"rb"!=luckysheet.chartparam.luckysheetCurrentChartResize||((h=luckysheet.chartparam.luckysheetCurrentChartResizeXy[3]+z)<60?h=60:h>=luckysheet.chartparam.luckysheetCurrentChartResizeWinH-luckysheet.chartparam.luckysheetCurrentChartResizeXy[5]-42-6&&(h=luckysheet.chartparam.luckysheetCurrentChartResizeWinH-luckysheet.chartparam.luckysheetCurrentChartResizeXy[5]-42-6));var P={top:i,left:y,height:h,width:f};luckysheet.chartparam.luckysheetCurrentChartResizeObj.css(P),window.generator&&generator.resize(luckysheet.chartparam.luckysheetcurrentChart)}else if(luckysheet.postil.move){l=(v=mouseposition(L.pageX,L.pageY))[0]+$("#luckysheet-cell-main").scrollLeft(),r=v[1]+$("#luckysheet-cell-main").scrollTop(),O=luckysheet.postil.currentObj.outerHeight(),j=luckysheet.postil.currentObj.outerWidth(),i=r-luckysheet.postil.moveXY[1],y=l-luckysheet.postil.moveXY[0];i<0&&(i=0),i+O+42+6>luckysheet.postil.currentWinH&&(i=luckysheet.postil.currentWinH-O-42-6),y<0&&(y=0),y+j+22+36>luckysheet.postil.currentWinW&&(y=luckysheet.postil.currentWinW-j-22-36),luckysheet.postil.currentObj.css({left:y,top:i})}else if(luckysheet.postil.resize){l=(v=luckysheet.mouseposition(L.pageX,L.pageY))[0]+$("#luckysheet-cell-main").scrollLeft(),r=v[1]+$("#luckysheet-cell-main").scrollTop();if(l<0||r<0)return!1;z=r-luckysheet.postil.resizeXY[1],D=l-luckysheet.postil.resizeXY[0],i=luckysheet.postil.resizeXY[5],h=luckysheet.postil.resizeXY[3],y=luckysheet.postil.resizeXY[4],f=luckysheet.postil.resizeXY[2];"lm"!=luckysheet.postil.resize&&"lt"!=luckysheet.postil.resize&&"lb"!=luckysheet.postil.resize||(y=l,f=luckysheet.postil.resizeXY[2]-D,y>luckysheet.postil.resizeXY[2]+luckysheet.postil.resizeXY[4]-60?(y=luckysheet.postil.resizeXY[2]+luckysheet.postil.resizeXY[4]-60,f=luckysheet.postil.resizeXY[2]-(luckysheet.postil.resizeXY[2]+luckysheet.postil.resizeXY[4]-60-luckysheet.postil.resizeXY[0])):y<=0&&(y=0,f=luckysheet.postil.resizeXY[2]+luckysheet.postil.resizeXY[0])),"rm"!=luckysheet.postil.resize&&"rt"!=luckysheet.postil.resize&&"rb"!=luckysheet.postil.resize||((f=luckysheet.postil.resizeXY[2]+D)<60?f=60:f>=luckysheet.postil.currentWinW-luckysheet.postil.resizeXY[4]-22-36&&(f=luckysheet.postil.currentWinW-luckysheet.postil.resizeXY[4]-22-36)),"mt"!=luckysheet.postil.resize&&"lt"!=luckysheet.postil.resize&&"rt"!=luckysheet.postil.resize||(i=r,h=luckysheet.postil.resizeXY[3]-z,i>luckysheet.postil.resizeXY[3]+luckysheet.postil.resizeXY[5]-60?(i=luckysheet.postil.resizeXY[3]+luckysheet.postil.resizeXY[5]-60,h=luckysheet.postil.resizeXY[3]-(luckysheet.postil.resizeXY[3]+luckysheet.postil.resizeXY[5]-60-luckysheet.postil.resizeXY[1])):i<=0&&(i=0,h=luckysheet.postil.resizeXY[3]+luckysheet.postil.resizeXY[1])),"mb"!=luckysheet.postil.resize&&"lb"!=luckysheet.postil.resize&&"rb"!=luckysheet.postil.resize||((h=luckysheet.postil.resizeXY[3]+z)<60?h=60:h>=luckysheet.postil.currentWinH-luckysheet.postil.resizeXY[5]-42-6&&(h=luckysheet.postil.currentWinH-luckysheet.postil.resizeXY[5]-42-6)),luckysheet.postil.currentObj.css({width:f,height:h,left:y,top:i})}else luckysheet.formula.rangeResize?luckysheet.formula.rangeResizeDraging(L,luckysheet.formula.rangeResizeObj,luckysheet.formula.rangeResizexy,luckysheet.formula.rangeResize,luckysheet.formula.rangeResizeWinW,luckysheet.formula.rangeResizeWinH,ch_width,rh_height):luckysheet.formula.rangeMove?luckysheet.formula.rangeMoveDraging(L,luckysheet.formula.rangeMovexy,luckysheet.formula.rangeMoveObj.data("range"),luckysheet.formula.rangeMoveObj,sheetBarHeight,statisticBarHeight):luckysheet.chart_selection.rangeResize?luckysheet.chart_selection.rangeResizeDraging(L,sheetBarHeight,statisticBarHeight):luckysheet.chart_selection.rangeMove&&luckysheet.chart_selection.rangeMoveDraging(L,sheetBarHeight,statisticBarHeight)},1))}}),$(document).mouseup(function(e){var t,l,r,a,s,n,o,c,u,i,h,d,y,f,m,k,p;if(luckysheet_select_status&&(clearTimeout(jfcountfuncTimeout),jfcountfuncTimeout=setTimeout(function(){jfcountfunc()},0),luckysheet.menuButton.luckysheetPaintModelOn&&(luckysheet.selection.pasteHandlerOfPaintModel(luckysheet_copy_save),luckysheet.menuButton.luckysheetPaintSingle&&luckysheet.menuButton.cancelPaintModel())),luckysheet_select_status=!1,clearTimeout(jfautoscrollTimeout),luckysheet_scroll_status=!1,$("#luckysheet-cell-selected").find(".luckysheet-cs-fillhandle").css("cursor","crosshair").end().find(".luckysheet-cs-draghandle").css("cursor","move"),$("#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0").css("cursor","default"),luckysheet_model_move_state=luckysheet_cols_selected_status=luckysheet_rows_selected_status=!1,luckysheet.formula.functionResizeStatus&&(luckysheet.formula.functionResizeStatus=!1,$("#luckysheet-wa-calculate-size").removeAttr("style")),luckysheet.freezen.horizontalmovestate&&(luckysheet.freezen.horizontalmovestate=!1,$("#luckysheet-freezebar-horizontal").removeClass("luckysheet-freezebar-active"),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css("cursor","-webkit-grab"),luckysheet.freezen.freezenhorizontaldata[4]<=columeHeaderHeight&&luckysheet.freezen.cancelFreezenHorizontal(),luckysheet.freezen.createAssistCanvas(),luckysheet.luckysheetrefreshgrid()),luckysheet.freezen.verticalmovestate&&(luckysheet.freezen.verticalmovestate=!1,$("#luckysheet-freezebar-vertical").removeClass("luckysheet-freezebar-active"),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css("cursor","-webkit-grab"),luckysheet.freezen.freezenverticaldata[4]<=rowHeaderWidth&&luckysheet.freezen.cancelFreezenVertical(),luckysheet.freezen.createAssistCanvas(),luckysheet.luckysheetrefreshgrid()),luckysheet.pivotTable&&luckysheet.pivotTable.movestate&&($("#luckysheet-modal-dialog-slider-pivot-move").remove(),luckysheet.pivotTable.movestate=!1,$("#luckysheet-modal-dialog-pivotTable-list, #luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").css("cursor","default"),"luckysheet-modal-dialog-pivotTable-list"!=luckysheet.pivotTable.movesave.containerid&&0==$(e.target).closest(".luckysheet-modal-dialog-slider-config-list").length&&("luckysheet-modal-dialog-config-value"==luckysheet.pivotTable.movesave.containerid&&luckysheet.pivotTable.resetOrderby(luckysheet.pivotTable.movesave.obj),luckysheet.pivotTable.movesave.obj.remove(),luckysheet.pivotTable.showvaluecolrow(),$("#luckysheet-modal-dialog-pivotTable-list").find(".luckysheet-modal-dialog-slider-list-item").each(function(){$(this).find(".luckysheet-slider-list-item-selected").find("i").remove()}),$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").find(".luckysheet-modal-dialog-slider-config-item").each(function(){var t=$(this).data("index");$("#luckysheet-modal-dialog-pivotTable-list").find(".luckysheet-modal-dialog-slider-list-item").each(function(){var e=$(this).find(".luckysheet-slider-list-item-selected");$(this).data("index")==t&&0==e.find("i").length&&e.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')})}),luckysheet.pivotTable.refreshPivotTable())),luckysheet.chartparam.luckysheet_chart_point_config&&luckysheet.chartparam.luckysheet_chart_point_config.movestart&&(clearTimeout(luckysheet.chartparam.luckysheet_chart_point_config.lagTimeoutclick),luckysheet.chartparam.luckysheet_chart_point_config.mouseupdone=!0,luckysheet.chartparam.luckysheet_chart_point_config.movestart=!1,$("#luckysheet-chart-point-selectedhelp").hide(),luckysheet.chartparam.luckysheet_chart_point_config.objectIndicator=[],luckysheet.chartparam.luckysheet_chart_point_config.changeindex=[],l=!(t=null),r=luckysheet.chartparam.luckysheet_chart_point_config.pointchart.getOption(),$("#luckysheet-chart-point-config .luckysheet-chart-point-searchitem-c").find(".luckysheet-chart-point-searchitem-active").each(function(){luckysheet.chartparam.luckysheet_chart_point_config.changeindex.push($(this).data("index"));var e=r.series[0].data[$(this).data("index")];!l||e instanceof Array||(l=!1,t=e)}),luckysheet.luckysheetactivepointconfig(r,t)),luckysheet_sheet_move_status&&(luckysheet_sheet_move_status=!1,luckysheet_sheet_move_data.activeobject.insertBefore($("#luckysheet-sheets-item-clone")),luckysheet_sheet_move_data.activeobject.removeAttr("style"),$("#luckysheet-sheets-item-clone").remove(),luckysheet_sheet_move_data.cursorobject.css({cursor:"pointer"}),luckysheet_sheet_move_data={},luckysheet.sheetmanage.reOrderAllSheet()),clearTimeout(luckysheet.chartparam.luckysheetCurrentChartMoveTimeout),luckysheet.chartparam.luckysheetCurrentChartMove&&(luckysheet.chartparam.luckysheetCurrentChartMove=!1,luckysheet.chartparam.luckysheetInsertChartTosheetChange&&(n=luckysheet.chartparam.luckysheetCurrentChartMoveObj.css("top"),o=luckysheet.chartparam.luckysheetCurrentChartMoveObj.css("left"),b=$("#luckysheet-cell-main").scrollLeft(),S=$("#luckysheet-cell-main").scrollTop(),_=luckysheet.chartparam.luckysheetCurrentChartMoveXy[2],A=luckysheet.chartparam.luckysheetCurrentChartMoveXy[3],d=luckysheet.chartparam.luckysheetCurrentChartMoveXy[4],y=luckysheet.chartparam.luckysheetCurrentChartMoveXy[5],c=luckysheet.chartparam.luckysheetCurrentChartMoveObj.find(".luckysheet-modal-dialog-content").attr("id"),u=!!window.store&&store.state.chartSetting.chartList[c].sheetIndex,luckysheet.jfredo.push({type:"moveChart",chart_id:c,sheetIndex:u,myTop:n,myLeft:o,scrollTop:S,scrollLeft:b,x:_,y:A,scrollTop1:y,scrollLeft1:d}),window.store&&store.commit({type:"updateChartItem",key:"left",value:o,chartId:c}),window.store&&store.commit({type:"updateChartItem",key:"top",value:n,chartId:c}),luckysheet.server.saveParam("c",u,{left:o,top:n,scrollTop:S,scrollLeft:b},{op:"xy",cid:c}))),luckysheet.formula.rangeResize&&luckysheet.formula.rangeResizeDragged(e,luckysheet.formula.rangeResizeObj,luckysheet.formula.rangeResize,luckysheet.formula.rangeResizexy,luckysheet.formula.rangeResizeWinW,luckysheet.formula.rangeResizeWinH),luckysheet.chartparam.luckysheetCurrentChartResize&&(luckysheet.chartparam.luckysheetCurrentChartResize=null,luckysheet.chartparam.luckysheetInsertChartTosheetChange&&(a=luckysheet.chartparam.luckysheetCurrentChartResizeObj.height(),s=luckysheet.chartparam.luckysheetCurrentChartResizeObj.width(),b=$("#luckysheet-cell-main").scrollLeft(),S=$("#luckysheet-cell-main").scrollTop(),n=luckysheet.chartparam.luckysheetCurrentChartMoveObj.css("top"),o=luckysheet.chartparam.luckysheetCurrentChartMoveObj.css("left"),c=luckysheet.chartparam.luckysheetCurrentChartResizeObj.find(".luckysheet-modal-dialog-content").attr("id"),u=!!window.store&&store.state.chartSetting.chartList[c].sheetIndex,i=luckysheet.chartparam.luckysheetCurrentChartResizeXy[2],h=luckysheet.chartparam.luckysheetCurrentChartResizeXy[3],_=luckysheet.chartparam.luckysheetCurrentChartResizeXy[4],A=luckysheet.chartparam.luckysheetCurrentChartResizeXy[5],d=luckysheet.chartparam.luckysheetCurrentChartResizeXy[6],y=luckysheet.chartparam.luckysheetCurrentChartResizeXy[7],luckysheet.jfredo.push({type:"resizeChart",chart_id:c,sheetIndex:u,myTop:n,myLeft:o,myHeight:a,myWidth:s,scrollTop:S,scrollLeft:b,x:_,y:A,myWidth1:i,myHeight1:h,scrollTop1:y,scrollLeft1:d}),window.store&&store.commit({type:"updateChartItem",key:"height",value:a,chartId:c}),window.store&&store.commit({type:"updateChartItem",key:"width",value:s,chartId:c}),window.store&&store.commit({type:"updateChartItem",key:"left",value:o,chartId:c}),window.store&&store.commit({type:"updateChartItem",key:"top",value:n,chartId:c}),luckysheet.server.saveParam("c",u,{width:s,height:a,top:n,left:o,scrollTop:S,scrollLeft:b},{op:"wh",cid:c}))),luckysheet.postil.move&&(luckysheet.postil.move=!1,m=(f=luckysheet.postil.currentObj.closest(".luckysheet-postil-show").attr("id")).split("luckysheet-postil-show_")[1].split("_")[0],k=f.split("luckysheet-postil-show_")[1].split("_")[1],p=[],(O=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata))[m][k].ps.left=luckysheet.postil.currentObj.position().left,O[m][k].ps.top=luckysheet.postil.currentObj.position().top,O[m][k].ps.value=luckysheet.postil.currentObj.find(".formulaInputFocus").text(),p.push(m+"_"+k),luckysheet.postil.ref(O,p),$("#"+f).remove(),O[m][k].ps.isshow?(luckysheet.postil.buildPs(m,k,O[m][k].ps),$("#"+f).addClass("luckysheet-postil-show-active"),$("#"+f).find(".luckysheet-postil-dialog-resize").show()):luckysheet.postil.editPs(m,k)),luckysheet.postil.resize&&(luckysheet.postil.resize=null,m=(f=luckysheet.postil.currentObj.closest(".luckysheet-postil-show").attr("id")).split("luckysheet-postil-show_")[1].split("_")[0],k=f.split("luckysheet-postil-show_")[1].split("_")[1],p=[],(O=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata))[m][k].ps.left=luckysheet.postil.currentObj.position().left,O[m][k].ps.top=luckysheet.postil.currentObj.position().top,O[m][k].ps.width=luckysheet.postil.currentObj.outerWidth(),O[m][k].ps.height=luckysheet.postil.currentObj.outerHeight(),O[m][k].ps.value=luckysheet.postil.currentObj.find(".formulaInputFocus").text(),p.push(m+"_"+k),luckysheet.postil.ref(O,p),$("#"+f).remove(),O[m][k].ps.isshow?(luckysheet.postil.buildPs(m,k,O[m][k].ps),$("#"+f).addClass("luckysheet-postil-show-active"),$("#"+f).find(".luckysheet-postil-dialog-resize").show()):luckysheet.postil.editPs(m,k)),luckysheet_rows_change_size&&(luckysheet_rows_change_size=!1,$("#luckysheet-change-size-line").hide(),$("#luckysheet-rows-change-size").css("opacity",0),$("#luckysheet-sheettable, #luckysheet-rows-h, #luckysheet-rows-h canvas").css("cursor","default"),v=mouseposition(e.pageX,e.pageY),S=$("#luckysheet-rows-h").scrollTop(),A=v[1]+S,F=$(window).height(),(he=luckysheet.rowLocation(A))[1],C=he[0],x=he[2],luckysheetConfigsetting.pointEdit?(g=(A+3)/luckysheetConfigsetting.pointEditZoom-luckysheet_rows_change_size_start[0],(A+3)/luckysheetConfigsetting.pointEditZoom-luckysheet_rows_change_size_start[0]<19&&(g=19),A/luckysheetConfigsetting.pointEditZoom>=F-200+S&&(g=w-200-luckysheet_rows_change_size_start[0]+S)):(g=A+3-luckysheet_rows_change_size_start[0],A+3-luckysheet_rows_change_size_start[0]<19&&(g=19),F-200+S<=A&&(g=w-200-luckysheet_rows_change_size_start[0]+S)),null==(E=$.extend(!0,{},config)).rowlen&&(E.rowlen={}),E.rowlen[luckysheet_rows_change_size_start[1]]=Math.ceil(g),clearjfundo&&(luckysheet.jfundo=[],luckysheet.jfredo.push({type:"resize",ctrlType:"resizeR",config:$.extend(!0,{},config),curconfig:$.extend(!0,{},E),sheetIndex:luckysheet.currentSheetIndex})),config=E,luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].config=config,luckysheet.server.saveParam("cg",luckysheet.currentSheetIndex,E.rowlen,{k:"rowlen"}),luckysheet.jfrefreshgrid_rhcw(luckysheet.flowdata.length,null)),luckysheet_cols_change_size){luckysheet_cols_change_size=!1,$("#luckysheet-change-size-line").hide(),$("#luckysheet-cols-change-size").css("opacity",0),$("#luckysheet-sheettable, #luckysheet-cols-h-c, .luckysheet-cols-h-cells, .luckysheet-cols-h-cells canvas").css("cursor","default");var g,v=mouseposition(e.pageX,e.pageY),b=$("#luckysheet-cols-h-c").scrollLeft(),_=v[0]+b,w=$(window).width(),x=visibledatarow.length-1,C=(visibledatarow[x],0),T=((de=luckysheet.colLocation(_))[1],de[0]),I=de[2];g=luckysheetConfigsetting.pointEdit?(_+3)/luckysheetConfigsetting.pointEditZoom-luckysheet_cols_change_size_start[0]:_+3-luckysheet_cols_change_size_start[0];var R=defaultcollen;if(null!=config.columlen&&null!=config.columlen[luckysheet_cols_change_size_start[1]]&&(R=config.columlen[luckysheet_cols_change_size_start[1]]),Math.abs(g-R)<3)return;luckysheetConfigsetting.pointEdit?((_+3)/luckysheetConfigsetting.pointEditZoom-luckysheet_cols_change_size_start[0]<30&&(g=30),_/luckysheetConfigsetting.pointEditZoom>=w-100+b&&(g=w-100-luckysheet_cols_change_size_start[0]+b)):(_+3-luckysheet_cols_change_size_start[0]<30&&(g=30),w-100+b<=_&&(g=w-100-luckysheet_cols_change_size_start[0]+b)),null==(E=$.extend(!0,{},config)).columlen&&(E.columlen={}),E.columlen[luckysheet_cols_change_size_start[1]]=Math.ceil(g),clearjfundo&&(luckysheet.jfundo=[],luckysheet.jfredo.push({type:"resize",ctrlType:"resizeC",config:$.extend(!0,{},config),curconfig:$.extend(!0,{},E),sheetIndex:luckysheet.currentSheetIndex})),config=E,luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].config=config,luckysheet.server.saveParam("cg",luckysheet.currentSheetIndex,E.columlen,{k:"columlen"}),luckysheet.jfrefreshgrid_rhcw(null,luckysheet.flowdata[0].length),setTimeout(function(){luckysheet.luckysheetrefreshgrid()},1)}if(luckysheet.formula.rangeMove&&luckysheet.formula.rangeMoveDragged(luckysheet.formula.rangeMoveObj),luckysheet_cell_selected_move){$("#luckysheet-cell-selected-move").hide(),luckysheet_cell_selected_move=!1;var v=mouseposition(e.pageX,e.pageY),b=$("#luckysheet-cell-main").scrollLeft(),S=$("#luckysheet-cell-main").scrollTop(),_=v[0]+b,A=v[1]+S,F=$(window).height()+S-sheetBarHeight-statisticBarHeight,w=$(window).width()+b,x=(he=luckysheet.rowLocation(A))[2],I=(de=luckysheet.colLocation(_))[2],N=luckysheet_cell_selected_move_index[0],M=luckysheet_cell_selected_move_index[1];if(x==N&&I==M)return;var E,O=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),j=luckysheet_select_save[luckysheet_select_save.length-1],z=luckysheet.getdatabyselection(j);if(null==(E=$.extend(!0,{},config)).merge&&(E.merge={}),null==E.rowlen&&(E.rowlen={}),luckysheet.hasPartMC(E,j.row[0],j.row[1],j.column[0],j.column[1]))return void(luckysheet.isEditMode()?alert("无法对合并单元格执行此操作"):luckysheet.tooltip.info('<i class="fa fa-exclamation-triangle"></i>提示',"无法对合并单元格执行此操作"));var D=j.row[0]-N+x,P=j.row[1]-N+x,L=j.column[0]-M+I,B=j.column[1]-M+I;if((D<0||A<0)&&(D=0,P=j.row[1]-j.row[0]),(L<0||_<0)&&(L=0,B=j.column[1]-j.column[0]),(P>=visibledatarow[visibledatarow.length-1]||F<A)&&(D=visibledatarow.length-1-j.row[1]+j.row[0],P=visibledatarow.length-1),(B>=visibledatacolumn[visibledatacolumn.length-1]||w<_)&&(L=visibledatacolumn.length-1-j.column[1]+j.column[0],B=visibledatacolumn.length-1),luckysheet.hasPartMC(E,D,P,L,B))return void(luckysheet.isEditMode()?alert("无法对合并单元格执行此操作"):luckysheet.tooltip.info('<i class="fa fa-exclamation-triangle"></i>提示',"无法对合并单元格执行此操作"));for(var q=luckysheet.getBorderInfoCompute(luckysheet.currentSheetIndex),H=null,V=j.row[0];V<=j.row[1];V++){V in E.rowlen&&(H=!0);for(var U=j.column[0];U<=j.column[1];U++){var Y=O[V][U];"object"==luckysheet.getObjType(Y)&&"mc"in Y&&Y.mc.r+"_"+Y.mc.c in E.merge&&delete E.merge[Y.mc.r+"_"+Y.mc.c],O[V][U]=null}}if(E.borderInfo&&0<E.borderInfo.length){for(var W=[],G=0;G<E.borderInfo.length;G++){var X,K,Z=E.borderInfo[G].rangeType;if("range"==Z){for(var J=E.borderInfo[G].range,Q=[],ee=0;ee<J.length;ee++)Q=Q.concat(luckysheet.conditionformat.CFSplitRange(J[ee],{row:j.row,column:j.column},{row:[D,P],column:[L,B]},"restPart"));E.borderInfo[G].range=Q,W.push(E.borderInfo[G])}else{"cell"==Z&&(X=E.borderInfo[G].value.row_index,K=E.borderInfo[G].value.col_index,X>=j.row[0]&&X<=j.row[1]&&K>=j.column[0]&&K<=j.column[1]||W.push(E.borderInfo[G]))}}E.borderInfo=W}for(var te={},V=0;V<z.length;V++)for(var le,U=0;U<z[0].length;U++){q[V+j.row[0]+"_"+(U+j.column[0])]&&(le={rangeType:"cell",value:{row_index:V+D,col_index:U+L,l:q[V+j.row[0]+"_"+(U+j.column[0])].l,r:q[V+j.row[0]+"_"+(U+j.column[0])].r,t:q[V+j.row[0]+"_"+(U+j.column[0])].t,b:q[V+j.row[0]+"_"+(U+j.column[0])].b}},null==E.borderInfo&&(E.borderInfo=[]),E.borderInfo.push(le));var re,ae="";null!=z[V]&&null!=z[V][U]&&(ae=z[V][U]),"object"==luckysheet.getObjType(ae)&&"mc"in ae&&(re=$.extend(!0,{},ae.mc),"rs"in ae.mc?(te[re.r+"_"+re.c]=[V+D,U+L],ae.mc.r=V+D,ae.mc.c=U+L,E.merge[V+D+"_"+(U+L)]=ae.mc):(ae.mc.r=te[re.r+"_"+re.c][0],ae.mc.c=te[re.r+"_"+re.c][1])),O[V+D][U+L]=ae}H&&(E=luckysheet.rowlenByRange(O,j.row[0],j.row[1],E),E=luckysheet.rowlenByRange(O,D,P,E));var se,ne,oe=$.extend(!0,[],luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_conditionformat_save);if(null!=oe&&0<oe.length)for(G=0;G<oe.length;G++){for(var ce=oe[G].cellrange,ue=[],ee=0;ee<ce.length;ee++)var ie=luckysheet.conditionformat.CFSplitRange(ce[ee],{row:j.row,column:j.column},{row:[D,P],column:[L,B]},"allPart"),ue=ue.concat(ie);oe[G].cellrange=ue}se=luckysheet_select_save[0].row_focus==luckysheet_select_save[0].row[0]?D:P,ne=luckysheet_select_save[0].column_focus==luckysheet_select_save[0].column[0]?L:B,(ie=[]).push({row:j.row,column:j.column}),ie.push({row:[D,P],column:[L,B]}),j.row=[D,P],j.column=[L,B],j.row_focus=se,j.column_focus=ne,luckysheet.jfrefreshgrid(O,ie,E,oe,H),luckysheet.selectHightlightShow(),$("#luckysheet-sheettable").css("cursor","default"),clearTimeout(jfcountfuncTimeout),jfcountfuncTimeout=setTimeout(function(){jfcountfunc()},500)}if(luckysheet.chart_selection.rangeMove&&luckysheet.chart_selection.rangeMoveDragged(),luckysheet.chart_selection.rangeResize&&luckysheet.chart_selection.rangeResizeDragged(),luckysheet_cell_selected_extend){luckysheet_cell_selected_extend=!1,$("#luckysheet-cell-selected-extend").hide();var he,de,v=mouseposition(e.pageX,e.pageY),b=$("#luckysheet-cell-main").scrollLeft(),S=$("#luckysheet-cell-main").scrollTop(),_=v[0]+b-5,A=v[1]+S-5,F=$(window).height()+S-sheetBarHeight-statisticBarHeight,w=$(window).width()+b,C=((he=luckysheet.rowLocation(A))[1],he[0]),x=he[2],T=((de=luckysheet.colLocation(_))[1],de[0]),I=de[2],N=luckysheet_cell_selected_extend_index[0],M=luckysheet_cell_selected_extend_index[1],D=(j=luckysheet_select_save[luckysheet_select_save.length-1]).row[0],P=j.row[1],L=j.column[0],B=j.column[1];(D<0||A<0)&&(D=0,P=j.row[1]-j.row[0]),(L<0||_<0)&&(L=0,B=j.column[1]-j.column[0]),(P>=visibledatarow[visibledatarow.length-1]||F<A)&&(D=visibledatarow.length-1-j.row[1]+j.row[0],P=visibledatarow.length-1),(B>=visibledatacolumn[visibledatacolumn.length-1]||w<_)&&(L=visibledatacolumn.length-1-j.column[1]+j.column[0],B=visibledatacolumn.length-1),luckysheet.dropCell.copyRange={row:$.extend(!0,[],j.row),column:$.extend(!0,[],j.column)};var ye=luckysheet.dropCell.typeItemHide();if(ye[0]||ye[1]||ye[2]||ye[3]||ye[4]||ye[5]||ye[6]?luckysheet.dropCell.applyType="1":luckysheet.dropCell.applyType="0",Math.abs(N-x)>Math.abs(M-I)){if(D<=x&&x<=P)return;if(luckysheet_select_save[0].top_move>=C){if(luckysheet.dropCell.applyRange={row:[x,j.row[0]-1],column:j.column},luckysheet.dropCell.direction="up",D-=j.row[0]-x,luckysheet.pivotTable.isPivotRange(D,B))return void luckysheet.tooltip.info("无法对所选单元格进行此更改，因为它会影响数据透视表！","")}else if(luckysheet.dropCell.applyRange={row:[j.row[1]+1,x],column:j.column},luckysheet.dropCell.direction="down",P+=x-j.row[1],luckysheet.pivotTable.isPivotRange(P,B))return void luckysheet.tooltip.info("无法对所选单元格进行此更改，因为它会影响数据透视表！","")}else{if(L<=I&&I<=B)return;if(luckysheet_select_save[0].left_move>=T){if(luckysheet.dropCell.applyRange={row:j.row,column:[I,j.column[0]-1]},luckysheet.dropCell.direction="left",L-=j.column[0]-I,luckysheet.pivotTable.isPivotRange(P,L))return void luckysheet.tooltip.info("无法对所选单元格进行此更改，因为它会影响数据透视表！","")}else if(luckysheet.dropCell.applyRange={row:j.row,column:[j.column[1]+1,I]},luckysheet.dropCell.direction="right",B+=I-j.column[1],luckysheet.pivotTable.isPivotRange(P,B))return void luckysheet.tooltip.info("无法对所选单元格进行此更改，因为它会影响数据透视表！","")}if(null!=config.merge){for(var fe=!1,V=j.row[0];V<=j.row[1];V++)for(U=j.column[0];U<=j.column[1];U++){if(null!=(Y=luckysheet.flowdata[V][U])&&null!=Y.mc){fe=!0;break}}if(fe)return void(luckysheet.isEditMode()?alert("无法对合并单元格执行此操作"):luckysheet.tooltip.info("无法对合并单元格执行此操作",""));for(V=D;V<=P;V++)for(U=L;U<=B;U++){if(null!=(Y=luckysheet.flowdata[V][U])&&null!=Y.mc){fe=!0;break}}if(fe)return void(luckysheet.isEditMode()?alert("无法对合并单元格执行此操作"):luckysheet.tooltip.info("无法对合并单元格执行此操作",""))}j.row=[D,P],j.column=[L,B],luckysheet.dropCell.update(),luckysheet.dropCell.createIcon(),$("#luckysheet-cell-selected-move").hide(),$("#luckysheet-sheettable").css("cursor","default"),clearTimeout(jfcountfuncTimeout),jfcountfuncTimeout=setTimeout(function(){jfcountfunc()},500)}}),$("#luckysheet-left-top").mousedown(function(e){$("#luckysheet-wa-functionbox-confirm").click(),luckysheet_select_status=!1,luckysheet_select_save=[{row:[0,luckysheet.flowdata.length-1],column:[0,luckysheet.flowdata[0].length-1],row_focus:0,column_focus:0}],luckysheet.selectHightlightShow(),clearTimeout(jfcountfuncTimeout),jfcountfuncTimeout=setTimeout(function(){jfcountfunc()},500),e.stopPropagation()});var luckysheet_rows_selected_status=!1;$("#luckysheet-rows-h").mousedown(function(e){luckysheet.postil.removeActivePs();var t=mouseposition(e.pageX,e.pageY)[1]+$("#luckysheet-rows-h").scrollTop(),l=luckysheet.rowLocation(t),r=l[1],a=l[0],s=l[2],n=visibledatacolumn.length-1,o=visibledatacolumn[n];if($("#luckysheet-rightclick-menu").hide(),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide(),"3"==e.which){for(var c=!1,u=0;u<luckysheet_select_save.length;u++){var i=luckysheet_select_save[u];if(null!=i.row&&s>=i.row[0]&&s<=i.row[1]&&0==i.column[0]&&i.column[1]==luckysheet.flowdata[0].length-1){c=!0;break}}if(c)return}var h=a,d=r-a-1,y=[s,s];luckysheet_scroll_status=!0;var f=$("#luckysheet-input-box");if(0<parseInt(f.css("top"))){if(luckysheet.formula.rangestart||luckysheet.formula.rangedrag_column_start||luckysheet.formula.rangedrag_row_start||luckysheet.formula.israngeseleciton()||$("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){var m,k,p,g,v,b=luckysheet.menuButton.mergeMoveMain([0,n],y,{row_focus:s,column_focus:0},h,d,0,o);return null!=b&&(y=b[1],h=b[2],d=b[3]),e.shiftKey?(d=h=0,y=[],y=(m=luckysheet.formula.func_selectedrange).top>a?(h=a,d=m.top+m.height-a,m.row[1]>m.row_focus&&(m.row[1]=m.row_focus),[s,m.row[1]]):m.top==a?(h=a,d=m.top+m.height-a,[s,m.row[0]]):(h=m.top,d=r-m.top-1,m.row[0]<m.row_focus&&(m.row[0]=m.row_focus),[m.row[0],s]),null!=(b=luckysheet.menuButton.mergeMoveMain([0,n],y,{row_focus:s,column_focus:0},h,d,0,o))&&(y=b[1],h=b[2],d=b[3]),m.row=y,m.top_move=h,m.height_move=d,luckysheet.formula.func_selectedrange=m):(e.ctrlKey&&","!=$("#luckysheet-rich-text-editor").find("span").last().text()&&(0<(g=$("#luckysheet-rich-text-editor").text()+",").length&&"="==g.substr(0,1)&&(g=luckysheet.formula.functionHTMLGenerate(g),window.getSelection?(k=window.getSelection(),luckysheet.formula.functionRangeIndex=[$(k.anchorNode).parent().index(),k.anchorOffset]):(p=document.selection.createRange(),luckysheet.formula.functionRangeIndex=p),$("#luckysheet-rich-text-editor").html(g),luckysheet.formula.canceFunctionrangeSelected(),luckysheet.formula.createRangeHightlight()),luckysheet.formula.rangestart=!1,luckysheet.formula.rangedrag_column_start=!1,luckysheet.formula.rangedrag_row_start=!1,$("#luckysheet-functionbox-cell").html(g),luckysheet.formula.rangeHightlightselected($("#luckysheet-rich-text-editor")),luckysheet.formula.israngeseleciton()),luckysheet.formula.func_selectedrange={left:luckysheet.colLocationByIndex(0)[0],width:luckysheet.colLocationByIndex(0)[1]-luckysheet.colLocationByIndex(0)[0]-1,top:h,height:d,left_move:0,width_move:o-1,top_move:h,height_move:d,row:y,column:[0,n],row_focus:s,column_focus:0}),luckysheet.formula.rangestart||luckysheet.formula.rangedrag_column_start||luckysheet.formula.rangedrag_row_start||luckysheet.formula.israngeseleciton()?luckysheet.formula.rangeSetValue({row:y,column:[null,null]}):$("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")&&(v=luckysheet.sheetmanage.getRangetxt(luckysheet.currentSheetIndex,{row:y,column:[0,n]},luckysheet.currentSheetIndex),$("#luckysheet-ifFormulaGenerator-multiRange-dialog input").val(v)),luckysheet.formula.rangedrag_row_start=!0,luckysheet.formula.rangestart=!1,luckysheet.formula.rangedrag_column_start=!1,$("#luckysheet-formula-functionrange-select").css({left:0,width:o-1,top:h,height:d}).show(),$("#luckysheet-formula-help-c").hide(),luckysheet.luckysheet_count_show(0,h,o-1,d,y,[0,n]),void setTimeout(function(){var e=window.getSelection().anchorNode;$("#luckysheet-search-formula-parm").is(":visible")||$("#luckysheet-search-formula-parm-select").is(":visible")?($editor=$("#luckysheet-rich-text-editor"),luckysheet.formula.rangechangeindex=luckysheet.formula.data_parm_index):$editor=$(e).closest("div");var t=$editor.find("span[rangeindex='"+luckysheet.formula.rangechangeindex+"']");luckysheet.formula.setCaretPosition(t.get(0),0,t.html().length)},1)}luckysheet.formula.updatecell(luckysheetCellUpdate[0],luckysheetCellUpdate[1]),luckysheet_rows_selected_status=!0}else luckysheet_rows_selected_status=!0;luckysheet_rows_selected_status&&(e.shiftKey?(d=h=0,y=[],y=(m=$.extend(!0,{},luckysheet_select_save[luckysheet_select_save.length-1])).top>a?(h=a,d=m.top+m.height-a,m.row[1]>m.row_focus&&(m.row[1]=m.row_focus),[s,m.row[1]]):m.top==a?(h=a,d=m.top+m.height-a,[s,m.row[0]]):(h=m.top,d=r-m.top-1,m.row[0]<m.row_focus&&(m.row[0]=m.row_focus),[m.row[0],s]),m.row=y,m.top_move=h,m.height_move=d,luckysheet_select_save[luckysheet_select_save.length-1]=m):e.ctrlKey?luckysheet_select_save.push({left:luckysheet.colLocationByIndex(0)[0],width:luckysheet.colLocationByIndex(0)[1]-luckysheet.colLocationByIndex(0)[0]-1,top:h,height:d,left_move:0,width_move:o-1,top_move:h,height_move:d,row:y,column:[0,n],row_focus:s,column_focus:0}):(luckysheet_select_save=[]).push({left:luckysheet.colLocationByIndex(0)[0],width:luckysheet.colLocationByIndex(0)[1]-luckysheet.colLocationByIndex(0)[0]-1,top:h,height:d,left_move:0,width_move:o-1,top_move:h,height_move:d,row:y,column:[0,n],row_focus:s,column_focus:0}),luckysheet.selectHightlightShow(),luckysheet.server.allowUpdate&&luckysheet.server.saveParam("mv",luckysheet.currentSheetIndex,luckysheet_select_save)),$("#luckysheet-helpbox-cell").text(luckysheet.sheetmanage.getRangetxt(luckysheet.currentSheetIndex,luckysheet_select_save[luckysheet_select_save.length-1])),setTimeout(function(){clearTimeout(jfcountfuncTimeout),jfcountfunc()},101)}).mousemove(function(e){var t,l,r,a;luckysheet_rows_selected_status||luckysheet_rows_change_size||luckysheet_select_status?$("#luckysheet-rows-h-hover").hide():(t=mouseposition(e.pageX,e.pageY)[1]+$("#luckysheet-rows-h").scrollTop(),r=(l=luckysheet.rowLocation(t))[1],a=l[0],l[2],$("#luckysheet-rows-h-hover").css({top:a,height:r-a-1,display:"block"}),t<r-1&&r-5<=t?$("#luckysheet-rows-change-size").css({top:r-3,opacity:0}):$("#luckysheet-rows-change-size").css("opacity",0))}).mouseleave(function(e){$("#luckysheet-rows-h-hover").hide(),$("#luckysheet-rows-change-size").css("opacity",0)}).mouseup(function(e){if(3==e.which){if(luckysheet.isEditMode())return;$("#luckysheet-cols-rows-shift").hide(),luckysheetRightHeadClickIs="row",$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word").text("行"),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-size").text("高"),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left").text("上"),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right").text("下"),$("#luckysheet-cols-rows-add").show(),$("#luckysheet-cols-rows-data").show(),$("#luckysheet-cols-rows-shift").hide(),showrightclickmenu($("#luckysheet-rightclick-menu"),$(this).offset().left+46,e.pageY),luckysheet_cols_menu_status=!0;var t=$.extend(!0,{},config);null==t.rowlen&&(t.rowlen={});for(var l=null==t.rowlen[luckysheet_select_save[0].row[0]]?luckysheet.defaultrowlen:t.rowlen[luckysheet_select_save[0].row[0]],r=!0,a=0;a<luckysheet_select_save.length;a++)for(var s=luckysheet_select_save[a],n=s.row[0],o=s.row[1],c=n;c<=o;c++){if((null==t.rowlen[c]?luckysheet.defaultrowlen:t.rowlen[c])!=l){r=!1;break}}r?$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val(l):$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val("")}}),luckysheet.luckysheet_count_show=function(e,t,l,r,a,s){var n,o,c=a[1]-a[0]+1,u=s[1]-s[0]+1,i=luckysheetTableContentHW[0],h=luckysheetTableContentHW[1],d=$("#luckysheet-cell-main").scrollLeft(),y=$("#luckysheet-cell-main").scrollTop();4<=c?((o=e-25)<0&&(o=e+5),o<d&&(o=d+10),n=h<r?y+h/2:t+r/2,$("#luckysheet-row-count-show").css({left:o,top:n,display:"block"}).html("<div>"+c.toString().split("").join("</div><div>")+"</div><div>行</div>")):$("#luckysheet-row-count-show").hide(),4<=u?((n=t-25)<0&&(n=t+5),n<y&&(n=y+10),o=i<l?d+i/2:e+l/2,$("#luckysheet-column-count-show").css({left:o,top:n,display:"block"}).text(u+"列")):$("#luckysheet-column-count-show").hide()};var luckysheet_cols_selected_status=!1;$("#luckysheet-cols-h-c").mousedown(function(e){luckysheet.postil.removeActivePs();var t=mouseposition(e.pageX,e.pageY)[0]+$(this).scrollLeft(),l=visibledatarow.length-1,r=visibledatarow[l],a=luckysheet.colLocation(t),s=a[1],n=a[0],o=a[2];if(orderbyindex=o,$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),"3"==e.which){for(var c=!1,u=0;u<luckysheet_select_save.length;u++){var i=luckysheet_select_save[u];if(null!=i.column&&o>=i.column[0]&&o<=i.column[1]&&0==i.row[0]&&i.row[1]==luckysheet.flowdata.length-1){c=!0;break}}if(c)return}var h=n,d=s-n-1,y=[o,o];luckysheet_scroll_status=!0;var f=$("#luckysheet-input-box");if(0<parseInt(f.css("top"))){if(luckysheet.formula.rangestart||luckysheet.formula.rangedrag_column_start||luckysheet.formula.rangedrag_row_start||luckysheet.formula.israngeseleciton()||$("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){var m,k,p,g,v,b=luckysheet.menuButton.mergeMoveMain(y,[0,l],{row_focus:0,column_focus:o},0,r,h,d);return null!=b&&(y=b[0],h=b[4],d=b[5]),e.shiftKey?(d=h=0,y=[],y=(m=luckysheet.formula.func_selectedrange).left>n?(h=n,d=m.left+m.width-n,m.column[1]>m.column_focus&&(m.column[1]=m.column_focus),[o,m.column[1]]):m.left==n?(h=n,d=m.left+m.width-n,[o,m.column[0]]):(h=m.left,d=s-m.left-1,m.column[0]<m.column_focus&&(m.column[0]=m.column_focus),[m.column[0],o]),null!=(b=luckysheet.menuButton.mergeMoveMain(y,[0,l],{row_focus:0,column_focus:o},0,r,h,d))&&(y=b[0],h=b[4],d=b[5]),m.column=y,m.left_move=h,m.width_move=d,luckysheet.formula.func_selectedrange=m):(e.ctrlKey&&","!=$("#luckysheet-rich-text-editor").find("span").last().text()&&(0<(g=$("#luckysheet-rich-text-editor").text()+",").length&&"="==g.substr(0,1)&&(g=luckysheet.formula.functionHTMLGenerate(g),window.getSelection?(k=window.getSelection(),luckysheet.formula.functionRangeIndex=[$(k.anchorNode).parent().index(),k.anchorOffset]):(p=document.selection.createRange(),luckysheet.formula.functionRangeIndex=p),$("#luckysheet-rich-text-editor").html(g),luckysheet.formula.canceFunctionrangeSelected(),luckysheet.formula.createRangeHightlight()),luckysheet.formula.rangestart=!1,luckysheet.formula.rangedrag_column_start=!1,luckysheet.formula.rangedrag_row_start=!1,$("#luckysheet-functionbox-cell").html(g),luckysheet.formula.rangeHightlightselected($("#luckysheet-rich-text-editor")),luckysheet.formula.israngeseleciton()),luckysheet.formula.func_selectedrange={left:h,width:d,top:luckysheet.rowLocationByIndex(0)[0],height:luckysheet.rowLocationByIndex(0)[1]-luckysheet.rowLocationByIndex(0)[0]-1,left_move:h,width_move:d,top_move:0,height_move:r-1,row:[0,l],column:y,row_focus:0,column_focus:o}),luckysheet.formula.rangestart||luckysheet.formula.rangedrag_column_start||luckysheet.formula.rangedrag_row_start||luckysheet.formula.israngeseleciton()?luckysheet.formula.rangeSetValue({row:[null,null],column:y}):$("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")&&(v=luckysheet.sheetmanage.getRangetxt(luckysheet.currentSheetIndex,{row:[0,l],column:y},luckysheet.currentSheetIndex),$("#luckysheet-ifFormulaGenerator-multiRange-dialog input").val(v)),luckysheet.formula.rangedrag_column_start=!0,luckysheet.formula.rangestart=!1,luckysheet.formula.rangedrag_row_start=!1,$("#luckysheet-formula-functionrange-select").css({left:h,width:d,top:0,height:r-1}).show(),$("#luckysheet-formula-help-c").hide(),void luckysheet.luckysheet_count_show(h,0,d,r-1,[0,l],y)}luckysheet.formula.updatecell(luckysheetCellUpdate[0],luckysheetCellUpdate[1]),luckysheet_cols_selected_status=!0}else luckysheet_cols_selected_status=!0;luckysheet_cols_selected_status&&(e.shiftKey?(d=h=0,y=[],y=(m=$.extend(!0,{},luckysheet_select_save[luckysheet_select_save.length-1])).left>n?(h=n,d=m.left+m.width-n,m.column[1]>m.column_focus&&(m.column[1]=m.column_focus),[o,m.column[1]]):m.left==n?(h=n,d=m.left+m.width-n,[o,m.column[0]]):(h=m.left,d=s-m.left-1,m.column[0]<m.column_focus&&(m.column[0]=m.column_focus),[m.column[0],o]),m.column=y,m.left_move=h,m.width_move=d,luckysheet_select_save[luckysheet_select_save.length-1]=m):e.ctrlKey?luckysheet_select_save.push({left:h,width:d,top:luckysheet.rowLocationByIndex(0)[0],height:luckysheet.rowLocationByIndex(0)[1]-luckysheet.rowLocationByIndex(0)[0]-1,left_move:h,width_move:d,top_move:0,height_move:r-1,row:[0,l],column:y,row_focus:0,column_focus:o}):(luckysheet_select_save=[]).push({left:h,width:d,top:luckysheet.rowLocationByIndex(0)[0],height:luckysheet.rowLocationByIndex(0)[1]-luckysheet.rowLocationByIndex(0)[0]-1,left_move:h,width_move:d,top_move:0,height_move:r-1,row:[0,l],column:y,row_focus:0,column_focus:o}),luckysheet.selectHightlightShow(),luckysheet.server.allowUpdate&&luckysheet.server.saveParam("mv",luckysheet.currentSheetIndex,luckysheet_select_save)),$("#luckysheet-helpbox-cell").text(luckysheet.sheetmanage.getRangetxt(luckysheet.currentSheetIndex,luckysheet_select_save[luckysheet_select_save.length-1])),setTimeout(function(){clearTimeout(jfcountfuncTimeout),jfcountfunc()},101),luckysheet_cols_menu_status&&($("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),luckysheet_cols_menu_status=!1),e.stopPropagation()}).mousemove(function(e){return luckysheet_cols_selected_status||luckysheet_select_status?($("#luckysheet-cols-h-hover").hide(),void $("#luckysheet-cols-menu-btn").hide()):void(luckysheet_cols_menu_status||luckysheet_cols_change_size||(t=mouseposition(e.pageX,e.pageY)[0]+$("#luckysheet-cols-h-c").scrollLeft(),r=(l=luckysheet.colLocation(t))[1],a=l[0],l[2],$("#luckysheet-cols-h-hover").css({left:a,width:r-a-1,display:"block"}),$("#luckysheet-cols-menu-btn").css({left:r-19,display:"block"}),$("#luckysheet-cols-change-size").css({left:r-5}),t<r&&r-5<=t?($("#luckysheet-cols-change-size").css({opacity:0}),$("#luckysheet-cols-menu-btn").hide()):($("#luckysheet-change-size-line").hide(),$("#luckysheet-cols-change-size").css("opacity",0))));var t,l,r,a}).mouseleave(function(e){luckysheet_cols_menu_status||luckysheet_cols_change_size||($("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),$("#luckysheet-cols-change-size").css("opacity",0))}).mouseup(function(e){if(3==e.which){if(luckysheet.isEditMode())return;luckysheetRightHeadClickIs="column",$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word").text("列"),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-size").text("宽"),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left").text("左"),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right").text("右"),$("#luckysheet-cols-rows-add").show(),$("#luckysheet-cols-rows-data").show(),$("#luckysheet-cols-rows-shift").hide(),showrightclickmenu($("#luckysheet-rightclick-menu"),e.pageX,$(this).offset().top+18),luckysheet_cols_menu_status=!0;var t=$.extend(!0,{},config);null==t.columlen&&(t.columlen={});for(var l=null==t.columlen[luckysheet_select_save[0].column[0]]?luckysheet.defaultcollen:t.columlen[luckysheet_select_save[0].column[0]],r=!0,a=0;a<luckysheet_select_save.length;a++)for(var s=luckysheet_select_save[a],n=s.column[0],o=s.column[1],c=n;c<=o;c++){if((null==t.columlen[c]?luckysheet.defaultcollen:t.columlen[c])!=l){r=!1;break}}r?$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val(l):$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val("")}});var luckysheet_cols_change_size=!1,luckysheet_cols_change_size_start=[],luckysheet_cols_dbclick_timeout=null,luckysheet_cols_dbclick_times=0;function luckysheetcolsdbclick(){luckysheet_cols_change_size=!1,$("#luckysheet-change-size-line").hide(),$("#luckysheet-cols-change-size").css("opacity",0),$("#luckysheet-sheettable, #luckysheet-cols-h-c, .luckysheet-cols-h-cells, .luckysheet-cols-h-cells canvas").css("cursor","default");var e=mouseposition(event.pageX,event.pageY),t=$("#luckysheet-cols-h-c").scrollLeft(),l=e[0]+t,r=$(window).width(),a=visibledatarow.length-1,s=(visibledatarow[a],luckysheet.colLocation(l)),n=(s[1],s[0]),o=s[2];luckysheet_cols_change_size_start=[n,o];for(var c=$("#luckysheetTableContent").get(0).getContext("2d"),u=$.extend(!0,{},config),i={},h=0;h<luckysheet_select_save.length;h++){var d=luckysheet_select_save[h].column[0],y=luckysheet_select_save[h].column[1];if(o<d||y<o){if(o in i)continue;l=-1/0;for(var f=0,m=13,k=0;k<luckysheet.flowdata.length&&!(15<=f);k++){var p=luckysheet.getcellvalue(k,luckysheet_cols_change_size_start[1],luckysheet.flowdata),g=luckysheet.getcellvalue(k,luckysheet_cols_change_size_start[1],luckysheet.flowdata,"m");null!=g&&(p=g);var v=luckysheet.flowdata[k][luckysheet_cols_change_size_start[1]];"object"==luckysheet.getObjType(v)&&"fs"in v&&v.fs>m&&(m=v.fs),null!=p&&0!=p.toString().length?l<(w=c.measureText(p).width)&&(l=w):f++}var b=r-100+t<=l?r-100+t:l+3<30?30:l+1.5*m;null==u.columlen&&(u.columlen={}),u.columlen[luckysheet_cols_change_size_start[1]]=Math.ceil(b),i[o]=1}else for(var _=d;_<=y;_++)if(!(_ in i)){l=-1/0;for(f=0,m=13,k=0;k<luckysheet.flowdata.length&&!(15<=f);k++){var w,p=luckysheet.getcellvalue(k,_,luckysheet.flowdata),v=luckysheet.flowdata[k][_];"object"==luckysheet.getObjType(v)&&"fs"in v&&v.fs>m&&(m=v.fs),luckysheet.func_methods.isRealNull(p)?f++:l<(w=c.measureText(p).width)&&(l=w)}b=r-100+t<=l?r-100+t:l+3<30?30:l+1.5*m;null==u.columlen&&(u.columlen={}),u.columlen[_]=Math.ceil(b),i[_]=1}}luckysheet.jfrefreshgridall(luckysheet.flowdata[0].length,luckysheet.flowdata.length,luckysheet.flowdata,u,luckysheet_select_save,"resizeC","columlen")}$("#luckysheet-cols-change-size").mousedown(function(e){luckysheet.postil.removeActivePs(),$("#luckysheet-input-box").hide(),$("#luckysheet-cols-change-size").css({opacity:1});var t=mouseposition(e.pageX,e.pageY),l=$("#luckysheet-cols-h-c").scrollLeft(),r=$("#luckysheet-cell-main").scrollTop(),a=$("#luckysheet-cell-main").height(),s=t[0]+l,n=visibledatarow.length-1,o=(visibledatarow[n],luckysheet.colLocation(s)),c=o[1],u=o[0],i=o[2];luckysheet_scroll_status=luckysheet_cols_change_size=!0,$("#luckysheet-change-size-line").css({height:a+r,"border-width":"0 1px 0 0",top:0,left:c-3,width:"1px",display:"block",cursor:"ew-resize"}),$("#luckysheet-sheettable, #luckysheet-cols-h-c, .luckysheet-cols-h-cells, .luckysheet-cols-h-cells canvas").css("cursor","ew-resize"),luckysheet_cols_change_size_start=[u,i],$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),luckysheet_cols_dbclick_times=0,e.stopPropagation()}).dblclick(function(){luckysheetcolsdbclick()});var luckysheet_rows_change_size=!1,luckysheet_rows_change_size_start=[];$("#luckysheet-rows-change-size").mousedown(function(e){luckysheet.postil.removeActivePs(),$("#luckysheet-input-box").hide(),$("#luckysheet-rows-change-size").css({opacity:1});var t=mouseposition(e.pageX,e.pageY)[1]+$("#luckysheet-rows-h").scrollTop(),l=$("#luckysheet-cell-main").scrollLeft(),r=$("#luckysheet-cell-main").width(),a=luckysheet.rowLocation(t),s=a[1],n=a[0],o=a[2];luckysheet_scroll_status=luckysheet_rows_change_size=!0,$("#luckysheet-change-size-line").css({height:"1px","border-width":"0 0px 1px 0",top:s-3,left:0,width:l+r,display:"block",cursor:"ns-resize"}),$("#luckysheet-sheettable, #luckysheet-rows-h, #luckysheet-rows-h canvas").css("cursor","ns-resize"),luckysheet_rows_change_size_start=[n,o],$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-rows-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),e.stopPropagation()}),window.luckysheet_cols_menu_status=!1,$("#luckysheet-cols-menu-btn").click(function(e){var t=$("#luckysheet-rightclick-menu"),l=$(this).offset();$("#luckysheet-cols-rows-shift").show(),luckysheetRightHeadClickIs="column",$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word").text("列"),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left").text("左"),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right").text("右"),$("#luckysheet-cols-rows-add").show(),$("#luckysheet-cols-rows-data").hide(),$("#luckysheet-cols-rows-shift").show(),showrightclickmenu(t,l.left,l.top+18),luckysheet_cols_menu_status=!0});var orderbyindex=0;$("#luckysheetorderbyasc, #luckysheetorderbyasc_t").mousedown(function(e){luckysheet.cleargridelement(e),luckysheet.sortColumnSeletion(orderbyindex,!0),luckysheet.selectHightlightShow()}),$("#luckysheetorderbydesc, #luckysheetorderbydesc_t").click(function(e){luckysheet.cleargridelement(e),luckysheet.sortColumnSeletion(orderbyindex,!1),luckysheet.selectHightlightShow()}),$("#luckysheet-copy-json-head").click(function(e){if($("body .luckysheet-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<luckysheet_select_save.length)luckysheet.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{if(null!=config.merge){for(var t=!1,l=0;l<luckysheet_select_save.length;l++){var r=luckysheet_select_save[l].row[0],a=luckysheet_select_save[l].row[1],s=luckysheet_select_save[l].column[0],n=luckysheet_select_save[l].column[1];if(t=luckysheet.hasPartMC(config,r,a,s,n))break}if(t)return void(luckysheet.isEditMode()?alert("无法对部分合并单元格执行此操作"):luckysheet.tooltip.info("无法对部分合并单元格执行此操作",""))}var o=luckysheet.getdatabyselection(luckysheet_select_save[0]),c=[];if(0!=o.length){if(1==o.length){for(var u={},i=0;i<o[0].length;i++)u[luckysheet.getcellvalue(0,i,o)]="";c.push(u)}else for(var h=1;h<o.length;h++){for(var u={},d=0;d<o[0].length;d++)null==luckysheet.getcellvalue(0,d,o)?u[""]=luckysheet.getcellvalue(h,d,o):u[luckysheet.getcellvalue(0,d,o)]=luckysheet.getcellvalue(h,d,o);c.push(u)}luckysheet.selection.copybyformat(e,JSON.stringify(c))}}}),$("#luckysheet-copy-json-nohead").click(function(e){if($("body .luckysheet-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<luckysheet_select_save.length)luckysheet.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{if(null!=config.merge){for(var t=!1,l=0;l<luckysheet_select_save.length;l++){var r=luckysheet_select_save[l].row[0],a=luckysheet_select_save[l].row[1],s=luckysheet_select_save[l].column[0],n=luckysheet_select_save[l].column[1];if(t=luckysheet.hasPartMC(config,r,a,s,n))break}if(t)return void(luckysheet.isEditMode()?alert("无法对部分合并单元格执行此操作"):luckysheet.tooltip.info("无法对部分合并单元格执行此操作",""))}var o=luckysheet.getdatabyselection(luckysheet_select_save[0]),c=[];if(0!=o.length){for(var u=luckysheet_select_save[0].column[0],i=0;i<o.length;i++){for(var h={},d=0;d<o[0].length;d++)h[luckysheet.luckysheetchatatABC(d+u)]=luckysheet.getcellvalue(i,d,o);c.push(h)}luckysheet.selection.copybyformat(e,JSON.stringify(c))}}}),$("#luckysheet-copy-array1").click(function(e){if($("body .luckysheet-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<luckysheet_select_save.length)luckysheet.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{if(null!=config.merge){for(var t=!1,l=0;l<luckysheet_select_save.length;l++){var r=luckysheet_select_save[l].row[0],a=luckysheet_select_save[l].row[1],s=luckysheet_select_save[l].column[0],n=luckysheet_select_save[l].column[1];if(t=luckysheet.hasPartMC(config,r,a,s,n))break}if(t)return void(luckysheet.isEditMode()?alert("无法对部分合并单元格执行此操作"):luckysheet.tooltip.info("无法对部分合并单元格执行此操作",""))}var o=luckysheet.getdatabyselection(luckysheet_select_save[0]),c=[];if(0!=o.length){for(var u=0;u<o.length;u++)for(var i=0;i<o[0].length;i++)c.push(luckysheet.getcellvalue(u,i,o));luckysheet.selection.copybyformat(e,JSON.stringify(c))}}}),$("#luckysheet-copy-array2").click(function(e){if($("body .luckysheet-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<luckysheet_select_save.length)luckysheet.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{if(null!=config.merge){for(var t=!1,l=0;l<luckysheet_select_save.length;l++){var r=luckysheet_select_save[l].row[0],a=luckysheet_select_save[l].row[1],s=luckysheet_select_save[l].column[0],n=luckysheet_select_save[l].column[1];if(t=luckysheet.hasPartMC(config,r,a,s,n))break}if(t)return void(luckysheet.isEditMode()?alert("无法对部分合并单元格执行此操作"):luckysheet.tooltip.info("无法对部分合并单元格执行此操作",""))}var o=luckysheet.getdatabyselection(luckysheet_select_save[0]),c=[];if(0!=o.length){for(var u=0;u<o.length;u++){for(var i=[],h=0;h<o[0].length;h++)i.push(luckysheet.getcellvalue(u,h,o));c.push(i)}luckysheet.selection.copybyformat(e,JSON.stringify(c))}}}),$("#luckysheet-copy-arraymore-confirm").click(function(e){if($("body .luckysheet-cols-menu").hide(),1<luckysheet_select_save.length)luckysheet.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{if(null!=config.merge){for(var t=!1,l=0;l<luckysheet_select_save.length;l++){var r=luckysheet_select_save[l].row[0],a=luckysheet_select_save[l].row[1],s=luckysheet_select_save[l].column[0],n=luckysheet_select_save[l].column[1];if(t=luckysheet.hasPartMC(config,r,a,s,n))break}if(t)return void(luckysheet.isEditMode()?alert("无法对部分合并单元格执行此操作"):luckysheet.tooltip.info("无法对部分合并单元格执行此操作",""))}var o=luckysheet.getdatabyselection(luckysheet_select_save[0]),c=[];if(0!=o.length){for(var u=0;u<o.length;u++)for(var i=0;i<o[0].length;i++)c.push(o[u][i]);var h=$("#luckysheet-copy-arraymore-row").val(),d=$("#luckysheet-copy-arraymore-col").val();if(""==h&&""==d)return luckysheet.selection.copybyformat(e,JSON.stringify(c)),void $("body .luckysheet-cols-menu").hide();if((""==h||null==(h=parseInt(h)))&&(h=1),""!=d&&null!=(d=parseInt(d))||(d=1),"NaN"!=h.toString()&&"NaN"!=d.toString())if(h<1||d<1)luckysheet.isEditMode()?alert("行列数不能小于1!"):luckysheet.tooltip.info("行列数不能小于1!","");else{for(var y=c.length,f=0,m=[],u=0;u<h;u++){for(var k=[],i=0;i<d;i++)if(k.push(c[f++]),y<=f)return luckysheet.selection.copybyformat(e,JSON.stringify(m)),void $("body .luckysheet-cols-menu").hide();m.push(k)}luckysheet.selection.copybyformat(e,JSON.stringify(m))}else luckysheet.isEditMode()?alert("请输入正确的数值!"):luckysheet.tooltip.info("请输入正确的数值!","")}}}),$("#luckysheet-copy-diagonal").click(function(e){if($("body .luckysheet-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<luckysheet_select_save.length)luckysheet.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{if(null!=config.merge){for(var t=!1,l=0;l<luckysheet_select_save.length;l++){var r=luckysheet_select_save[l].row[0],a=luckysheet_select_save[l].row[1],s=luckysheet_select_save[l].column[0],n=luckysheet_select_save[l].column[1];if(t=luckysheet.hasPartMC(config,r,a,s,n))break}if(t)return void(luckysheet.isEditMode()?alert("无法对部分合并单元格执行此操作"):luckysheet.tooltip.info("无法对部分合并单元格执行此操作",""))}var o=luckysheet.getdatabyselection(luckysheet_select_save[0]),c=[];if(0!=o.length){for(var u=o[0].length,i=0;i<o.length&&!(u<=i);i++)c.push(o[i][i]);luckysheet.selection.copybyformat(e,JSON.stringify(c)),copyType="diagonal",copysetting=[]}}}),$("#luckysheet-copy-antidiagonal").click(function(e){if($("body .luckysheet-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<luckysheet_select_save.length)luckysheet.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{if(null!=config.merge){for(var t=!1,l=0;l<luckysheet_select_save.length;l++){var r=luckysheet_select_save[l].row[0],a=luckysheet_select_save[l].row[1],s=luckysheet_select_save[l].column[0],n=luckysheet_select_save[l].column[1];if(t=luckysheet.hasPartMC(config,r,a,s,n))break}if(t)return void(luckysheet.isEditMode()?alert("无法对部分合并单元格执行此操作"):luckysheet.tooltip.info("无法对部分合并单元格执行此操作",""))}var o=luckysheet.getdatabyselection(luckysheet_select_save[0]),c=[];if(0!=o.length){for(var u=o[0].length,i=0;i<o.length&&!(u<=i);i++)c.push(o[i][u-i-1]);luckysheet.selection.copybyformat(e,JSON.stringify(c)),copyType="antidiagonal",copysetting=[]}}}),$("#luckysheet-copy-diagonaloffset").click(function(e){if($("body .luckysheet-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<luckysheet_select_save.length)luckysheet.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{if(null!=config.merge){for(var t=!1,l=0;l<luckysheet_select_save.length;l++){var r=luckysheet_select_save[l].row[0],a=luckysheet_select_save[l].row[1],s=luckysheet_select_save[l].column[0],n=luckysheet_select_save[l].column[1];if(t=luckysheet.hasPartMC(config,r,a,s,n))break}if(t)return void(luckysheet.isEditMode()?alert("无法对部分合并单元格执行此操作"):luckysheet.tooltip.info("无法对部分合并单元格执行此操作",""))}var o=luckysheet.getdatabyselection(luckysheet_select_save[0]),c=[];if(0!=o.length){var u=o[0].length,i=parseInt($("#luckysheet-copy-diagonaloffset-value").val());if("NaN"!=i.toString())if(i<0)luckysheet.isEditMode()?alert("偏移列不能为负数！"):luckysheet.tooltip.info("偏移列不能为负数！","");else{null==i&&(i=1);for(var u=o[0].length,h=0;h<o.length&&!(u<=h+i);h++)c.push(o[h][h+i]);luckysheet.selection.copybyformat(e,JSON.stringify(c)),copyType="diagonaloffset",copysetting=[i]}else luckysheet.isEditMode()?alert("请输入正确的数值！"):luckysheet.tooltip.info("请输入正确的数值！","")}}}),$("#luckysheet-copy-boolvalue").click(function(e){if($("body .luckysheet-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<luckysheet_select_save.length)luckysheet.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{if(null!=config.merge){for(var t=!1,l=0;l<luckysheet_select_save.length;l++){var r=luckysheet_select_save[l].row[0],a=luckysheet_select_save[l].row[1],s=luckysheet_select_save[l].column[0],n=luckysheet_select_save[l].column[1];if(t=luckysheet.hasPartMC(config,r,a,s,n))break}if(t)return void(luckysheet.isEditMode()?alert("无法对部分合并单元格执行此操作"):luckysheet.tooltip.info("无法对部分合并单元格执行此操作",""))}var o=luckysheet.getdatabyselection(luckysheet_select_save[0]),c=[];if(0!=o.length){for(var u=0;u<o.length;u++){for(var i=[],h=0;h<o[0].length;h++){var d,y=!1,y=null!=(d="object"==luckysheet.getObjType(o[u][h])?o[u][h].v:o[u][h])&&""!=d&&(null==(d=parseInt(d))||0<d);i.push(y)}c.push(i)}luckysheet.selection.copybyformat(e,JSON.stringify(c)),copyType="boolvalue",copysetting=[]}}}),$("#luckysheet-matrix-turn-up").click(function(e){if($("body .luckysheet-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<luckysheet_select_save.length)luckysheet.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{var t=luckysheet.getdatabyselection(luckysheet_select_save[0]);if(0!=t.length){for(var l=[],r=t.length-1;0<=r;r--){for(var a=[],s=0;s<t[0].length;s++){var n="";null!=t[r]&&null!=t[r][s]&&(n=t[r][s]),a.push(n)}l.push(a)}luckysheet.editor.controlHandler(l)}}}),$("#luckysheet-matrix-turn-left").click(function(e){if($("body .luckysheet-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<luckysheet_select_save.length)luckysheet.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{var t=luckysheet.getdatabyselection(luckysheet_select_save[0]);if(0!=t.length){for(var l=[],r=0;r<t.length;r++){for(var a=[],s=t[0].length-1;0<=s;s--){var n="";null!=t[r]&&null!=t[r][s]&&(n=t[r][s]),a.push(n)}l.push(a)}luckysheet.editor.controlHandler(l)}}}),$("#luckysheet-matrix-turn-cw").click(function(e){if($("body .luckysheet-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<luckysheet_select_save.length)luckysheet.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{var t=luckysheet.getdatabyselection(luckysheet_select_save[0]);if(0!=t.length){for(var l=[],r=0;r<t[0].length;r++){for(var a=[],s=t.length-1;0<=s;s--){var n="";null!=t[s]&&null!=t[s][r]&&(n=t[s][r]),a.push(n)}l.push(a)}luckysheet.editor.controlHandlerD(l)}}}),$("#luckysheet-matrix-turn-anticw").click(function(e){if($("body .luckysheet-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<luckysheet_select_save.length)luckysheet.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{var t=luckysheet.getdatabyselection(luckysheet_select_save[0]);if(0!=t.length){for(var l=[],r=t[0].length-1;0<=r;r--){for(var a=[],s=0;s<t.length;s++){var n="";null!=t[s]&&null!=t[s][r]&&(n=t[s][r]),a.push(n)}l.push(a)}luckysheet.editor.controlHandlerD(l)}}}),$("#luckysheet-matrix-turn-trans").click(function(e){if($("body .luckysheet-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<luckysheet_select_save.length)luckysheet.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{var t=luckysheet.getdatabyselection(luckysheet_select_save[0]);if(0!=t.length){for(var l=[],r=0;r<t[0].length;r++){for(var a=[],s=0;s<t.length;s++){var n="";null!=t[s]&&null!=t[s][r]&&(n=t[s][r]),a.push(n)}l.push(a)}luckysheet.editor.controlHandlerD(l)}}});var jfnqrt=function(e,t){if(0==e)return 0;for(var l=e,r=(t-1)*l/t+e/(Math.pow(l,t-1)*t);1e-6<Math.abs(r-l);)r=(t-1)*(l=r)/t+e/(Math.pow(l,t-1)*t);return r};$("#luckysheet-matrix-cal-confirm").click(function(e){if($("body .luckysheet-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<luckysheet_select_save.length)luckysheet.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{var t=luckysheet.getdatabyselection(luckysheet_select_save[0]);if(0!=t.length){var l=$("#luckysheet-matrix-cal-type").val(),r=parseInt($("#luckysheet-matrix-cal-value").val());if("NaN"!=r.toString()){null==r&&(r=2);for(var a=[],s=0;s<t.length;s++){for(var n=[],o=0;o<t[0].length;o++){var c="";null!=t[s]&&null!=t[s][o]&&(c=t[s][o],null!=parseInt(c)&&null!=t[s][o].ct&&"n"==t[s][o].ct.t&&("minus"==l?c.v=c.v-r:"multiply"==l?c.v=c.v*r:"divided"==l?c.v=luckysheet.numFormat(c.v/r,4):"power"==l?c.v=Math.pow(c.v,r):"root"==l?2==r?c.v=luckysheet.numFormat(Math.sqrt(c.v),4):3==r&&Math.cbrt?c.v=luckysheet.numFormat(Math.cbrt(c.v),4):c.v=luckysheet.numFormat(jfnqrt(c.v,r),4):c.v="log"==l?luckysheet.numFormat(1e4*Math.log(c.v)/Math.log(Math.abs(r)),4):c.v+r,null==c.v?c.m="":c.m=c.v.toString())),n.push(c)}a.push(n)}luckysheet.editor.controlHandler(a)}else luckysheet.isEditMode()?alert("请输入正确的数值！"):luckysheet.tooltip.info("请输入正确的数值！","")}}}),$("#luckysheet-matrix-delezero-row").click(function(e){if($("body .luckysheet-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<luckysheet_select_save.length)luckysheet.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{var t=luckysheet.getdatabyselection(luckysheet_select_save[0]);if(0!=t.length){for(var l=[],r=t[0].length,a=0;a<t.length;a++){for(var s=[],n=!0,o=!0,c=0;c<r;c++){var u="";if(null!=t[a]&&null!=t[a][c]){if(("0"==(u=t[a][c]).v||0==u.v)&&n)continue;n=!1}s.push(u)}var i=[];if(s.length==r)i=s;else{for(c=s.length-1;0<=c;c--){u="";if(null!=s[c]){if(("0"==(u=s[c]).v||0==u.v)&&o)continue;o=!1}i.unshift(u)}for(var h=r-i.length,d=0;d<h;d++)i.push("")}l.push(i)}luckysheet.editor.controlHandler(l)}}}),$("#luckysheet-matrix-delezero-column").click(function(e){if($("body .luckysheet-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<luckysheet_select_save.length)luckysheet.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{var t=luckysheet.getdatabyselection(luckysheet_select_save[0]);if(0!=t.length){for(var l=[],r=t.length,a=t[0].length,s=0;s<a;s++){for(var n=[],o=!0,c=!0,u=0;u<r;u++){var i="";if(null!=t[u]&&null!=t[u][s]){if(("0"==(i=t[u][s]).v||0==i.v)&&o)continue;o=!1}n.push(i)}var h=[];if(n.length==r)h=n;else{for(u=n.length-1;0<=u;u--){i="";if(null!=n[u]){if(("0"==(i=n[u]).v||0==i.v)&&c)continue;c=!1}h.unshift(i)}for(var d=r-h.length,y=0;y<d;y++)h.push("")}l.push(h)}for(var f=[],s=0;s<l[0].length;s++){for(n=[],u=0;u<l.length;u++){i="";null!=l[u]&&null!=l[u][s]&&(i=l[u][s]),n.push(i)}f.push(n)}luckysheet.editor.controlHandler(f)}}}),$("#luckysheet-matrix-delerpt-row").click(function(e){if($("body .luckysheet-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<luckysheet_select_save.length)luckysheet.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{var t=luckysheet.getdatabyselection(luckysheet_select_save[0]);if(0!=t.length){for(var l=[],r=t[0].length,a=0;a<t.length;a++){for(var s=[],n={},o=0;o<r;o++){var c=null;null!=t[a]&&null!=t[a][o]&&((c=t[a][o]).v in n||(n[c.v]=[]),n[c.v].push(c))}for(o=0;o<r;o++){c=null;null!=t[a]&&null!=t[a][o]&&1==n[(c=t[a][o]).v].length&&s.push(c)}for(var u=r-s.length,i=0;i<u;i++)s.push(null);l.push(s)}luckysheet.editor.controlHandler(l)}}}),$("#luckysheet-matrix-delerpt-column").click(function(e){if($("body .luckysheet-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<luckysheet_select_save.length)luckysheet.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{var t=luckysheet.getdatabyselection(luckysheet_select_save[0]);if(0!=t.length){for(var l=[],r=t.length,a=t[0].length,s=0;s<a;s++){for(var n=[],o={},c=0;c<r;c++){var u=null;null!=t[c]&&null!=t[c][s]&&((u=t[c][s]).v in o||(o[u.v]=[]),o[u.v].push(u))}for(c=0;c<r;c++){u=null;null!=t[c]&&null!=t[c][s]&&1==o[(u=t[c][s]).v].length&&n.push(u)}a1=n;for(var i=r-a1.length,h=0;h<i;h++)a1.push(null);l.push(a1)}for(var d=[],s=0;s<l[0].length;s++){for(n=[],c=0;c<l.length;c++){u=null;null!=l[c]&&null!=l[c][s]&&(u=l[c][s]),n.push(u)}d.push(n)}luckysheet.editor.controlHandler(d)}}}),$("#luckysheet-icon-undo").click(function(e){luckysheet.controlHistory.redo(e)}),$("#luckysheet-icon-redo").click(function(e){luckysheet.controlHistory.undo(e)});var isInitialSheetConfig=!1,luckysheetcurrentSheetitem=null,jfdbclicklagTimeout=null;function showsheetconfigmenu(){isInitialSheetConfig||(isInitialSheetConfig=!0,$("#luckysheetsheetconfigcolorur").spectrum({showPalette:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!1,showSelectionPalette:!0,maxPaletteSize:10,cancelText:"取消",chooseText:"确定颜色",togglePaletteMoreText:"更多",togglePaletteLessText:"少于",clearText:"清除颜色选择",noColorSelectedText:"没有颜色被选择",palette:[["rgb(0, 0, 0)","rgb(67, 67, 67)","rgb(102, 102, 102)","rgb(204, 204, 204)","rgb(217, 217, 217)","rgb(255, 255, 255)"],["rgb(152, 0, 0)","rgb(255, 0, 0)","rgb(255, 153, 0)","rgb(255, 255, 0)","rgb(0, 255, 0)","rgb(0, 255, 255)","rgb(74, 134, 232)","rgb(0, 0, 255)","rgb(153, 0, 255)","rgb(255, 0, 255)"],["rgb(230, 184, 175)","rgb(244, 204, 204)","rgb(252, 229, 205)","rgb(255, 242, 204)","rgb(217, 234, 211)","rgb(208, 224, 227)","rgb(201, 218, 248)","rgb(207, 226, 243)","rgb(217, 210, 233)","rgb(234, 209, 220)"],["rgb(221, 126, 107)","rgb(234, 153, 153)","rgb(249, 203, 156)","rgb(255, 229, 153)","rgb(182, 215, 168)","rgb(162, 196, 201)","rgb(164, 194, 244)","rgb(159, 197, 232)","rgb(180, 167, 214)","rgb(213, 166, 189)"],["rgb(204, 65, 37)","rgb(224, 102, 102)","rgb(246, 178, 107)","rgb(255, 217, 102)","rgb(147, 196, 125)","rgb(118, 165, 175)","rgb(109, 158, 235)","rgb(111, 168, 220)","rgb(142, 124, 195)","rgb(194, 123, 160)"],["rgb(166, 28, 0)","rgb(204, 0, 0)","rgb(230, 145, 56)","rgb(241, 194, 50)","rgb(106, 168, 79)","rgb(69, 129, 142)","rgb(60, 120, 216)","rgb(61, 133, 198)","rgb(103, 78, 167)","rgb(166, 77, 121)"],["rgb(91, 15, 0)","rgb(102, 0, 0)","rgb(120, 63, 4)","rgb(127, 96, 0)","rgb(39, 78, 19)","rgb(12, 52, 61)","rgb(28, 69, 135)","rgb(7, 55, 99)","rgb(32, 18, 77)","rgb(76, 17, 48)"],["#c1232b","#27727b","#fcce10","#e87c25","#b5c334","#fe8463","#9bca63","#fad860","#f3a43b","#60c0dd","#d7504b","#c6e579","#f4e001","#f0805a","#26c0c0","#c12e34","#e6b600","#0098d9","#2b821d","#005eaa","#339ca8","#cda819","#32a487","#3fb1e3","#6be6c1","#626c91","#a0a7e6","#c4ebad","#96dee8"]],change:function(e){$(this);e=null!=e?e.toHexString():"rgb(0, 0, 0)";var t=null;0<luckysheetcurrentSheetitem.find(".luckysheet-sheets-item-color").length&&(t=luckysheetcurrentSheetitem.find(".luckysheet-sheets-item-color").css("background-color")),luckysheetcurrentSheetitem.find(".luckysheet-sheets-item-color").remove(),luckysheetcurrentSheetitem.append('<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+e+';"></div>');var l,r=luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex);luckysheetfile[r].color=e,luckysheet.server.saveParam("all",luckysheet.currentSheetIndex,e,{k:"color"}),clearjfundo&&((l={type:"sheetColor"}).sheetIndex=luckysheet.currentSheetIndex,l.oldcolor=t,l.color=e,luckysheet.jfundo=[],luckysheet.jfredo.push(l))}}),$("#luckysheetsheetconfigcolorreset").click(function(){var e=null;0<luckysheetcurrentSheetitem.find(".luckysheet-sheets-item-color").length&&(e=luckysheetcurrentSheetitem.find(".luckysheet-sheets-item-color").css("background-color")),luckysheetcurrentSheetitem.find(".luckysheet-sheets-item-color").remove();var t,l=luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex);luckysheetfile[l].color=null,luckysheet.server.saveParam("all",luckysheet.currentSheetIndex,null,{k:"color"}),clearjfundo&&((t={type:"sheetColor"}).sheetIndex=luckysheet.currentSheetIndex,t.oldcolor=e,t.color=null,luckysheet.jfundo=[],luckysheet.jfredo.push(t))}));var e=luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex);null!=luckysheetfile[e].color&&0<luckysheetfile[e].color.length&&$("#luckysheetsheetconfigcolorur").spectrum("set",luckysheetfile[e].color),$("#luckysheetsheetconfigcolorur").parent().find("span, div, button, input, a").addClass("luckysheet-mousedown-cancel"),setTimeout(function(){mouseclickposition($("#luckysheet-rightclick-sheet-menu"),luckysheetcurrentSheetitem.offset().left+luckysheetcurrentSheetitem.width(),luckysheetcurrentSheetitem.offset().top-18,"leftbottom")},1)}var luckysheetsheetrightclick=function(e,t,l){clearTimeout(jfdbclicklagTimeout),t.hasClass("luckysheet-sheets-item-name")&&"true"==t.attr("contenteditable")||(luckysheet.formula.rangestart||luckysheet.formula.rangedrag_column_start||luckysheet.formula.rangedrag_row_start||luckysheet.formula.israngeseleciton()?setTimeout(function(){luckysheet.formula.setCaretPosition(luckysheet.formula.rangeSetValueTo.get(0),0,luckysheet.formula.rangeSetValueTo.text().length),luckysheet.formula.createRangeHightlight(),$("#luckysheet-input-box-index").find(".luckysheet-input-box-index-sheettxt").remove().end().prepend("<span class='luckysheet-input-box-index-sheettxt'>"+luckysheet.sheetmanage.getSheetName(luckysheet.formula.rangetosheet)+"!</span>").show(),$("#luckysheet-input-box-index").css({left:$("#luckysheet-input-box").css("left"),top:parseInt($("#luckysheet-input-box").css("top"))-20+"px","z-index":$("#luckysheet-input-box").css("z-index")})},1):($("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight").remove()),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),e.addClass("luckysheet-sheets-item-active"),luckysheet.cleargridelement(l),luckysheet.sheetmanage.changeSheet(e.data("index")),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide(),(t.hasClass("luckysheet-sheets-item-menu")||t.hasClass("fa-sort-desc")||"3"==l.which)&&(luckysheetcurrentSheetitem=t.closest(".luckysheet-sheets-item"),luckysheet.isEditMode()||showsheetconfigmenu()))};$("#luckysheet-sheet-area").on("mousedown","div.luckysheet-sheets-item",function(l){if(!luckysheet.isEditMode()){var e=$(this),r=$(l.target),a=r.closest(".luckysheet-sheets-item");if("3"==l.which)return luckysheetsheetrightclick(e,r,l),luckysheetcurrentSheetitem=a,void showsheetconfigmenu();a.hasClass("luckysheet-sheets-item-active")&&"false"==a.find(".luckysheet-sheets-item-name").attr("contenteditable")&&(jfdbclicklagTimeout=setTimeout(function(){luckysheet_sheet_move_status=!0,luckysheet_sheet_move_data={widthlist:[]},$("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").each(function(e){0==e?luckysheet_sheet_move_data.widthlist.push(parseInt($(this).outerWidth())):luckysheet_sheet_move_data.widthlist.push(parseInt($(this).outerWidth())+luckysheet_sheet_move_data.widthlist[e-1])}),luckysheet_sheet_move_data.curindex=$("#luckysheet-sheet-area div.luckysheet-sheets-item").index(a);var e=l.pageX;luckysheet_sheet_move_data.curleft=e-a.offset().left,luckysheet_sheet_move_data.pageX=e,luckysheet_sheet_move_data.activeobject=a,luckysheet_sheet_move_data.cursorobject=r;var t=a.clone().css("visibility","hidden").attr("id","luckysheet-sheets-item-clone");a.after(t),a.css({position:"absolute",opacity:.8,cursor:"move",transition:"initial","z-index":10})},200))}}).on("click","div.luckysheet-sheets-item",function(e){luckysheet.isEditMode();var t=$(this),l=$(e.target);luckysheetsheetrightclick(t,l,e)});var luckysheetsheetnameeditor=function(t){t.attr("contenteditable","true").addClass("luckysheet-mousedown-cancel").data("oldtxt",t.text()),setTimeout(function(){var e;document.selection?((e=document.body.createTextRange()).moveToElementText(t.get(0)),e.select()):window.getSelection&&((e=document.createRange()).selectNodeContents(t.get(0)),window.getSelection().removeAllRanges(),window.getSelection().addRange(e))},1)};$("#luckysheet-sheet-area").on("dblclick","span.luckysheet-sheets-item-name",function(e){luckysheetsheetnameeditor($(this))}),$("#luckysheet-sheet-area").on("blur","span.luckysheet-sheets-item-name",function(e){for(var t=$(this),l=t.text(),r=t.data("oldtxt"),a=luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex),s=0;s<luckysheetfile.length;s++)if(a!=s&&luckysheetfile[s].name==l)return luckysheet.isEditMode()?alert("标签页的名称不能重复！请重新修改"):luckysheet.tooltip.info("提示","标签页的名称不能重复！请重新修改"),void t.text(r).attr("contenteditable","false");var n,o=$(window).width(),c=0;$("#luckysheet-sheet-container-c > div.luckysheet-sheets-item:visible").each(function(){c+=$(this).outerWidth()}),.7*o<=c&&($("#luckysheet-sheet-area .luckysheet-sheets-scroll").css("display","inline-block"),$("#luckysheet-sheet-container .docs-sheet-fade-left").show()),luckysheetfile[a].name=l,luckysheet.server.saveParam("all",luckysheet.currentSheetIndex,l,{k:"name"}),t.attr("contenteditable","false").removeClass("luckysheet-mousedown-cancel"),clearjfundo&&((n={type:"sheetName"}).sheetIndex=luckysheet.currentSheetIndex,n.oldtxt=r,n.txt=l,luckysheet.jfundo=[],luckysheet.jfredo.push(n))}),$("#luckysheet-sheet-area").on("keydown","span.luckysheet-sheets-item-name",function(e){var t,l=e.keyCode,r=$(this);l==keycode.ENTER&&(t=luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex),luckysheetfile[t].name=r.text(),r.attr("contenteditable","false"))}),$("#luckysheetsheetconfigrename").click(function(){luckysheetsheetnameeditor(luckysheetcurrentSheetitem.find("span.luckysheet-sheets-item-name")),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide()}),$("#luckysheetsheetconfigshow").click(function(){$("#luckysheet-sheets-m").click(),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-rightclick-sheet-menu").hide()}),$("#luckysheetsheetconfigmoveleft").click(function(){0<luckysheetcurrentSheetitem.prevAll(":visible").length&&(luckysheetcurrentSheetitem.insertBefore(luckysheetcurrentSheetitem.prevAll(":visible").eq(0)),luckysheet.sheetmanage.reOrderAllSheet()),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide()}),$("#luckysheetsheetconfigmoveright").click(function(){0<luckysheetcurrentSheetitem.nextAll(":visible").length&&(luckysheetcurrentSheetitem.insertAfter(luckysheetcurrentSheetitem.nextAll(":visible").eq(0)),luckysheet.sheetmanage.reOrderAllSheet()),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide()}),$("#luckysheetsheetconfigdelete").click(function(e){var t;$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide(),$("#luckysheet-sheet-container-c .luckysheet-sheets-item:visible").length<=1?luckysheet.isEditMode()?alert("工作薄内至少含有一张可视工作表。若需删除选定的工作表，请先插入一张新工作表或显示一张隐藏的工作表。"):luckysheet.tooltip.info("工作薄内至少含有一张可视工作表。若需删除选定的工作表，请先插入一张新工作表或显示一张隐藏的工作表。",""):(t=luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex),luckysheet.tooltip.confirm("是否删除【"+luckysheetfile[t].name+"】？","<span style='color:#9e9e9e;font-size:12px;'>可以通过Ctrl+Z撤销删除</span>",function(){luckysheet.sheetmanage.deleteSheet(luckysheetcurrentSheetitem.data("index"))},null),$("#luckysheet-input-box").removeAttr("style"))}),$("#luckysheetsheetconfigcopy").click(function(e){luckysheet.sheetmanage.copySheet(luckysheetcurrentSheetitem.data("index"),e),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide()}),$("#luckysheetsheetconfighide").click(function(){1!=$("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").length?(luckysheet.sheetmanage.setSheetHide(luckysheetcurrentSheetitem.data("index")),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide()):luckysheet.isEditMode()?alert("不能隐藏, 至少保留一个sheet标签"):luckysheet.tooltip.info("不能隐藏","至少保留一个sheet标签")}),$("#luckysheet-sheets-add").click(function(e){luckysheet.sheetmanage.addNewSheet(e),luckysheet.sheetmanage.locationSheet(),$("#luckysheet-input-box").removeAttr("style")});var sheetscrollani=null,sheetscrollstart=0,sheetscrollend=0,sheetscrollstep=150;$("#luckysheet-sheets-leftscroll").click(function(){var e=$("#luckysheet-sheet-container-c");sheetscrollstart=e.scrollLeft(),(sheetscrollend=e.scrollLeft()-sheetscrollstep)<=0&&$("#luckysheet-sheet-container .docs-sheet-fade-left").hide(),$("#luckysheet-sheet-container .docs-sheet-fade-right").show(),clearInterval(sheetscrollani),sheetscrollani=setInterval(function(){sheetscrollstart-=4,e.scrollLeft(sheetscrollstart),sheetscrollstart<=sheetscrollend&&clearInterval(sheetscrollani)},1)}),$("#luckysheet-sheets-rightscroll").click(function(){var e=$("#luckysheet-sheet-container-c");sheetscrollstart=e.scrollLeft(),sheetscrollend=e.scrollLeft()+sheetscrollstep,0<sheetscrollstart&&$("#luckysheet-sheet-container .docs-sheet-fade-right").hide(),$("#luckysheet-sheet-container .docs-sheet-fade-left").show(),clearInterval(sheetscrollani),sheetscrollani=setInterval(function(){sheetscrollstart+=4,e.scrollLeft(sheetscrollstart),sheetscrollend<=sheetscrollstart&&clearInterval(sheetscrollani)},1)});var initialOpenSheet=!0;$("#luckysheet-sheets-m").click(function(e){$("#luckysheet-sheet-list").html("");for(var t="",l=0;l<luckysheetfile.length;l++){var r=luckysheetfile[l],a="",s="";1==r.status&&(a='<i class="fa fa-check" aria-hidden="true"></i>'),1==r.hide&&(a='<i class="fa fa-low-vision" aria-hidden="true"></i>',s+="color:#BBBBBB;"),null!=r.color&&0<r.color.length&&(s+="border-right:4px solid "+r.color+";"),t+=luckysheet.replaceHtml(sheetselectlistitemHTML,{index:r.index,name:r.name,icon:a,style:s})}initialOpenSheet?($("#"+container).append(luckysheet.replaceHtml(sheetselectlistHTML,{item:t})),$("#luckysheet-sheet-list").on("click",".luckysheet-cols-menuitem",function(e){var t,l;luckysheet.isEditMode()?alert("图表编辑模式下不允许该操作！"):(l=(t=$(this)).data("index"),t.data("index")!=luckysheet.currentSheetIndex&&(luckysheet.sheetmanage.setSheetShow(l),luckysheet.sheetmanage.locationSheet()))}),initialOpenSheet=!1):$("#luckysheet-sheet-list").html(t),$t=$("#luckysheet-sheet-list"),mouseclickposition($t,$(this).offset().left,$(this).offset().top-12,"leftbottom"),$("#luckysheet-input-box").removeAttr("style")});var luckysheetextendtable=function(type,index,value,direction){var d=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),file=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)];value=Math.floor(value);var cfg=$.extend(!0,{},config);null==cfg.merge&&(cfg.merge={});var merge_new={};for(var m in cfg.merge){var mc=cfg.merge[m],r=mc.r,c=mc.c,rs=mc.rs,cs=mc.cs;"row"==type?index<r?merge_new[r+value+"_"+c]={r:r+value,c:c,rs:rs,cs:cs}:index==r?"lefttop"==direction?merge_new[r+value+"_"+c]={r:r+value,c:c,rs:rs,cs:cs}:merge_new[r+"_"+c]={r:r,c:c,rs:rs+value,cs:cs}:merge_new[r+"_"+c]=index<r+rs-1||index==r+rs-1&&"lefttop"==direction?{r:r,c:c,rs:rs+value,cs:cs}:{r:r,c:c,rs:rs,cs:cs}:"column"==type&&(index<c?merge_new[r+"_"+(c+value)]={r:r,c:c+value,rs:rs,cs:cs}:index==c?"lefttop"==direction?merge_new[r+"_"+(c+value)]={r:r,c:c+value,rs:rs,cs:cs}:merge_new[r+"_"+c]={r:r,c:c,rs:rs,cs:cs+value}:merge_new[r+"_"+c]=index<c+cs-1||index==c+cs-1&&"lefttop"==direction?{r:r,c:c,rs:rs,cs:cs+value}:{r:r,c:c,rs:rs,cs:cs})}cfg.merge=merge_new;var calcChain=file.calcChain,newCalcChain=[];if(null!=calcChain&&0<calcChain.length)for(var i=0;i<calcChain.length;i++){var calc=$.extend(!0,{},calcChain[i]),calc_r=calc.r,calc_c=calc.c,calc_i=calc.index,calc_funcStr=calc.func[2],functionStr,functionStr;"row"==type?(functionStr="="+luckysheet.formula.functionStrChange(calc_funcStr,"add","row",direction,index,value),d[calc_r][calc_c].f==calc_funcStr&&(d[calc_r][calc_c].f=functionStr),calc.func[2]=functionStr,"lefttop"==direction?index<=calc_r&&(calc.r+=value):"rightbottom"==direction&&index<calc_r&&(calc.r+=value),newCalcChain.push(calc)):"column"==type&&(functionStr="="+luckysheet.formula.functionStrChange(calc_funcStr,"add","col",direction,index,value),d[calc_r][calc_c].f==calc_funcStr&&(d[calc_r][calc_c].f=functionStr),calc.func[2]=functionStr,"lefttop"==direction?index<=calc_c&&(calc.c+=value):"rightbottom"==direction&&index<calc_c&&(calc.c+=value),newCalcChain.push(calc))}var filter_select=file.filter_select,filter=file.filter,newFilterObj=null;if(null!=filter_select&&"{}"!=JSON.stringify(filter_select)){newFilterObj={filter_select:null,filter:null};var f_r1=filter_select.row[0],f_r2=filter_select.row[1],f_c1=filter_select.column[0],f_c2=filter_select.column[1];if("row"==type){if(f_r1<index?(f_r2==index&&"lefttop"==direction||index<f_r2)&&(f_r2+=value):f_r1!=index||"lefttop"==direction?(f_r1+=value,f_r2+=value):"rightbottom"==direction&&index<f_r2&&(f_r2+=value),null!=filter)for(var k in newFilterObj.filter={},filter){var f_rowhidden=filter[k].rowhidden,f_rowhidden_new={};for(var n in f_rowhidden)n=parseFloat(n),n<index?f_rowhidden_new[n]=0:n!=index||"lefttop"==direction?f_rowhidden_new[n+value]=0:"rightbottom"==direction&&(f_rowhidden_new[n]=0);newFilterObj.filter[k]=$.extend(!0,{},filter[k]),newFilterObj.filter[k].rowhidden=f_rowhidden_new,newFilterObj.filter[k].str=f_r1,newFilterObj.filter[k].edr=f_r2}}else if("column"==type&&(f_c1<index?(f_c2==index&&"lefttop"==direction||index<f_c2)&&(f_c2+=value):f_c1!=index||"lefttop"==direction?(f_c1+=value,f_c2+=value):"rightbottom"==direction&&index<f_c2&&(f_c2+=value),null!=filter))for(var k in newFilterObj.filter={},filter){var f_cindex=filter[k].cindex;(f_cindex==index&&"lefttop"==direction||index<f_cindex)&&(f_cindex+=value),newFilterObj.filter[f_cindex-f_c1]=$.extend(!0,{},filter[k]),newFilterObj.filter[f_cindex-f_c1].cindex=f_cindex,newFilterObj.filter[f_cindex-f_c1].stc=f_c1,newFilterObj.filter[f_cindex-f_c1].edc=f_c2}newFilterObj.filter_select={row:[f_r1,f_r2],column:[f_c1,f_c2]}}if(null!=newFilterObj&&null!=newFilterObj.filter)for(var k in cfg.rowhidden={},newFilterObj.filter){var f_rowhidden=newFilterObj.filter[k].rowhidden;for(var n in f_rowhidden)cfg.rowhidden[n]=0}else delete cfg.rowhidden;var CFarr=file.luckysheet_conditionformat_save,newCFarr=[];if(null!=CFarr&&0<CFarr.length)for(var i=0;i<CFarr.length;i++){for(var cf_range=CFarr[i].cellrange,cf_new_range=[],j=0;j<cf_range.length;j++){var CFr1=cf_range[j].row[0],CFr2=cf_range[j].row[1],CFc1=cf_range[j].column[0],CFc2=cf_range[j].column[1];"row"==type?CFr1<index?(CFr2==index&&"lefttop"==direction||index<CFr2)&&(CFr2+=value):CFr1!=index||"lefttop"==direction?(CFr1+=value,CFr2+=value):"rightbottom"==direction&&index<CFr2&&(CFr2+=value):"column"==type&&(CFc1<index?(CFc2==index&&"lefttop"==direction||index<CFc2)&&(CFc2+=value):CFc1!=index||"lefttop"==direction?(CFc1+=value,CFc2+=value):"rightbottom"==direction&&index<CFc2&&(CFc2+=value)),cf_new_range.push({row:[CFr1,CFr2],column:[CFc1,CFc2]})}var cf=$.extend(!0,{},CFarr[i]);cf.cellrange=cf_new_range,newCFarr.push(cf)}var AFarr=file.luckysheet_alternateformat_save,newAFarr=[];if(null!=AFarr&&0<AFarr.length)for(var i=0;i<AFarr.length;i++){var AFr1=AFarr[i].cellrange.row[0],AFr2=AFarr[i].cellrange.row[1],AFc1=AFarr[i].cellrange.column[0],AFc2=AFarr[i].cellrange.column[1],af=$.extend(!0,{},AFarr[i]);"row"==type?AFr1<index?(AFr2==index&&"lefttop"==direction||index<AFr2)&&(AFr2+=value):AFr1!=index||"lefttop"==direction?(AFr1+=value,AFr2+=value):"rightbottom"==direction&&index<AFr2&&(AFr2+=value):"column"==type&&(AFc1<index?(AFc2==index&&"lefttop"==direction||index<AFc2)&&(AFc2+=value):AFc1!=index||"lefttop"==direction?(AFc1+=value,AFc2+=value):"rightbottom"==direction&&index<AFc2&&(AFc2+=value)),af.cellrange={row:[AFr1,AFr2],column:[AFc1,AFc2]},newAFarr.push(af)}var newFreezen={freezenhorizontaldata:null,freezenverticaldata:null},freezen_scrollTop,freezen_row_st,freezen_top,freezen_scrollLeft,freezen_col_st,freezen_left;if(null!=luckysheet.freezen.freezenhorizontaldata&&"row"==type?(freezen_scrollTop=luckysheet.freezen.freezenhorizontaldata[2],freezen_row_st=luckysheet.freezen.freezenhorizontaldata[1]-1,(freezen_row_st==index&&"lefttop"==direction||index<freezen_row_st)&&(freezen_row_st+=value),freezen_top=visibledatarow[freezen_row_st]-2-freezen_scrollTop+columeHeaderHeight,newFreezen.freezenhorizontaldata=[visibledatarow[freezen_row_st],freezen_row_st+1,freezen_scrollTop,luckysheet.freezen.cutVolumn(visibledatarow,freezen_row_st+1),freezen_top]):newFreezen.freezenhorizontaldata=luckysheet.freezen.freezenhorizontaldata,null!=luckysheet.freezen.freezenverticaldata&&"column"==type?(freezen_scrollLeft=luckysheet.freezen.freezenverticaldata[2],freezen_col_st=luckysheet.freezen.freezenverticaldata[1]-1,(freezen_col_st==index&&"lefttop"==direction||index<freezen_col_st)&&(freezen_col_st+=value),freezen_left=visibledatacolumn[freezen_col_st]-2-freezen_scrollLeft+rowHeaderWidth,newFreezen.freezenverticaldata=[visibledatacolumn[freezen_col_st],freezen_col_st+1,freezen_scrollLeft,luckysheet.freezen.cutVolumn(visibledatacolumn,freezen_col_st+1),freezen_left]):newFreezen.freezenverticaldata=luckysheet.freezen.freezenverticaldata,"row"==type){var type1="r";if(null!=cfg.rowlen){var rowlen_new={};for(var r in cfg.rowlen)r=parseFloat(r),r<index?rowlen_new[r]=cfg.rowlen[r]:r!=index||"lefttop"==direction?rowlen_new[r+value]=cfg.rowlen[r]:"rightbottom"==direction&&(rowlen_new[r]=cfg.rowlen[r]);cfg.rowlen=rowlen_new}for(var row=[],c=0;c<d[0].length;c++)row.push(null);if(cfg.borderInfo&&0<cfg.borderInfo.length){for(var borderInfo=[],i=0;i<cfg.borderInfo.length;i++){var rangeType=cfg.borderInfo[i].rangeType,row_index;if("range"==rangeType){for(var borderRange=cfg.borderInfo[i].range,emptyRange=[],j=0,bd_obj;j<borderRange.length;j++){var bd_r1=borderRange[j].row[0],bd_r2=borderRange[j].row[1];"lefttop"==direction?index<=bd_r1?(bd_r1+=value,bd_r2+=value):index<=bd_r2&&(bd_r2+=value):index<bd_r1?(bd_r1+=value,bd_r2+=value):index<bd_r2&&(bd_r2+=value),bd_r1<=bd_r2&&emptyRange.push({row:[bd_r1,bd_r2],column:borderRange[j].column})}0<emptyRange.length&&(bd_obj={rangeType:"range",borderType:cfg.borderInfo[i].borderType,style:cfg.borderInfo[i].style,color:cfg.borderInfo[i].color,range:emptyRange},borderInfo.push(bd_obj))}else{"cell"==rangeType&&(row_index=cfg.borderInfo[i].value.row_index,"lefttop"==direction?index<=row_index&&(row_index+=value):index<row_index&&(row_index+=value),cfg.borderInfo[i].value.row_index=row_index,borderInfo.push(cfg.borderInfo[i]))}}cfg.borderInfo=borderInfo}for(var arr=[],r=0;r<value;r++)arr.push(JSON.stringify(row));"lefttop"==direction?0==index?eval("d.unshift("+arr.join(",")+")"):eval("d.splice("+index+", 0, "+arr.join(",")+")"):eval("d.splice("+(index+1)+", 0, "+arr.join(",")+")")}else{var type1="c";if(null!=cfg.columlen){var columlen_new={};for(var c in cfg.columlen)c=parseFloat(c),c<index?columlen_new[c]=cfg.columlen[c]:c!=index||"lefttop"==direction?columlen_new[c+value]=cfg.columlen[c]:"rightbottom"==direction&&(columlen_new[c]=cfg.columlen[c]);cfg.columlen=columlen_new}for(var col=[],r=0;r<d.length;r++)col.push(null);if(cfg.borderInfo&&0<cfg.borderInfo.length){for(var borderInfo=[],i=0;i<cfg.borderInfo.length;i++){var rangeType=cfg.borderInfo[i].rangeType,col_index;if("range"==rangeType){for(var borderRange=cfg.borderInfo[i].range,emptyRange=[],j=0,bd_obj;j<borderRange.length;j++){var bd_c1=borderRange[j].column[0],bd_c2=borderRange[j].column[1];"lefttop"==direction?index<=bd_c1?(bd_c1+=value,bd_c2+=value):index<=bd_c2&&(bd_c2+=value):index<bd_c1?(bd_c1+=value,bd_c2+=value):index<bd_c2&&(bd_c2+=value),bd_c1<=bd_c2&&emptyRange.push({row:borderRange[j].row,column:[bd_c1,bd_c2]})}0<emptyRange.length&&(bd_obj={rangeType:"range",borderType:cfg.borderInfo[i].borderType,style:cfg.borderInfo[i].style,color:cfg.borderInfo[i].color,range:emptyRange},borderInfo.push(bd_obj))}else{"cell"==rangeType&&(col_index=cfg.borderInfo[i].value.col_index,"lefttop"==direction?index<=col_index&&(col_index+=value):index<col_index&&(col_index+=value),cfg.borderInfo[i].value.col_index=col_index,borderInfo.push(cfg.borderInfo[i]))}}cfg.borderInfo=borderInfo}for(var r=0;r<d.length;r++)for(var row=d[r],i=0;i<value;i++)"lefttop"==direction?0==index?row.unshift(col[r]):row.splice(index,0,col[r]):row.splice(index+1,0,col[r])}luckysheet.jfrefreshgrid_adRC(d,cfg,"addRC",{index:index,len:value,direction:direction,rc:type1,restore:!1},newCalcChain,newFilterObj,newCFarr,newAFarr,newFreezen);var range=null,scrollLeft,scrollTop,winH,winW,row,row_pre,range="row"==type?"lefttop"==direction?[{row:[index,index+value-1],column:[0,d[0].length-1]}]:[{row:[index+1,index+value],column:[0,d[0].length-1]}]:"lefttop"==direction?[{row:[0,d.length-1],column:[index,index+value-1]}]:[{row:[0,d.length-1],column:[index+1,index+value]}];luckysheet_select_save=range,luckysheet.selectHightlightShow(),"row"==type&&(scrollLeft=$("#luckysheet-cell-main").scrollLeft(),scrollTop=$("#luckysheet-cell-main").scrollTop(),winH=$("#luckysheet-cell-main").height(),winW=$("#luckysheet-cell-main").width(),row=visibledatarow[range[0].row[1]],row_pre=range[0].row[0]-1==-1?0:visibledatarow[range[0].row[0]-1],0<row-scrollTop-winH+20?$("#luckysheet-scrollbar-y").scrollTop(row-winH+20):row_pre-scrollTop-20<0&&$("#luckysheet-scrollbar-y").scrollTop(row_pre-20),30<value&&($("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide()))};luckysheet.luckysheetextendtable=luckysheetextendtable;var luckysheetextendData=function(e,t){var l=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),r=$.extend(!0,{},config);null==r.merge&&(r.merge={});for(var a=l[0].length,s=luckysheet.datagridgrowth([],e,a),l=l.concat(s),n=0;n<t.length;n++){var o=t[n].r,c=t[n].c,u=t[n].v;luckysheet.setcellvalue(o,c,l,u),null!=u&&null!=u.mc&&null!=u.mc.rs&&(r.merge[u.mc.r+"_"+u.mc.c]=$.extend(!0,{},u.mc))}luckysheet.flowdata=l,luckysheet.editor.webWorkerFlowDataCache(luckysheet.flowdata),luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].data=l,config=r,luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].config=config,luckysheet.jfrefreshgrid_rhcw(luckysheet.flowdata.length,luckysheet.flowdata[0].length)};luckysheet.luckysheetextendData=luckysheetextendData,$("#luckysheet-add-lefttop, #luckysheet-add-lefttop_t").click(function(e){var t,l;$("#luckysheet-rightclick-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<luckysheet_select_save.length?luckysheet.isEditMode()?alert("不能对多重选择区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选择区域执行此操作，请选择单个区域，然后再试",""):(l=$(this).parent().find("input").val(),luckysheet.func_methods.isRealNum(l)?(l=parseInt(l))<1||100<l?luckysheet.isEditMode()?alert("增加错误, 增加范围限制在1-100"):luckysheet.tooltip.info("增加错误, 增加范围限制在1-100",""):(t=luckysheet_select_save[0][luckysheetRightHeadClickIs][0],luckysheetextendtable(luckysheetRightHeadClickIs,t,l,"lefttop")):luckysheet.isEditMode()?alert("增加错误, 请输入数字"):luckysheet.tooltip.info("增加错误, 请输入数字",""))}),$("#luckysheet-add-rightbottom, #luckysheet-add-rightbottom_t").click(function(e){var t,l;$("#luckysheet-rightclick-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<luckysheet_select_save.length?luckysheet.isEditMode()?alert("不能对多重选择区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选择区域执行此操作，请选择单个区域，然后再试",""):(l=$(this).parent().find("input").val(),luckysheet.func_methods.isRealNum(l)?(l=parseInt(l))<1||100<l?luckysheet.isEditMode()?alert("增加错误, 增加范围限制在1-100"):luckysheet.tooltip.info("增加错误, 增加范围限制在1-100",""):(t=luckysheet_select_save[0][luckysheetRightHeadClickIs][1],luckysheetextendtable(luckysheetRightHeadClickIs,t,l,"rightbottom")):luckysheet.isEditMode()?alert("增加错误, 请输入数字"):luckysheet.tooltip.info("增加错误, 请输入数字",""))});var luckysheetdeletetable=function(e,t,l){var r=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),a=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)],s=l-t+1,n=$.extend(!0,{},config);null==n.merge&&(n.merge={});var o={};for(var c in n.merge){var u=n.merge[c],i=u.r,h=u.c,d=u.rs,y=u.cs;"row"==e?i<t?i+d-1<t?o[i+"_"+h]={r:i,c:h,rs:d,cs:y}:t<=i+d-1&&i+d-1<l?o[i+"_"+h]={r:i,c:h,rs:t-i,cs:y}:l<=i+d-1&&(o[i+"_"+h]={r:i,c:h,rs:d-s,cs:y}):t<=i&&i<=l?l<i+d-1&&(o[t+"_"+h]={r:t,c:h,rs:i+d-1-l,cs:y}):l<i&&(o[i-s+"_"+h]={r:i-s,c:h,rs:d,cs:y}):"column"==e&&(h<t?h+y-1<t?o[i+"_"+h]={r:i,c:h,rs:d,cs:y}:t<=h+y-1&&h+y-1<l?o[i+"_"+h]={r:i,c:h,rs:d,cs:t-h}:l<=h+y-1&&(o[i+"_"+h]={r:i,c:h,rs:d,cs:y-s}):t<=h&&h<=l?l<h+y-1&&(o[i+"_"+t]={r:i,c:t,rs:d,cs:h+y-1-l}):l<h&&(o[i+"_"+(h-s)]={r:i,c:h-s,rs:d,cs:y}))}n.merge=o;var f=a.calcChain,m=[];if(null!=f&&0<f.length)for(var k=0;k<f.length;k++){var p,g=$.extend(!0,{},f[k]),v=g.r,b=g.c,_=(g.index,g.func[2]);"row"==e?(v<t||l<v)&&(p="="+luckysheet.formula.functionStrChange(_,"del","row",null,t,s),r[v][b].f==_&&(r[v][b].f=p),g.func[2]=p,l<v&&(g.r=v-s),m.push(g)):"column"==e&&(b<t||l<b)&&(p="="+luckysheet.formula.functionStrChange(_,"del","col",null,t,s),r[v][b].f==_&&(r[v][b].f=p),g.func[2]=p,l<b&&(g.c=b-s),m.push(g))}var w=a.filter_select,x=a.filter,C=null;if(null!=w&&"{}"!=JSON.stringify(w)){C={filter_select:null,filter:null};var T=w.row[0],I=w.row[1],R=w.column[0],S=w.column[1];if("row"==e){if(l<T?(T-=s,I-=s,C.filter_select={row:[T,I],column:[R,S]}):T<t&&(I<t||(I<=l?I=t-1:I-=s),C.filter_select={row:[T,I],column:[R,S]}),null!=C.filter_select&&null!=x)for(var A in x){var F=x[A].rowhidden,N={};for(var M in F)M<t?N[M]=0:l<M&&(N[M-s]=0);"{}"!=JSON.stringify(N)&&(null==C.filter&&(C.filter={}),C.filter[A]=$.extend(!0,{},x[A]),C.filter[A].rowhidden=N,C.filter[A].str=T,C.filter[A].edr=I)}}else if("column"==e&&(l<R?(R-=s,S-=s,C.filter_select={row:[T,I],column:[R,S]}):R<t?(S<t||(S<=l?S=t-1:S-=s),C.filter_select={row:[T,I],column:[R,S]}):l<S&&(R=t,S-=s,C.filter_select={row:[T,I],column:[R,S]}),null!=C.filter_select&&null!=x))for(var A in x){var E=x[A].cindex;E<t?(null==C.filter&&(C.filter={}),C.filter[E-R]=$.extend(!0,{},x[A]),C.filter[E-R].edc=S):l<E&&(E-=s,null==C.filter&&(C.filter={}),C.filter[E-R]=$.extend(!0,{},x[A]),C.filter[E-R].cindex=E,C.filter[E-R].stc=R,C.filter[E-R].edc=S)}}if(null!=C&&null!=C.filter)for(var A in n.rowhidden={},C.filter){F=C.filter[A].rowhidden;for(var M in F)n.rowhidden[M]=0}else delete n.rowhidden;var O=a.luckysheet_conditionformat_save,j=[];if(null!=O&&0<O.length)for(k=0;k<O.length;k++){for(var z,D=O[k].cellrange,P=[],L=0;L<D.length;L++){var B=D[L].row[0],q=D[L].row[1],H=D[L].column[0],V=D[L].column[1];"row"==e?t<=B&&q<=l||(l<B?(B-=s,q-=s):B<t?q<t||(q<=l?q=t-1:q-=s):l<q&&(B=t,q-=s),P.push({row:[B,q],column:[H,V]})):"column"==e&&(t<=H&&V<=l||(l<H?(H-=s,V-=s):H<t?V<t||(V<=l?V=t-1:V-=s):l<V&&(H=t,V-=s),P.push({row:[B,q],column:[H,V]})))}0<P.length&&((z=$.extend(!0,{},O[k])).cellrange=P,j.push(z))}var U=a.luckysheet_alternateformat_save,Y=[];if(null!=U&&0<U.length)for(k=0;k<U.length;k++){var W,G=U[k].cellrange.row[0],X=U[k].cellrange.row[1],K=U[k].cellrange.column[0],Z=U[k].cellrange.column[1];"row"==e?t<=G&&X<=l||(l<G?(G-=s,X-=s):G<t?X<t||(X<=l?X=t-1:X-=s):l<X&&(G=t,X-=s),(W=$.extend(!0,{},U[k])).cellrange={row:[G,X],column:[K,Z]},Y.push(W)):"column"==e&&(t<=K&&Z<=l||(l<K?(K-=s,Z-=s):K<t?Z<t||(Z<=l?Z=t-1:Z-=s):l<Z&&(K=t,Z-=s),(W=$.extend(!0,{},U[k])).cellrange={row:[G,X],column:[K,Z]},Y.push(W)))}var J,Q,ee,te,le,re,ae,se,ne={freezenhorizontaldata:null,freezenverticaldata:null};if(null!=luckysheet.freezen.freezenhorizontaldata&&"row"==e?(J=luckysheet.freezen.freezenhorizontaldata[2],-1==(Q=luckysheet_searcharray(visibledatarow,J))&&(Q=0),t<=(ee=luckysheet.freezen.freezenhorizontaldata[1]-1)&&(ee<l?ee=t-1:ee-=s),ee<Q&&(ee=Q),te=visibledatarow[ee]-2-J+columeHeaderHeight,ne.freezenhorizontaldata=[visibledatarow[ee],ee+1,J,luckysheet.freezen.cutVolumn(visibledatarow,ee+1),te]):ne.freezenhorizontaldata=luckysheet.freezen.freezenhorizontaldata,null!=luckysheet.freezen.freezenverticaldata&&"column"==e?(le=luckysheet.freezen.freezenverticaldata[2],-1==(re=luckysheet_searcharray(visibledatacolumn,le))&&(re=0),t<=(ae=luckysheet.freezen.freezenverticaldata[1]-1)&&(ae<l?ae=t-1:ae-=s),ae<re&&(ae=re),se=visibledatacolumn[ae]-2-le+rowHeaderWidth,ne.freezenverticaldata=[visibledatacolumn[ae],ae+1,le,luckysheet.freezen.cutVolumn(visibledatacolumn,ae+1),se]):ne.freezenverticaldata=luckysheet.freezen.freezenverticaldata,"row"==e){var oe="r";null==n.rowlen&&(n.rowlen={});var ce={};for(var i in n.rowlen)i<t?ce[i]=n.rowlen[i]:l<i&&(ce[i-s]=n.rowlen[i]);if(n.rowlen=ce,n.borderInfo&&0<n.borderInfo.length){for(var ue,ie=[],k=0;k<n.borderInfo.length;k++){if("range"==(pe=n.borderInfo[k].rangeType)){for(var he=n.borderInfo[k].range,de=[],L=0;L<he.length;L++){for(var ye=he[L].row[0],fe=he[L].row[1],i=t;i<=l;i++)i<he[L].row[0]?(--ye,--fe):i<=he[L].row[1]&&--fe;ye<=fe&&de.push({row:[ye,fe],column:he[L].column})}0<de.length&&(ve={rangeType:"range",borderType:n.borderInfo[k].borderType,style:n.borderInfo[k].style,color:n.borderInfo[k].color,range:de},ie.push(ve))}else{"cell"==pe&&((ue=n.borderInfo[k].value.row_index)<t?ie.push(n.borderInfo[k]):l<ue&&(n.borderInfo[k].value.row_index=ue-(l-t+1),ie.push(n.borderInfo[k])))}}n.borderInfo=ie}if(r.splice(t,s),!luckysheetConfigsetting.pointEdit){for(var me=[],h=0;h<r[0].length;h++)me.push(null);for(i=0;i<s;i++)r.push(me)}}else{oe="c";null==n.columlen&&(n.columlen={});var ke={};for(var h in n.columlen)h<t?ke[h]=n.columlen[h]:l<h&&(ke[h-s]=n.columlen[h]);if(n.columlen=ke,n.borderInfo&&0<n.borderInfo.length){for(var pe,ge,ie=[],k=0;k<n.borderInfo.length;k++){if("range"==(pe=n.borderInfo[k].rangeType)){for(var ve,he=n.borderInfo[k].range,de=[],L=0;L<he.length;L++){for(var be=he[L].column[0],_e=he[L].column[1],h=t;h<=l;h++)h<he[L].column[0]?(--be,--_e):h<=he[L].column[1]&&--_e;be<=_e&&de.push({row:he[L].row,column:[be,_e]})}0<de.length&&(ve={rangeType:"range",borderType:n.borderInfo[k].borderType,style:n.borderInfo[k].style,color:n.borderInfo[k].color,range:de},ie.push(ve))}else{"cell"==pe&&((ge=n.borderInfo[k].value.col_index)<t?ie.push(n.borderInfo[k]):l<ge&&(n.borderInfo[k].value.col_index=ge-(l-t+1),ie.push(n.borderInfo[k])))}}n.borderInfo=ie}var we=[];if(!luckysheetConfigsetting.pointEdit)for(i=0;i<s;i++)we.push(null);for(i=0;i<r.length;i++){(me=[].concat(r[i])).splice(t,s),r[i]=me.concat(we)}}luckysheet.jfrefreshgrid_adRC(r,n,"delRC",{index:t,len:l-t+1,rc:oe},m,C,j,Y,ne)};luckysheet.luckysheetdeletetable=luckysheetdeletetable,$("#luckysheet-del-selected, #luckysheet-del-selected_t").click(function(e){var t,l;$("#luckysheet-rightclick-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<luckysheet_select_save.length?"row"!=luckysheetRightHeadClickIs&&"column"!=luckysheetRightHeadClickIs||(luckysheet.isEditMode()?alert("不能对多重选择区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选择区域执行此操作，请选择单个区域，然后再试","")):(t=luckysheet_select_save[0][luckysheetRightHeadClickIs][0],l=luckysheet_select_save[0][luckysheetRightHeadClickIs][1],luckysheetdeletetable(luckysheetRightHeadClickIs,t,l))}),$("#luckysheet-delete-text").click(function(){if($("#luckysheet-rightclick-menu").hide(),$("#"+container).attr("tabindex",0).focus(),0<luckysheet_select_save.length){for(var e=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),t=!1,l=0;l<luckysheet_select_save.length;l++){var r=luckysheet_select_save[l].row[0],a=luckysheet_select_save[l].row[1],s=luckysheet_select_save[l].column[0],n=luckysheet_select_save[l].column[1];if(luckysheet.hasPartMC(config,r,a,s,n)){t=!0;break}}if(t)return void(luckysheet.isEditMode()?alert("无法对部分合并单元格执行此操作"):luckysheet.tooltip.info("无法对部分合并单元格执行此操作",""));for(l=0;l<luckysheet_select_save.length;l++)for(var r=luckysheet_select_save[l].row[0],a=luckysheet_select_save[l].row[1],s=luckysheet_select_save[l].column[0],n=luckysheet_select_save[l].column[1],o=r;o<=a;o++)for(var c=s;c<=n;c++)luckysheet.pivotTable.isPivotRange(o,c)||("object"==luckysheet.getObjType(e[o][c])?(delete e[o][c].m,delete e[o][c].v,null!=e[o][c].f&&(delete e[o][c].f,luckysheet.formula.delFunctionGroup(o,c,luckysheet.currentSheetIndex),delete e[o][c].spl)):e[o][c]=null);luckysheet.jfrefreshgrid(e,luckysheet_select_save)}}),$("#luckysheet-rows-cols-changesize").click(function(){$("#luckysheet-rightclick-menu").hide(),$("#"+container).attr("tabindex",0).focus();var e=parseInt($(this).siblings("input[type='number']").val().trim());if(e<0||255<e)luckysheet.isEditMode()?alert("数值必须在0 ~ 255之间"):luckysheet.tooltip.info("数值必须在0 ~ 255之间","");else{var t,l=$.extend(!0,{},config);if("row"==luckysheetRightHeadClickIs){t="resizeR",null==l.rowlen&&(l.rowlen={});for(var r=0;r<luckysheet_select_save.length;r++)for(var a=luckysheet_select_save[r].row[0],s=luckysheet_select_save[r].row[1],n=a;n<=s;n++)l.rowlen[n]=e}else if("column"==luckysheetRightHeadClickIs){t="resizeC",null==l.columlen&&(l.columlen={});for(r=0;r<luckysheet_select_save.length;r++)for(var o=luckysheet_select_save[r].column[0],c=luckysheet_select_save[r].column[1],u=o;u<=c;u++)l.columlen[u]=e}clearjfundo&&(luckysheet.jfundo=[],luckysheet.jfredo.push({type:"resize",ctrlType:t,config:$.extend(!0,{},config),curconfig:$.extend(!0,{},l),sheetIndex:luckysheet.currentSheetIndex})),config=l,luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].config=config,"row"==luckysheetRightHeadClickIs?(luckysheet.server.saveParam("cg",luckysheet.currentSheetIndex,l.rowlen,{k:"rowlen"}),luckysheet.jfrefreshgrid_rhcw(luckysheet.flowdata.length,null)):"column"==luckysheetRightHeadClickIs&&(luckysheet.server.saveParam("cg",luckysheet.currentSheetIndex,l.columlen,{k:"columlen"}),luckysheet.jfrefreshgrid_rhcw(null,luckysheet.flowdata[0].length))}});var luckysheet_sort_existSort={},luckysheet_sort_initial=!0,luckysheet_model_move_state=!1,luckysheet_model_xy=[0,0],luckysheet_model_move_obj=null;$(document).on("mousedown","div.luckysheet-modal-dialog",function(e){var t;$(e.target).is(".luckysheet-modal-dialog")&&(luckysheet_model_move_state=!0,t=(luckysheet_model_move_obj=$(e.currentTarget)).offset(),luckysheet_model_xy=[e.pageX-t.left,e.pageY-t.top])}),$(document).on("click",".luckysheet-modal-dialog-title-close, .luckysheet-model-close-btn",function(e){($("#textcolorselect").is(":visible")||$("#cellcolorselect").is(":visible"))&&$("#luckysheet-conditionformat-dialog").show(),$(e.currentTarget).parents(".luckysheet-modal-dialog").hide(),$("#luckysheet-modal-dialog-mask").hide(),$(this).parents(".luckysheet-modal-dialog").hasClass("luckysheet-search-formula")&&(luckysheet.formula.dontupdate(),luckysheetMoveHighlightCell("down",0,"rangeOfSelect")),$(this).parents(".luckysheet-modal-dialog").hasClass("luckysheet-search-formula-parm")&&(luckysheet.formula.dontupdate(),luckysheetMoveHighlightCell("down",0,"rangeOfSelect")),$(this).parents(".luckysheet-modal-dialog").hasClass("luckysheet-search-formula-parm-select")&&(luckysheet.formula.dontupdate(),luckysheetMoveHighlightCell("down",0,"rangeOfSelect")),$("#"+container).attr("tabindex",0).focus()}),$("#luckysheetorderby").click(function(){if($("body .luckysheet-cols-menu").hide(),1<luckysheet_select_save.length)luckysheet.isEditMode()?alert("不能对多重选择区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选择区域执行此操作，请选择单个区域，然后再试","");else{var e=luckysheet_select_save[0],a=e.row[0],t=e.row[1],s=e.column[0],n=e.column[1];luckysheet_sort_initial&&(luckysheet_sort_initial=!1,$("body").append(luckysheet.replaceHtml(modelHTML,{id:"luckysheet-sort-dialog",addclass:"",title:"排序范围",content:'<div style="overflow: hidden;" class="luckysheet-sort-modal"><div><label><input type="checkbox" id="luckysheet-sort-haveheader"/><span>数据具有标题行</span></label></div><div style="overflow-y:auto;" id="luckysheet-sort-dialog-tablec"><table data-itemcount="0" cellspacing="0"> <tr><td>排序依据 <select name="sort_0"> <option value="1">1</option> <option value="2">2</option> <option value="3">3</option> <option value="4">4</option> </select> </td> <td> <div><label><input value="asc" type="radio" checked="checked" name="sort_0"><span>正序A-Z</span></label></div> <div><label><input value="desc" type="radio" name="sort_0"><span>倒序Z-A</span></label></div></td></tr></table></div><div style="background: #e5e5e5;border-top: 1px solid #f5f5f5; height: 1px; width: 100%;margin:2px 0px;margin-bottom:10px;"></div> <div> <span style="font-weight: bold; text-decoration: underline;text-align:center;color: blue;cursor: pointer;" class="luckysheet-sort-dialog-additem">+ 添加其他排序列</span> </div> </div>',botton:'<button id="luckysheet-sort-modal-confirm" class="btn btn-primary">排序</button><button class="btn btn-default luckysheet-model-close-btn">关闭</button>'})),$("#luckysheet-sort-dialog .luckysheet-sort-dialog-additem").click(function(){for(var e,t=luckysheet_select_save[0],l=t.row[0],r=(t.row[1],t.column[0]),a=t.column[1],s="",n=$("#luckysheet-sort-dialog table").data("itemcount")+1,o=$("#luckysheet-sort-haveheader").is(":checked"),c=r;c<=a;c++){o?(null==(e=luckysheet.getcellvalue(l,c,luckysheet.flowdata,"m"))&&(e="列"+(c-r+1)),s+='<option value="'+c+'">'+e+"</option>"):s+='<option value="'+c+'">'+luckysheet.luckysheetchatatABC(c)+"</option>"}$("#luckysheet-sort-dialog table").append('<tr class="luckysheet-sort-dialog-tr"><td><span class="luckysheet-sort-item-close" onclick="$(this).parent().parent().remove();"><i class="fa fa-times" aria-hidden="true"></i></span>次要排序 <select name="sort_'+n+'">'+s+'</select> </td> <td> <div><label><input value="asc" type="radio" checked="checked" name="sort_'+n+'"><span>正序A-Z</span></label></div> <div><label><input value="desc" type="radio" name="sort_'+n+'"><span>倒序Z-A</span></label></div></td></tr>'),$("#luckysheet-sort-dialog table").data("itemcount",n)}),$("#luckysheet-sort-haveheader").change(function(){for(var e,t=luckysheet_select_save[0],l=t.row[0],r=(t.row[1],t.column[0]),a=t.column[1],s=$(this).is(":checked"),n="",o=r;o<=a;o++){s?(null==(e=luckysheet.getcellvalue(l,o,luckysheet.flowdata,"m"))&&(e="列"+(o-r+1)),n+='<option value="'+o+'">'+e+"</option>"):n+='<option value="'+o+'">'+luckysheet.luckysheetchatatABC(o)+"</option>"}$("#luckysheet-sort-dialog tr select").each(function(){$(this).html(n)})}),$("#luckysheet-sort-modal-confirm").click(function(){if(1<luckysheet_select_save.length)luckysheet.isEditMode()?alert("不能对多重选择区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选择区域执行此操作，请选择单个区域，然后再试","");else{for(var e,t=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),l=luckysheet_select_save[0],r=l.row[0],a=l.row[1],s=l.column[0],n=l.column[1],o=$("#luckysheet-sort-haveheader").is(":checked"),c=!1,u=[],i=e=o?r+1:r;i<=a;i++){for(var h=[],d=s;d<=n;d++){if(null!=t[i][d]&&null!=t[i][d].mc){c=!0;break}h.push(t[i][d])}u.push(h)}if(c)luckysheet.isEditMode()?alert("选区有合并单元格，无法执行此操作！"):luckysheet.tooltip.info("选区有合并单元格，无法执行此操作！","");else{$($("#luckysheet-sort-dialog table tr").toArray().reverse()).each(function(){var e=$(this).find("select").val(),t=$(this).find("input:radio:checked").val();e-=s,t="asc"==t,u=luckysheet.orderbydata([].concat(u),e,t)});for(var y,i=e;i<=a;i++)for(d=s;d<=n;d++)t[i][d]=u[i-e][d-s];null!=config.rowlen?(y=$.extend(!0,{},config),y=luckysheet.rowlenByRange(t,e,a,y),luckysheet.jfrefreshgrid(t,[{row:[e,a],column:[s,n]}],y,null,!0)):luckysheet.jfrefreshgrid(t,[{row:[e,a],column:[s,n]}]),$("#luckysheet-sort-dialog").hide(),$("#luckysheet-modal-dialog-mask").hide()}}}));for(var l="",r=s;r<=n;r++)l+='<option value="'+r+'">'+luckysheet.luckysheetchatatABC(r)+"</option>";$("#luckysheet-sort-dialog select").html(l),$("#luckysheet-sort-dialog .luckysheet-sort-dialog-tr").remove(),$("#luckysheet-sort-haveheader").prop("checked",!1),$("#luckysheet-sort-dialog input:radio:first").prop("checked","checked"),$("#luckysheet-sort-dialog .luckysheet-modal-dialog-title-text").html("排序范围从<span>"+luckysheet.luckysheetchatatABC(s)+(a+1)+"</span>到<span>"+luckysheet.luckysheetchatatABC(n)+(t+1)+"</span>");var o=$("#luckysheet-sort-dialog"),c=o.outerHeight(),u=o.outerWidth(),i=$(window).width(),h=$(window).height(),d=$(document).scrollLeft(),y=$(document).scrollTop();$("#luckysheet-sort-dialog-tablec").css("max-height",(h-c)/2),$("#luckysheet-sort-dialog").css({left:(i+d-u)/2,top:(h+y-c)/2}).show(),$("#luckysheet-modal-dialog-mask").show(),a<t&&setTimeout(function(){for(var e=luckysheet.flowdata[a],t=luckysheet.flowdata[a+1],l=!1,r=s;r<=n;r++){luckysheet.isdatatype(e[r])!=luckysheet.isdatatype(t[r])&&(l=!0)}l&&$("#luckysheet-sort-haveheader").prop("checked",!0).change()},10)}});var hidefilersubmenu=null;$("#luckysheet-filter-menu").mouseover(function(){clearTimeout(hidefilersubmenu),hidefilersubmenu=setTimeout(function(){$("#luckysheet-filter-submenu").hide()},500)}),$("#luckysheet-filter-submenu").mouseover(function(){clearTimeout(hidefilersubmenu)}).find(".luckysheet-cols-menuitem").click(function(e){$("#luckysheet-filter-selected span").html($(this).find(".luckysheet-cols-menuitem-content").text()).data("value",$(this).data("value")),$("#luckysheet-filter-menu .luckysheet-filter-selected-input").hide();var t=$(this).data("type"),l=$(this).attr("data-value");"2"==t?($("#luckysheet-filter-selected span").data("type","2"),$("#luckysheet-filter-menu .luckysheet-filter-selected-input2").show(),$("#luckysheet-filter-menu .luckysheet-filter-selected-input input").prop("type","number")):"0"==t?$("#luckysheet-filter-selected span").data("type","0"):($("#luckysheet-filter-selected span").data("type","1"),$("#luckysheet-filter-menu .luckysheet-filter-selected-input").eq(0).show(),"dateequal"==l||"datelessthan"==l||"datemorethan"==l?$("#luckysheet-filter-menu .luckysheet-filter-selected-input input").prop("type","date"):"morethan"==l||"moreequalthan"==l||"lessthan"==l||"lessequalthan"==l||"equal"==l||"noequal"==l?$("#luckysheet-filter-menu .luckysheet-filter-selected-input input").prop("type","number"):$("#luckysheet-filter-menu .luckysheet-filter-selected-input input").prop("type","text")),$("#luckysheet-filter-byvalue").next().slideUp(),$("#luckysheet-filter-submenu").hide()}),$("#luckysheet-filter-bycondition, #luckysheet-filter-byvalue").click(function(){var e=$(this);e.next().slideToggle(200),setTimeout(function(){"luckysheet-filter-bycondition"==e.attr("id")&&$("#luckysheet-filter-bycondition").next().is(":visible")&&"无"!=$("#luckysheet-filter-selected span").text()&&$("#luckysheet-filter-byvalue").next().slideUp(200),e.is($("#luckysheet-filter-bycondition"))&&$("#luckysheet-filter-bycondition").next().is(":hidden")&&$("#luckysheet-filter-byvalue").next().is(":hidden")&&$("#luckysheet-filter-byvalue").next().slideDown(200)},300)}),$("#luckysheet-filter-cancel").click(function(){$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide()}),$("#luckysheet-filter-confirm").click(function(){var e=$("#luckysheet-filter-menu"),t=e.data("str"),l=e.data("edr"),r=e.data("cindex"),a=e.data("stc"),s=e.data("edc"),n={};$("#luckysheet-filter-options-sheet"+luckysheet.currentSheetIndex+" .luckysheet-filter-options").not($("#luckysheet-filter-options-sheet"+luckysheet.currentSheetIndex+" .luckysheet-filter-options").eq(r-a).get(0)).each(function(){var e=$(this).data("rowhidden");if(""==e)return!0;for(var t in e=JSON.parse(e.replace(/\'/g,'"')))n[t]=0});var o={},c={},u={};if($("#luckysheet-filter-bycondition").next().is(":visible")&&$("#luckysheet-filter-byvalue").next().is(":hidden")&&"null"!=$("#luckysheet-filter-selected span").data("value")){var i,h=$("#luckysheet-filter-selected span"),d=h.data("type"),y=h.data("value");u.value=y,u.text=h.text(),"0"==d?u.type="0":"2"==d?(i=$("#luckysheet-filter-menu .luckysheet-filter-selected-input2 input"),u.type="2",u.value1=i.eq(0).val(),u.value2=i.eq(1).val()):(u.type="1",u.value1=$("#luckysheet-filter-menu .luckysheet-filter-selected-input").eq(0).find("input").val());for(var f,m,k,p,g,v=t+1;v<=l;v++){v in n||null!=luckysheet.flowdata[v]&&(b=luckysheet.flowdata[v][r],"cellnull"==y?null==b||luckysheet.func_methods.isRealNull(b.v)||(c[v]=0):"cellnonull"==y?null!=b&&!luckysheet.func_methods.isRealNull(b.v)||(c[v]=0):"textinclude"==y?(m=u.value1,null!=b&&!luckysheet.func_methods.isRealNull(b.v)&&-1!=b.m.indexOf(m)||(c[v]=0)):"textnotinclude"==y?(m=u.value1,null==b||luckysheet.func_methods.isRealNull(b.v)||-1<b.m.indexOf(m)&&(c[v]=0)):"textstart"==y?(f=(m=u.value1).length,null!=b&&!luckysheet.func_methods.isRealNull(b.v)&&b.m.substr(0,f)==m||(c[v]=0)):"textend"==y?(f=(m=u.value1).length,(null==b||luckysheet.func_methods.isRealNull(b.v)||f>b.m.length||b.m.substr(b.m.length-f,f)!=m)&&(c[v]=0)):"textequal"==y?(m=u.value1,null!=b&&!luckysheet.func_methods.isRealNull(b.v)&&b.m==m||(c[v]=0)):"dateequal"==y?(m=luckysheet.mask.genarate(u.value1)[2],null!=b&&!luckysheet.func_methods.isRealNull(b.v)&&null!=b.ct&&"d"==b.ct.t&&parseInt(b.v)==m||(c[v]=0)):"datelessthan"==y?(m=luckysheet.mask.genarate(u.value1)[2],(null==b||luckysheet.func_methods.isRealNull(b.v)||null==b.ct||"d"!=b.ct.t||parseInt(b.v)>=m)&&(c[v]=0)):"datemorethan"==y?(m=luckysheet.mask.genarate(u.value1)[2],(null==b||luckysheet.func_methods.isRealNull(b.v)||null==b.ct||"d"!=b.ct.t||parseInt(b.v)<=m)&&(c[v]=0)):"morethan"==y?(m=parseFloat(u.value1),(null==b||luckysheet.func_methods.isRealNull(b.v)||null==b.ct||"n"!=b.ct.t||b.v<=m)&&(c[v]=0)):"moreequalthan"==y?(m=parseFloat(u.value1),(null==b||luckysheet.func_methods.isRealNull(b.v)||null==b.ct||"n"!=b.ct.t||b.v<m)&&(c[v]=0)):"lessthan"==y?(m=parseFloat(u.value1),(null==b||luckysheet.func_methods.isRealNull(b.v)||null==b.ct||"n"!=b.ct.t||b.v>=m)&&(c[v]=0)):"lessequalthan"==y?(m=parseFloat(u.value1),(null==b||luckysheet.func_methods.isRealNull(b.v)||null==b.ct||"n"!=b.ct.t||b.v>m)&&(c[v]=0)):"equal"==y?(m=parseFloat(u.value1),null!=b&&!luckysheet.func_methods.isRealNull(b.v)&&null!=b.ct&&"n"==b.ct.t&&b.v==m||(c[v]=0)):"noequal"==y?(m=parseFloat(u.value1),null!=b&&!luckysheet.func_methods.isRealNull(b.v)&&null!=b.ct&&"n"==b.ct.t&&b.v!=m||(c[v]=0)):"include"==y?((m=parseFloat(u.value1))<(k=parseFloat(u.value2))?(g=m,p=k):(p=m,g=k),(null==b||luckysheet.func_methods.isRealNull(b.v)||null==b.ct||"n"!=b.ct.t||b.v<g||b.v>p)&&(c[v]=0)):"noinclude"==y&&((m=parseFloat(u.value1))<(k=parseFloat(u.value2))?(g=m,p=k):(p=m,g=k),(null==b||luckysheet.func_methods.isRealNull(b.v)||null==b.ct||"n"!=b.ct.t||b.v>=g&&b.v<=p)&&(c[v]=0)))}}else{$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").each(function(e,t){return!(!$(t).is(":visible")||!$(t).is(":checked"))||(0<$(t).closest(".day").length&&(l=$(t).siblings("label").text(),Number(l)<10&&(l="0"+Number(l)),r=$(t).closest(".monthBox").find(".month label").text().replace("月",""),Number(r)<10&&(r="0"+Number(r)),a=$(t).closest(".yearBox").find(".year label").text().replace("年",""),o[s="日期格式#$$$#"+a+"-"+r+"-"+l]="1"),void(0<$(t).closest(".textBox").length&&(s=$(t).closest(".textBox").data("filter"),o[s]="1")));var l,r,a,s});for(var b,v=t+1;v<=l;v++){v in n||null!=luckysheet.flowdata[v]&&(y=null==(b=luckysheet.flowdata[v][r])||luckysheet.func_methods.isRealNull(b.v)?"null#$$$#null":null!=b.ct&&"d"==b.ct.t?"日期格式#$$$#"+luckysheet.mask.update("YYYY-MM-DD",b.v):b.v+"#$$$#"+b.m)in o&&(c[v]=0)}}var _=$("#luckysheet-filter-options-sheet"+luckysheet.currentSheetIndex+" .luckysheet-filter-options").eq(r-a),w=$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']:visible:checked").length<$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']:visible").length||0<$("#luckysheet-filter-byvalue-input").val().length||$("#luckysheet-filter-bycondition").next().is(":visible")&&$("#luckysheet-filter-byvalue").next().is(":hidden")&&"null"!=$("#luckysheet-filter-selected span").data("value"),x=$.extend(!0,n,c),C=luckysheet.json.parseJsonParm(_.data("rowhidden"));luckysheet.labelFilterOptionState(_,w,c,u,!0,t,l,r,a,s);var T,I=$.extend(!0,{},config);I.rowhidden=x,clearjfundo&&((T={type:"datachangeAll_filter"}).sheetIndex=luckysheet.currentSheetIndex,T.config=$.extend(!0,{},config),T.curconfig=I,T.optionstate=w,T.optionsindex=r-a,T.rowhidden=$.extend(!0,{},c),T.rowhidenPre=$.extend(!0,{},C),null!=u&&(T.caljs=u),luckysheet.jfundo=[],luckysheet.jfredo.push(T)),config=I,luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].config=config,luckysheet.server.saveParam("cg",luckysheet.currentSheetIndex,I.rowhidden,{k:"rowhidden"}),luckysheet.jfrefreshgrid_rhcw(luckysheet.flowdata.length,luckysheet.flowdata[0].length),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),luckysheet.cleargridelement()}),luckysheet.json={parseJsonParm:function(obj){if(null==obj)return{};if("string"!=luckysheet.getObjType(obj))return obj;try{var json=eval("("+obj+")");return json}catch(e){return{}}},hasKey:function(e){var t=this.parseJsonParm(e);for(var l in t)return!0;return!1}},luckysheet.labelFilterOptionState=function(e,t,l,r,a,s,n,o,c,u){var i,h;t?(e.addClass("luckysheet-filter-options-active").data("rowhidden",JSON.stringify(l)).data("caljs",JSON.stringify(r)).html('<i class="fa fa-filter luckysheet-mousedown-cancel" aria-hidden="true"></i>'),null!=r&&(e.data("byconditionvalue",r.value).data("byconditiontype",r.type).data("byconditiontext",r.text),null!=r.value1&&e.data("byconditionvalue1",r.value1),null!=r.value2&&e.data("byconditionvalue2",r.value2))):(e.removeClass("luckysheet-filter-options-active").data("rowhidden","").data("caljs","").html('<i class="fa fa-caret-down luckysheet-mousedown-cancel" aria-hidden="true"></i>'),e.data("byconditionvalue","null").data("byconditiontype","0").data("byconditiontext","无").data("byconditionvalue1","").data("byconditionvalue2","")),a&&(null==(i=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)]).filter&&(i.filter={}),t?(h={caljs:r,rowhidden:l,optionstate:t,str:s,edr:n,cindex:o,stc:c,edc:u},i.filter[o-c]=h):delete i.filter[o-c],luckysheet.server.saveParam("all",luckysheet.currentSheetIndex,i.filter,{k:"filter"}))},$("#luckysheet-filter-selected").click(function(){var e=$(this).offset(),t=$("#luckysheet-filter-submenu");t.hide();var l=$(window).height(),r=$(window).width(),a=t.width(),s=(t.height(),e.top),n=e.left,o=l-e.top-20;e.left+a>r&&(n=e.left-a),e.top>l/2&&((s=l-e.top)<0&&(s=0),o=e.top-20),t.css({top:s,left:n,height:o}).show(),clearTimeout(hidefilersubmenu)});var orderbydatafiler=function(e,t,l,r,a,s){for(var n=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),o=!1,c=[],u=e+=1;u<=l;u++){for(var i=[],h=t;h<=r;h++){if(null!=n[u][h]&&null!=n[u][h].mc){o=!0;break}i.push(n[u][h])}c.push(i)}if(o)luckysheet.isEditMode()?alert("筛选选区有合并单元格，无法执行此操作！"):luckysheet.tooltip.info("筛选选区有合并单元格，无法执行此操作！","");else{c=luckysheet.orderbydata(c,a-t,s);for(var d,u=e;u<=l;u++)for(h=t;h<=r;h++)n[u][h]=c[u-e][h-t];null!=config.rowlen?(d=$.extend(!0,{},config),d=luckysheet.rowlenByRange(n,e,l,d),luckysheet.jfrefreshgrid(n,[{row:[e,l],column:[t,r]}],d,null,!0)):luckysheet.jfrefreshgrid(n,[{row:[e,l],column:[t,r]}])}};luckysheet.createFilter=function(){if(1<luckysheet_select_save.length)return $("#luckysheet-rightclick-menu").hide(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),$("#"+container).attr("tabindex",0).focus(),void(luckysheet.isEditMode()?alert("不能对多重选择区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选择区域执行此操作，请选择单个区域，然后再试",""));if(!luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].isPivotTable){$("#luckysheet-filter-selected-sheet"+luckysheet.currentSheetIndex+", #luckysheet-filter-options-sheet"+luckysheet.currentSheetIndex).remove();var e=luckysheet_select_save[0];if(e.row[0]==e.row[1]&&e.column[0]==e.column[1]){for(var t,l,r=e.row[1],a=0;a<luckysheet.flowdata[r].length;a++){var s=luckysheet.flowdata[r][a];if(null==s||luckysheet.func_methods.isRealNull(s.v)){if(null!=t){l=a-1;break}}else null==t&&(t=a)}null==l&&(l=luckysheet.flowdata[r].length-1),luckysheet_select_save=[{row:[r,r],column:[t,l]}],luckysheet.selectHightlightShow(),luckysheet.luckysheet_shiftpositon=$.extend(!0,{},e),luckysheetMoveEndCell("down","range")}else e.row[1]-e.row[0]<2&&(luckysheet.luckysheet_shiftpositon=$.extend(!0,{},e),luckysheetMoveEndCell("down","range"));luckysheet_filter_save=$.extend(!0,{},luckysheet_select_save[0]),luckysheet.createFilterOptions(luckysheet_filter_save),luckysheet.server.saveParam("all",luckysheet.currentSheetIndex,luckysheet_filter_save,{k:"filter_select"}),filterchage&&luckysheet.jfredo.push({type:"filtershow",data:[],curdata:[],sheetIndex:luckysheet.currentSheetIndex,filter_save:luckysheet_filter_save})}},luckysheet.createFilterOptions=function(e,t){if($("#luckysheet-filter-selected-sheet"+luckysheet.currentSheetIndex).remove(),$("#luckysheet-filter-options-sheet"+luckysheet.currentSheetIndex).remove(),null!=e&&"{}"!=JSON.stringify(e)){var l=e.row[0],r=e.row[1],a=e.column[0],s=e.column[1],n=visibledatarow[r],o=l-1==-1?0:visibledatarow[l-1],c=visibledatacolumn[s],u=a-1==-1?0:visibledatacolumn[a-1],i='<div id="luckysheet-filter-selected-sheet'+luckysheet.currentSheetIndex+'" class="luckysheet-cell-selected luckysheet-filter-selected"  style="left:'+u+"px;width:"+(c-u-1)+"px;top:"+o+"px;height:"+(n-o-1)+'px;display:block;border-color:#897BFF;z-index:20;background:none;"></div>';$("#luckysheet-cell-main").append(i);for(var h,d,y,f="",m=a;m<=s;m++){null==t||null==t[m-a]?f+='<div data-rowhidden="" data-str="'+l+'" data-edr="'+r+'" data-cindex="'+m+'" data-stc="'+a+'" data-edc="'+s+'" class="luckysheet-filter-options" style="left:'+(visibledatacolumn[m]-20)+"px;top:"+o+'px;display:block;"><i class="fa fa-caret-down" aria-hidden="true"></i></div>':(y=null!=t[m-a].caljs?(h=null!=t[m-a].caljs.value1?'data-byconditionvalue1="'+t[m-a].caljs.value1+'" ':"",d=null!=t[m-a].caljs.value2?'data-byconditionvalue2="'+t[m-a].caljs.value2+'" ':"",'data-caljs="'+JSON.stringify(t[m-a].caljs)+'" data-byconditionvalue="'+t[m-a].caljs.value+'" data-byconditiontype="'+t[m-a].caljs.type+'" data-byconditiontext="'+t[m-a].caljs.text+'" '+h+d):"",f+='<div data-rowhidden="'+JSON.stringify(t[m-a].rowhidden).replace(/\"/g,"'")+'" '+y+' data-str="'+l+'" data-edr="'+r+'" data-cindex="'+m+'" data-stc="'+a+'" data-edc="'+s+'" class="luckysheet-filter-options luckysheet-filter-options-active" style="left:'+(visibledatacolumn[m]-20)+"px;top:"+o+'px;display:block;"><i class="fa fa-filter luckysheet-mousedown-cancel" aria-hidden="true"></i></div>')}$("#luckysheet-cell-main").append('<div id="luckysheet-filter-options-sheet'+luckysheet.currentSheetIndex+'" class="luckysheet-filter-options-c">'+f+"</div>"),$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),$("#luckysheet-cell-main").scrollTop()>e.top_move&&$("#luckysheet-scrollbar-y").scrollTop(e.top_move),luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].filter_select=e}},$("#luckysheetfilter").click(luckysheet.createFilter);var submenuhide=null;if($("#luckysheet-filter-orderby-color").hover(function(){for(var e=$("#luckysheet-filter-menu"),t=e.data("str"),l=e.data("edr"),r=e.data("cindex"),a=(e.data("stc"),e.data("edc"),{}),s={},n=luckysheet.alternateformat.getComputeMap(),o=luckysheet.conditionformat.getComputeMap(),c=t+1;c<=l;c++){var u=luckysheet.flowdata[c][r],i=luckysheet.menuButton.checkstatus(luckysheet.flowdata,c,r,"bg"),h=luckysheet.alternateformat.checksAF(c,r,n);null!=h&&(i=h[1]);var d=luckysheet.conditionformat.checksCF(c,r,o);null!=d&&null!=d.cellColor&&(i=d.cellColor),-1<i.indexOf("rgb")&&(i=luckysheet.rgbTohex(i)),4==i.length&&(i=i.substr(0,1)+i.substr(1,1).repeat(2)+i.substr(2,1).repeat(2)+i.substr(3,1).repeat(2));var y=luckysheet.menuButton.checkstatus(luckysheet.flowdata,c,r,"fc");null!=h&&(y=h[0]),null!=d&&null!=d.textColor&&(y=d.textColor),-1<y.indexOf("rgb")&&(y=luckysheet.rgbTohex(y)),4==y.length&&(y=y.substr(0,1)+y.substr(1,1).repeat(2)+y.substr(2,1).repeat(2)+y.substr(3,1).repeat(2)),null!=config&&null!=config.rowhidden&&c in config.rowhidden?(a[i]=1,null==u||luckysheet.func_methods.isRealNull(u.v)||(s[y]=1)):(a[i]=0,null==u||luckysheet.func_methods.isRealNull(u.v)||(s[y]=0))}var m="";if(2<JSON.stringify(a).length&&1<Object.keys(a).length){var k="";for(b in a)0==a[b]?k+='<div class="item luckysheet-mousedown-cancel"><label class="luckysheet-mousedown-cancel" style="background-color: '+b+'" title="'+b+'"></label><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/></div>':k+='<div class="item luckysheet-mousedown-cancel"><label class="luckysheet-mousedown-cancel" style="background-color: '+b+'" title="'+b+'"></label><input class="luckysheet-mousedown-cancel" type="checkbox"/></div>';m='<div id="filterBgColor" class="box luckysheet-mousedown-cancel"><div class="title luckysheet-mousedown-cancel">按单元格颜色筛选</div><div style="max-height:128px;overflow:auto;" class="luckysheet-mousedown-cancel">'+k+"</div></div>"}var p,g="";if(2<JSON.stringify(s).length&&1<Object.keys(s).length){var v="";for(f in s)0==s[f]?v+='<div class="item luckysheet-mousedown-cancel"><label class="luckysheet-mousedown-cancel" style="background-color: '+f+'" title="'+f+'"></label><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/></div>':v+='<div class="item luckysheet-mousedown-cancel"><label class="luckysheet-mousedown-cancel" style="background-color: '+f+'" title="'+f+'"></label><input class="luckysheet-mousedown-cancel" type="checkbox"/></div>';g='<div id="filterFcColor" class="box luckysheet-mousedown-cancel"><div class="title luckysheet-mousedown-cancel">按字体颜色筛选</div><div style="max-height:128px;overflow:auto;" class="luckysheet-mousedown-cancel">'+v+"</div></div>"}p=""==m&&""==g?'<div class="luckysheet-mousedown-cancel" style="padding: 10px 30px;text-align: center;">本列仅包含一种颜色</div>':m+g+'<div class="luckysheet-mousedown-cancel"><button id="luckysheet-filter-orderby-color-confirm" class="btn btn-primary luckysheet-mousedown-cancel" style="margin: 5px 20px;width: 70px;">确认</button></div>',$("#luckysheet-filter-orderby-color-submenu").remove(),$("body").append('<div id="luckysheet-filter-orderby-color-submenu" class="luckysheet-cols-menu luckysheet-mousedown-cancel">'+p+"</div>");var _=$("#luckysheet-filter-orderby-color-submenu").end(),w=_.outerHeight(),x=_.outerWidth(),C=$(this).parent(),T=$(window).width(),I=$(window).height(),R=C.width(),w=_.height()+25,x=_.width()+5,S=$(this).offset(),A=S.top,F=S.left+R;T<F+x&&(F=S.left-x),I<A+w&&(A=I-w),$("#luckysheet-filter-orderby-color-submenu").css({top:A,left:F}).show()},function(){submenuhide=setTimeout(function(){$("#luckysheet-filter-orderby-color-submenu").hide()},200)}),$(document).on("mouseover mouseleave","#luckysheet-filter-orderby-color-submenu",function(e){"mouseover"===e.type?clearTimeout(submenuhide):$(this).hide()}),$(document).on("click","#luckysheet-filter-orderby-color-submenu .item label",function(){$(this).siblings("input[type='checkbox']").click()}),$(document).off("click.orderbyColorConfirm").on("click.orderbyColorConfirm","#luckysheet-filter-orderby-color-submenu #luckysheet-filter-orderby-color-confirm",function(){var e,t,a={},s={};$("#luckysheet-filter-orderby-color-submenu .item").each(function(e,t){var l,r;$(t).find("input[type='checkbox']").is(":checked")&&(l=$(this).find("label").attr("title"),"filterBgColor"==(r=$(this).closest(".box").attr("id"))?a[l]=0:"filterFcColor"==r&&(s[l]=0))}),e=0<$("#luckysheet-filter-orderby-color-submenu #filterBgColor").length,t=0<$("#luckysheet-filter-orderby-color-submenu #filterFcColor").length;var l=$("#luckysheet-filter-menu"),r=l.data("str"),n=l.data("edr"),o=l.data("cindex"),c=l.data("stc"),u=l.data("edc"),i={};$("#luckysheet-filter-options-sheet"+luckysheet.currentSheetIndex+" .luckysheet-filter-options").not($("#luckysheet-filter-options-sheet"+luckysheet.currentSheetIndex+" .luckysheet-filter-options").eq(o-c).get(0)).each(function(){var e=$(this).data("rowhidden");if(""==e)return!0;for(var t in JSON.parse(e))i[t]=0});for(var h,d,y,f,m,k={},p={},g=luckysheet.alternateformat.getComputeMap(),v=luckysheet.conditionformat.getComputeMap(),b=r+1;b<=n;b++){b in i||null!=luckysheet.flowdata[b]&&(h=luckysheet.flowdata[b][o],d=luckysheet.menuButton.checkstatus(luckysheet.flowdata,b,o,"bg"),null!=(y=luckysheet.alternateformat.checksAF(b,o,g))&&(d=y[1]),null!=(f=luckysheet.conditionformat.checksCF(b,o,v))&&null!=f.cellColor&&(d=f.cellColor),-1<d.indexOf("rgb")&&(d=luckysheet.rgbTohex(d)),4==d.length&&(d=d.substr(0,1)+d.substr(1,1).repeat(2)+d.substr(2,1).repeat(2)+d.substr(3,1).repeat(2)),m=luckysheet.menuButton.checkstatus(luckysheet.flowdata,b,o,"fc"),null!=y&&(m=y[0]),null!=f&&null!=f.textColor&&(m=f.textColor),-1<m.indexOf("rgb")&&(m=luckysheet.rgbTohex(m)),4==m.length&&(m=m.substr(0,1)+m.substr(1,1).repeat(2)+m.substr(2,1).repeat(2)+m.substr(3,1).repeat(2)),e&&t?d in a||m in s&&null!=h&&!luckysheet.func_methods.isRealNull(h.v)||(k[b]=0):e?d in a||(k[b]=0):t&&(m in s&&null!=h&&!luckysheet.func_methods.isRealNull(h.v)||(k[b]=0)))}var _=$("#luckysheet-filter-options-sheet"+luckysheet.currentSheetIndex+" .luckysheet-filter-options").eq(o-c),w=0<Object.keys(k).length,x=$.extend(!0,i,k),C=luckysheet.json.parseJsonParm(_.data("rowhidden"));luckysheet.labelFilterOptionState(_,w,k,p,!0,r,n,o,c,u);var T,I=$.extend(!0,{},config);I.rowhidden=x,clearjfundo&&((T={type:"datachangeAll_filter"}).sheetIndex=luckysheet.currentSheetIndex,T.config=$.extend(!0,{},config),T.curconfig=I,T.optionstate=w,T.optionsindex=o-c,T.rowhidden=$.extend(!0,{},k),T.rowhidenPre=$.extend(!0,{},C),null!=p&&(T.caljs=p),luckysheet.jfundo=[],luckysheet.jfredo.push(T)),config=I,luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].config=config,luckysheet.server.saveParam("cg",luckysheet.currentSheetIndex,I.rowhidden,{k:"rowhidden"}),luckysheet.jfrefreshgrid_rhcw(luckysheet.flowdata.length,luckysheet.flowdata[0].length),$("#luckysheet-filter-menu, #luckysheet-filter-submenu, #luckysheet-filter-orderby-color-submenu").hide(),luckysheet.cleargridelement()}),$("#luckysheet-cell-main").on("click",".luckysheet-filter-options",function(e){var t=$(e.currentTarget),T=t.offset(),l=$("#luckysheet-filter-menu"),I=$(window).height(),R=($(window).width(),t.data("str")),S=t.data("edr"),A=t.data("cindex"),r=t.data("stc"),a=t.data("edc"),F=""==t.data("rowhidden")?{}:JSON.parse(t.data("rowhidden").replace(/\'/g,'"'));$("body .luckysheet-cols-menu").hide(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),$("#luckysheet-filter-byvalue-input").val(""),$("#luckysheet-filter-bycondition").next().hide(),$("#luckysheet-filter-byvalue").next().show(),l.data("str",R),l.data("edr",S),l.data("cindex",A),l.data("stc",r),l.data("edc",a),$("#luckysheet-filter-menu .luckysheet-filter-selected-input").hide().find("input").val(),$("#luckysheet-filter-selected span").data("type","0").data("type",null).text("无");var s,n=t.data("byconditiontype");$("#luckysheet-filter-selected span").data("value",t.data("byconditionvalue")).data("type",n).text(t.data("byconditiontext")),"2"==n?((s=$("#luckysheet-filter-menu .luckysheet-filter-selected-input2").show().find("input")).eq(0).val(t.data("byconditionvalue1")),s.eq(1).val(t.data("byconditionvalue2"))):"1"==n&&$("#luckysheet-filter-menu .luckysheet-filter-selected-input").eq(0).show().find("input").val(t.data("byconditionvalue1")),$("#luckysheet-filter-orderby-asc").off("click").on("click",function(){orderbydatafiler(R,r,S,a,A,!0)}),$("#luckysheet-filter-orderby-desc").off("click").on("click",function(){orderbydatafiler(R,r,S,a,A,!1)}),$("#luckysheet-filter-byvalue-select").empty().html('<div style="width:100%;text-align:center;position:relative;top:45%;font-size:14px;"><div class="luckysheetLoaderGif"></div><span>数据量大！请稍后</span></div>');var N={};$("#luckysheet-filter-options-sheet"+luckysheet.currentSheetIndex+" .luckysheet-filter-options").not(this).each(function(){var e=$(this).data("rowhidden");if(""==e)return!0;for(var t in e=JSON.parse(e.replace(/\'/g,'"')))N[t]=0});luckysheet.flowdata;return setTimeout(function(){for(var e,t,l,r,a={},s={},n={},o={},c=R+1;c<=S;c++){c in N||null!=luckysheet.flowdata[c]&&(null==(e=luckysheet.flowdata[c][A])||luckysheet.func_methods.isRealNull(e.v)||null==e.ct||"d"!=e.ct.t?(l=null==e||luckysheet.func_methods.isRealNull(e.v)?C=null:(C=e.v,e.m),C in n||(n[C]={}),l in n[C]||(n[C][l]=0),n[C][l]++,c in F&&(o[C+"#$$$#"+l]=0)):(t=(C=luckysheet.mask.update("YYYY-MM-DD",e.v)).split("-")[0],l=C.split("-")[1],r=C.split("-")[2],t in a||(a[t]={}),l in a[t]||(a[t][l]={}),r in a[t][l]||(a[t][l][r]=0),a[t][l][r]++,c in F&&(s[t]=0,s[l]=0,s[r]=0)))}var u=[];if(2<JSON.stringify(a).length)for(t in a){var i,h=0,d="";for(l in a[t]){var y,f=0,m="";for(r in a[t][l]){var k,p,g=a[t][l][r];f+=g,k=Number(l)<10?"0"+Number(l):l,p=Number(r)<10?"0"+Number(r):r,t in s&&l in s&&r in s?m+='<div class="day luckysheet-mousedown-cancel cf" data-check="false" title="'+t+"-"+k+"-"+p+'"><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+r+'</label><span class="count luckysheet-mousedown-cancel">( '+g+" )</span></div>":m+='<div class="day luckysheet-mousedown-cancel cf" data-check="true" title="'+t+"-"+k+"-"+p+'"><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+r+'</label><span class="count luckysheet-mousedown-cancel">( '+g+" )</span></div>"}h+=f,y=Number(l)<10?"0"+Number(l):l,t in s&&l in s?d+='<div class="monthBox luckysheet-mousedown-cancel"><div class="month luckysheet-mousedown-cancel cf" data-check="false" title="'+t+"-"+y+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+l+'月</label><span class="count luckysheet-mousedown-cancel">( '+f+' )</span></div><div class="dayList luckysheet-mousedown-cancel">'+m+"</div></div>":d+='<div class="monthBox luckysheet-mousedown-cancel"><div class="month luckysheet-mousedown-cancel cf" data-check="true" title="'+t+"-"+y+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+l+'月</label><span class="count luckysheet-mousedown-cancel">( '+f+' )</span></div><div class="dayList luckysheet-mousedown-cancel">'+m+"</div></div>"}i=t in s?'<div class="yearBox luckysheet-mousedown-cancel"><div class="year luckysheet-mousedown-cancel cf" data-check="false" title="'+t+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+t+'年</label><span class="count luckysheet-mousedown-cancel">( '+h+' )</span></div><div class="monthList luckysheet-mousedown-cancel">'+d+"</div></div>":'<div class="yearBox luckysheet-mousedown-cancel"><div class="year luckysheet-mousedown-cancel cf" data-check="true" title="'+t+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+t+'年</label><span class="count luckysheet-mousedown-cancel">( '+h+' )</span></div><div class="monthList luckysheet-mousedown-cancel">'+d+"</div></div>",u.unshift(i)}if(2<JSON.stringify(n).length)for(var v=Object.keys(n),v=luckysheet.orderbydata1D(v,!0),b=0;b<v.length;b++){var _,w,C=v[b];for(x in n[C]){_=C+"#$$$#"+x=="null#$$$#null"?"(空白)":x,w=C+"#$$$#"+x in o?'<div class="textBox luckysheet-mousedown-cancel cf" data-check="false" data-filter="'+C+"#$$$#"+x+'" title="'+_+'"><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+_+'</label><span class="luckysheet-mousedown-cancel count">( '+n[C][x]+" )</span></div>":'<div class="textBox luckysheet-mousedown-cancel cf" data-check="true" data-filter="'+C+"#$$$#"+x+'" title="'+_+'"><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+_+'</label><span class="luckysheet-mousedown-cancel count">( '+n[C][x]+" )</span></div>",u.push(w)}}$("#luckysheet-filter-byvalue-select").html("<div class='ListBox luckysheet-mousedown-cancel' style='min-height: 100px; max-height: "+(I-T.top-350)+"px; overflow-y: auto; overflow-x: hidden;'><table cellspacing='0' style='width:100%;' class='luckysheet-mousedown-cancel'>"+u.join("")+"</table></div>")},1),showrightclickmenu(l,T.left,T.top+20),e.stopPropagation(),!1}),$(document).off("click.filterCheckbox1").on("click.filterCheckbox1","#luckysheet-filter-byvalue-select .textBox",function(){"true"==$(this).attr("data-check")?($(this).attr("data-check","false"),$(this).find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).find("input[type='checkbox']").prop("checked",!0))}),$(document).off("click.filterCheckbox2").on("click.filterCheckbox2","#luckysheet-filter-byvalue-select .year",function(){"true"==$(this).attr("data-check")?($(this).attr("data-check","false"),$(this).parents(".yearBox").find(".month").attr("data-check","false"),$(this).parents(".yearBox").find(".day").attr("data-check","false"),$(this).parents(".yearBox").find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).parents(".yearBox").find(".month").attr("data-check","true"),$(this).parents(".yearBox").find(".day").attr("data-check","true"),$(this).parents(".yearBox").find("input[type='checkbox']").prop("checked",!0))}),$(document).off("click.filterCheckbox3").on("click.filterCheckbox3","#luckysheet-filter-byvalue-select .month",function(){"true"==$(this).attr("data-check")?($(this).attr("data-check","false"),$(this).parents(".monthBox").find(".day").attr("data-check","false"),$(this).parents(".monthBox").find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).parents(".monthBox").find(".day").attr("data-check","true"),$(this).parents(".monthBox").find("input[type='checkbox']").prop("checked",!0));var l=!0;$(this).parents(".yearBox").find(".day").each(function(e,t){"true"==$(t).attr("data-check")||(l=!1)}),l?($(this).parents(".yearBox").find(".year").attr("data-check","true"),$(this).parents(".yearBox").find(".year input[type='checkbox']").prop("checked",!0)):($(this).parents(".yearBox").find(".year").attr("data-check","false"),$(this).parents(".yearBox").find(".year input[type='checkbox']").removeAttr("checked"))}),$(document).off("click.filterCheckbox4").on("click.filterCheckbox4","#luckysheet-filter-byvalue-select .day",function(){"true"==$(this).attr("data-check")?($(this).attr("data-check","false"),$(this).find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).find("input[type='checkbox']").prop("checked",!0));var l=!0;$(this).parents(".monthBox").find(".day").each(function(e,t){"true"==$(t).attr("data-check")||(l=!1)}),l?($(this).parents(".monthBox").find(".month").attr("data-check","true"),$(this).parents(".monthBox").find(".month input[type='checkbox']").prop("checked",!0)):($(this).parents(".monthBox").find(".month").attr("data-check","false"),$(this).parents(".monthBox").find(".month input[type='checkbox']").removeAttr("checked"));var r=!0;$(this).parents(".yearBox").find(".day").each(function(e,t){"true"==$(t).attr("data-check")||(r=!1)}),r?($(this).parents(".yearBox").find(".year").attr("data-check","true"),$(this).parents(".yearBox").find(".year input[type='checkbox']").prop("checked",!0)):($(this).parents(".yearBox").find(".year").attr("data-check","false"),$(this).parents(".yearBox").find(".year input[type='checkbox']").removeAttr("checked"))}),$(document).off("click.filterYearDropdown").on("click.filterYearDropdown","#luckysheet-filter-byvalue-select .yearBox .fa-caret-right",function(e){var t=$(this).parents(".luckysheet-mousedown-cancel");t.hasClass("year")&&$(this).parents(".yearBox").find(".monthList").slideToggle(),t.hasClass("month")&&$(this).parents(".monthBox").find(".dayList").slideToggle(),e.stopPropagation()}),$("#luckysheet-filter-byvalue-btn-all").click(function(){$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").prop("checked",!0),$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").parents(".luckysheet-mousedown-cancel").attr("data-check","true")}),$("#luckysheet-filter-byvalue-btn-clear").click(function(){$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").removeAttr("checked"),$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").parents(".luckysheet-mousedown-cancel").attr("data-check","false")}),$("#luckysheet-filter-byvalue-btn-contra").click(function(){$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").each(function(e,t){$(t).is(":checked")?($(t).removeAttr("checked"),$(t).parents(".luckysheet-mousedown-cancel").attr("data-check","false")):($(t).prop("checked",!0),$(t).parents(".luckysheet-mousedown-cancel").attr("data-check","true"))}),$("#luckysheet-filter-byvalue-select .ListBox .monthBox").each(function(e,t){var l=!0;$(t).find(".day input[type='checkbox']").each(function(e,t){$(t).is(":checked")||(l=!1)}),l?($(t).find(".month input[type='checkbox']").prop("checked",!0),$(t).attr("data-check","true")):($(t).find(".month input[type='checkbox']").removeAttr("checked"),$(t).attr("data-check","false"))}),$("#luckysheet-filter-byvalue-select .ListBox .yearBox").each(function(e,t){var l=!0;$(t).find(".day input[type='checkbox']").each(function(e,t){$(t).is(":checked")||(l=!1)}),l?($(t).find(".year input[type='checkbox']").prop("checked",!0),$(t).attr("data-check","true")):($(t).find(".year input[type='checkbox']").removeAttr("checked"),$(t).attr("data-check","false"))})}),$("#luckysheet-filter-initial").click(function(){$("#luckysheet-filter-menu .luckysheet-filter-selected-input").hide().find("input").val(),$("#luckysheet-filter-selected span").data("type","0").data("type",null).text("无"),$("#luckysheet-filter-selected-sheet"+luckysheet.currentSheetIndex+", #luckysheet-filter-options-sheet"+luckysheet.currentSheetIndex).remove(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide();var e={type:"datachangeAll_filter_clear"};e.sheetIndex=luckysheet.currentSheetIndex,e.config=$.extend(!0,{},config),config.rowhidden={},e.curconfig=$.extend(!0,{},config),e.filter_save=$.extend(!0,{},luckysheet_filter_save);var a=[];$("#luckysheet-filter-options-sheet"+luckysheet.currentSheetIndex+" .luckysheet-filter-options").each(function(){var e=$(this),t=e.hasClass("luckysheet-filter-options-active"),l=luckysheet.json.parseJsonParm(e.data("rowhidden")),r=luckysheet.json.parseJsonParm(e.data("caljs"));a.push({optionstate:t,rowhidden:l,caljs:r,str:e.data("str"),edr:e.data("edr"),cindex:e.data("cindex"),stc:e.data("stc"),edc:e.data("edc")})}),e.optiongroups=a,luckysheet.jfundo=[],luckysheet.jfredo.push(e),luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].filter=null,luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].filter_select=null,luckysheet.server.saveParam("fsc",luckysheet.currentSheetIndex,null),luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].config=config,luckysheet.server.saveParam("cg",luckysheet.currentSheetIndex,{},{k:"rowhidden"}),luckysheet.jfrefreshgrid_rhcw(luckysheet.flowdata.length,luckysheet.flowdata[0].length)}),$("#luckysheet-filter-byvalue-input").on("input propertychange",function(){var a=$(this).val().toString();$("#luckysheet-filter-byvalue-select .ListBox .luckysheet-mousedown-cancel").show(),""!=a&&$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").each(function(e,t){var l,r;0<$(t).closest(".day").length&&(l=$(t).siblings("label").text().toString(),r=$(t).closest(".monthBox").find(".month label").text().toString(),-1==($(t).closest(".yearBox").find(".year label").text().toString()+"-"+r+"-"+l).indexOf(a)&&($(t).closest(".day").hide(),0==$(t).closest(".dayList").find(".day:visible").length&&$(t).closest(".monthBox").find(".month").hide(),0==$(t).closest(".monthList").find(".day:visible").length&&$(t).closest(".yearBox").find(".year").hide())),0<$(t).closest(".textBox").length&&-1==$(t).siblings("label").text().toString().indexOf(a)&&$(t).parents(".textBox").hide()})}),0<luckysheetConfigsetting.userMenuItem.length){$("body").append('<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel" id="luckysheet-user-menu">${item}</div>');for(var itemset="",i=0;i<luckysheetConfigsetting.userMenuItem.length;i++){var item=luckysheetConfigsetting.userMenuItem[i];itemset+='<div data-src="'+item.url+'" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 6px 0px 6px 5px;"><span style="margin-right:3px;" class="icon luckysheet-mousedown-cancel">'+item.icon+"</span> "+item.name+"</div></div>"}$("#luckysheet-user-menu").html(itemset).find("i").addClass("luckysheet-mousedown-cancel").end().find(".luckysheet-cols-menuitem").click(function(){window.open($(this).data("src"),"_self")})}$("#luckysheet_info_detail_title").click(function(){window.open(luckysheetConfigsetting.myFolderUrl,"_self")}),$("#luckysheet_info_detail_input").val(luckysheet.server.title).css("width",10*luckysheet.getByteLen(luckysheet.server.title)).keydown(function(){event.ctrlKey,event.altKey,event.shiftKey;var e=event.keyCode,t=$(this);e==keycode.ENTER&&t.blur().change()}).bind("input propertychange",function(){var e=$(this),t=10*luckysheet.getByteLen(e.val()),l=$("#luckysheet_info_detail_update").outerWidth(),r=$("#luckysheet_info_detail_save").outerWidth(),a=$("#luckysheet_info_detail_user").parent().outerWidth()+60,s=$("#"+container).outerWidth()-r-l-a-100;s<t?$("#luckysheet_info_detail_input").css("width",s):$("#luckysheet_info_detail_input").css("width",t)}).change(function(){luckysheet.server.saveParam("na",null,$(this).val())}),$("#luckysheet-functionbox-cell").focus(function(){var e,t,l,r,a,s,n,o;luckysheet.isEditMode()||0<luckysheet_select_save.length&&(t=(e=luckysheet_select_save[luckysheet_select_save.length-1]).row_focus,l=e.column_focus,r=visibledatarow[t],a=t-1==-1?0:visibledatarow[t-1],s=visibledatacolumn[l],n=l-1==-1?0:visibledatacolumn[l-1],(o=luckysheet.menuButton.mergeborer(luckysheet.flowdata,t,l))&&(r=o.row[1],a=o.row[0],t=o.row[2],s=o.column[1],n=o.column[0],l=o.column[2]),luckysheet.luckysheetupdateCell(r,a,t,s,n,l,luckysheet.flowdata,null,!0),luckysheet.formula.rangeResizeTo=$("#luckysheet-functionbox-cell"))}).keydown(function(e){var t,l,r;luckysheet.isEditMode()||(e.ctrlKey,e.altKey,e.shiftKey,t=e.keyCode,l=$("#luckysheet-input-box"),t==keycode.ENTER&&0<parseInt(l.css("top"))?($("#luckysheet-formula-search-c").is(":visible")&&null!=luckysheet.formula.searchFunctionCell?luckysheet.formula.searchFunctionEnter($("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active")):(luckysheet.formula.updatecell(luckysheetCellUpdate[0],luckysheetCellUpdate[1]),luckysheet_select_save=[{row:[luckysheetCellUpdate[0],luckysheetCellUpdate[0]],column:[luckysheetCellUpdate[1],luckysheetCellUpdate[1]],row_focus:luckysheetCellUpdate[0],column_focus:luckysheetCellUpdate[1]}],luckysheetMoveHighlightCell("down",1,"rangeOfSelect"),$("#luckysheet-functionbox-cell").blur()),e.preventDefault()):t==keycode.ESC&&0<parseInt(l.css("top"))?(luckysheet.formula.dontupdate(),luckysheetMoveHighlightCell("down",0,"rangeOfSelect"),e.preventDefault()):t==keycode.F4&&0<parseInt(l.css("top"))?(luckysheet.formula.setfreezonFuc(e),e.preventDefault()):t==keycode.UP&&0<parseInt(l.css("top"))?$("#luckysheet-formula-search-c").is(":visible")&&(0==(r=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active").prev()).length&&(r=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").last()),$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").removeClass("luckysheet-formula-search-item-active"),r.addClass("luckysheet-formula-search-item-active"),e.preventDefault()):t==keycode.DOWN&&0<parseInt(l.css("top"))?$("#luckysheet-formula-search-c").is(":visible")&&(0==(r=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active").next()).length&&(r=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").first()),$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").removeClass("luckysheet-formula-search-item-active"),r.addClass("luckysheet-formula-search-item-active"),e.preventDefault()):t==keycode.LEFT&&0<parseInt(l.css("top"))||t==keycode.RIGHT&&0<parseInt(l.css("top"))?luckysheet.formula.rangeHightlightselected($("#luckysheet-functionbox-cell")):(!(112<=t&&t<=123||t<=46||144==t||108==t||e.ctrlKey||e.altKey||e.shiftKey&&(37==t||38==t||39==t||40==t))||8==t||32==t||46==t||e.ctrlKey&&86==t)&&luckysheet.formula.functionInputHanddler($("#luckysheet-rich-text-editor"),$("#luckysheet-functionbox-cell"),t))}).click(function(){luckysheet.isEditMode()||luckysheet.formula.rangeHightlightselected($("#luckysheet-functionbox-cell"))}),$("#luckysheet-wa-functionbox-cancel").click(function(){$(this).hasClass("luckysheet-wa-calculate-active")&&($("#luckysheet-search-formula-parm").is(":visible")&&$("#luckysheet-search-formula-parm").hide(),$("#luckysheet-search-formula-parm-select").is(":visible")&&$("#luckysheet-search-formula-parm-select").hide(),luckysheet.formula.dontupdate(),luckysheetMoveHighlightCell("down",0,"rangeOfSelect"))}),$("#luckysheet-wa-functionbox-confirm").click(function(){$(this).hasClass("luckysheet-wa-calculate-active")&&($("#luckysheet-search-formula-parm").is(":visible")&&$("#luckysheet-search-formula-parm").hide(),$("#luckysheet-search-formula-parm-select").is(":visible")&&$("#luckysheet-search-formula-parm-select").hide(),luckysheet.formula.updatecell(luckysheetCellUpdate[0],luckysheetCellUpdate[1]),luckysheetMoveHighlightCell("down",0,"rangeOfSelect"))}),$("#luckysheet-wa-functionbox-fx").click(function(){var e,t,l,r,a,s,n,o,c;0!=luckysheet_select_save.length?(t=(e=luckysheet_select_save[luckysheet_select_save.length-1]).row_focus,l=e.column_focus,r=visibledatarow[t],a=t-1==-1?0:visibledatarow[t-1],s=visibledatacolumn[l],n=l-1==-1?0:visibledatacolumn[l-1],luckysheet.luckysheetupdateCell(r,a,t,s,n,l,luckysheet.flowdata),null!=(o=luckysheet.flowdata[t][l])&&null!=o.f?null!=(c=luckysheet.formula.getfunctionParam(o.f)).fn?luckysheet.insertFormula.formulaParmDialog(c.fn,c.param):luckysheet.insertFormula.formulaListDialog():($("#luckysheet-rich-text-editor").html('<span dir="auto" class="luckysheet-formula-text-color">=</span>'),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),luckysheet.insertFormula.formulaListDialog()),luckysheet.insertFormula.init()):luckysheet.isEditMode()?alert("请选择单元格插入函数"):luckysheet.tooltip.info("请选择单元格插入函数","")}),$("#luckysheet-formula-functionrange").on("mousedown",".luckysheet-copy",function(e){luckysheet.formula.rangeMove=!0,luckysheet_scroll_status=!0,luckysheet.formula.rangeMoveObj=$(this).parent(),luckysheet.formula.rangeMoveIndex=$(this).parent().attr("rangeindex");var t=mouseposition(e.pageX,e.pageY),l=t[0]+$("#luckysheet-cell-main").scrollLeft(),r=t[1]+$("#luckysheet-cell-main").scrollTop();$("#luckysheet-formula-functionrange-highlight-"+luckysheet.formula.rangeMoveIndex).find(".luckysheet-selection-copy-hc").css("opacity",.13);var a=$(this).data("type");"top"==a?r+=3:"right"==a?l-=3:"bottom"==a?r-=3:"left"==a&&(l+=3);var s=luckysheet.rowLocation(r)[2],n=luckysheet.colLocation(l)[2];luckysheet.formula.rangeMovexy=[s,n],$("#luckysheet-sheettable").css("cursor","move"),e.stopPropagation()}),$("#luckysheet-formula-functionrange").on("mousedown",".luckysheet-highlight",function(e){luckysheet.formula.rangeResize=$(this).data("type"),luckysheet.formula.rangeResizeIndex=$(this).parent().attr("rangeindex");var t=mouseposition(e.pageX,e.pageY),l=$("#luckysheet-cell-main").scrollLeft(),r=$("#luckysheet-cell-main").scrollTop(),a=t[0]+l,s=t[1]+r;luckysheet.formula.rangeResizeObj=$(this).parent(),$("#luckysheet-formula-functionrange-highlight-"+luckysheet.formula.rangeResizeIndex).find(".luckysheet-selection-copy-hc").css("opacity",.13),"lt"==luckysheet.formula.rangeResize?(a+=3,s+=3):"lb"==luckysheet.formula.rangeResize?(a+=3,s-=3):"rt"==luckysheet.formula.rangeResize?(a-=3,s+=3):"rb"==luckysheet.formula.rangeResize&&(a-=3,s-=3);var n=luckysheet.rowLocation(s),o=n[1],c=n[0],u=(n[2],luckysheet.colLocation(a)),i=u[1],h=u[0],d=(u[2],luckysheet.formula.rangeResizeObj.position());luckysheet.formula.rangeResizexy=[h,c,luckysheet.formula.rangeResizeObj.width(),luckysheet.formula.rangeResizeObj.height(),d.left+l,d.top+r,i,o],luckysheet.formula.rangeResizeWinH=$("#luckysheet-cell-main")[0].scrollHeight,luckysheet.formula.rangeResizeWinW=$("#luckysheet-cell-main")[0].scrollWidth,luckysheet_scroll_status=!0,event.stopPropagation()}),$("#luckysheet-chart-rangeShow").on("mousedown.chartRangeShowMove",".luckysheet-chart-rangeShow-move",function(e){luckysheet.chart_selection.rangeMove=!0,luckysheet_scroll_status=!0,luckysheet.chart_selection.rangeMoveObj=$(this).parent();var t,l,r=luckysheet.chartparam.luckysheetCurrentChartMoveObj.find(".luckysheet-modal-dialog-content").attr("id"),a=!!window.store&&store.state.chartSetting.chartList[r],s=$(this).parent().attr("id");"luckysheet-chart-rangeShow-content"==s?(t=a.rangeArray[0].row[0]+a.rangeSplitArray.content.row[0],l=a.rangeArray[0].column[0]+a.rangeSplitArray.content.column[0],luckysheet.chart_selection.rangeMoveIndex=[t,l]):"luckysheet-chart-rangeShow-rowtitle"==s?(t=a.rangeArray[0].row[0]+a.rangeSplitArray.rowtitle.row[0],l=a.rangeArray[0].column[0]+a.rangeSplitArray.rowtitle.column[0],luckysheet.chart_selection.rangeMoveIndex=[t,l]):"luckysheet-chart-rangeShow-coltitle"==s&&(t=a.rangeArray[0].row[0]+a.rangeSplitArray.coltitle.row[0],l=a.rangeArray[0].column[0]+a.rangeSplitArray.coltitle.column[0],luckysheet.chart_selection.rangeMoveIndex=[t,l]);var n=luckysheet.mouseposition(e.pageX,e.pageY),o=n[0]+$("#luckysheet-cell-main").scrollLeft(),c=n[1]+$("#luckysheet-cell-main").scrollTop(),u=$(this).data("type");"top"==u?c+=3:"right"==u?o-=3:"bottom"==u?c-=3:"left"==u&&(o+=3);var i=luckysheet.rowLocation(c)[2],h=luckysheet.colLocation(o)[2];luckysheet.chart_selection.rangeMovexy=[i,h],e.stopPropagation()}),$("#luckysheet-chart-rangeShow").on("mousedown.chartRangeShowResize",".luckysheet-chart-rangeShow-resize",function(e){luckysheet.chart_selection.rangeResize=$(this).data("type"),luckysheet_scroll_status=!0,luckysheet.chart_selection.rangeResizeObj=$(this).parent();var t,l,r,a,s=luckysheet.chartparam.luckysheetCurrentChartMoveObj.find(".luckysheet-modal-dialog-content").attr("id"),n=!!window.store&&store.state.chartSetting.chartList[s],o=$(this).parent().attr("id");"luckysheet-chart-rangeShow-content"==o?(l=n.rangeRowCheck.exits?(t=n.rangeArray[0].row[0]+n.rangeSplitArray.content.row[0],n.rangeArray[0].row[0]+n.rangeSplitArray.content.row[1]):(t=n.rangeSplitArray.content.row[0],n.rangeSplitArray.content.row[0]),a=n.rangeColCheck.exits?(r=n.rangeArray[0].column[0]+n.rangeSplitArray.content.column[0],n.rangeArray[0].column[0]+n.rangeSplitArray.content.column[1]):(r=n.rangeSplitArray.content.column[0],n.rangeSplitArray.content.column[1]),luckysheet.chart_selection.rangeResizeIndex={row:[t,l],column:[r,a]}):"luckysheet-chart-rangeShow-rowtitle"==o?(t=n.rangeArray[0].row[0]+n.rangeSplitArray.rowtitle.row[0],l=n.rangeArray[0].row[0]+n.rangeSplitArray.rowtitle.row[1],r=n.rangeArray[0].column[0]+n.rangeSplitArray.rowtitle.column[0],a=n.rangeArray[0].column[0]+n.rangeSplitArray.rowtitle.column[1],luckysheet.chart_selection.rangeResizeIndex={row:[t,l],column:[r,a]}):"luckysheet-chart-rangeShow-coltitle"==o&&(t=n.rangeArray[0].row[0]+n.rangeSplitArray.coltitle.row[0],l=n.rangeArray[0].row[0]+n.rangeSplitArray.coltitle.row[1],r=n.rangeArray[0].column[0]+n.rangeSplitArray.coltitle.column[0],a=n.rangeArray[0].column[0]+n.rangeSplitArray.coltitle.column[1],luckysheet.chart_selection.rangeResizeIndex={row:[t,l],column:[r,a]});var c=luckysheet.mouseposition(e.pageX,e.pageY),u=c[0]+$("#luckysheet-cell-main").scrollLeft(),i=c[1]+$("#luckysheet-cell-main").scrollTop();"lt"==luckysheet.chart_selection.rangeResize?(u+=3,i+=3):"lb"==luckysheet.chart_selection.rangeResize?(u+=3,i-=3):"rt"==luckysheet.chart_selection.rangeResize?(u-=3,i+=3):"rb"==luckysheet.chart_selection.rangeResize&&(u-=3,i-=3);var h=luckysheet.rowLocation(i)[2],d=luckysheet.colLocation(u)[2];luckysheet.chart_selection.rangeResizexy=[h,d],e.stopPropagation()}),$("#luckysheet-wa-calculate-size").mousedown(function(e){var t=e.pageY;luckysheet.formula.functionResizeData.y=t,luckysheet.formula.functionResizeStatus=!0,luckysheet.formula.functionResizeData.calculatebarHeight=calculatebarHeight,null!=luckysheet.formula.rangetosheet&&luckysheet.formula.updatecell(luckysheetCellUpdate[0],luckysheetCellUpdate[1])});for(var luckysheet_function_exe={},i=0;i<luckysheet.functionlist.length;i++){var func=luckysheet.functionlist[i];luckysheet_function_exe[func.n]=func}window.luckysheet_function=luckysheet_function_exe,$("#"+container+" .luckysheet-wa-editor").on("click",".luckysheet-toolbar-zoom-combobox",function(e){$(e.currentTarget).addClass("luckysheet-toolbar-combo-button-open"),$(e.currentTarget).find(".luckysheet-toolbar-combo-button-input").focus()}),$("#"+container+" .luckysheet-wa-editor").on("blur",".luckysheet-toolbar-combo-button-input",function(e){$(e.currentTarget).closest(".luckysheet-toolbar-zoom-combobox").removeClass("luckysheet-toolbar-combo-button-open")}),luckysheet.menuButton.initialMenuButton();var devicePixelRatio=window.devicePixelRatio||1,devicePixelRatio=Math.ceil(devicePixelRatio);luckysheet.dpi_x=document.getElementById("testdpidiv").offsetWidth*devicePixelRatio,luckysheet.dpi_y=document.getElementById("testdpidiv").offsetHeight*devicePixelRatio,$("#testdpidiv").remove(),$(document).on("paste",function(e){if(!luckysheet.isEditMode()&&luckysheet.selection.isPasteAction){$("#luckysheet-rich-text-editor").blur(),luckysheet.selection.isPasteAction=!1;var t=window.clipboardData,l=(t=t||e.originalEvent.clipboardData).getData("text/html");if(-1<l.indexOf("luckysheet_copy_action_table")&&null!=luckysheet_copy_save.copyRange&&0<luckysheet_copy_save.copyRange.length){for(var r=[],a=new RegExp("<tr.*?>(.*?)</tr>","g"),s=new RegExp("<td.*?>(.*?)</td>","g"),n=l.match(a),o=0;o<n.length;o++){for(var c=[],u=n[o].match(s),i=0;i<u.length;i++){var h=u[i].replace(/<td.*?>/g,"").replace(/<\/td>/g,"");c.push(h)}r.push(c)}var d,y=luckysheet_copy_save.copyRange[0].row[0],f=luckysheet_copy_save.copyRange[0].row[1],m=luckysheet_copy_save.copyRange[0].column[0],k=luckysheet_copy_save.copyRange[0].column[1],p=luckysheet_copy_save.dataSheetIndex;d=p==luckysheet.currentSheetIndex?luckysheet.editor.deepCopyFlowData(luckysheet.flowdata):luckysheetfile[luckysheet.sheetmanage.getSheetIndex(p)].data;for(var g=!0,A=y;A<=f&&!(5<A-y);A++)for(var v=m;v<=k;v++){var b=d[A][v];if((null!=b&&null!=b.ct&&-1<b.ct.fa.indexOf("w")?d[A][v].v:d[A][v].m)!=r[A-y][v-m]){g=!1;break}}}if(-1<l.indexOf("luckysheet_copy_action_table")&&null!=luckysheet_copy_save.copyRange&&0<luckysheet_copy_save.copyRange.length&&g)luckysheet_paste_iscut?(luckysheet_paste_iscut=!1,luckysheet.selection.pasteHandlerOfCutPaste(luckysheet_copy_save),luckysheet.selection.clearcopy(e)):luckysheet.selection.pasteHandlerOfCopyPaste(luckysheet_copy_save);else if(-1<l.indexOf("table")){$("#luckysheet-copy-content").html(l);var F=new Array($("#luckysheet-copy-content").find("table tr").length),N=0;$("#luckysheet-copy-content").find("table tr").eq(0).find("td").each(function(){var e=parseInt($(this).attr("colspan"));isNaN(e)&&(e=1),N+=e});for(o=0;o<F.length;o++)F[o]=new Array(N);var A=0,M={};$("#luckysheet-copy-content").find("table tr").each(function(){var e=$(this),S=0;e.find("td").each(function(){var e,t=$(this),l={},r=t.text();0==$.trim(r).length?(l.v=null,l.m=""):(e=luckysheet.mask.genarate(t.text()),l.v=e[2],l.ct=e[1],l.m=e[0]);var a=t.css("background-color");"rgba(0, 0, 0, 0)"==a&&(a="rgba(255,255,255)"),l.bg=a;var s=t.css("font-weight");l.bl=400==s||"normal"==s?0:1;var n=t.css("font-style");l.it="normal"==n?0:1;for(var o=t.css("font-family").split(","),c=0;c<o.length;c++){var u=$.trim(o[c].toLowerCase());if(null!=(u=luckysheet.menuButton.fontjson[u])){l.ff=u;break}l.ff=0}var i=Math.floor(72*parseInt(t.css("font-size"))/luckysheet.dpi_y)+1;l.fs=i;var h=t.css("color");l.fc=h;var d=t.css("text-align");l.ht="center"==d?0:"right"==d?2:1;var y=t.css("vertical-align");for(l.vt="middle"==y?0:"top"==y||"text-top"==y?1:2;S<N&&null!=F[A][S];)S++;if(S==N)return!0;if(null==F[A][S]){F[A][S]=l;var f=parseInt(t.attr("rowspan")),m=parseInt(t.attr("colspan"));isNaN(f)&&(f=1),isNaN(m)&&(m=1);for(var k,p=luckysheet_select_save[0].row[0]+A,g=luckysheet_select_save[0].column[0]+S,v=0;v<f;v++)for(var b,_,w,x,C,T,I,R=0;R<m;R++){0!=v||null!=(b=t.css("border-top"))&&0<b.length&&"0px"!=b.substr(0,3).toLowerCase()&&(x=t.css("border-top-width"),C=t.css("border-top-style"),T=t.css("border-top-color"),I=luckysheet.menuButton.getQKBorder(x,C,T),null==M[A+v+"_"+(S+R)]&&(M[A+v+"_"+(S+R)]={}),M[A+v+"_"+(S+R)].t={style:I[0],color:I[1]}),v!=f-1||null!=(_=t.css("border-bottom"))&&0<_.length&&"0px"!=_.substr(0,3).toLowerCase()&&(x=t.css("border-bottom-width"),C=t.css("border-bottom-style"),T=t.css("border-bottom-color"),I=luckysheet.menuButton.getQKBorder(x,C,T),null==M[A+v+"_"+(S+R)]&&(M[A+v+"_"+(S+R)]={}),M[A+v+"_"+(S+R)].b={style:I[0],color:I[1]}),0==R&&null!=(s=t.css("border-left"))&&0<s.length&&"0px"!=s.substr(0,3).toLowerCase()&&(x=t.css("border-left-width"),C=t.css("border-left-style"),T=t.css("border-left-color"),I=luckysheet.menuButton.getQKBorder(x,C,T),null==M[A+v+"_"+(S+R)]&&(M[A+v+"_"+(S+R)]={}),M[A+v+"_"+(S+R)].l={style:I[0],color:I[1]}),R!=m-1||null!=(w=t.css("border-right"))&&0<w.length&&"0px"!=w.substr(0,3).toLowerCase()&&(x=t.css("border-right-width"),C=t.css("border-right-style"),T=t.css("border-right-color"),I=luckysheet.menuButton.getQKBorder(x,C,T),null==M[A+v+"_"+(S+R)]&&(M[A+v+"_"+(S+R)]={}),M[A+v+"_"+(S+R)].r={style:I[0],color:I[1]}),0==v&&0==R||(F[A+v][S+R]={mc:{r:p,c:g}})}(1<f||1<m)&&(k={rs:f,cs:m,r:p,c:g},F[A][S].mc=k)}return++S==N||void 0}),A++}),luckysheet_selection_range=[],luckysheet.selection.pasteHandler(F,M),$("#luckysheet-copy-content").empty()}else l=t.getData("text/plain"),luckysheet.selection.pasteHandler(l)}}),luckysheetConfigsetting.enablePage&&$("#luckysheet-bottom-page-next").click(function(){var e=luckysheetConfigsetting.pageInfo.queryExps,t=luckysheetConfigsetting.pageInfo.reportId,l=luckysheetConfigsetting.pageInfo.fields,r=luckysheetConfigsetting.pageInfo.mobile,a=luckysheetConfigsetting.pageInfo.frezon,s=luckysheetConfigsetting.pageInfo.currentPage,n=(luckysheetConfigsetting.pageInfo.totalPage,luckysheetConfigsetting.pageInfo.pageUrl);luckysheet.method.addDataAjax({queryExps:e,reportId:t,fields:l,mobile:r,frezon:a,pageIndex:s,currentPage:s},luckysheet.currentSheetIndex,n,function(){luckysheetConfigsetting.pageInfo.currentPage++,luckysheetConfigsetting.pageInfo.totalPage==luckysheetConfigsetting.pageInfo.currentPage?($("#luckysheet-bottom-page-next").hide(),$("#luckysheet-bottom-page-info").html("共"+luckysheetConfigsetting.total+"条，"+luckysheetConfigsetting.pageInfo.totalPage+"页，已显示全部数据")):$("#luckysheet-bottom-page-info").html("共"+luckysheetConfigsetting.total+"条，"+luckysheetConfigsetting.pageInfo.totalPage+"页，当前已显示"+luckysheetConfigsetting.pageInfo.currentPage+"页")})}).mousedown(function(e){e.stopPropagation()}),$("#luckysheet-bottom-bottom-top").click(function(){$("#luckysheet-scrollbar-y").scrollTop(0)}).mousedown(function(e){e.stopPropagation()})};var showrightclickmenu=function(e,t,l){var r=$(window).height(),a=$(window).width(),s=e.width(),n=e.height(),o=l,c=a<t+s?t-s:t;r<l+n&&(o=l-n),o<0&&(o=0),e.css({top:o,left:c}).show()};function mouseclickposition(e,t,l,r){var a=$(window).height(),s=($(window).width(),e.width());e.height();null==r&&(r="lefttop"),"lefttop"==r?e.css({top:l,left:t}).show():"righttop"==r?e.css({top:l,left:t-s}).show():"leftbottom"==r?e.css({bottom:a-l-12,left:t}).show():"rightbottom"==r&&e.css({bottom:a-l-12,left:t-s}).show()}luckysheet.showrightclickmenu=showrightclickmenu;var luckysheetfontformat=function(e){if("object"!=luckysheet.getObjType(e))return luckysheetdefaultstyle.font;var t,l,r="";return"0"==e.it||null==e.it?r+="normal ":r+="italic ",r+="normal ","0"==e.bl||null==e.bl?r+="normal ":r+="bold ",e.fs?r+=Math.ceil(e.fs*devicePixelRatio)+"pt ":r+=Math.ceil(10*devicePixelRatio)+"pt ",e.ff?(t=luckysheet.menuButton.fontarray,(l=null)==(l=luckysheet.isdatatypemulti(e.ff).num?t[parseInt(e.ff)]:t[luckysheet.menuButton.fontjson[e.ff]])&&(l="微软雅黑"),r+=l+', "Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif'):r+='微软雅黑, "Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif',r};function luckysheetDrawgrid(e,t,l,r,a,s){0!=$("#luckysheetTableContent").length&&((luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].isPivotTable?luckysheetDrawMain_back:luckysheetDrawMain)(e,t,l,r,a,s),$("#luckysheetTableContent").get(0).getContext("2d").clearRect(0,0,46,20),luckysheetDrawgridColumnTitle(e,l,a),luckysheetDrawgridRowTitle(t,r,s))}function luckysheetDrawgridRowTitle(e,t,l){null==e&&(e=$("#luckysheet-cell-main").scrollTop()),null==t&&(t=luckysheetTableContentHW[1]),null==l&&(l=columeHeaderHeight);var r,a,s,n,o=$("#luckysheetTableContent").get(0).getContext("2d");o.clearRect(0,l*devicePixelRatio,(rowHeaderWidth-1)*devicePixelRatio,t*devicePixelRatio),o.font=luckysheetdefaultstyle.font,o.textBaseline=luckysheetdefaultstyle.textBaseline,o.fillStyle=luckysheetdefaultstyle.fillStyle,-1==(r=luckysheet_searcharray(visibledatarow,e))&&(r=0),-1==(a=luckysheet_searcharray(visibledatarow,e+t))&&(a=visibledatarow.length-1);for(var c,u,i,h=r;h<=a&&(n=0==h?-e-1:visibledatarow[h-1]-e-1,!(e+t<(s=visibledatarow[h]-e)));h++){null!=config.rowhidden&&null!=config.rowhidden[h]||(c=o.measureText(h+1),u=(rowHeaderWidth*devicePixelRatio-c.width)/2,i=(n+(s-n)/2+l)*devicePixelRatio,o.fillText(h+1,u,i)),o.beginPath(),o.moveTo(-1,(s+l-2+.5)*devicePixelRatio),o.lineTo((rowHeaderWidth-1)*devicePixelRatio,(s+l-2+.5)*devicePixelRatio),o.lineWidth=devicePixelRatio,o.strokeStyle=luckysheetdefaultstyle.strokeStyle,o.closePath(),o.stroke()}o.beginPath(),o.moveTo((rowHeaderWidth-2+.5)*devicePixelRatio,(l-1)*devicePixelRatio),o.lineTo((rowHeaderWidth-2+.5)*devicePixelRatio,(rh_height+l)*devicePixelRatio),o.lineWidth=devicePixelRatio,o.strokeStyle=luckysheetdefaultstyle.strokeStyle,o.closePath(),o.stroke(),o.clearRect(0,0,rowHeaderWidth*devicePixelRatio,columeHeaderHeight*devicePixelRatio)}function luckysheetDrawgridColumnTitle(e,t,l){null==e&&(e=$("#luckysheet-cell-main").scrollLeft()),null==t&&(t=luckysheetTableContentHW[0]),null==l&&(l=rowHeaderWidth);var r,a,s,n,o=$("#luckysheetTableContent").get(0).getContext("2d");o.clearRect(l*devicePixelRatio,-.5,t*devicePixelRatio,(columeHeaderHeight-1.5)*devicePixelRatio),o.font=luckysheetdefaultstyle.font,o.textBaseline=luckysheetdefaultstyle.textBaseline,o.fillStyle=luckysheetdefaultstyle.fillStyle,-1==(r=luckysheet_searcharray(visibledatacolumn,e))&&(r=0),-1==(a=luckysheet_searcharray(visibledatacolumn,e+t))&&(a=visibledatacolumn.length-1);for(var c=r;c<=a&&(n=0==c?-e:visibledatacolumn[c-1]-e,!(e+t<(s=visibledatacolumn[c]-e)));c++){var u=luckysheet.luckysheetchatatABC(c),i=o.measureText(u),h=Math.round((n+(s-n)/2+l)*devicePixelRatio-i.width/2),d=Math.round(columeHeaderHeight/2*devicePixelRatio);o.fillText(u,h,d),o.beginPath(),o.moveTo((s+l-2+.5)*devicePixelRatio,.5),o.lineTo((s+l-2+.5)*devicePixelRatio,(columeHeaderHeight-2)*devicePixelRatio),o.lineWidth=devicePixelRatio,o.strokeStyle=luckysheetdefaultstyle.strokeStyle,o.closePath(),o.stroke()}o.beginPath(),o.moveTo((l-1)*devicePixelRatio,(columeHeaderHeight-2+.5)*devicePixelRatio),o.lineTo((ch_width+l-2)*devicePixelRatio,(columeHeaderHeight-2+.5)*devicePixelRatio),o.lineWidth=devicePixelRatio,o.strokeStyle=luckysheetdefaultstyle.strokeStyle,o.closePath(),o.stroke(),o.clearRect(0,0,rowHeaderWidth*devicePixelRatio,columeHeaderHeight*devicePixelRatio)}function luckysheetDrawMain(scrollWidth,scrollHeight,drawWidth,drawHeight,offsetLeft,offsetTop,columnOffsetCell,rowOffsetCell,mycanvas,ctx,ctxdata){if(null!=ctxdata&&(luckysheet.flowdata=ctxdata),null!=luckysheet.flowdata){null==scrollWidth&&(scrollWidth=$("#luckysheet-cell-main").scrollLeft()),null==scrollHeight&&(scrollHeight=$("#luckysheet-cell-main").scrollTop()),null==drawWidth&&(drawWidth=luckysheetTableContentHW[0]),null==drawHeight&&(drawHeight=luckysheetTableContentHW[1]),null==offsetLeft&&(offsetLeft=rowHeaderWidth),null==offsetTop&&(offsetTop=columeHeaderHeight),null==columnOffsetCell&&(columnOffsetCell=0),null==rowOffsetCell&&(rowOffsetCell=0);var luckysheetTableContent=null;if(null!=ctx){var luckysheetTableElement=document.createElement("canvas");luckysheetTableElement.width=drawWidth,luckysheetTableElement.height=drawHeight,luckysheetTableContent=luckysheetTableElement.getContext("2d")}else if(null==mycanvas)luckysheetTableContent=$("#luckysheetTableContent").get(0).getContext("2d");else if("object"==luckysheet.getObjType(mycanvas))try{luckysheetTableContent=mycanvas.get(0).getContext("2d")}catch(e){luckysheetTableContent=mycanvas}else luckysheetTableContent=$("#"+mycanvas).get(0).getContext("2d");luckysheetTableContent.clearRect(0,0,luckysheetTableContentHW[0]*devicePixelRatio,luckysheetTableContentHW[1]*devicePixelRatio);var offlinecanvas=null,offlineElement,dataset_row_st,dataset_row_ed,dataset_col_st,dataset_col_ed,fill_row_st,fill_row_ed,fill_col_st,fill_col_ed,end_r,start_r,end_c,start_c,offlinecanvas=null!=ctx?(offlineElement=document.createElement("canvas"),offlineElement.width=drawWidth,offlineElement.height=drawHeight,offlineElement.getContext("2d")):$("#luckysheetTableContentF").get(0).getContext("2d");offlinecanvas.fillStyle="#ffffff",offlinecanvas.fillRect(0,0,luckysheetTableContentHW[0]*devicePixelRatio,luckysheetTableContentHW[1]*devicePixelRatio),offlinecanvas.font=luckysheetdefaultstyle.font,offlinecanvas.textBaseline="top",offlinecanvas.fillStyle=luckysheetdefaultstyle.fillStyle,dataset_row_st=luckysheet_searcharray(visibledatarow,scrollHeight),dataset_row_ed=luckysheet_searcharray(visibledatarow,scrollHeight+drawHeight),-1==dataset_row_st&&(dataset_row_st=0),dataset_row_st+=rowOffsetCell,-1==dataset_row_ed&&(dataset_row_ed=visibledatarow.length-1),dataset_row_ed+=rowOffsetCell,dataset_row_ed>=visibledatarow.length&&(dataset_row_ed=visibledatarow.length-1),dataset_col_st=luckysheet_searcharray(visibledatacolumn,scrollWidth),dataset_col_ed=luckysheet_searcharray(visibledatacolumn,scrollWidth+drawWidth),-1==dataset_col_st&&(dataset_col_st=0),dataset_col_st+=columnOffsetCell,-1==dataset_col_ed&&(dataset_col_ed=visibledatacolumn.length-1),dataset_col_ed+=columnOffsetCell,dataset_col_ed>=visibledatacolumn.length&&(dataset_col_ed=visibledatacolumn.length-1),fill_row_st=0==dataset_row_st?0:visibledatarow[dataset_row_st-1],fill_row_ed=visibledatarow[dataset_row_ed],fill_col_st=0==dataset_col_st?0:visibledatacolumn[dataset_col_st-1],fill_col_ed=visibledatacolumn[dataset_col_ed],luckysheetTableContent.fillStyle="#ffffff",luckysheetTableContent.fillRect((offsetLeft-1)*devicePixelRatio,(offsetTop-1)*devicePixelRatio,(fill_col_ed-scrollWidth)*devicePixelRatio,(fill_row_ed-scrollHeight)*devicePixelRatio),luckysheetTableContent.font=luckysheetdefaultstyle.font,luckysheetTableContent.textBaseline="top",luckysheetTableContent.fillStyle=luckysheetdefaultstyle.fillStyle;for(var cellupdate=[],mergeCache={},borderOffset={},r=dataset_row_st;r<=dataset_row_ed;r++){start_r=0==r?-scrollHeight-1:visibledatarow[r-1]-scrollHeight-1,end_r=visibledatarow[r]-scrollHeight;for(var c=dataset_col_st;c<=dataset_col_ed;c++)if(start_c=0==c?-scrollWidth:visibledatacolumn[c-1]-scrollWidth,end_c=visibledatacolumn[c]-scrollWidth,c!=dataset_col_ed||luckysheetcurrentisPivotTable||(luckysheetTableContent.beginPath(),luckysheetTableContent.moveTo(devicePixelRatio*(offsetLeft-1),devicePixelRatio*(end_r+offsetTop-2+.5)),luckysheetTableContent.lineTo(devicePixelRatio*(fill_col_ed-scrollWidth+offsetLeft-2),devicePixelRatio*(end_r+offsetTop-2+.5)),luckysheetTableContent.lineWidth=devicePixelRatio,luckysheetTableContent.strokeStyle=luckysheetdefaultstyle.strokeStyle,luckysheetTableContent.closePath(),luckysheetTableContent.stroke()),r!=dataset_row_st||luckysheetcurrentisPivotTable||(luckysheetTableContent.beginPath(),luckysheetTableContent.moveTo(devicePixelRatio*(end_c+offsetLeft-2+.5),devicePixelRatio*(offsetTop-1)),luckysheetTableContent.lineTo(devicePixelRatio*(end_c+offsetLeft-2+.5),devicePixelRatio*(fill_row_ed-scrollHeight+offsetTop-2)),luckysheetTableContent.lineWidth=devicePixelRatio,luckysheetTableContent.strokeStyle=luckysheetdefaultstyle.strokeStyle,luckysheetTableContent.closePath(),luckysheetTableContent.stroke()),luckysheetcurrentisPivotTable&&luckysheet.pivotTable.drawPivotTable?((0==c||5==c)&&r<=11&&(luckysheetTableContent.beginPath(),luckysheetTableContent.moveTo(devicePixelRatio*(end_c-2+.5+offsetLeft),devicePixelRatio*(start_r+offsetTop)),luckysheetTableContent.lineTo(devicePixelRatio*(end_c-2+.5+offsetLeft),devicePixelRatio*(end_r-2+offsetTop)),luckysheetTableContent.lineWidth=devicePixelRatio,luckysheetTableContent.strokeStyle="#000000",luckysheetTableContent.closePath(),luckysheetTableContent.stroke()),(2==r||11==r)&&c<=5&&(luckysheetTableContent.beginPath(),luckysheetTableContent.moveTo(devicePixelRatio*(start_c-1+offsetLeft),devicePixelRatio*(end_r-2+.5+offsetTop)),luckysheetTableContent.lineTo(devicePixelRatio*(end_c-2+offsetLeft),devicePixelRatio*(end_r-2+.5+offsetTop)),luckysheetTableContent.lineWidth=devicePixelRatio,luckysheetTableContent.strokeStyle="#000000",luckysheetTableContent.closePath(),luckysheetTableContent.stroke()),6==r&&3==c&&luckysheetTableContent.fillText("数据透视表",devicePixelRatio*(start_c+4+offsetLeft),devicePixelRatio*(start_r+(end_r-start_r)/2-1+offsetTop))):luckysheetcurrentisPivotTable&&c<luckysheet.pivotTable.pivotTableBoundary[1]&&r<luckysheet.pivotTable.pivotTableBoundary[0]&&(luckysheetTableContent.beginPath(),luckysheetTableContent.moveTo(devicePixelRatio*(end_c-2+.5+offsetLeft),devicePixelRatio*(start_r+offsetTop)),luckysheetTableContent.lineTo(devicePixelRatio*(end_c-2+.5+offsetLeft),devicePixelRatio*(end_r-2+offsetTop)),luckysheetTableContent.lineWidth=devicePixelRatio,luckysheetTableContent.strokeStyle="#000000",luckysheetTableContent.closePath(),luckysheetTableContent.stroke(),luckysheetTableContent.beginPath(),luckysheetTableContent.moveTo(devicePixelRatio*(start_c-1+offsetLeft),devicePixelRatio*(end_r-2+.5+offsetTop)),luckysheetTableContent.lineTo(devicePixelRatio*(end_c-2+offsetLeft),devicePixelRatio*(end_r-2+.5+offsetTop)),luckysheetTableContent.lineWidth=devicePixelRatio,luckysheetTableContent.strokeStyle="#000000",luckysheetTableContent.closePath(),luckysheetTableContent.stroke()),null==config.rowhidden||null==config.rowhidden[r]){var firstcolumlen=defaultcollen;if(null!=config.columlen&&null!=config.columlen[c]&&(firstcolumlen=config.columlen[c]),null!=luckysheet.flowdata[r]&&null!=luckysheet.flowdata[r][c]){var value=luckysheet.flowdata[r][c];if("object"==luckysheet.getObjType(value)&&"mc"in value){if(borderOffset[r+"_"+c]={start_r:start_r,start_c:start_c,end_r:end_r,end_c:end_c},!("rs"in value.mc)){var key="r"+value.mc.r+"c"+value.mc.c,margeMain=cellupdate[mergeCache[key]];null==margeMain?(mergeCache[key]=cellupdate.length,cellupdate.push({r:r,c:c,start_c:start_c,start_r:start_r,end_r:end_r,end_c:end_c,firstcolumlen:firstcolumlen,startlist:[]})):(margeMain.c==c&&(margeMain.end_r+=end_r-start_r-1,margeMain.startlist.push(start_r)),margeMain.r==r&&(margeMain.end_c+=end_c-start_c,margeMain.firstcolumlen+=firstcolumlen));continue}var key="r"+r+"c"+c;mergeCache[key]=cellupdate.length}}cellupdate.push({r:r,c:c,start_r:start_r,start_c:start_c,end_r:end_r,end_c:end_c,firstcolumlen:firstcolumlen,startlist:[]}),borderOffset[r+"_"+c]={start_r:start_r,start_c:start_c,end_r:end_r,end_c:end_c}}}for(var dynamicArray_compute=luckysheet.dynamicArray_compute(luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].dynamicArray),af_compute=luckysheet.alternateformat.getComputeMap(),cf_compute=luckysheet.conditionformat.getComputeMap(),sparklinesRender=function(r,c,offsetX,offsetY,canvasid,ctx){if(null!=luckysheet.flowdata[r]&&null!=luckysheet.flowdata[r][c]){var sparklines=luckysheet.flowdata[r][c].spl;if(null!=sparklines)if("string"==typeof sparklines&&(sparklines=eval("("+sparklines+")")),"object"==luckysheet.getObjType(sparklines)){var temp1=sparklines,x=temp1.offsetX,y=temp1.offsetY;x=null==x?0:x,y=null==y?0:y,luckysheet.sparkline.render(temp1.shapeseq,temp1.shapes,offsetX+x,offsetY+y,temp1.pixelWidth,temp1.pixelHeight,canvasid,ctx)}else if("array"==luckysheet.getObjType(sparklines)&&"object"==luckysheet.getObjType(sparklines[0]))for(var i=0;i<sparklines.length;i++){var temp1=sparklines[i],x=temp1.offsetX,y=temp1.offsetY;x=null==x?0:x,y=null==y?0:y,luckysheet.sparkline.render(temp1.shapeseq,temp1.shapes,offsetX+x,offsetY+y,temp1.pixelWidth,temp1.pixelHeight,canvasid,ctx)}}},nullCellRender=function(e,t,l,r,a,s){var n=luckysheet.alternateformat.checksAF(e,t,af_compute),o=luckysheet.conditionformat.checksCF(e,t,cf_compute),c=luckysheet.menuButton.borderfix(luckysheet.flowdata,e,t);luckysheetTableContent.fillStyle=luckysheet.menuButton.checkstatus(luckysheet.flowdata,e,t,"bg"),null!=n&&null!=n[1]&&(luckysheetTableContent.fillStyle=n[1]),null!=o&&null!=o.cellColor&&(luckysheetTableContent.fillStyle=o.cellColor),null!=luckysheet.flowdata[e][t]&&null!=luckysheet.flowdata[e][t].tc&&(luckysheetTableContent.fillStyle=luckysheet.flowdata[e][t].tc);var u,i,h,d,y,f,m=[devicePixelRatio*(r+offsetLeft+c[0]),devicePixelRatio*(l+offsetTop+1+c[1]),devicePixelRatio*(s-r-3+c[2]),devicePixelRatio*(a-l-3-.5+c[3])];luckysheetTableContent.fillRect(m[0],m[1],m[2],m[3]),e+"_"+t in dynamicArray_compute&&(u=dynamicArray_compute[e+"_"+t].v,luckysheetTableContent.fillStyle="#000000",i=luckysheetdefaultstyle.font,luckysheetTableContent.font=i,luckysheetTableContent.measureText(u).width,h=luckysheet.menuButton.getTextSize("田",i)[1],d=(r+4+offsetLeft)*devicePixelRatio,y=luckysheet.browser.luckysheetrefreshfixed(),f=(a+offsetTop-2+y)*devicePixelRatio-h,luckysheetTableContent.fillText(null==u?"":u,d,f)),null!=luckysheet.flowdata[e][t]&&null!=luckysheet.flowdata[e][t].ps&&(luckysheetTableContent.beginPath(),luckysheetTableContent.moveTo(devicePixelRatio*(s+offsetLeft-6),devicePixelRatio*(l+offsetTop)),luckysheetTableContent.lineTo(devicePixelRatio*(s+offsetLeft-1),devicePixelRatio*(l+offsetTop)),luckysheetTableContent.lineTo(devicePixelRatio*(s+offsetLeft-1),devicePixelRatio*(l+offsetTop+5)),luckysheetTableContent.fillStyle="#FC6666",luckysheetTableContent.fill(),luckysheetTableContent.closePath()),luckysheetTableContent.beginPath(),luckysheetTableContent.moveTo(devicePixelRatio*(s-2+.5+offsetLeft),devicePixelRatio*(l+offsetTop)),luckysheetTableContent.lineTo(devicePixelRatio*(s-2+.5+offsetLeft),devicePixelRatio*(a-2+offsetTop)),luckysheetTableContent.lineWidth=devicePixelRatio,luckysheetcurrentisPivotTable&&!luckysheet.pivotTable.drawPivotTable?luckysheetTableContent.strokeStyle="#000000":luckysheetTableContent.strokeStyle=luckysheetdefaultstyle.strokeStyle,luckysheetTableContent.stroke(),luckysheetTableContent.closePath(),luckysheetTableContent.beginPath(),luckysheetTableContent.moveTo(devicePixelRatio*(r-2+offsetLeft),devicePixelRatio*(a-2+.5+offsetTop)),luckysheetTableContent.lineTo(devicePixelRatio*(s+offsetLeft-2),devicePixelRatio*(a-2+.5+offsetTop)),luckysheetTableContent.lineWidth=devicePixelRatio,luckysheetcurrentisPivotTable&&!luckysheet.pivotTable.drawPivotTable?luckysheetTableContent.strokeStyle="#000000":luckysheetTableContent.strokeStyle=luckysheetdefaultstyle.strokeStyle,luckysheetTableContent.stroke(),luckysheetTableContent.closePath()},cellRender=function(e,t,l,r,a,s,n,o){var c=luckysheet.alternateformat.checksAF(e,t,af_compute),u=luckysheet.conditionformat.checksCF(e,t,cf_compute),i=luckysheet.menuButton.borderfix(luckysheet.flowdata,e,t),h=luckysheetfontformat(luckysheet.flowdata[e][t]);luckysheetTableContent.font=h;var d=luckysheetTableContent.measureText(n).width,y=luckysheet.menuButton.getTextSize("田",h)[1];if("2"==luckysheet.flowdata[e][t].tb){for(var f=n.toString(),m=s-r-8,k=[],p=1;p<=f.length;p++){var g=f.substring(k.join("").length,p);m<(q=luckysheetTableContent.measureText(g).width)?(k.push(f.substring(k.join("").length,p-1)),p-=2):q<=m&&p==f.length&&k.push(g)}var v=k.length*y}else{null!=luckysheet.flowdata[e][t].tr&&"0"!=luckysheet.flowdata[e][t].tr?"1"==(z=luckysheet.flowdata[e][t].tr)||"2"==z?v=U=.707*(d+y):"3"==z?(1<(n=n.toString()).length?D=n.split(""):(D=[]).push(n),U=luckysheetTableContent.measureText(D[0]).width,v=D.length*y):"4"!=z&&"5"!=z||(U=y,v=d):(U=d,v=y)}var b=luckysheet.menuButton.checkstatus(luckysheet.flowdata,e,t,"ht"),_=(r+4+offsetLeft)*devicePixelRatio;"0"==b?_=(r+(s-r)/2+offsetLeft)*devicePixelRatio-d/2:"2"==b&&(_=(s+offsetLeft-8)*devicePixelRatio-d);var w,x,C,T,I,R,S,A,F,N,M,E,O,j,z,D,P=luckysheet.menuButton.checkstatus(luckysheet.flowdata,e,t,"vt"),L=luckysheet.browser.luckysheetrefreshfixed(),B=(a+offsetTop-2+L)*devicePixelRatio-y;if("0"==P?B=(l+(a-l)/2+offsetTop+L)*devicePixelRatio-y/2:"1"==P&&(B=(l+offsetTop+L)*devicePixelRatio),x="Safari"!=luckysheet.browser.BrowserType()&&("offline"==o||("0"==b||"2"==b)&&s-r<U||("0"==P||"2"==P)&&a-l<v)?((w=offlinecanvas).font=h,[devicePixelRatio*(r+offsetLeft+i[0]),devicePixelRatio*(l+offsetTop+.5+i[1]),devicePixelRatio*(s-r-3+i[2]),devicePixelRatio*(a-l-3-.5+i[3])]):(w=luckysheetTableContent,[devicePixelRatio*(r+offsetLeft+i[0]),devicePixelRatio*(l+offsetTop+1+i[1]),devicePixelRatio*(s-r-3+i[2]),devicePixelRatio*(a-l-3-.5+i[3])]),w.fillStyle=luckysheet.menuButton.checkstatus(luckysheet.flowdata,e,t,"bg"),null!=c&&null!=c[1]&&(w.fillStyle=c[1]),null!=u&&null!=u.cellColor&&(w.fillStyle=u.cellColor),null!=luckysheet.flowdata[e][t]&&null!=luckysheet.flowdata[e][t].tc&&(luckysheetTableContent.fillStyle=luckysheet.flowdata[e][t].tc),w.fillRect(x[0],x[1],x[2],x[3]),null!=luckysheet.flowdata[e][t].ps&&(w.beginPath(),w.moveTo(devicePixelRatio*(s+offsetLeft-6),devicePixelRatio*(l+offsetTop)),w.lineTo(devicePixelRatio*(s+offsetLeft-1),devicePixelRatio*(l+offsetTop)),w.lineTo(devicePixelRatio*(s+offsetLeft-1),devicePixelRatio*(l+offsetTop+5)),w.fillStyle="#FC6666",w.fill(),w.closePath()),null!=u&&null!=u.dataBar&&(C=devicePixelRatio*(r+offsetLeft+i[0]+2),T=devicePixelRatio*(l+offsetTop+.5+i[1]+2),I=devicePixelRatio*(s-r-3+i[2]-4),R=devicePixelRatio*(a-l-3-.5+i[3]-4),S=u.dataBar.valueType,A=u.dataBar.valueLen,1<(F=u.dataBar.format).length?"minus"==S?(E=u.dataBar.minusLen,(N=w.createLinearGradient(C+I*E*(1-A),T,C+I*E,T)).addColorStop(0,"#ffffff"),N.addColorStop(1,"#ff0000"),w.fillStyle=N,w.fillRect(C+I*E*(1-A),T,I*E*A,R),w.beginPath(),w.moveTo(C+I*E*(1-A),T),w.lineTo(C+I*E*(1-A),T+R),w.lineTo(C+I*E,T+R),w.lineTo(C+I*E,T),w.lineTo(C+I*E*(1-A),T),w.lineWidth=devicePixelRatio,w.strokeStyle="#ff0000",w.stroke(),w.closePath()):"plus"==S&&(1==(M=u.dataBar.plusLen)?((N=w.createLinearGradient(C,T,C+I*A,T)).addColorStop(0,F[0]),N.addColorStop(1,F[1]),w.fillStyle=N,w.fillRect(C,T,I*A,R),w.beginPath(),w.moveTo(C,T),w.lineTo(C,T+R),w.lineTo(C+I*A,T+R),w.lineTo(C+I*A,T),w.lineTo(C,T)):(E=u.dataBar.minusLen,(N=w.createLinearGradient(C+I*E,T,C+I*E+I*M*A,T)).addColorStop(0,F[0]),N.addColorStop(1,F[1]),w.fillStyle=N,w.fillRect(C+I*E,T,I*M*A,R),w.beginPath(),w.moveTo(C+I*E,T),w.lineTo(C+I*E,T+R),w.lineTo(C+I*E+I*M*A,T+R),w.lineTo(C+I*E+I*M*A,T),w.lineTo(C+I*E,T)),w.lineWidth=devicePixelRatio,w.strokeStyle=F[0],w.stroke(),w.closePath()):"minus"==S?(E=u.dataBar.minusLen,w.fillStyle="#ff0000",w.fillRect(C+I*E*(1-A),T,I*E*A,R),w.beginPath(),w.moveTo(C+I*E*(1-A),T),w.lineTo(C+I*E*(1-A),T+R),w.lineTo(C+I*E,T+R),w.lineTo(C+I*E,T),w.lineTo(C+I*E*(1-A),T),w.lineWidth=devicePixelRatio,w.strokeStyle="#ff0000",w.stroke(),w.closePath()):"plus"==S&&(1==(M=u.dataBar.plusLen)?(w.fillStyle=F[0],w.fillRect(C,T,I*A,R),w.beginPath(),w.moveTo(C,T),w.lineTo(C,T+R),w.lineTo(C+I*A,T+R),w.lineTo(C+I*A,T),w.lineTo(C,T)):(E=u.dataBar.minusLen,w.fillStyle=F[0],w.fillRect(C+I*E,T,I*M*A,R),w.beginPath(),w.moveTo(C+I*E,T),w.lineTo(C+I*E,T+R),w.lineTo(C+I*E+I*M*A,T+R),w.lineTo(C+I*E+I*M*A,T),w.lineTo(C+I*E,T)),w.lineWidth=devicePixelRatio,w.strokeStyle=F[0],w.stroke(),w.closePath())),null!=u&&null!=u.icons&&(O=u.icons.left,j=u.icons.top,w.drawImage(luckysheet_CFiconsImg,42*O,32*j,32,32,x[0],B+2,y-2,y-2),"0"!=b&&"2"!=b&&(_=_+y-2)),w.fillStyle=luckysheet.menuButton.checkstatus(luckysheet.flowdata,e,t,"fc"),null!=c&&null!=c[0]&&(w.fillStyle=c[0]),null!=u&&null!=u.textColor&&(w.fillStyle=u.textColor),null!=luckysheet.flowdata[e][t].dd)w.fillStyle="#0000ff",w.fillText(null==n?"":n,_,B),w.beginPath(),w.strokeStyle="#0000ff",w.moveTo(_,B+y),w.lineTo(_+d,B+y),w.closePath(),w.stroke();else if("2"==luckysheet.flowdata[e][t].tb){for(f=n.toString(),m=s-r-8,k=[],p=1;p<=f.length;p++){var q,g=f.substring(k.join("").length,p);m<(q=w.measureText(g).width)?(k.push(f.substring(k.join("").length,p-1)),p-=2):q<=m&&p==f.length&&k.push(g)}for(var H=0;H<k.length;H++){var V=w.measureText(k[H]).width;"0"==b?_=(r+(s-r)/2+offsetLeft)*devicePixelRatio-V/2:"2"==b&&(_=(s+offsetLeft-8)*devicePixelRatio-V),B="0"==P?(l+(a-l)/2+offsetTop+L)*devicePixelRatio-y*k.length/2:"1"==P?(l+offsetTop+L)*devicePixelRatio:(a+offsetTop-2+L)*devicePixelRatio-y*k.length,w.fillText(k[H],_,B+H*y)}}else if(null!=luckysheet.flowdata[e][t].tr&&"0"!=luckysheet.flowdata[e][t].tr){if("1"==(z=luckysheet.flowdata[e][t].tr)||"2"==z){var U=.707*(d+y),Y=(r+4+offsetLeft)*devicePixelRatio;"0"==b?Y=(r+(s-r)/2+offsetLeft)*devicePixelRatio-U/2:"2"==b&&(Y=(s+offsetLeft-8)*devicePixelRatio-U);var W=(a+offsetTop-2+L)*devicePixelRatio-(v=.707*(d+y));"0"==P?W=(l+(a-l)/2+offsetTop+L)*devicePixelRatio-v/2:"1"==P&&(W=(l+offsetTop+L)*devicePixelRatio),"1"==z&&(w.save(),w.translate(Y,W),w.rotate(45*Math.PI/180),w.translate(-Y,-W),w.fillText(null==n?"":n,Y+.707*.707*y,W-.707*.707*y),w.restore(),"1"!=luckysheet.menuButton.checkstatus(luckysheet.flowdata,e,t,"cl")||luckysheet.func_methods.isRealNull(n)||(w.beginPath(),w.strokeStyle="#000",w.moveTo(Y+y/2,W+y/2),w.lineTo(Y+U-y/2,W+v-y/2),w.closePath(),w.stroke())),"2"==z&&(w.save(),w.translate(Y,W+v),w.rotate(-45*Math.PI/180),w.translate(-Y,-(W+v)),w.fillText(null==n?"":n,Y+.707*.707*y,W+v-.707*.707*y),w.restore(),"1"!=luckysheet.menuButton.checkstatus(luckysheet.flowdata,e,t,"cl")||luckysheet.func_methods.isRealNull(n)||(w.beginPath(),w.strokeStyle="#000",w.moveTo(Y+y/2,W+v-y/2),w.lineTo(Y+U-y/2,W+y/2),w.closePath(),w.stroke()))}else if("3"==z){if(!luckysheet.func_methods.isRealNull(n)){1<(n=n.toString()).length?D=n.split(""):(D=[]).push(n);for(var U=w.measureText(D[0]).width,v=D.length*y,G=0;G<D.length;G++){var X=w.measureText(D[G]).width,_="0"==b?(r+(s-r)/2+offsetLeft)*devicePixelRatio-X/2:"2"==b?(s+offsetLeft-8)*devicePixelRatio-X:(r+4+offsetLeft)*devicePixelRatio,B="0"==P?(l+(a-l)/2+offsetTop+L)*devicePixelRatio-y*D.length/2:"1"==P?(l+offsetTop+L)*devicePixelRatio:(a+offsetTop-2+L)*devicePixelRatio-y*D.length;w.fillText(D[G],_,B+G*y)}"1"!=luckysheet.menuButton.checkstatus(luckysheet.flowdata,e,t,"cl")||luckysheet.func_methods.isRealNull(n)||(w.beginPath(),w.strokeStyle="#000",w.moveTo(_+U/2,B),w.lineTo(_+U/2,B+v),w.closePath(),w.stroke())}}else{"4"!=z&&"5"!=z||(U=y,Y=(r+4+offsetLeft)*devicePixelRatio,"0"==b?Y=(r+(s-r)/2+offsetLeft)*devicePixelRatio-U/2:"2"==b&&(Y=(s+offsetLeft-8)*devicePixelRatio-U),W=(a+offsetTop-2+L)*devicePixelRatio-(v=d),"0"==P?W=(l+(a-l)/2+offsetTop+L)*devicePixelRatio-v/2:"1"==P&&(W=(l+offsetTop+L)*devicePixelRatio),"4"==z&&(w.save(),w.translate(Y,W),w.rotate(90*Math.PI/180),w.translate(-Y,-W),w.fillText(null==n?"":n,Y,W-U),w.restore(),"1"!=luckysheet.menuButton.checkstatus(luckysheet.flowdata,e,t,"cl")||luckysheet.func_methods.isRealNull(n)||(w.beginPath(),w.strokeStyle="#000",w.moveTo(Y+U/2,W),w.lineTo(Y+U/2,W+v),w.closePath(),w.stroke())),"5"==z&&(w.save(),w.translate(Y+v,W),w.rotate(-90*Math.PI/180),w.translate(-(Y+v),-W),w.fillText(null==n?"":n,Y,W-v),w.restore(),"1"!=luckysheet.menuButton.checkstatus(luckysheet.flowdata,e,t,"cl")||luckysheet.func_methods.isRealNull(n)||(w.beginPath(),w.strokeStyle="#000",w.moveTo(Y+U/2,W),w.lineTo(Y+U/2,W+v),w.closePath(),w.stroke())))}}else{w.fillText(null==n?"":n,_,B),"1"!=luckysheet.menuButton.checkstatus(luckysheet.flowdata,e,t,"cl")||luckysheet.func_methods.isRealNull(n)||(w.beginPath(),w.strokeStyle="#000",w.moveTo(_,B+y/2),w.lineTo(_+d,B+y/2),w.closePath(),w.stroke())}"Safari"!=luckysheet.browser.BrowserType()&&("offline"==o||("0"==b||"2"==b)&&s-r<U||("0"==P||"2"==P)&&a-l<v)&&(w.font=luckysheetdefaultstyle.font,0<$("#luckysheetTableContentF").length?luckysheetTableContent.drawImage($("#luckysheetTableContentF").get(0),x[0],x[1],x[2],x[3],x[0],x[1],x[2],x[3]):luckysheetTableContent.drawImage(offlineElement,x[0],x[1],x[2],x[3],x[0],x[1],x[2],x[3])),luckysheetTableContent.font=luckysheetdefaultstyle.font,luckysheetTableContent.beginPath(),luckysheetTableContent.moveTo(devicePixelRatio*(s-2+.5+offsetLeft),devicePixelRatio*(l+offsetTop)),luckysheetTableContent.lineTo(devicePixelRatio*(s-2+.5+offsetLeft),devicePixelRatio*(a-2+offsetTop)),luckysheetTableContent.lineWidth=devicePixelRatio,luckysheetcurrentisPivotTable&&!luckysheet.pivotTable.drawPivotTable?luckysheetTableContent.strokeStyle="#000000":luckysheetTableContent.strokeStyle=luckysheetdefaultstyle.strokeStyle,luckysheetTableContent.stroke(),luckysheetTableContent.closePath(),luckysheetTableContent.beginPath(),luckysheetTableContent.moveTo(devicePixelRatio*(r-2+offsetLeft),devicePixelRatio*(a-2+.5+offsetTop)),luckysheetTableContent.lineTo(devicePixelRatio*(s+offsetLeft-2),devicePixelRatio*(a-2+.5+offsetTop)),luckysheetTableContent.lineWidth=devicePixelRatio,luckysheetcurrentisPivotTable&&!luckysheet.pivotTable.drawPivotTable?luckysheetTableContent.strokeStyle="#000000":luckysheetTableContent.strokeStyle=luckysheetdefaultstyle.strokeStyle,luckysheetTableContent.stroke(),luckysheetTableContent.closePath()},mcArr=[],cud=0;cud<cellupdate.length;cud++){var item=cellupdate[cud],r=item.r,c=item.c,start_r=item.start_r,start_c=item.start_c,end_r=item.end_r,end_c=item.end_c,firstcolumlen=item.firstcolumlen,cell,value,er,ec,end_ec,margeMaindata,borderfix,cellsize;null!=luckysheet.flowdata[r]&&(null==luckysheet.flowdata[r][c]?nullCellRender(r,c,start_r,start_c,end_r,end_c):(cell=luckysheet.flowdata[r][c],value=null,er=r,ec=c,end_ec=end_c,"object"==typeof cell&&"mc"in cell?(mcArr.push(cellupdate[cud]),margeMaindata=cell.mc,value=luckysheet.getcellvalue(margeMaindata.r,margeMaindata.c,null,"m"),null==value&&(value=luckysheet.getcellvalue(margeMaindata.r,margeMaindata.c)),r=margeMaindata.r,c=margeMaindata.c,er+=margeMaindata.rs,ec+=margeMaindata.rc,start_c=0==c?-scrollWidth:visibledatacolumn[c-1]-scrollWidth,start_r=0==r?-scrollHeight-1:visibledatarow[r-1]-scrollHeight-1,end_ec=visibledatacolumn[ec]-scrollWidth):(value=luckysheet.getcellvalue(r,c,null,"m"),null==value&&(value=luckysheet.getcellvalue(r,c))),null==value||0==value.toString().length?(nullCellRender(r,c,start_r,start_c,end_r,end_c),borderfix=luckysheet.menuButton.borderfix(luckysheet.flowdata,r,c),cellsize=[devicePixelRatio*(start_c+offsetLeft+borderfix[0]),devicePixelRatio*(start_r+offsetTop+.5+borderfix[1]),devicePixelRatio*(end_c-start_c-3+borderfix[2]),devicePixelRatio*(end_r-start_r-3-.5+borderfix[3])],sparklinesRender(r,c,cellsize[0],cellsize[1],"luckysheetTableContent",luckysheetTableContent)):(r+"_"+c in dynamicArray_compute&&(value=dynamicArray_compute[r+"_"+c].v),cellRender(r,c,start_r,start_c,end_r,end_c,value))))}for(var m=0;m<mcArr.length;m++){var item=mcArr[m],r=item.r,c=item.c,start_r=item.start_r,start_c=item.start_c,end_r=item.end_r,end_c=item.end_c,firstcolumlen=item.firstcolumlen,cell=luckysheet.flowdata[r][c],value=null,er=r,ec=c,end_ec=end_c,margeMaindata=cell.mc,borderfix,cellsize;value=luckysheet.getcellvalue(margeMaindata.r,margeMaindata.c,null,"m"),null==value&&(value=luckysheet.getcellvalue(margeMaindata.r,margeMaindata.c)),r=margeMaindata.r,c=margeMaindata.c,er+=margeMaindata.rs,ec+=margeMaindata.rc,start_c=0==c?-scrollWidth:visibledatacolumn[c-1]-scrollWidth,start_r=0==r?-scrollHeight-1:visibledatarow[r-1]-scrollHeight-1,end_ec=visibledatacolumn[ec]-scrollWidth,null==value||0==value.toString().length?(nullCellRender(r,c,start_r,start_c,end_r,end_c),borderfix=luckysheet.menuButton.borderfix(luckysheet.flowdata,r,c),cellsize=[devicePixelRatio*(start_c+offsetLeft+borderfix[0]),devicePixelRatio*(start_r+offsetTop+.5+borderfix[1]),devicePixelRatio*(end_c-start_c-3+borderfix[2]),devicePixelRatio*(end_r-start_r-3-.5+borderfix[3])],sparklinesRender(r,c,cellsize[0],cellsize[1],"luckysheetTableContent",luckysheetTableContent)):(r+"_"+c in dynamicArray_compute&&(value=dynamicArray_compute[r+"_"+c].v),cellRender(r,c,start_r,start_c,end_r,end_c,value,"offline"))}if(null!=config.borderInfo&&0<config.borderInfo.length){var borderLeftRender=function(e,t,l,r,a,s,n,o,c){var u=devicePixelRatio*(r-2+.5+n),i=devicePixelRatio*(l+o),h=devicePixelRatio*(r-2+.5+n),d=devicePixelRatio*(a-2+o);luckysheet.menuButton.setLineDash(c,e,"v",u,i,h,d),c.strokeStyle=t,c.stroke(),c.closePath()},borderRightRender=function(e,t,l,r,a,s,n,o,c){var u=devicePixelRatio*(s-2+.5+n),i=devicePixelRatio*(l+o),h=devicePixelRatio*(s-2+.5+n),d=devicePixelRatio*(a-2+o);luckysheet.menuButton.setLineDash(c,e,"v",u,i,h,d),c.strokeStyle=t,c.stroke(),c.closePath()},borderBottomRender=function(e,t,l,r,a,s,n,o,c){var u=devicePixelRatio*(r-2+n),i=devicePixelRatio*(a-2+.5+o),h=devicePixelRatio*(s+n-2),d=devicePixelRatio*(a-2+.5+o);luckysheet.menuButton.setLineDash(c,e,"h",u,i,h,d),c.strokeStyle=t,c.stroke(),c.closePath()},borderTopRender=function(e,t,l,r,a,s,n,o,c){var u=devicePixelRatio*(r-2+n),i=devicePixelRatio*(l-1+.5+o),h=devicePixelRatio*(s+n-2),d=devicePixelRatio*(l-1+.5+o);luckysheet.menuButton.setLineDash(c,e,"h",u,i,h,d),c.strokeStyle=t,c.stroke(),c.closePath()},borderInfoCompute=luckysheet.getBorderInfoCompute();for(x in borderInfoCompute){var bd_r=x.split("_")[0],bd_c=x.split("_")[1],start_r,start_c,end_r,end_c,borderLeft,borderRight,borderTop,borderBottom;borderOffset[bd_r+"_"+bd_c]&&(start_r=borderOffset[bd_r+"_"+bd_c].start_r,start_c=borderOffset[bd_r+"_"+bd_c].start_c,end_r=borderOffset[bd_r+"_"+bd_c].end_r,end_c=borderOffset[bd_r+"_"+bd_c].end_c,borderLeft=borderInfoCompute[x].l,null!=borderLeft&&borderLeftRender(borderLeft.style,borderLeft.color,start_r,start_c,end_r,end_c,offsetLeft,offsetTop,luckysheetTableContent),borderRight=borderInfoCompute[x].r,null!=borderRight&&borderRightRender(borderRight.style,borderRight.color,start_r,start_c,end_r,end_c,offsetLeft,offsetTop,luckysheetTableContent),borderTop=borderInfoCompute[x].t,null!=borderTop&&borderTopRender(borderTop.style,borderTop.color,start_r,start_c,end_r,end_c,offsetLeft,offsetTop,luckysheetTableContent),borderBottom=borderInfoCompute[x].b,null!=borderBottom&&borderBottomRender(borderBottom.style,borderBottom.color,start_r,start_c,end_r,end_c,offsetLeft,offsetTop,luckysheetTableContent))}}dataset_col_ed==visibledatacolumn.length-1&&luckysheetTableContent.clearRect((fill_col_ed-scrollWidth+offsetLeft-1)*devicePixelRatio,(offsetTop-1)*devicePixelRatio,(ch_width-visibledatacolumn[dataset_col_ed])*devicePixelRatio,(fill_row_ed-scrollHeight)*devicePixelRatio),null!=ctx&&ctx.drawImage(luckysheetTableElement,0,0,drawWidth,drawHeight,-drawWidth/2+offsetLeft,-drawHeight/2+offsetTop,drawWidth,drawHeight)}}function luckysheetDrawMain_back(e,t,l,r,a,s,n,o,c){null==e&&(e=$("#luckysheet-cell-main").scrollLeft()),null==t&&(t=$("#luckysheet-cell-main").scrollTop()),null==l&&(l=luckysheetTableContentHW[0]),null==r&&(r=luckysheetTableContentHW[1]),null==a&&(a=rowHeaderWidth),null==s&&(s=columeHeaderHeight),null==n&&(n=0),null==o&&(o=0);var u=null;if(null==c)u=$("#luckysheetTableContent").get(0).getContext("2d");else if("object"==luckysheet.getObjType(c))try{u=c.get(0).getContext("2d")}catch(e){u=c}else u=$("#"+c).get(0).getContext("2d");u.clearRect(a*devicePixelRatio,s*devicePixelRatio,l*devicePixelRatio,r*devicePixelRatio);var i,h,d,y,f,m,k,p,g=$("#luckysheetTableContentF").get(0).getContext("2d");g.fillStyle="#ffffff",g.fillRect(0,0,luckysheetTableContentHW[0]*devicePixelRatio,luckysheetTableContentHW[1]*devicePixelRatio),g.font=luckysheetdefaultstyle.font,g.textBaseline="top",g.fillStyle=luckysheetdefaultstyle.fillStyle,-1==(i=luckysheet_searcharray(visibledatarow,t))&&(i=0),i+=o,-1==(h=luckysheet_searcharray(visibledatarow,t+r))&&(h=visibledatarow.length-1),(h+=o)>=visibledatarow.length&&(h=visibledatarow.length-1),-1==(d=luckysheet_searcharray(visibledatacolumn,e))&&(d=0),d+=n,-1==(y=luckysheet_searcharray(visibledatacolumn,e+l))&&(y=visibledatacolumn.length-1),(y+=n)>=visibledatacolumn.length&&(y=visibledatacolumn.length-1),f=0==i?0:visibledatarow[i-1],m=visibledatarow[h],k=0==d?0:visibledatacolumn[d-1],p=visibledatacolumn[y],u.fillStyle="#ffffff",u.fillRect((a-1)*devicePixelRatio,(s-1)*devicePixelRatio,(p-k)*devicePixelRatio,(m-f)*devicePixelRatio);for(var v=[],b={},_=i;_<=h;_++){N=0==_?-t-1:visibledatarow[_-1]-t-1,E=visibledatarow[_]-t;for(var w=d;w<=y;w++)if(F=0==w?-e:visibledatacolumn[w-1]-e,M=visibledatacolumn[w]-e,w==y&&!luckysheetcurrentisPivotTable&&E<=r&&-1<=N&&(u.beginPath(),u.moveTo(devicePixelRatio*(a-1),devicePixelRatio*(E+s-2+.5)),u.lineTo(devicePixelRatio*(M+a-2),devicePixelRatio*(E+s-2+.5)),u.lineWidth=devicePixelRatio,u.strokeStyle=luckysheetdefaultstyle.strokeStyle,u.closePath(),u.stroke()),_==i&&!luckysheetcurrentisPivotTable&&M<=l+18&&-1<=F&&(u.beginPath(),u.moveTo(devicePixelRatio*(M+a-2+.5),devicePixelRatio*(s-1)),u.lineTo(devicePixelRatio*(M+a-2+.5),devicePixelRatio*(m-f+s-2)),u.lineWidth=devicePixelRatio,u.strokeStyle=luckysheetdefaultstyle.strokeStyle,u.closePath(),u.stroke()),luckysheetcurrentisPivotTable&&luckysheet.pivotTable.drawPivotTable?((0==w||5==w)&&_<=11&&(u.beginPath(),u.moveTo(devicePixelRatio*(M-2+.5+a),devicePixelRatio*(N+s)),u.lineTo(devicePixelRatio*(M-2+.5+a),devicePixelRatio*(E-2+s)),u.lineWidth=devicePixelRatio,u.strokeStyle="#000000",u.closePath(),u.stroke()),(2==_||11==_)&&w<=5&&(u.beginPath(),u.moveTo(devicePixelRatio*(F-1+a),devicePixelRatio*(E-2+.5+s)),u.lineTo(devicePixelRatio*(M+a-2),devicePixelRatio*(E-2+.5+s)),u.lineWidth=devicePixelRatio,u.strokeStyle="#000000",u.closePath(),u.stroke()),6==_&&3==w&&u.fillText("数据透视表",devicePixelRatio*(F+4+a),devicePixelRatio*(N+(E-N)/2-1+s))):luckysheetcurrentisPivotTable&&w<luckysheet.pivotTable.pivotTableBoundary[1]&&_<luckysheet.pivotTable.pivotTableBoundary[0]&&(u.beginPath(),u.moveTo(devicePixelRatio*(M-2+.5+a),devicePixelRatio*(N+s)),u.lineTo(devicePixelRatio*(M-2+.5+a),devicePixelRatio*(E-2+s)),u.lineWidth=devicePixelRatio,u.strokeStyle="#000000",u.closePath(),u.stroke(),u.beginPath(),u.moveTo(devicePixelRatio*(F-1+a),devicePixelRatio*(E-2+.5+s)),u.lineTo(devicePixelRatio*(M+a-2),devicePixelRatio*(E-2+.5+s)),u.lineWidth=devicePixelRatio,u.strokeStyle="#000000",u.closePath(),u.stroke()),(null==config.rowhidden||null==config.rowhidden[_])&&null!=luckysheet.flowdata[_]&&null!=luckysheet.flowdata[_][w]&&-1<=N&&-1<=F){var x=luckysheet.flowdata[_][w],C=defaultcollen;if(null!=config.columlen&&null!=config.columlen[w]&&(C=config.columlen[w]),"object"==luckysheet.getObjType(x)&&"mc"in x){if(!("rs"in x.mc)){var T,I=v[b[T="r"+x.mc.r+"c"+x.mc.c]];null==I?(b[T]=v.length,v.push({r:_,c:w,start_c:F,start_r:N,end_r:E,end_c:M,firstcolumlen:C,startlist:[]})):(I.c==w&&(I.end_r+=E-N-1,I.startlist.push(N)),I.r==_&&(I.end_c+=M-F,I.firstcolumlen+=C),S=luckysheet.flowdata[I.r][I.c],I.c+S.mc.cs-1==w&&(I.r,S.mc.rs));continue}b[T="r"+_+"c"+w]=v.length}v.push({r:_,c:w,start_c:F,start_r:N,end_r:E,end_c:M,firstcolumlen:C,startlist:[]})}null!=config.rowhidden&&config.rowhidden[_]}for(var R=0;R<v.length;R++){var S,A=v[R],_=A.r,w=A.c,F=A.start_c,N=A.start_r,M=A.end_c,E=A.end_r,C=A.firstcolumlen,O=luckysheet.flowdata[_][w],x=null,j=w;"object"==typeof O&&"mc"in O?(S=O.mc,null==(x=luckysheet.getcellvalue(S.r,S.c,null,"m"))&&(x=luckysheet.getcellvalue(S.r,S.c)),_=S.r,w=S.c,S.rs,j+=S.rc,F=0==w?-e:visibledatacolumn[w-1]-e,N=0==_?-t-1:visibledatarow[_-1]-t-1,visibledatacolumn[j]):null==(x=luckysheet.getcellvalue(_,w,null,"m"))&&(x=luckysheet.getcellvalue(_,w));var z=luckysheet.menuButton.borderfix(luckysheet.flowdata,_,w);g.fillStyle=luckysheet.menuButton.checkstatus(luckysheet.flowdata,_,w,"bg");var D=[devicePixelRatio*(F+a+z[0]),devicePixelRatio*(N+s+.5+z[1]),devicePixelRatio*(M-F-3+z[2]),devicePixelRatio*(E-N-3-.5+z[3])];g.fillRect(D[0],D[1],D[2],D[3]),g.fillStyle=luckysheet.menuButton.checkstatus(luckysheet.flowdata,_,w,"fc");var P=luckysheetfontformat(luckysheet.flowdata[_][w]);g.font=P;var L=g.measureText(x).width,B=luckysheet.menuButton.getTextSize("田",P)[1];g.fillStyle=luckysheet.menuButton.checkstatus(luckysheet.flowdata,_,w,"fc");var q=luckysheet.menuButton.checkstatus(luckysheet.flowdata,_,w,"ht"),H=(F+4+a)*devicePixelRatio;"0"==q?H=(F+(M-F)/2+a)*devicePixelRatio-L/2:"2"==q&&(H=(M+a-8)*devicePixelRatio-L);var V=luckysheet.menuButton.checkstatus(luckysheet.flowdata,_,w,"vt"),U=luckysheet.browser.luckysheetrefreshfixed(),Y=(E+s-2+U)*devicePixelRatio-B;if("0"==V?Y=(N+(E-N)/2+s+U)*devicePixelRatio-B/2:"1"==V&&(Y=(N+s+U)*devicePixelRatio),"2"==luckysheet.flowdata[_][w].tb&&M-F<L){for(var W=x.toString(),G=M-F-8,X=[],K=1;K<=W.length;K++){var Z=W.substring(X.join("").length,K),J=g.measureText(Z).width;G<J?(X.push(W.substring(X.join("").length,K-1)),K-=2):J<=G&&K==W.length&&X.push(Z)}for(var Q=0;Q<X.length;Q++){var ee=g.measureText(X[Q]).width,H="0"==q?(F+(M-F)/2+a)*devicePixelRatio-ee/2:"2"==q?(M+a-8)*devicePixelRatio-ee:(F+4+a)*devicePixelRatio,Y="0"==V?(N+(E-N)/2+s+U)*devicePixelRatio-B*X.length/2:"1"==V?(N+s+U)*devicePixelRatio:(E+s-2+U)*devicePixelRatio-B*X.length;g.fillText(X[Q],H,Y+Q*B)}}else if(luckysheet.flowdata[_][w].tr&&"0"!=luckysheet.flowdata[_][w].tr){var te,le=luckysheet.flowdata[_][w].tr;if("1"==le||"2"==le){var re=.707*(L+B),ae=(F+4+a)*devicePixelRatio;"0"==q?ae=(F+(M-F)/2+a)*devicePixelRatio-re/2:"2"==q&&(ae=(M+a-8)*devicePixelRatio-re);var se=(E+s-2+U)*devicePixelRatio-(ne=.707*(L+B));"0"==V?se=(N+(E-N)/2+s+U)*devicePixelRatio-ne/2:"1"==V&&(se=(N+s+U)*devicePixelRatio),"1"==le&&(g.save(),g.translate(ae,se),g.rotate(45*Math.PI/180),g.translate(-ae,-se),g.fillText(null==x?"":x,ae+.707*.707*B,se-.707*.707*B),g.restore(),"1"==luckysheet.menuButton.checkstatus(luckysheet.flowdata,_,w,"cl")&&x&&(g.beginPath(),g.moveTo(ae+B/2,se+B/2),g.lineTo(ae+re-B/2,se+ne-B/2),g.closePath(),g.stroke())),"2"==le&&(g.save(),g.translate(ae+re,se),g.rotate(-45*Math.PI/180),g.translate(-(ae+re),-se),g.fillText(null==x?"":x,ae-.707*.707*B,se-.707*.707*B),g.restore(),"1"==luckysheet.menuButton.checkstatus(luckysheet.flowdata,_,w,"cl")&&x&&(g.beginPath(),g.moveTo(ae+B/2,se+ne-B/2),g.lineTo(ae+re-B/2,se+B/2),g.closePath(),g.stroke()))}else if("3"==le){if(x){1<(x=x.toString()).length?te=x.split(""):(te=[]).push(x);for(var re=g.measureText(te[0]).width,ne=te.length*B,oe=0;oe<te.length;oe++){var ce=g.measureText(te[oe]).width;H="0"==q?(F+(M-F)/2+a)*devicePixelRatio-ce/2:"2"==q?(M+a-8)*devicePixelRatio-ce:(F+4+a)*devicePixelRatio,Y="0"==V?(N+(E-N)/2+s+U)*devicePixelRatio-B*te.length/2:"1"==V?(N+s+U)*devicePixelRatio:(E+s-2+U)*devicePixelRatio-B*te.length,g.fillText(te[oe],H,Y+oe*B)}"1"==luckysheet.menuButton.checkstatus(luckysheet.flowdata,_,w,"cl")&&x&&(g.beginPath(),g.moveTo(H+re/2,Y),g.lineTo(H+re/2,Y+ne),g.closePath(),g.stroke())}}else{"4"!=le&&"5"!=le||(re=B,ae=(F+4+a)*devicePixelRatio,"0"==q?ae=(F+(M-F)/2+a)*devicePixelRatio-re/2:"2"==q&&(ae=(M+a-8)*devicePixelRatio-re),se=(E+s-2+U)*devicePixelRatio-(ne=L),"0"==V?se=(N+(E-N)/2+s+U)*devicePixelRatio-ne/2:"1"==V&&(se=(N+s+U)*devicePixelRatio),"4"==le&&(g.save(),g.translate(ae,se),g.rotate(90*Math.PI/180),g.translate(-ae,-se),g.fillText(null==x?"":x,ae,se-re),g.restore(),"1"==luckysheet.menuButton.checkstatus(luckysheet.flowdata,_,w,"cl")&&x&&(g.beginPath(),g.moveTo(ae+re/2,se),g.lineTo(ae+re/2,se+ne),g.closePath(),g.stroke())),"5"==le&&(g.save(),g.translate(ae+ne,se),g.rotate(-90*Math.PI/180),g.translate(-(ae+ne),-se),g.fillText(null==x?"":x,ae,se-ne),g.restore(),"1"==luckysheet.menuButton.checkstatus(luckysheet.flowdata,_,w,"cl")&&x&&(g.beginPath(),g.moveTo(ae+re/2,se),g.lineTo(ae+re/2,se+ne),g.closePath(),g.stroke())))}}else{"1"==luckysheet.menuButton.checkstatus(luckysheet.flowdata,_,w,"cl")&&x?(u.strokeStyle="#000000",g.beginPath(),g.moveTo(H,Y+B/2),g.lineTo(H+L,Y+B/2),g.closePath(),g.stroke(),g.textBaseline="middle",g.fillText(null==x?"":x,H,Y+B/2)):(g.textBaseline="top",g.fillText(null==x?"":x,H,Y))}g.font=luckysheetdefaultstyle.font,u.drawImage($("#luckysheetTableContentF").get(0),D[0],D[1],D[2],D[3],D[0],D[1],D[2],D[3]);var ue,ie=luckysheet.menuButton.checkstatus(luckysheet.flowdata,_,w,"bs"),he=luckysheet.menuButton.checkstatus(luckysheet.flowdata,_,w,"bc"),de=luckysheet.menuButton.checkstatus(luckysheet.flowdata,_,w,"bs_t"),ye=luckysheet.menuButton.checkstatus(luckysheet.flowdata,_,w,"bc_t"),fe=luckysheet.menuButton.checkstatus(luckysheet.flowdata,_,w,"bs_b"),me=luckysheet.menuButton.checkstatus(luckysheet.flowdata,_,w,"bc_b"),ke=luckysheet.menuButton.checkstatus(luckysheet.flowdata,_,w,"bs_l"),pe=luckysheet.menuButton.checkstatus(luckysheet.flowdata,_,w,"bc_l"),ge=luckysheet.menuButton.checkstatus(luckysheet.flowdata,_,w,"bs_r"),ve=luckysheet.menuButton.checkstatus(luckysheet.flowdata,_,w,"bc_r");"none"==ke&&"none"==ie||(ue="none"==ke?ie:ke,luckysheet.menuButton.setLineDash(u,ue,"v",devicePixelRatio*(F-2+.5+a),devicePixelRatio*(N+s),devicePixelRatio*(F-2+.5+a),devicePixelRatio*(E-2+s)),u.strokeStyle="none"==ke?he:pe,u.stroke(),u.closePath()),"none"==ge&&"none"==ie||(ue="none"==ge?ie:ge,luckysheet.menuButton.setLineDash(u,ue,"v",devicePixelRatio*(M-2+.5+a),devicePixelRatio*(N+s),devicePixelRatio*(M-2+.5+a),devicePixelRatio*(E-2+s)),u.strokeStyle="none"==ge?he:ve,u.stroke(),u.closePath()),"none"==fe&&"none"==ie||(ue="none"==fe?ie:fe,luckysheet.menuButton.setLineDash(u,ue,"h",devicePixelRatio*(F-2+a),devicePixelRatio*(E-2+.5+s),devicePixelRatio*(M+a-2),devicePixelRatio*(E-2+.5+s)),u.strokeStyle="none"==fe?he:me,u.stroke(),u.closePath()),"none"==de&&"none"==ie||(ue="none"==de?ie:de,luckysheet.menuButton.setLineDash(u,ue,"h",devicePixelRatio*(F-2+a),devicePixelRatio*(N-1+.5+s),devicePixelRatio*(M+a-2),devicePixelRatio*(N-1+.5+s)),u.strokeStyle="none"==de?he:ye,u.stroke(),u.closePath())}}function luckysheetDrawgrid_c(e,t,l,r,a,s){null==e&&(e=$("#luckysheet-cell-main").scrollLeft()),null==t&&(t=$("#luckysheet-cell-main").scrollTop()),null==l&&(l=luckysheetTableContentHW[0]),null==r&&(r=luckysheetTableContentHW[1]),null==a&&(a=0),null==s&&(s=0);var n,o,c,u,i=$("#luckysheetTableContent").get(0).getContext("2d");i.clearRect(a,s,l,r),i.font=luckysheetdefaultstyle.font,i.textBaseline=luckysheetdefaultstyle.textBaseline,i.fillStyle=luckysheetdefaultstyle.fillStyle,-1==(n=luckysheet_searcharray(visibledatarow,t))&&(n=0),-1==(o=luckysheet_searcharray(visibledatarow,t+r))&&(o=visibledatarow.length-1),-1==(c=luckysheet_searcharray(visibledatacolumn,e))&&(c=0),-1==(u=luckysheet_searcharray(visibledatacolumn,e+l))&&(u=visibledatacolumn.length-1);for(var h,d,y=n;y<=o;y++){d=0==y?-t-1:visibledatarow[y-1]-t-1,h=visibledatarow[y]-t;for(var f=c;f<=u;f++){var m,k,p=0==f?-e:visibledatacolumn[f-1]-e,g=visibledatacolumn[f]-e;null!=config.rowhidden&&null!=config.rowhidden[y]||null!=luckysheet.flowdata[y]&&null!=luckysheet.flowdata[y][f]&&(k=i.measureText(luckysheet.flowdata[y][f]),i.clearRect(p+rowHeaderWidth-1+a,d+columeHeaderHeight+s,g-p-1,h-d),i.fillText(luckysheet.flowdata[y][f],p+4+rowHeaderWidth+a,columeHeaderHeight+d+(h-d)/2-1+s)),y==o&&(i.clearRect(p+rowHeaderWidth-1,0,g-p-1,columeHeaderHeight-2),luckysheetcurrentisPivotTable||(i.beginPath(),i.moveTo(g+rowHeaderWidth-2+a,.5+s),i.lineTo(g+rowHeaderWidth-2+a,columeHeaderHeight+rh_height+s),i.lineWidth=devicePixelRatio,i.strokeStyle=luckysheetdefaultstyle.strokeStyle,i.closePath(),i.stroke()),m=luckysheet.luckysheetchatatABC(f),k=i.measureText(m),i.fillText(m,Math.round(p+rowHeaderWidth+(g-p-k.width)/2),Math.round(columeHeaderHeight/2-2))),luckysheetcurrentisPivotTable&&luckysheet.pivotTable.drawPivotTable?((0==f||5==f)&&y<=11&&(i.beginPath(),i.moveTo(g+rowHeaderWidth-2+a,columeHeaderHeight+d+s),i.lineTo(g+rowHeaderWidth-2+a,columeHeaderHeight+h-2+s),i.lineWidth=devicePixelRatio,i.strokeStyle="#000000",i.closePath(),i.stroke(),i.clearRect(g+rowHeaderWidth-2+a,s,2,columeHeaderHeight)),(2==y||11==y)&&f<=5&&(i.beginPath(),i.moveTo(rowHeaderWidth-1+p+a,h+columeHeaderHeight-2+s),i.lineTo(rowHeaderWidth+g+a,h+columeHeaderHeight-2+s),i.lineWidth=devicePixelRatio,i.strokeStyle="#000000",i.closePath(),i.stroke()),6==y&&3==f&&i.fillText("数据透视表",p+4+rowHeaderWidth+a,columeHeaderHeight+d+(h-d)/2-1+s)):luckysheetcurrentisPivotTable&&f<luckysheet.pivotTable.pivotTableBoundary[1]&&y<luckysheet.pivotTable.pivotTableBoundary[0]&&(i.beginPath(),i.moveTo(g+rowHeaderWidth-2+a,columeHeaderHeight+d+s),i.lineTo(g+rowHeaderWidth-2+a,columeHeaderHeight+h-2+s),i.lineWidth=devicePixelRatio,i.strokeStyle="#000000",i.closePath(),i.stroke(),i.clearRect(g+rowHeaderWidth-2,0,2,columeHeaderHeight),i.beginPath(),i.moveTo(rowHeaderWidth-1+p+a,h+columeHeaderHeight-2+s),i.lineTo(rowHeaderWidth+g+a,h+columeHeaderHeight-2+s),i.lineWidth=devicePixelRatio,i.strokeStyle="#000000",i.closePath(),i.stroke())}null!=config.rowhidden&&null!=config.rowhidden[y]||(i.clearRect(a,d+columeHeaderHeight-1+s,rowHeaderWidth-2,h-d-1),k=i.measureText(y+1),i.fillText(y+1,a+(rowHeaderWidth-k.width)/2,columeHeaderHeight+d+(h-d)/2-2+s)),luckysheetcurrentisPivotTable||(i.beginPath(),i.moveTo(-.5+a,h+columeHeaderHeight-2+s),i.lineTo(rowHeaderWidth+ch_width+a,h+columeHeaderHeight-2+s),i.lineWidth=devicePixelRatio,i.strokeStyle=luckysheetdefaultstyle.strokeStyle,i.closePath(),i.stroke())}i.beginPath(),i.moveTo(rowHeaderWidth-2+a,-.5+s),i.lineTo(rowHeaderWidth-2+a,columeHeaderHeight+rh_height+s),i.lineWidth=devicePixelRatio,i.strokeStyle=luckysheetdefaultstyle.strokeStyle,i.closePath(),i.stroke(),i.beginPath(),i.moveTo(-.5+a,columeHeaderHeight-2+s),i.lineTo(rowHeaderWidth+ch_width+a,columeHeaderHeight-2+s),i.lineWidth=devicePixelRatio,i.strokeStyle=luckysheetdefaultstyle.strokeStyle,i.closePath(),i.stroke(),i.clearRect(a,s,rowHeaderWidth-2,columeHeaderHeight-2),i.clearRect(ch_width+rowHeaderWidth<l?ch_width+rowHeaderWidth-2:l-2+a,s,l,r)}function jfexecStroke(e,t){e[t++].stroke(),t<e.length&&setTimeout(function(){jfexecStroke(e,t)},1e3)}luckysheet.luckysheetfontformat=luckysheetfontformat,luckysheet.menuButton={menu:'<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-menuButton ${subclass} luckysheet-mousedown-cancel" id="luckysheet-icon-${id}-menuButton">${item}</div>',item:'<div itemvalue="${value}" itemname="${name}" class="luckysheet-cols-menuitem ${sub} luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 0px 3px 1px;"><span style="margin-right:3px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span> ${name} <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;">${example}</span></div></div>',split:'<div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div>',color:'<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel luckysheet-menuButton ${sub}" id="${id}"><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel luckysheet-color-reset"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">重置颜色</div></div> <div class="luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <input type="text" class="luckysheet-color-selected" /> </div> </div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> ${coloritem}</div>',coloritem:'<div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel ${class}"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${name}</div></div>',subcolor:'<div id="luckysheet-icon-${id}-menuButton" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-menuButton-sub luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <input type="text" class="luckysheet-color-selected" /> </div> </div></div>',rightclickmenu:null,submenuhide:null,focus:function(e,t){e.find(".luckysheet-cols-menuitem").find("span.icon").html(""),null==t?e.find(".luckysheet-cols-menuitem").eq(0).find("span.icon").html('<i class="fa fa-check luckysheet-mousedown-cancel"></i>'):e.find(".luckysheet-cols-menuitem[itemvalue='"+t+"']").find("span.icon").html('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')},createButtonMenu:function(e){for(var t="",l=0;l<e.length;l++){var r=e[l];"split"==r.value?t+=this.split:"more"==r.example?t+=luckysheet.replaceHtml(this.item,{value:r.value,name:r.text,example:"►",sub:"luckysheet-cols-submenu"}):t+=luckysheet.replaceHtml(this.item,{value:r.value,name:r.text,example:r.example,sub:""})}return t},cancelPaintModel:function(){$("#luckysheet-sheettable_0").removeClass("luckysheetPaintCursor"),luckysheet_copy_save.dataSheetIndex==luckysheet.currentSheetIndex?(luckysheet_selection_range=[],luckysheet.selectionCopyShow()):luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet_copy_save.dataSheetIndex)].luckysheet_selection_range=[],luckysheet_copy_save={},this.luckysheetPaintModelOn=!1,$("#luckysheetpopover").fadeOut(200,function(){$("#luckysheetpopover").remove()})},luckysheetPaintModelOn:!1,luckysheetPaintSingle:!1,initialMenuButton:function(){var _this=this;$("#luckysheet-icon-paintformat").click(function(){if(null!=luckysheet_select_save&&0!=luckysheet_select_save.length)if(1<luckysheet_select_save.length)luckysheet.isEditMode()?alert("无法对多重选择区域执行此操作"):luckysheet.tooltip.info("提示","无法对多重选择区域执行此操作");else{luckysheet.tooltip.popover("<i class='fa fa-paint-brush'></i> 格式刷开启","topCenter",!0,null,"ESC键退出",function(){_this.cancelPaintModel()}),$("#luckysheet-sheettable_0").addClass("luckysheetPaintCursor"),luckysheet_selection_range=[{row:luckysheet_select_save[0].row,column:luckysheet_select_save[0].column}],luckysheet.selectionCopyShow();for(var e=!1,t=!1,l=luckysheet_select_save[0].row[0];l<=luckysheet_select_save[0].row[1];l++)if(null==config.rowhidden||null==config.rowhidden[l]){null!=config.rowlen&&l in config.rowlen&&(e=!0);for(var r=luckysheet_select_save[0].column[0];r<=luckysheet_select_save[0].column[1];r++){var a=luckysheet.flowdata[l][r];"object"==luckysheet.getObjType(a)&&"mc"in a&&null!=a.mc.rs&&(t=!0)}}luckysheet_copy_save={dataSheetIndex:luckysheet.currentSheetIndex,copyRange:[{row:luckysheet_select_save[0].row,column:luckysheet_select_save[0].column}],RowlChange:e,HasMC:t},_this.luckysheetPaintModelOn=!0,_this.luckysheetPaintSingle=!0}else luckysheet.isEditMode()?alert("请选择需要复制格式的区域"):luckysheet.tooltip.info("提示","请选择需要复制格式的区域")}),$("#luckysheet-icon-paintformat").dblclick(function(){if(null!=luckysheet_select_save&&0!=luckysheet_select_save.length)if(1<luckysheet_select_save.length)luckysheet.isEditMode()?alert("无法对多重选择区域执行此操作"):luckysheet.tooltip.info("提示","无法对多重选择区域执行此操作");else{luckysheet.tooltip.popover("<i class='fa fa-paint-brush'></i> 格式刷开启","topCenter",!0,null,"ESC键退出",function(){_this.cancelPaintModel()}),$("#luckysheet-sheettable_0").addClass("luckysheetPaintCursor"),luckysheet_selection_range=[{row:luckysheet_select_save[0].row,column:luckysheet_select_save[0].column}],luckysheet.selectionCopyShow();for(var e=!1,t=!1,l=luckysheet_select_save[0].row[0];l<=luckysheet_select_save[0].row[1];l++)if(null==config.rowhidden||null==config.rowhidden[l]){null!=config.rowlen&&l in config.rowlen&&(e=!0);for(var r=luckysheet_select_save[0].column[0];r<=luckysheet_select_save[0].column[1];r++){var a=luckysheet.flowdata[l][r];"object"==luckysheet.getObjType(a)&&"mc"in a&&null!=a.mc.rs&&(t=!0)}}luckysheet_copy_save={dataSheetIndex:luckysheet.currentSheetIndex,copyRange:[{row:luckysheet_select_save[0].row,column:luckysheet_select_save[0].column}],RowlChange:e,HasMC:t},_this.luckysheetPaintModelOn=!0,_this.luckysheetPaintSingle=!1}else luckysheet.isEditMode()?alert("请选择需要复制格式的区域"):luckysheet.tooltip.info("提示","请选择需要复制格式的区域")}),$("#luckysheet-icon-currency").click(function(){var e=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata);_this.updateFormat(e,"ct","¥ #.00")}),$("#luckysheet-icon-percent").click(function(){var e=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata);_this.updateFormat(e,"ct","0.00%")}),$("#luckysheet-icon-fmt-decimal-decrease").click(function(){var e=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),t=luckysheet_select_save[0].row_focus,l=luckysheet_select_save[0].column_focus,r=_this.checkstatus(e,t,l,"ct"),a=e[t][l];if(null!=r&&"n"==r.t){"General"==r.fa&&(r=luckysheet.mask.genarate(a.v)[1]);if(/^(w|W)((0?)|(0\.0+))$/.test(r.fa))-1<r.fa.indexOf(".")?".0"==r.fa.substr(-2)?_this.updateFormat(e,"ct",r.fa.split(".")[0]):_this.updateFormat(e,"ct",r.fa.substr(0,r.fa.length-1)):_this.updateFormat(e,"ct",r.fa);else{var s="",n="";if(-1<r.fa.indexOf(".")){s=(o=r.fa.split("."))[0];var o=(n=o[1]).split(""),c="";for(i=o.length-1;0<=i;i--){var u=o[i];if("#"==u||"0"==u||","==u||!isNaN(parseInt(u)))break;c=u+c}var h,d,y="";-1<r.fa.indexOf(".")&&(h=n,0<c.length&&(h=n.replace(c,"")),y=""==(d=(d=h.replace(/#/g,"0")).substr(0,d.length-1))?s+c:s+"."+d+c),_this.updateFormat(e,"ct",y)}}}}),$("#luckysheet-icon-fmt-decimal-increase").click(function(){var e=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),t=luckysheet_select_save[0].row_focus,l=luckysheet_select_save[0].column_focus,r=_this.checkstatus(e,t,l,"ct"),a=e[t][l];if(null!=r&&"n"==r.t)if("General"==r.fa&&(r=luckysheet.mask.genarate(a.v)[1]),"General"!=r.fa){if(/^(w|W)((0?)|(0\.0+))$/.test(r.fa))-1<r.fa.indexOf(".")?_this.updateFormat(e,"ct",r.fa+"0"):"0"==r.fa.substr(-1)?_this.updateFormat(e,"ct",r.fa+".0"):_this.updateFormat(e,"ct",r.fa+"0.0");else{var s="",n="",o=(n=-1<r.fa.indexOf(".")?(s=(o=r.fa.split("."))[0],o[1]):r.fa).split(""),c="";for(i=o.length-1;0<=i;i--){var u=o[i];if("#"==u||"0"==u||","==u||!isNaN(parseInt(u)))break;c=u+c}var h,d,y="";y=-1<r.fa.indexOf(".")?(h=n,0<c.length&&(h=n.replace(c,"")),d=h.replace(/#/g,"0"),s+"."+(d+="0")+c):0<c.length?n.replace(c,"")+".0"+c:n+".0"+c,_this.updateFormat(e,"ct",y)}}else _this.updateFormat(e,"ct","#.0")}),$("#luckysheet-icon-fmt-other").click(function(){var e,t,l,r,a=$(this).attr("id")+"-menuButton",s=$("#"+a);0==s.length&&(e=_this.createButtonMenu([{text:"自动",value:"General",example:""},{text:"纯文本",value:"@",example:""},{text:"",value:"split",example:""},{text:"数字",value:"##0.00",example:"1000.12"},{text:"百分比",value:"#0.00%",example:"12.21%"},{text:"科学计数",value:"0.00E+00",example:"1.01E+5"},{text:"",value:"split",example:""},{text:"会计",value:"¥(0.00)",example:"¥(1200.09)"},{text:"万元",value:"w",example:"1亿2000万2500"},{text:"货币",value:"¥0.00",example:"¥1200.09"},{text:"万元2位小数",value:"w0.00",example:"2万2500.55"},{text:"",value:"split",example:""},{text:"日期",value:"yyyy-MM-dd",example:"2017-11-29"},{text:"时间",value:"hh:mm AM/PM",example:"3:00 PM"},{text:"时间24H",value:"hh:mm",example:"15:00"},{text:"日期时间",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},{text:"日期时间24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},{text:"",value:"split",example:""}]),t=luckysheet.replaceHtml(_this.menu,{id:"fmt-other",item:e,subclass:"",sub:""}),l=_this.createButtonMenu([{text:"更多货币格式...",value:"morecurrency",example:""},{text:"更多日期与时间格式...",value:"moredatetime",example:""},{text:"更多数字格式...",value:"moredigit",example:""}]),r=luckysheet.replaceHtml(_this.menu,{id:"fmtOtherSelf",item:l,subclass:"luckysheet-menuButton-sub"}),$("body").append(t+r),s=$("#"+a).width(250),_this.focus(s),s.find(".luckysheet-cols-menuitem").click(function(){s.hide(),$("#"+container).attr("tabindex",0).focus();var e,t=$(this).attr("itemvalue");"fmtOtherSelf"!=t&&(e=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),_this.focus(s,t),_this.updateFormat(e,"ct",t))}),$("#luckysheet-icon-fmtOtherSelf-menuButton").find(".luckysheet-cols-menuitem").click(function(){s.hide(),$("#luckysheet-icon-fmtOtherSelf-menuButton").hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this).attr("itemvalue");luckysheet.moreFormat.createDialog(e),luckysheet.moreFormat.init()}));var n=$(this).outerWidth(),o=s.outerWidth(),c=$(this).offset().left;n<o&&o+c>$("#"+container).width()&&(c=c-o+n),mouseclickposition(s,c,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-font-family").click(function(){var e,t,l=$(this).attr("id")+"-menuButton",a=$("#"+l);0==a.length&&(e=_this.createButtonMenu([{value:"0",text:"<span class='luckysheet-mousedown-cancel' style='font-size:16px;font-family:微软雅黑'>微软雅黑</span>",example:""},{value:"1",text:"<span class='luckysheet-mousedown-cancel' style='font-size:16px;font-family:宋体'>宋体</span>",example:""},{value:"2",text:"<span class='luckysheet-mousedown-cancel' style='font-size:16px;font-family:黑体'>黑体</span>",example:""},{value:"3",text:"<span class='luckysheet-mousedown-cancel' style='font-size:16px;font-family:楷体'>楷体</span>",example:""},{value:"4",text:"<span class='luckysheet-mousedown-cancel' style='font-size:16px;font-family:仿宋'>仿宋</span>",example:""},{value:"5",text:"<span class='luckysheet-mousedown-cancel' style='font-size:16px;font-family:新宋体'>新宋体</span>",example:""},{value:"6",text:"<span class='luckysheet-mousedown-cancel' style='font-size:16px;font-family:华文新魏'>华文新魏</span>",example:""},{value:"7",text:"<span class='luckysheet-mousedown-cancel' style='font-size:16px;font-family:华文行楷'>华文行楷</span>",example:""},{value:"8",text:"<span class='luckysheet-mousedown-cancel' style='font-size:16px;font-family:华文隶书'>华文隶书</span>",example:""},{value:"9",text:"<span class='luckysheet-mousedown-cancel' style='font-size:16px;font-family:Arial'>Arial</span>",example:""},{value:"10",text:"<span class='luckysheet-mousedown-cancel' style='font-size:16px;font-family:Times New Roman'>Times New Roman</span>",example:""},{value:"11",text:"<span class='luckysheet-mousedown-cancel' style='font-size:16px;font-family:Tahoma'>Tahoma</span>",example:""},{value:"12",text:"<span class='luckysheet-mousedown-cancel' style='font-size:16px;font-family:Verdana'>Verdana</span>",example:""}]),t=luckysheet.replaceHtml(_this.menu,{id:"font-family",item:e,subclass:"",sub:""}),$("body").append(t),a=$("#"+l).width(150),_this.focus(a),a.find(".luckysheet-cols-menuitem").click(function(){a.hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this),t=e.attr("itemvalue"),l=e.attr("itemname");_this.focus(a,t),$("#luckysheet-icon-font-family").find(".luckysheet-toolbar-menu-button-caption").html(" "+l+" ");var r=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata);_this.updateFormat(r,"ff",t)}));var r=$(this).outerWidth(),s=a.outerWidth(),n=$(this).offset().left;r<s&&s+n>$("#"+container).width()&&(n=n-s+r),mouseclickposition(a,n,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-text-color").click(function(){var e=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),t=$(this).attr("color");null==t&&(t="#000000"),_this.updateFormat(e,"fc",t)}),$("#luckysheet-icon-text-color-menu").click(function(){var e,t,l=$(this).attr("id")+"-menuButton",r=$("#"+l);0==r.length&&(_this.createButtonMenu([{name:"交替颜色...",id:"luckysheet-color-alternate",example:""}]),e=luckysheet.replaceHtml(_this.coloritem,{class:"luckysheet-icon-alternateformat",name:"交替颜色..."}),t=luckysheet.replaceHtml(_this.color,{id:l,coloritem:e,colorself:"text-color-self",sub:""}),$("body").append(t),r=$("#"+l),$("#"+l).find(".luckysheet-color-selected").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,maxPaletteSize:8,maxSelectionSize:8,cancelText:"取消",chooseText:"确定颜色",togglePaletteMoreText:"自定义",togglePaletteLessText:"收起",togglePaletteOnly:!0,clearText:"清除颜色选择",color:"#000",noColorSelectedText:"没有颜色被选择",localStorageKey:"spectrum.textcolor"+luckysheet.server.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(e){$(this);e=null!=e?e.toHexString():"#000";$("#luckysheet-icon-text-color .luckysheet-color-menu-button-indicator").css("border-bottom-color",e),$("#luckysheet-icon-text-color").attr("color",e);var t=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata);_this.updateFormat(t,"fc",e),r.hide(),$("#"+container).attr("tabindex",0).focus()}}),r.find(".luckysheet-color-reset").click(function(){r.hide(),$("#"+container).attr("tabindex",0).focus();var e=$("#"+l).find(".luckysheet-color-selected");e.val("#000000"),$("#luckysheet-icon-text-color").attr("color",null),e.spectrum("set","#000000"),$("#luckysheet-icon-text-color .luckysheet-color-menu-button-indicator").css("border-bottom-color","#000000");var t=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata);_this.updateFormat(t,"fc",null)}),r.find(".luckysheet-icon-alternateformat").click(function(){var e;r.hide(),$("#"+container).attr("tabindex",0).focus(),1<luckysheet_select_save.length?luckysheet.isEditMode()?alert("不能对多重选择区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选择区域执行此操作，请选择单个区域，然后再试",""):(e=$.extend(!0,{},luckysheet_select_save[0]),luckysheet.alternateformat.rangeIsExists(e)[0]||(luckysheet.alternateformat.modelfocusIndex=0,luckysheet.alternateformat.new(e)),luckysheet.alternateformat.init(),luckysheet.alternateformat.perfect())}));var a=$(this).outerWidth(),s=r.outerWidth(),n=$(this).offset().left;a<s&&s+n>$("#"+container).width()&&(n=n-s+a);var o=$(this).offset().top+26;setTimeout(function(){var e=$("#"+l).find(".luckysheet-color-selected");e.spectrum("set",e.val()),mouseclickposition(r,n-28,o,"lefttop")},1)}),$("#luckysheet-icon-cell-color").click(function(){var e=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),t=$(this).attr("color");null==t&&(t="#ffffff"),_this.updateFormat(e,"bg",t)}),$("#luckysheet-icon-cell-color-menu").click(function(){var e,t,l=$(this).attr("id")+"-menuButton",r=$("#"+l);0==r.length&&(e=luckysheet.replaceHtml(_this.coloritem,{class:"luckysheet-icon-alternateformat",name:"交替颜色..."}),t=luckysheet.replaceHtml(_this.color,{id:l,coloritem:e,colorself:"cell-color-self",sub:""}),$("body").append(t),r=$("#"+l),$("#"+l).find(".luckysheet-color-selected").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,maxPaletteSize:8,maxSelectionSize:8,color:"#fff",cancelText:"取消",chooseText:"确定颜色",togglePaletteMoreText:"自定义",togglePaletteLessText:"收起",togglePaletteOnly:!0,clearText:"清除颜色选择",noColorSelectedText:"没有颜色被选择",localStorageKey:"spectrum.bgcolor"+luckysheet.server.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(e){$(this);e=null!=e?e.toHexString():"#fff";$("#luckysheet-icon-cell-color .luckysheet-color-menu-button-indicator").css("border-bottom-color",e),$("#luckysheet-icon-cell-color").attr("color",e);var t=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata);_this.updateFormat(t,"bg",e),r.hide(),$("#"+container).attr("tabindex",0).focus()}}),r.find(".luckysheet-color-reset").click(function(){r.hide(),$("#"+container).attr("tabindex",0).focus();var e=$("#"+l).find(".luckysheet-color-selected");e.val("#ffffff"),$("#luckysheet-icon-cell-color").attr("color",null),e.spectrum("set","#ffffff"),$("#luckysheet-icon-cell-color .luckysheet-color-menu-button-indicator").css("border-bottom-color","#ffffff");var t=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata);_this.updateFormat(t,"bg",null)}),r.find(".luckysheet-icon-alternateformat").click(function(){var e;r.hide(),$("#"+container).attr("tabindex",0).focus(),1<luckysheet_select_save.length?luckysheet.isEditMode()?alert("不能对多重选择区域执行此操作，请选择单个区域，然后再试"):luckysheet.tooltip.info("不能对多重选择区域执行此操作，请选择单个区域，然后再试",""):(e=$.extend(!0,{},luckysheet_select_save[0]),luckysheet.alternateformat.rangeIsExists(e)[0]||(luckysheet.alternateformat.modelfocusIndex=0,luckysheet.alternateformat.new(e)),luckysheet.alternateformat.init(),luckysheet.alternateformat.perfect())}),$("#"+l).find(".luckysheet-color-selected").val("#fff"));var a=$(this).outerWidth(),s=r.outerWidth(),n=$(this).offset().left;a<s&&s+n>$("#"+container).width()&&(n=n-s+a);var o=$(this).offset().top+26;setTimeout(function(){var e=$("#"+l).find(".luckysheet-color-selected");e.spectrum("set",e.val()),mouseclickposition(r,n-28,o,"lefttop")},1)});var luckysheet_fs_setTimeout=null;$("#luckysheet-icon-font-size").click(function(){var e,t,l=$(this).attr("id")+"-menuButton",r=$("#"+l);0==r.length&&(e=_this.createButtonMenu([{text:"9",value:"9",example:""},{text:"10",value:"10",example:""},{text:"11",value:"11",example:""},{text:"12",value:"12",example:""},{text:"14",value:"14",example:""},{text:"16",value:"16",example:""},{text:"18",value:"18",example:""},{text:"20",value:"20",example:""},{text:"22",value:"22",example:""},{text:"24",value:"24",example:""},{text:"26",value:"26",example:""},{text:"28",value:"28",example:""},{text:"36",value:"36",example:""},{text:"48",value:"48",example:""},{text:"72",value:"72",example:""}]),t=luckysheet.replaceHtml(_this.menu,{id:"font-size",item:e,subclass:"",sub:""}),$("body").append(t),r=$("#"+l).width(150),_this.focus(r,10),r.find(".luckysheet-cols-menuitem").click(function(){r.hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this).attr("itemvalue"),t=$("#luckysheet-icon-font-size input");$("#luckysheet-icon-font-size").attr("itemvalue",e),_this.focus(r,e),t.val(e);var l=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata);_this.updateFormat(l,"fs",e),clearTimeout(luckysheet_fs_setTimeout)}));var a=$(this).outerWidth(),s=r.outerWidth(),n=$("#luckysheet-icon-font-size").attr("itemvalue");null==n&&(n=10),_this.focus(r,n);var o=$(this).offset().left;a<s&&s+o>$("#"+container).width()&&(o=o-s+a),mouseclickposition(r,o,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-border-all").click(function(){luckysheet.editor.deepCopyFlowData(luckysheet.flowdata);var e=$(this).attr("type");null==e&&(e="border-all");var t=$("#luckysheet-icon-borderColor-menuButton").find(".luckysheet-color-selected").val(),l=$("#luckysheetborderSizepreview").attr("itemvalue");null!=t&&""!=t||(t="#000"),null!=l&&""!=l||(l="1");var r=$.extend(!0,{},config);null==r.borderInfo&&(r.borderInfo=[]);var a,s={rangeType:"range",borderType:e,color:t,style:l,range:luckysheet_select_save};r.borderInfo.push(s),clearjfundo&&(luckysheet.jfundo=[],(a=[]).type="borderChange",a.config=$.extend(!0,{},config),a.curconfig=$.extend(!0,{},r),a.sheetIndex=luckysheet.currentSheetIndex,luckysheet.jfredo.push(a)),luckysheet.server.saveParam("cg",luckysheet.currentSheetIndex,r.borderInfo,{k:"borderInfo"}),config=r,luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].config=config,setTimeout(function(){luckysheet.luckysheetrefreshgrid()},1)}),$("#luckysheet-icon-border-menu").click(function(){var e,t,l,r,a,s,n,o,c=$(this).attr("id")+"-menuButton",u=$("#"+c);0==u.length&&(e=_this.createButtonMenu([{text:"上框线",value:"border-top",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-top" style="user-select: none;"> </div> </div>'},{text:"下框线",value:"border-bottom",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-bottom" style="user-select: none;"> </div> </div>'},{text:"左框线",value:"border-left",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-left" style="user-select: none;"> </div> </div>'},{text:"右框线",value:"border-right",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-right" style="user-select: none;"> </div> </div>'},{text:"",value:"split",example:""},{text:"无",value:"border-none",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-none" style="user-select: none;"> </div> </div>'},{text:"所有",value:"border-all",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-all" style="user-select: none;"> </div> </div>'},{text:"外侧",value:"border-outside",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-outside" style="user-select: none;"> </div> </div>'},{text:"",value:"split",example:""},{text:"内侧",value:"border-inside",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-inside" style="user-select: none;"> </div> </div>'},{text:"内侧横线",value:"border-horizontal",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-horizontal" style="user-select: none;"> </div> </div>'},{text:"内侧竖线",value:"border-vertical",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-vertical" style="user-select: none;"> </div> </div>'},{text:"",value:"split",example:""},{text:"<span id='luckysheet-icon-borderColor-linecolor' class='luckysheet-mousedown-cancel' style='border-bottom:3px solid #000;'>边框颜色</span>",value:"borderColor",example:"more"},{text:"边框粗细<img id='luckysheetborderSizepreview' width=100 height=10 src='data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==' style='position:absolute;bottom:-5px;right:0px;width:100px;height:10px;'>",value:"borderSize",example:"more"}]),t=luckysheet.replaceHtml(_this.menu,{id:"border-menu",item:e,subclass:"",sub:""}),l=[{text:"无边框",value:"0",example:""},{text:"<canvas type='Thin' class='border-Thin' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"1",example:""},{text:"<canvas type='Hair' class='border-Hair' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"2",example:""},{text:"<canvas type='Dotted' class='border-Dotted' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"3",example:""},{text:"<canvas type='Dashed' class='border-Dashed' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"4",example:""},{text:"<canvas type='DashDot' class='border-DashDot' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"5",example:""},{text:"<canvas type='DashDotDot' class='border-DashDotDot' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"6",example:""},{text:"<canvas type='Medium' class='border-Medium' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"8",example:""},{text:"<canvas type='MediumDashed' class='border-MediumDashed' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"9",example:""},{text:"<canvas type='MediumDashDot' class='border-MediumDashDot' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"10",example:""},{text:"<canvas type='MediumDashDotDot' class='border-MediumDashDotDot' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"11",example:""},{text:"<canvas type='Thick' class='border-Thick' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"13",example:""}],r=_this.createButtonMenu(l),a=luckysheet.replaceHtml(_this.menu,{id:"borderSize",item:r,subclass:"luckysheet-menuButton-sub"}),s="luckysheet-icon-borderSize-menuButton",n="luckysheet-icon-borderColor-menuButton",o=luckysheet.replaceHtml(_this.color,{id:n,coloritem:"",colorself:"",sub:"luckysheet-menuButton-sub"}),$("body").append(t+o+a),u=$("#"+c).width(150),_this.focus(u,"border-all"),$("#"+s+" canvas").each(function(e){$(this).attr("type");var t=$(this).closest(".luckysheet-cols-menuitem").attr("itemvalue"),l=$(this).addClass("luckysheet-mousedown-cancel").get(0).getContext("2d");l.translate(.5,.5),_this.setLineDash(l,t,"h",0,5,100,5),l.strokeStyle="#000000",l.stroke(),l.closePath()}),$("#"+s+" .luckysheet-cols-menuitem").click(function(){$("#"+s).hide();var e,t=$(this),l=t.attr("itemvalue");0==l?$("#luckysheetborderSizepreview").attr("src","data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==").attr("itemvalue",null):(e=t.find("canvas").get(0).toDataURL("image/png"),$("#luckysheetborderSizepreview").attr("src",e).attr("itemvalue",l)),_this.focus($("#"+s),l)}),u.find(".luckysheet-cols-menuitem").click(function(){u.hide(),$("#"+container).attr("tabindex",0).focus();var e,t,l,r,a,s=$(this).attr("itemvalue");"borderColor"!=s&&"borderSize"!=s&&(luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),null!=(e=$("#"+n).find(".luckysheet-color-selected").val())&&""!=e||(e="#000"),null!=(t=$("#luckysheetborderSizepreview").attr("itemvalue"))&&""!=t||(t="1"),null==(l=$.extend(!0,{},config)).borderInfo&&(l.borderInfo=[]),r={rangeType:"range",borderType:s,color:e,style:t,range:luckysheet_select_save},l.borderInfo.push(r),clearjfundo&&(luckysheet.jfundo=[],(a=[]).type="borderChange",a.config=$.extend(!0,{},config),a.curconfig=$.extend(!0,{},l),a.sheetIndex=luckysheet.currentSheetIndex,luckysheet.jfredo.push(a)),luckysheet.server.saveParam("cg",luckysheet.currentSheetIndex,l.borderInfo,{k:"borderInfo"}),config=l,luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].config=config,setTimeout(function(){luckysheet.luckysheetrefreshgrid()},1),$("#luckysheet-icon-border-all").attr("type",s),$("#luckysheet-icon-border-all").find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-"+s),_this.focus(u,s))}),$("#"+n).find(".luckysheet-color-selected").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,maxPaletteSize:8,maxSelectionSize:8,color:"#000",cancelText:"取消",chooseText:"确定颜色",togglePaletteMoreText:"自定义",togglePaletteLessText:"收起",togglePaletteOnly:!0,clearText:"清除颜色选择",noColorSelectedText:"没有颜色被选择",localStorageKey:"spectrum.bordercolor"+luckysheet.server.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(e){$(this);e=null!=e?e.toHexString():"#000";$("#luckysheet-icon-borderColor-linecolor").css("border-bottom-color",e),$("#"+n).find(".luckysheet-color-selected").val(e)}}),$("#"+n).find(".luckysheet-color-reset").click(function(){var e=$("#"+n).find(".luckysheet-color-selected");e.val("#000"),$("#luckysheet-icon-cell-color").attr("color",null),e.spectrum("set","#000"),$("#luckysheet-icon-borderColor-linecolor").css("border-bottom-color","#000")}));var i=$(this).outerWidth(),h=u.outerWidth(),d=$(this).offset().left;i<h&&h+d>$("#"+container).width()&&(d=d-h+i),mouseclickposition(u,d-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-merge-button").click(function(){if(luckysheet.selectIsOverlap())luckysheet.isEditMode()?alert("不能合并重叠区域"):luckysheet.tooltip.info("不能合并重叠区域","");else{if(null!=config.merge){for(var e=!1,t=0;t<luckysheet_select_save.length;t++){var l=luckysheet_select_save[t].row[0],r=luckysheet_select_save[t].row[1],a=luckysheet_select_save[t].column[0],s=luckysheet_select_save[t].column[1];if(e=luckysheet.hasPartMC(config,l,r,a,s))break}if(e)return void(luckysheet.isEditMode()?alert("无法对部分合并单元格执行此操作"):luckysheet.tooltip.info("无法对部分合并单元格执行此操作",""))}var n=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata);_this.updateFormat_mc(n,"mergeAll")}}),$("#luckysheet-icon-merge-menu").click(function(){var e,t,l=$(this).attr("id")+"-menuButton",c=$("#"+l);0==c.length&&(e=_this.createButtonMenu([{text:"全部合并",value:"mergeAll",example:""},{text:"垂直合并",value:"mergeV",example:""},{text:"水平合并",value:"mergeH",example:""},{text:"取消合并",value:"mergeCancel",example:""}]),t=luckysheet.replaceHtml(_this.menu,{id:"merge-menu",item:e,subclass:"",sub:""}),$("body").append(t),c=$("#"+l).width(100),_this.focus(c),c.find(".luckysheet-cols-menuitem").click(function(){if(c.hide(),$("#"+container).attr("tabindex",0).focus(),luckysheet.selectIsOverlap())luckysheet.isEditMode()?alert("不能合并重叠区域"):luckysheet.tooltip.info("不能合并重叠区域","");else{if(null!=config.merge){for(var e=!1,t=0;t<luckysheet_select_save.length;t++){var l=luckysheet_select_save[t].row[0],r=luckysheet_select_save[t].row[1],a=luckysheet_select_save[t].column[0],s=luckysheet_select_save[t].column[1];if(e=luckysheet.hasPartMC(config,l,r,a,s))break}if(e)return void(luckysheet.isEditMode()?alert("无法对部分合并单元格执行此操作"):luckysheet.tooltip.info("无法对部分合并单元格执行此操作",""))}var n=$(this).attr("itemvalue");_this.focus(c,n);var o=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata);_this.updateFormat_mc(o,n)}}));var r=$(this).outerWidth(),a=c.outerWidth(),s=$(this).offset().left;r<a&&a+s>$("#"+container).width()&&(s=s-a+r),mouseclickposition(c,s-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-align").click(function(){var e=$("#luckysheet-icon-align").attr("type");null==e&&(e="left");var t=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata);_this.updateFormat(t,"ht",e)}),$("#luckysheet-icon-align-menu").click(function(){var e,t,l=$(this).attr("id")+"-menuButton",r=$("#"+l);0==r.length&&(e=_this.createButtonMenu([{text:"左对齐",value:"left",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-left" style="user-select: none;"> </div> </div>'},{text:"中间对齐",value:"center",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-center" style="user-select: none;"> </div> </div>'},{text:"右对齐",value:"right",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-right" style="user-select: none;"> </div> </div>'}]),t=luckysheet.replaceHtml(_this.menu,{id:"align-menu",item:e,subclass:"",sub:""}),$("body").append(t),r=$("#"+l).width(120),_this.focus(r),r.find(".luckysheet-cols-menuitem").click(function(){r.hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this).attr("itemvalue");_this.focus(r,e),$("#luckysheet-icon-align").attr("type",e).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-"+e);var t=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata);_this.updateFormat(t,"ht",e)}));var a=$(this).outerWidth(),s=r.outerWidth(),n=$(this).offset().left;a<s&&s+n>$("#"+container).width()&&(n=n-s+a),mouseclickposition(r,n-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-valign").click(function(){var e=$("#luckysheet-icon-valign").attr("type");null==e&&(e="bottom");var t=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata);_this.updateFormat(t,"vt",e)}),$("#luckysheet-icon-valign-menu").click(function(){var e,t,l=$(this).attr("id")+"-menuButton",r=$("#"+l);0==r.length&&(e=_this.createButtonMenu([{text:"顶部对齐",value:"top",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-top" style="user-select: none;"> </div> </div>'},{text:"居中对齐",value:"middle",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-middle" style="user-select: none;"> </div> </div>'},{text:"底部对齐",value:"bottom",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-bottom" style="user-select: none;"> </div> </div>'}]),t=luckysheet.replaceHtml(_this.menu,{id:"valign-menu",item:e,subclass:"",sub:""}),$("body").append(t),r=$("#"+l).width(120),_this.focus(r,"bottom"),r.find(".luckysheet-cols-menuitem").click(function(){r.hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this).attr("itemvalue");_this.focus(r,e),$("#luckysheet-icon-valign").attr("type",e).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-"+e);var t=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata);_this.updateFormat(t,"vt",e)}));var a=$(this).outerWidth(),s=r.outerWidth(),n=$(this).offset().left;a<s&&s+n>$("#"+container).width()&&(n=n-s+a),mouseclickposition(r,n-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-textwrap-menu").click(function(){var e,t,l=$(this).attr("id")+"-menuButton",r=$("#"+l);0==r.length&&(e=_this.createButtonMenu([{text:"溢出",value:"overflow",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-overflow" style="user-select: none;"> </div> </div>'},{text:"自动换行",value:"wrap",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-wrap" style="user-select: none;"> </div> </div>'},{text:"截断",value:"clip",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-clip" style="user-select: none;"> </div> </div>'}]),t=luckysheet.replaceHtml(_this.menu,{id:"textwrap-menu",item:e,subclass:"",sub:""}),$("body").append(t),r=$("#"+l).width(120),_this.focus(r),r.find(".luckysheet-cols-menuitem").click(function(){r.hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this).attr("itemvalue");_this.focus(r,e),$("#luckysheet-icon-textwrap").attr("type",e).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-"+e);var t=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata);_this.updateFormat(t,"tb",e)}));var a=$(this).outerWidth(),s=r.outerWidth(),n=$(this).offset().left;a<s&&s+n>$("#"+container).width()&&(n=n-s+a),mouseclickposition(r,n-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-rotation-menu").click(function(){var e,t,l=$(this).attr("id")+"-menuButton",r=$("#"+l);0==r.length&&(e=_this.createButtonMenu([{text:"无旋转",value:"none",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none" style="user-select: none;"> </div> </div>'},{text:"向上倾斜",value:"angleup",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-angleup" style="user-select: none;"> </div> </div>'},{text:"向下倾斜",value:"angledown",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-angledown" style="user-select: none;"> </div> </div>'},{text:"竖排文字",value:"vertical",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-vertical" style="user-select: none;"> </div> </div>'},{text:"向上90°",value:"rotation-up",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-rotation-up" style="user-select: none;"> </div> </div>'},{text:"向下90°",value:"rotation-down",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-rotation-down" style="user-select: none;"> </div> </div>'}]),t=luckysheet.replaceHtml(_this.menu,{id:"rotation-menu",item:e,subclass:"",sub:""}),$("body").append(t),r=$("#"+l).width(120),_this.focus(r),r.find(".luckysheet-cols-menuitem").click(function(){r.hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this).attr("itemvalue");_this.focus(r,e),$("#luckysheet-icon-rotation").attr("type",e).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-"+e);var t=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata);_this.updateFormat(t,"tr",e)}));var a=$(this).outerWidth(),s=r.outerWidth(),n=$(this).offset().left;a<s&&s+n>$("#"+container).width()&&(n=n-s+a),mouseclickposition(r,n-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-freezen-menu").click(function(){var e,t,l=$(this).attr("id")+"-menuButton",d=$("#"+l);0==d.length&&(e=_this.createButtonMenu([{text:"冻结首行",value:"freezenRow",example:""},{text:"冻结首列",value:"freezenColumn",example:""},{text:"冻结行列",value:"freezenRC",example:""},{text:"",value:"split",example:""},{text:"冻结行到选区",value:"freezenRowRange",example:""},{text:"冻结列到选区",value:"freezenColumnRange",example:""},{text:"冻结行列到选区",value:"freezenRCRange",example:""},{text:"",value:"split",example:""},{text:"取消冻结",value:"freezenCancel",example:""}]),t=luckysheet.replaceHtml(_this.menu,{id:"freezen-menu",item:e,subclass:"",sub:""}),$("body").append(t),(d=$("#"+l).width(130)).find(".luckysheet-cols-menuitem").click(function(){d.hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this).attr("itemvalue");if(_this.focus(d,e),"freezenRow"==e){var t=$("#luckysheet-cell-main").scrollTop();-1==(o=luckysheet_searcharray(visibledatarow,t))&&(o=0);var l=visibledatarow[o]-2-t+columeHeaderHeight,r=[visibledatarow[o],o+1,t,luckysheet.freezen.cutVolumn(visibledatarow,o+1),l];luckysheet.freezen.saveFreezen(r,l,null,null),null!=luckysheet.freezen.freezenverticaldata&&(luckysheet.freezen.cancelFreezenVertical(),luckysheet.freezen.createAssistCanvas(),luckysheet.luckysheetrefreshgrid()),luckysheet.freezen.createFreezenHorizontal(r,l),luckysheet.freezen.createAssistCanvas(),luckysheet.luckysheetrefreshgrid()}else if("freezenColumn"==e){var a=$("#luckysheet-cell-main").scrollLeft();-1==(u=luckysheet_searcharray(visibledatacolumn,a))&&(u=0);var s=visibledatacolumn[u]-2-a+rowHeaderWidth,n=[visibledatacolumn[u],u+1,a,luckysheet.freezen.cutVolumn(visibledatacolumn,u+1),s];luckysheet.freezen.saveFreezen(null,null,n,s),null!=luckysheet.freezen.freezenhorizontaldata&&(luckysheet.freezen.cancelFreezenHorizontal(),luckysheet.freezen.createAssistCanvas(),luckysheet.luckysheetrefreshgrid()),luckysheet.freezen.createFreezenVertical(n,s),luckysheet.freezen.createAssistCanvas(),luckysheet.luckysheetrefreshgrid()}else if("freezenRC"==e){t=$("#luckysheet-cell-main").scrollTop();-1==(o=luckysheet_searcharray(visibledatarow,t))&&(o=0);l=visibledatarow[o]-2-t+columeHeaderHeight,r=[visibledatarow[o],o+1,t,luckysheet.freezen.cutVolumn(visibledatarow,o+1),l];luckysheet.freezen.saveFreezen(r,l,null,null),luckysheet.freezen.createFreezenHorizontal(r,l);a=$("#luckysheet-cell-main").scrollLeft();-1==(u=luckysheet_searcharray(visibledatacolumn,a))&&(u=0);s=visibledatacolumn[u]-2-a+rowHeaderWidth,n=[visibledatacolumn[u],u+1,a,luckysheet.freezen.cutVolumn(visibledatacolumn,u+1),s];luckysheet.freezen.saveFreezen(null,null,n,s),luckysheet.freezen.createFreezenVertical(n,s),luckysheet.freezen.createAssistCanvas(),luckysheet.luckysheetrefreshgrid()}else if("freezenRowRange"==e){if(null==luckysheet_select_save||0==luckysheet_select_save.length)return void(luckysheet.isEditMode()?alert("没有选区"):luckysheet.tooltip.info("没有选区",""));t=$("#luckysheet-cell-main").scrollTop();(o=luckysheet_searcharray(visibledatarow,t))<(c=null==(i=luckysheet_select_save[luckysheet_select_save.length-1]).row_focus?i.row[0]:i.row_focus)&&(o=c),-1==o&&(o=0);l=visibledatarow[o]-2-t+columeHeaderHeight,r=[visibledatarow[o],o+1,t,luckysheet.freezen.cutVolumn(visibledatarow,o+1),l];luckysheet.freezen.saveFreezen(r,l,null,null),null!=luckysheet.freezen.freezenverticaldata&&(luckysheet.freezen.cancelFreezenVertical(),luckysheet.freezen.createAssistCanvas(),luckysheet.luckysheetrefreshgrid()),luckysheet.freezen.createFreezenHorizontal(r,l),luckysheet.freezen.createAssistCanvas(),luckysheet.luckysheetrefreshgrid()}else if("freezenColumnRange"==e){if(null==luckysheet_select_save||0==luckysheet_select_save.length)return void(luckysheet.isEditMode()?alert("没有选区"):luckysheet.tooltip.info("没有选区",""));a=$("#luckysheet-cell-main").scrollLeft();(u=luckysheet_searcharray(visibledatacolumn,a))<(h=null==(i=luckysheet_select_save[luckysheet_select_save.length-1]).column_focus?i.column[0]:i.column_focus)&&(u=h),-1==u&&(u=0);s=visibledatacolumn[u]-2-a+rowHeaderWidth,n=[visibledatacolumn[u],u+1,a,luckysheet.freezen.cutVolumn(visibledatacolumn,u+1),s];luckysheet.freezen.saveFreezen(null,null,n,s),null!=luckysheet.freezen.freezenhorizontaldata&&(luckysheet.freezen.cancelFreezenHorizontal(),luckysheet.freezen.createAssistCanvas(),luckysheet.luckysheetrefreshgrid()),luckysheet.freezen.createFreezenVertical(n,s),luckysheet.freezen.createAssistCanvas(),luckysheet.luckysheetrefreshgrid()}else if("freezenRCRange"==e){if(null==luckysheet_select_save||0==luckysheet_select_save.length)return void(luckysheet.isEditMode()?alert("没有选区"):luckysheet.tooltip.info("没有选区",""));var o,c,t=$("#luckysheet-cell-main").scrollTop();(o=luckysheet_searcharray(visibledatarow,t))<(c=null==(i=luckysheet_select_save[luckysheet_select_save.length-1]).row_focus?i.row[0]:i.row_focus)&&(o=c),-1==o&&(o=0);l=visibledatarow[o]-2-t+columeHeaderHeight,r=[visibledatarow[o],o+1,t,luckysheet.freezen.cutVolumn(visibledatarow,o+1),l];luckysheet.freezen.saveFreezen(r,l,null,null),luckysheet.freezen.createFreezenHorizontal(r,l);var u,i,h,a=$("#luckysheet-cell-main").scrollLeft();(u=luckysheet_searcharray(visibledatacolumn,a))<(h=null==(i=luckysheet_select_save[luckysheet_select_save.length-1]).column_focus?i.column[0]:i.column_focus)&&(u=h),-1==u&&(u=0);s=visibledatacolumn[u]-2-a+rowHeaderWidth,n=[visibledatacolumn[u],u+1,a,luckysheet.freezen.cutVolumn(visibledatacolumn,u+1),s];luckysheet.freezen.saveFreezen(null,null,n,s),luckysheet.freezen.createFreezenVertical(n,s),luckysheet.freezen.createAssistCanvas(),luckysheet.luckysheetrefreshgrid()}else"freezenCancel"==e&&(null!=luckysheet.freezen.freezenverticaldata&&(luckysheet.freezen.cancelFreezenVertical(),luckysheet.freezen.createAssistCanvas(),luckysheet.luckysheetrefreshgrid()),null!=luckysheet.freezen.freezenhorizontaldata&&(luckysheet.freezen.cancelFreezenHorizontal(),luckysheet.freezen.createAssistCanvas(),luckysheet.luckysheetrefreshgrid()),luckysheet.freezen.scrollAdapt());setTimeout(function(){luckysheet.luckysheetsizeauto()},0)}));var r=$(this).outerWidth(),a=d.outerWidth(),s=$(this).offset().left;r<a&&a+s>$("#"+container).width()&&(s=s-a+r),mouseclickposition(d,s-68,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-autofilter").click(function(){var e,t,l=$(this).attr("id")+"-menuButton",r=$("#"+l);0==r.length&&(e=_this.createButtonMenu([{text:"升序",value:"asc",example:'<i style="font-size:14px;" class="fa fa-sort-numeric-asc" aria-hidden="true"></i>'},{text:"降序",value:"desc",example:'<i style="font-size:14px;" class="fa fa-sort-numeric-desc" aria-hidden="true"></i>'},{text:"自定义排序...",value:"diysort",example:'<i style="font-size:14px;" class="fa fa-sort" aria-hidden="true"></i>'},{text:"",value:"split",example:""},{text:"筛选",value:"filter",example:'<i style="font-size:14px;" class="fa fa-filter" aria-hidden="true"></i>'},{text:"清除筛选",value:"clearfilter",example:'<i style="font-size:14px;" class="fa fa-window-close" aria-hidden="true"></i>'}]),t=luckysheet.replaceHtml(_this.menu,{id:"autofilter",item:e,subclass:"",sub:""}),$("body").append(t),(r=$("#"+l).width(150)).find(".luckysheet-cols-menuitem").click(function(){r.hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this).attr("itemvalue");"diysort"==e?$("#luckysheetorderby").click():"asc"==e?luckysheet.sortSelection(!0):"desc"==e?luckysheet.sortSelection(!1):"filter"==e?0<$("#luckysheet-filter-options-sheet"+luckysheet.currentSheetIndex).length?$("#luckysheet-filter-initial").click():luckysheet.createFilter():"clearfilter"==e&&$("#luckysheet-filter-initial").click()}));var a=$(this).outerWidth(),s=r.outerWidth(),n=$(this).offset().left;a<s&&s+n>$("#"+container).width()&&(n=n-s+a),mouseclickposition(r,n,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-seachmore").click(function(){var e,t,l=$(this).attr("id")+"-menuButton",r=$("#"+l);0==r.length&&(e=_this.createButtonMenu([{text:"查找 ...",value:"search",example:'<i style="font-size:14px;" class="fa fa-search" aria-hidden="true"></i>'},{text:"替换 ...",value:"replace",example:'<i style="font-size:14px;" class="fa fa-files-o" aria-hidden="true"></i>'},{text:"转到 ...",value:"goto",example:'<i style="font-size:14px;" class="fa fa-arrow-right" aria-hidden="true"></i>'},{text:"",value:"split",example:""},{text:"定位条件 ...",value:"location",example:'<i style="font-size:14px;" class="fa fa-location-arrow" aria-hidden="true"></i>'},{text:"公式",value:"locationFormula",example:"定位"},{text:"日期",value:"locationConstantDate",example:"定位"},{text:"数字",value:"locationConstantNumber",example:"定位"},{text:"字符",value:"locationConstantString",example:"定位"},{text:"错误",value:"locationConstantError",example:"定位"},{text:"条件格式",value:"locationCF",example:"定位"},{text:"间隔行",value:"locationStepRow",example:"定位"},{text:"间隔列",value:"locationStepColumn",example:"定位"}]),t=luckysheet.replaceHtml(_this.menu,{id:"seachmore",item:e,subclass:"",sub:""}),$("body").append(t),(r=$("#"+l).width(150)).find(".luckysheet-cols-menuitem").click(function(){r.hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this).attr("itemvalue");if("search"==e||"replace"==e)"search"==e?luckysheet.searchReplace.createDialog(0):"replace"==e&&luckysheet.searchReplace.createDialog(1),luckysheet.searchReplace.init(),$("#luckysheet-search-replace #searchInput input").focus();else if("location"==e)luckysheet.locationCell.createDialog(),luckysheet.locationCell.init();else if("locationFormula"==e||"locationConstantDate"==e||"locationConstantNumber"==e||"locationConstantString"==e||"locationConstantError"==e||"locationCF"==e){t=0==luckysheet_select_save.length||1==luckysheet_select_save.length&&luckysheet_select_save[0].row[0]==luckysheet_select_save[0].row[1]&&luckysheet_select_save[0].column[0]==luckysheet_select_save[0].column[1]?[{row:[0,luckysheet.flowdata.length-1],column:[0,luckysheet.flowdata[0].length-1]}]:$.extend(!0,[],luckysheet_select_save),"locationFormula"==e?luckysheet.locationCell.apply(t,"locationFormula","all"):"locationConstantDate"==e?luckysheet.locationCell.apply(t,"locationConstant","d"):"locationConstantNumber"==e?luckysheet.locationCell.apply(t,"locationConstant","n"):"locationConstantString"==e?luckysheet.locationCell.apply(t,"locationConstant","s,g"):"locationConstantError"==e?luckysheet.locationCell.apply(t,"locationConstant","e"):"locationCF"==e&&luckysheet.locationCell.apply(t,"locationCF")}else if("locationStepRow"==e){if(0==luckysheet_select_save.length||1==luckysheet_select_save.length&&luckysheet_select_save[0].row[0]==luckysheet_select_save[0].row[1])return void(luckysheet.isEditMode()?alert("请选择最少两行"):luckysheet.tooltip.info("提示","请选择最少两行"));var t=$.extend(!0,[],luckysheet_select_save);luckysheet.locationCell.apply(t,"locationStepRow")}else if("locationStepColumn"==e){if(0==luckysheet_select_save.length||1==luckysheet_select_save.length&&luckysheet_select_save[0].column[0]==luckysheet_select_save[0].column[1])return void(luckysheet.isEditMode()?alert("请选择最少两列"):luckysheet.tooltip.info("提示","请选择最少两列"));t=$.extend(!0,[],luckysheet_select_save);luckysheet.locationCell.apply(t,"locationStepColumn")}}));var a=$(this).outerWidth(),s=r.outerWidth(),n=$(this).offset().left;a<s&&s+n>$("#"+container).width()&&(n=n-s+a),mouseclickposition(r,n,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-function").click(function(){_this.autoSelectionFormula("SUM")}),$("#luckysheet-icon-function-menu").click(function(){var e,t,l=$(this).attr("id")+"-menuButton",y=$("#"+l);0==y.length&&(e=_this.createButtonMenu([{text:"求和",value:"SUM",example:"SUM"},{text:"平均值",value:"AVERAGE",example:"AVERAGE"},{text:"计数",value:"COUNT",example:"COUNT"},{text:"最大值",value:"MAX",example:"MAX"},{text:"最小值",value:"MIN",example:"MIN"},{text:"",value:"split",example:""},{text:"if公式生成器",value:"if",example:"IF"},{text:"函数查找 ...",value:"formula",example:""}]),t=luckysheet.replaceHtml(_this.menu,{id:"function-menu",item:e,subclass:"",sub:""}),$("body").append(t),(y=$("#"+l).width(150)).find(".luckysheet-cols-menuitem").click(function(){y.hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this).attr("itemvalue");if("if"==e){var t=null==(a=luckysheet_select_save[luckysheet_select_save.length-1]).row_focus?a.row[0]:a.row_focus,l=null==a.column_focus?a.column[0]:a.column_focus;if(luckysheet.flowdata[t]&&luckysheet.flowdata[t][l]&&luckysheet.flowdata[t][l].f){var r=luckysheet.flowdata[t][l].f.toString();if(-1==r.indexOf("=if("))return void(luckysheet.isEditMode()?alert("该单元格函数不属于if公式！"):luckysheet.tooltip.info("该单元格函数不属于if公式！",""));luckysheet.ifFormulaGenerator.ifFormulaDialog(r)}else luckysheet.ifFormulaGenerator.ifFormulaDialog();luckysheet.ifFormulaGenerator.init()}else if("formula"==e){if(0==luckysheet_select_save.length)return void(luckysheet.isEditMode()?alert("请选择单元格插入函数"):luckysheet.tooltip.info("请选择单元格插入函数",""));var a,s=(a=luckysheet_select_save[luckysheet_select_save.length-1]).row_focus,n=a.column_focus,o=visibledatarow[s],c=s-1==-1?0:visibledatarow[s-1],u=visibledatacolumn[n],i=n-1==-1?0:visibledatacolumn[n-1];luckysheet.luckysheetupdateCell(o,c,s,u,i,n,luckysheet.flowdata);var h,d=luckysheet.flowdata[s][n];null!=d&&null!=d.f?null!=(h=luckysheet.formula.getfunctionParam(d.f)).fn?luckysheet.insertFormula.formulaParmDialog(h.fn,h.param):luckysheet.insertFormula.formulaListDialog():($("#luckysheet-rich-text-editor").html('<span dir="auto" class="luckysheet-formula-text-color">=</span>'),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),luckysheet.insertFormula.formulaListDialog()),luckysheet.insertFormula.init()}else _this.autoSelectionFormula(e)}));var r=$(this).outerWidth(),a=y.outerWidth(),s=$(this).offset().left;r<a&&a+s>$("#"+container).width()&&(s=s-a+r),mouseclickposition(y,s-48,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-bold").click(function(){var e=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),t=luckysheet_select_save[0].row_focus,l=luckysheet_select_save[0].column_focus,r=1==(r=_this.checkstatus(e,t,l,"bl"))?0:1;_this.updateFormat(e,"bl",r),luckysheet.menuButton.menuButtonFocus(e,t,l)}),$("#luckysheet-icon-italic").click(function(){var e=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),t=luckysheet_select_save[0].row_focus,l=luckysheet_select_save[0].column_focus,r=1==(r=_this.checkstatus(e,t,l,"it"))?0:1;_this.updateFormat(e,"it",r),luckysheet.menuButton.menuButtonFocus(e,t,l)}),$("#luckysheet-icon-strikethrough").click(function(){var e=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),t=luckysheet_select_save[0].row_focus,l=luckysheet_select_save[0].column_focus,r=1==(r=_this.checkstatus(e,t,l,"cl"))?0:1;_this.updateFormat(e,"cl",r),luckysheet.menuButton.menuButtonFocus(e,t,l)}),$("#luckysheet-icon-conditionformat").click(function(){var menuButtonId=$(this).attr("id")+"-menuButton",$menuButton=$("#"+menuButtonId),itemdata,itemset,menu,subitemdata,subitemset,submenu,subitemdata2,subitemset2,submenu2,submenu3,submenu4,subitemdata6,subitemset6,submenu6;0==$menuButton.length&&(itemdata=[{text:"突出显示单元格规则",value:"highlightCellRule",example:"more"},{text:"项目选取规则",value:"projectSelectRule",example:"more"},{text:"数据条",value:"dataBar",example:"more"},{text:"色阶",value:"colorGradation",example:"more"},{text:"图标集",value:"icons",example:""},{text:"",value:"split",example:""},{text:"新建规则",value:"newRule",example:""},{text:"清除规则",value:"deleteRule",example:"more"},{text:"管理规则",value:"administerRule",example:""}],itemset=_this.createButtonMenu(itemdata),menu=luckysheet.replaceHtml(_this.menu,{id:"conditionformat",item:itemset,subclass:"",sub:""}),subitemdata=[{text:"大于",value:"greaterThan",example:">"},{text:"小于",value:"lessThan",example:"<"},{text:"介于",value:"betweenness",example:"[]"},{text:"等于",value:"equal",example:"="},{text:"文本包含",value:"textContains",example:"()"},{text:"发生日期",value:"occurrenceDate",example:"昨天"},{text:"重复值",value:"duplicateValue",example:"##"}],subitemset=_this.createButtonMenu(subitemdata),submenu=luckysheet.replaceHtml(_this.menu,{id:"highlightCellRule",item:subitemset,subclass:"luckysheet-menuButton-sub"}),subitemdata2=[{text:"前 10 项",value:"top10",example:"前10项"},{text:"前 10%",value:"top10%",example:"前10%"},{text:"最后 10 项",value:"last10",example:"后10项"},{text:"最后 10%",value:"last10%",example:"后10%"},{text:"高于平均值",value:"AboveAverage",example:"高于均值"},{text:"低于平均值",value:"SubAverage",example:"低于均值"}],subitemset2=_this.createButtonMenu(subitemdata2),submenu2=luckysheet.replaceHtml(_this.menu,{id:"projectSelectRule",item:subitemset2,subclass:"luckysheet-menuButton-sub"}),submenu3='<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-menuButton luckysheet-menuButton-sub luckysheet-mousedown-cancel" id="luckysheet-icon-dataBar-menuButton" style="width: 126px;padding: 5px;top: 118.5px;left: 1321.48px;display: none;"><div itemvalue="0" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 0;" title="蓝-白渐变数据条"></div></div><div itemvalue="1" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px 0;" title="绿-白渐变数据条"></div></div><div itemvalue="2" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px 0;" title="红-白渐变数据条"></div></div><div itemvalue="3" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 -36px;" title="橙-白渐变数据条"></div></div><div itemvalue="4" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px -36px;" title="浅蓝-白渐变数据条"></div></div><div itemvalue="5" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px -36px;" title="紫-白渐变数据条"></div></div><div itemvalue="6" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 -72px;" title="蓝色数据条"></div></div><div itemvalue="7" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px -72px;" title="绿色数据条"></div></div><div itemvalue="8" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px -72px;" title="红色数据条"></div></div><div itemvalue="9" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 -108px;" title="橙色数据条"></div></div><div itemvalue="10" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px -108px;" title="浅蓝色数据条"></div></div><div itemvalue="11" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px -108px;" title="紫色数据条"></div></div></div>',submenu4='<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-menuButton luckysheet-menuButton-sub luckysheet-mousedown-cancel" id="luckysheet-icon-colorGradation-menuButton" style="width: 126px;padding: 5px;top: 143.5px;left: 1321.48px;display: none;"><div itemvalue="0" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 0;" title="绿-黄-红色阶"></div></div><div itemvalue="1" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px 0;" title="红-黄-绿色阶"></div></div><div itemvalue="2" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px 0;" title="绿-白-红色阶"></div></div><div itemvalue="3" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -114px 0;" title="红-白-绿色阶"></div></div><div itemvalue="4" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 -36px;" title="蓝-白-红色阶"></div></div><div itemvalue="5" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px -36px;" title="红-白-蓝色阶"></div></div><div itemvalue="6" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px -36px;" title="白-红色阶"></div></div><div itemvalue="7" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -114px -36px;" title="红-白色阶"></div></div><div itemvalue="8" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 -72px;" title="绿-白色阶"></div></div><div itemvalue="9" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px -72px;" title="白-绿色阶"></div></div><div itemvalue="10" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px -72px;" title="绿-黄色阶"></div></div><div itemvalue="11" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -114px -72px;" title="黄-绿色阶"></div></div></div>',subitemdata6=[{text:"清除整个工作表的规则",value:"delSheet",example:""}],subitemset6=_this.createButtonMenu(subitemdata6),submenu6=luckysheet.replaceHtml(_this.menu,{id:"deleteRule",item:subitemset6,subclass:"luckysheet-menuButton-sub"}),$("body").append(menu+submenu+submenu2+submenu3+submenu4+submenu6),$menuButton=$("#"+menuButtonId).width(190),$("#luckysheet-icon-highlightCellRule-menuButton").width(130),$("#luckysheet-icon-projectSelectRule-menuButton").width(170),$menuButton.find(".luckysheet-cols-menuitem").click(function(){$menuButton.hide(),$("#"+container).attr("tabindex",0).focus();var $t=$(this),itemvalue=$t.attr("itemvalue");if("icons"==itemvalue){if(0==luckysheet_select_save.length)return void(luckysheet.isEditMode()?alert("请选择应用范围"):luckysheet.tooltip.info("请选择应用范围",""));luckysheet.conditionformat.CFiconsDialog(),luckysheet.conditionformat.init()}else if("newRule"==itemvalue){if(0==luckysheet_select_save.length)return void(luckysheet.isEditMode()?alert("请选择应用范围"):luckysheet.tooltip.info("请选择应用范围",""));luckysheet.conditionformat.newConditionRuleDialog(0),luckysheet.conditionformat.init()}else if("administerRule"==itemvalue){var loadSheetUrl=luckysheet.server.loadSheetUrl,file=luckysheet.getluckysheetfile();if(""!=loadSheetUrl&&null!=loadSheetUrl){for(var sheetindex=[],i=0;i<file.length;i++)sheetindex.push(file[i].index);$.post(loadSheetUrl,{gridKey:luckysheet.server.gridKey,index:sheetindex.join(",")},function(d){var dataset=eval("("+d+")"),otherfile;for(var item in setTimeout(function(){$("#luckysheetloadingdata").fadeOut().remove()},500),dataset){item!=luckysheet.currentSheetIndex&&(otherfile=file[luckysheet.sheetmanage.getSheetIndex(item)],otherfile.celldata=dataset[item.toString()],otherfile.data=luckysheet.sheetmanage.buildGridData(otherfile))}luckysheet.setluckysheetfile(file),luckysheet.conditionformat.fileClone=$.extend(!0,[],file),luckysheet.conditionformat.administerRuleDialog(),luckysheet.conditionformat.init()})}else luckysheet.conditionformat.fileClone=$.extend(!0,[],file),luckysheet.conditionformat.administerRuleDialog(),luckysheet.conditionformat.init()}}),$(document).off("click.CFhighlightCellRule").on("click.CFhighlightCellRule","#luckysheet-icon-highlightCellRule-menuButton .luckysheet-cols-menuitem",function(){$menuButton.hide(),$("#luckysheet-icon-highlightCellRule-menuButton").hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this).attr("itemvalue");if(0!=luckysheet_select_save.length){var t=luckysheet.conditionformat.textCellColorHtml;switch(e){case"greaterThan":var l="条件格式——大于",r='<div class="box" data-itemvalue="greaterThan"><div class="boxTitleOne">为大于以下值的单元格设置格式：</div><div class="inpbox range"><input id="conditionVal" class="formulaInputFocus"/><i class="fa fa-table" aria-hidden="true" title="点击选择单元格"></i></div><div style="margin: 5px 0;">设置为：</div>'+t+"</div>";break;case"lessThan":l="条件格式——小于",r='<div class="box" data-itemvalue="lessThan"><div class="boxTitleOne">为小于以下值的单元格设置格式：</div><div class="inpbox range"><input id="conditionVal" class="formulaInputFocus"/><i class="fa fa-table" aria-hidden="true" title="点击选择单元格"></i></div><div style="margin: 5px 0;">设置为：</div>'+t+"</div>";break;case"betweenness":l="条件格式——介于",r='<div class="box" data-itemvalue="betweenness"><div class="boxTitleOne">为介于以下值的单元格设置格式：</div><div style="height: 30px;line-height: 30px;"><div class="inpbox2 range"><input id="conditionVal" class="formulaInputFocus"/><i class="fa fa-table" aria-hidden="true" title="点击选择单元格"></i></div><div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">到</div><div class="inpbox2 range"><input id="conditionVal2" class="formulaInputFocus"/><i class="fa fa-table" aria-hidden="true" title="点击选择单元格"></i></div></div><div style="margin: 5px 0;">设置为：</div>'+t+"</div>";break;case"equal":l="条件格式——等于",r='<div class="box" data-itemvalue="equal"><div class="boxTitleOne">为等于以下值的单元格设置格式：</div><div class="inpbox range"><input id="conditionVal" class="formulaInputFocus"/><i class="fa fa-table" aria-hidden="true" title="点击选择单元格"></i></div><div style="margin: 5px 0;">设置为：</div>'+t+"</div>";break;case"textContains":l="条件格式——文本包含",r='<div class="box" data-itemvalue="textContains"><div class="boxTitleOne">为包含以下文本的单元格设置格式：</div><div class="inpbox range"><input id="conditionVal" class="formulaInputFocus"/><i class="fa fa-table" aria-hidden="true" title="点击选择单元格"></i></div><div style="margin: 5px 0;">设置为：</div>'+t+"</div>";break;case"occurrenceDate":l="条件格式——发生日期",r='<div class="box" data-itemvalue="occurrenceDate"><div class="boxTitleOne">为包含以下日期的单元格设置格式：</div><div class="inpbox"><input id="daterange-btn" class="formulaInputFocus" readonly="readonly" placeholder="请选择日期"/></div><div style="margin: 5px 0;">设置为：</div>'+t+"</div>";break;case"duplicateValue":l="条件格式——重复值",r='<div class="box" data-itemvalue="duplicateValue"><div class="boxTitleOne">为包含以下类型值的单元格设置格式：</div><select id="conditionVal" class="selectbox"><option value="0">重复</option><option value="1">唯一</option></select><span style="margin-left: 5px;">值</span><div style="margin:5px 0;">设置为：</div>'+t+"</div>"}luckysheet.conditionformat.conditionformatDialog(l,r)}else luckysheet.isEditMode()?alert("请选择条件格式的应用范围"):luckysheet.tooltip.info("请选择条件格式的应用范围","")}),$(document).off("click.CFprojectSelectRule").on("click.CFprojectSelectRule","#luckysheet-icon-projectSelectRule-menuButton .luckysheet-cols-menuitem",function(){$menuButton.hide(),$("#luckysheet-icon-projectSelectRule-menuButton").hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this).attr("itemvalue");if(0!=luckysheet_select_save.length){var t=luckysheet.conditionformat.textCellColorHtml;switch(e){case"top10":var l="条件格式——前 10 项",r='<div class="box" data-itemvalue="top10"><div class="boxTitleOne">为值最大的那些单元格设置格式：</div><div style="height: 30px;line-height: 30px;"><div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">前</div><div class="inpbox2"><input id="conditionVal" class="formulaInputFocus" type="number" value="10"/></div><div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">项</div></div><div style="margin: 5px 0;">设置为：</div>'+t+"</div>";break;case"top10%":l="条件格式——前 10%",r='<div class="box" data-itemvalue="top10%"><div class="boxTitleOne">为值最大的那些单元格设置格式：</div><div style="height: 30px;line-height: 30px;"><div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">前</div><div class="inpbox2"><input id="conditionVal" class="formulaInputFocus" type="number" value="10"/></div><div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">%</div></div><div style="margin: 5px 0;">设置为：</div>'+t+"</div>";break;case"last10":l="条件格式——最后 10 项",r='<div class="box" data-itemvalue="last10"><div class="boxTitleOne">为值最小的那些单元格设置格式：</div><div style="height: 30px;line-height: 30px;"><div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">最后</div><div class="inpbox2"><input id="conditionVal" class="formulaInputFocus" type="number" value="10"/></div><div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">项</div></div><div style="margin: 5px 0;">设置为：</div>'+t+"</div>";break;case"last10%":l="条件格式——最后 10%",r='<div class="box" data-itemvalue="last10%"><div class="boxTitleOne">为值最小的那些单元格设置格式：</div><div style="height: 30px;line-height: 30px;"><div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">最后</div><div class="inpbox2"><input id="conditionVal" class="formulaInputFocus" type="number" value="10"/></div><div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">%</div></div><div style="margin:5px 0;">设置为：</div>'+t+"</div>";break;case"AboveAverage":l="条件格式——高于平均值",r='<div class="box" data-itemvalue="AboveAverage"><div class="boxTitleOne">为高于平均值的单元格设置格式：</div><div style="margin: 5px 0;">针对选定区域，设置为：</div>'+t+"</div>";break;case"SubAverage":l="条件格式——低于平均值",r='<div class="box" data-itemvalue="SubAverage"><div class="boxTitleOne">为低于平均值的单元格设置格式：</div><div style="margin: 5px 0;">针对选定区域，设置为：</div>'+t+"</div>"}luckysheet.conditionformat.conditionformatDialog(l,r)}else luckysheet.isEditMode()?alert("请选择条件格式的应用范围"):luckysheet.tooltip.info("请选择条件格式的应用范围","")}),$(document).off("click.CFdataBar").on("click.CFdataBar","#luckysheet-icon-dataBar-menuButton .luckysheet-cols-menuitem",function(){$menuButton.hide(),$("#luckysheet-icon-dataBar-menuButton").hide(),$("#"+container).attr("tabindex",0).focus();var e,t,l=$(this).attr("itemvalue");0<luckysheet_select_save.length&&(e=$.extend(!0,[],luckysheet_select_save),t=luckysheet.conditionformat.dataBarList[l].format,luckysheet.conditionformat.updateItem("dataBar",e,t))}),$(document).off("click.CFcolorGradation").on("click.CFcolorGradation","#luckysheet-icon-colorGradation-menuButton .luckysheet-cols-menuitem",function(){$menuButton.hide(),$("#luckysheet-icon-colorGradation-menuButton").hide(),$("#"+container).attr("tabindex",0).focus();var e,t,l=$(this).attr("itemvalue");0<luckysheet_select_save.length&&(e=$.extend(!0,[],luckysheet_select_save),t=luckysheet.conditionformat.colorGradationList[l].format,luckysheet.conditionformat.updateItem("colorGradation",e,t))}),$(document).off("click.CFdeleteRule").on("click.CFdeleteRule","#luckysheet-icon-deleteRule-menuButton .luckysheet-cols-menuitem",function(){$menuButton.hide(),$("#luckysheet-icon-deleteRule-menuButton").hide(),$("#"+container).attr("tabindex",0).focus(),"delSheet"==$(this).attr("itemvalue")&&luckysheet.conditionformat.updateItem("delSheet")}));var userlen=$(this).outerWidth(),tlen=$menuButton.outerWidth(),menuleft=$(this).offset().left;userlen<tlen&&tlen+menuleft>$("#"+container).width()&&(menuleft=menuleft-tlen+userlen),mouseclickposition($menuButton,menuleft,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-postil").click(function(){var e=$(this).attr("id")+"-menuButton",t=$("#"+e);t.remove(),luckysheet.postil.removeActivePs();var l=luckysheet_select_save[luckysheet_select_save.length-1],r=l.row_focus;null==r&&(r=l.row[0]);var a,s=l.column_focus;null==s&&(s=l.column[0]),a=null!=luckysheet.flowdata[r][s]&&null!=luckysheet.flowdata[r][s].ps?[{text:"编辑批注",value:"editPs",example:""},{text:"删除",value:"delPs",example:""},{text:"",value:"split",example:""},{text:"显示/隐藏批注",value:"showHidePs",example:""},{text:"显示/隐藏所有批注",value:"showHideAllPs",example:""}]:[{text:"新建批注",value:"newPs",example:""},{text:"",value:"split",example:""},{text:"显示/隐藏所有批注",value:"showHideAllPs",example:""}];var n=_this.createButtonMenu(a),o=luckysheet.replaceHtml(_this.menu,{id:"postil",item:n,subclass:"",sub:""});$("body").append(o),(t=$("#"+e).width(150)).find(".luckysheet-cols-menuitem").click(function(){t.hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this).attr("itemvalue");"newPs"==e?luckysheet.postil.newPs(r,s):"editPs"==e?luckysheet.postil.editPs(r,s):"delPs"==e?luckysheet.postil.delPs(r,s):"showHidePs"==e?luckysheet.postil.showHidePs(r,s):"showHideAllPs"==e&&luckysheet.postil.showHideAllPs()});var c=$(this).outerWidth(),u=t.outerWidth(),i=$(this).offset().left;c<u&&u+i>$("#"+container).width()&&(i=i-u+c),mouseclickposition(t,i,$(this).offset().top+25,"lefttop")}),$("body").on("mouseover mouseleave",".luckysheet-menuButton .luckysheet-cols-submenu",function(e){var t,l,r,a,s,n,o,c,u,i=$(this),h=i.attr("itemvalue"),d=$("#luckysheet-icon-"+h+"-menuButton");"mouseover"===e.type?(t=i.parent(),l=$(window).width(),r=$(window).height(),a=t.width(),s=d.height()+25,n=d.width()+5,c=(o=i.offset()).top,l<(u=o.left+a)+n&&(u=o.left-n),r<c+s&&(c=r-s),d.css({top:c,left:u}).show(),_this.rightclickmenu=i):_this.submenuhide=setTimeout(function(){d.hide()},200)}).on("mouseover mouseleave",".luckysheet-menuButton-sub",function(e){"mouseover"===e.type?(_this.rightclickmenu.addClass("luckysheet-cols-menuitem-hover"),clearTimeout(_this.submenuhide)):(_this.rightclickmenu.removeClass("luckysheet-cols-menuitem-hover"),$(this).hide())})},fontarray:["微软雅黑","宋体","黑体","楷体","仿宋","新宋体","华文新魏","华文行楷","华文隶书","Arial","Times New Roman","Tahoma","Verdana"],fontjson:{"微软雅黑":0,"microsoft yahei":0,"宋体":1,simsun:1,"黑体":2,simhei:2,"楷体":3,kaiti:3,"仿宋":4,fangsong:4,"新宋体":5,nsimsun:5,"华文新魏":6,stxinwei:6,"华文行楷":7,stxingkai:7,"华文隶书":8,stliti:8,arial:9,"times new roman":10,tahoma:11,verdana:12},getQKBorder:function(e,t,l){var r=0;t=t.toLowerCase();var a="";-1<e.indexOf("pt")?(e=parseFloat(e))<1||(a=e<1.5?"Medium":"Thick"):(e=parseFloat(e))<2||(a=e<3?"Medium":"Thick");a="solid";return"double"==t?r=2:"dotted"==t?r="Medium"==a||"Thick"==a?3:10:"dashed"==t?r="Medium"==a||"Thick"==a?4:9:"solid"==t&&(r="Medium"==a?8:"Thick"==a?13:1),[r,l]},updateFormat:function(e,t,l){var r=document.createElement("canvas").getContext("2d"),a=$.extend(!0,{},config);null==a.rowlen&&(a.rowlen={});for(var s=0;s<luckysheet_select_save.length;s++){var n=luckysheet_select_save[s].row[0],o=luckysheet_select_save[s].row[1],c=luckysheet_select_save[s].column[0],u=luckysheet_select_save[s].column[1];if("ct"==t){for(var i=n;i<=o;i++)if(null==config.rowhidden||null==config.rowhidden[i])for(var h=c;h<=u;h++){var d=e[i][h],y=null;y="object"==luckysheet.getObjType(d)?e[i][h].v:e[i][h],"@"!=l&&luckysheet.func_methods.isRealNum(y)&&(y=parseFloat(y));var f=luckysheet.mask.update(l,y),m="n";luckysheet.mask.is_date(l)||14===l||15===l||16===l||17===l||18===l||19===l||20===l||21===l||22===l||45===l||46===l||47===l?m="d":"@"==l||49===l?m="s":"General"!=l&&0!==l||(m="g"),"object"==luckysheet.getObjType(d)?(e[i][h].m=f,null==e[i][h].ct&&(e[i][h].ct={}),e[i][h].ct.fa=l,e[i][h].ct.t=m):e[i][h]={ct:{fa:l,t:m},v:y,m:f}}}else{"ht"==t?"left"==l?l="1":"center"==l?l="0":"right"==l&&(l="2"):"vt"==t?"top"==l?l="1":"middle"==l?l="0":"bottom"==l&&(l="2"):"tb"==t?"overflow"==l?l="1":"clip"==l?l="0":"wrap"==l&&(l="2"):"tr"==t&&("none"==l?l="0":"angleup"==l?l="2":"angledown"==l?l="1":"vertical"==l?l="3":"rotation-up"==l?l="5":"rotation-down"==l&&(l="4"));for(i=n;i<=o;i++)if(null==config.rowhidden||null==config.rowhidden[i])for(h=c;h<=u;h++){y=e[i][h];"object"==luckysheet.getObjType(y)||(e[i][h]={v:y}),e[i][h][t]=l,"tr"==t&&null!=e[i][h].tb&&(e[i][h].tb="0")}}if("tb"==t&&"2"==l){for(i=n;i<=o;i++)if(null==config.rowhidden||null==config.rowhidden[i]){var k=defaultrowlen;null!=a.rowlen[i]&&(k=a.rowlen[i]);for(h=c;h<=u;h++){if(null!=(d=e[i][h])&&!luckysheet.func_methods.isRealNull(d.v)){var p=luckysheetfontformat(d),g=luckysheet.menuButton.getTextSize("田",p)[1];r.font=p;var v=d.m.toString(),b=r.measureText(v).width;if((R=luckysheet.colLocationByIndex(h)[1]-luckysheet.colLocationByIndex(h)[0]-8)<b){for(var _=[],w=1;w<=v.length;w++){var x=v.substring(_.join("").length,w);R<(S=r.measureText(x).width)?(_.push(v.substring(_.join("").length,w-1)),w-=2):S<=R&&w==v.length&&_.push(x)}k<(C=g*_.length)&&(k=C)}}}k!=defaultrowlen&&(a.rowlen[i]=k)}}else if("tr"==t){for(i=n;i<=o;i++)if(null==config.rowhidden||null==config.rowhidden[i]){k=defaultrowlen;null!=a.rowlen[i]&&(k=a.rowlen[i]);for(h=c;h<=u;h++){null==(d=e[i][h])||luckysheet.func_methods.isRealNull(d.v)||(p=luckysheetfontformat(d),g=luckysheet.menuButton.getTextSize("田",p)[1],r.font=p,y=d.m.toString(),I=r.measureText(y).width,"0"==l?C=g:"1"==l||"2"==l?C=.707*(I+g)+4:"3"==l?C=y.length*g+4:"4"!=l&&"5"!=l||(C=I+4),k<(C=Math.round(C))&&(k=C))}k!=defaultrowlen&&(a.rowlen[i]=k)}}else if("fs"==t)for(i=n;i<=o;i++)if(null==config.rowhidden||null==config.rowhidden[i]){k=defaultrowlen;null!=a.rowlen[i]&&(k=a.rowlen[i]);for(h=c;h<=u;h++){if(null!=(d=e[i][h])){var C,T,I,p=luckysheetfontformat(d),g=luckysheet.menuButton.getTextSize("田",p)[1];if(r.font=p,luckysheet.func_methods.isRealNull(d.v))C=g;else if("2"==d.tb){var R,v=d.m.toString(),b=r.measureText(v).width;if((R=luckysheet.colLocationByIndex(h)[1]-luckysheet.colLocationByIndex(h)[0]-8)<b){for(_=[],w=1;w<=v.length;w++){var S,x=v.substring(_.join("").length,w);R<(S=r.measureText(x).width)?(_.push(v.substring(_.join("").length,w-1)),w-=2):S<=R&&w==v.length&&_.push(x)}C=g*_.length}else C=g}else{C=null!=d.tr?(T=d.tr,y=d.m.toString(),I=r.measureText(y).width,"0"==T?C=g:"1"==T||"2"==T?C=.707*(I+g)+4:"3"==T?C=y.length*g+4:"4"!=T&&"5"!=T||(C=I+4),Math.round(C)):g}k<C&&(k=C)}}k!=defaultrowlen&&(a.rowlen[i]=k)}}"tb"==t&&"2"==l||"tr"==t||"fs"==t?luckysheet.jfrefreshgrid(e,luckysheet_select_save,a,null,!0):luckysheet.jfrefreshgrid(e,luckysheet_select_save)},updateFormat_mc:function(e,t){var l=$.extend(!0,{},config);if(null==l.merge&&(l.merge={}),"mergeCancel"==t)for(var r=0;r<luckysheet_select_save.length;r++){var a=(k=luckysheet_select_save[r]).row[0],s=k.row[1],n=k.column[0],o=k.column[1];if(a!=s||n!=o)for(var c={},u=a;u<=s;u++)for(var i=n;i<=o;i++){null!=(d=e[u][i])&&null!=d.mc&&(y=d.mc.r,f=d.mc.c,"rs"in d.mc?(delete d.mc,delete l.merge[y+"_"+f],c[y+"_"+f]=$.extend(!0,{},d)):(delete(m=c[y+"_"+f]).v,delete m.m,delete m.ct,delete m.f,delete m.spl,e[u][i]=m))}}else{for(var h=!1,r=0;r<luckysheet_select_save.length;r++)for(a=(k=luckysheet_select_save[r]).row[0],s=k.row[1],n=k.column[0],o=k.column[1],u=a;u<=s;u++)for(i=n;i<=o;i++){var d=e[u][i];if("object"==luckysheet.getObjType(d)&&"mc"in d){h=!0;break}}if(h)for(r=0;r<luckysheet_select_save.length;r++){a=(k=luckysheet_select_save[r]).row[0],s=k.row[1],n=k.column[0],o=k.column[1];if(a!=s||n!=o)for(c={},u=a;u<=s;u++)for(var y,f,m,i=n;i<=o;i++){null!=(d=e[u][i])&&null!=d.mc&&(y=d.mc.r,f=d.mc.c,"rs"in d.mc?(delete d.mc,delete l.merge[y+"_"+f],c[y+"_"+f]=$.extend(!0,{},d)):(delete(m=c[y+"_"+f]).v,delete m.m,delete m.ct,delete m.f,delete m.spl,e[u][i]=m))}}else for(r=0;r<luckysheet_select_save.length;r++){var k,a=(k=luckysheet_select_save[r]).row[0],s=k.row[1],n=k.column[0],o=k.column[1];if(a!=s||n!=o)if("mergeAll"==t){for(var c={},p=!1,u=a;u<=s;u++)for(i=n;i<=o;i++){null==(d=e[u][i])||luckysheet.func_methods.isRealNull(d.v)&&null==d.f||p||(c=$.extend(!0,{},d),p=!0),e[u][i]={mc:{r:a,c:n}}}e[a][n]=c,e[a][n].mc={r:a,c:n,rs:s-a+1,cs:o-n+1},l.merge[a+"_"+n]={r:a,c:n,rs:s-a+1,cs:o-n+1}}else if("mergeV"==t)for(i=n;i<=o;i++){for(c={},p=!1,u=a;u<=s;u++){null==(d=e[u][i])||luckysheet.func_methods.isRealNull(d.v)&&null==d.f||p||(c=$.extend(!0,{},d),p=!0),e[u][i]={mc:{r:a,c:i}}}e[a][i]=c,e[a][i].mc={r:a,c:i,rs:s-a+1,cs:1},l.merge[a+"_"+i]={r:a,c:i,rs:s-a+1,cs:1}}else if("mergeH"==t)for(u=a;u<=s;u++){for(c={},p=!1,i=n;i<=o;i++){null==(d=e[u][i])||luckysheet.func_methods.isRealNull(d.v)&&null==d.f||p||(c=$.extend(!0,{},d),p=!0),e[u][i]={mc:{r:u,c:n}}}e[u][n]=c,e[u][n].mc={r:u,c:n,rs:1,cs:o-n+1},l.merge[u+"_"+n]={r:u,c:n,rs:1,cs:o-n+1}}}}clearjfundo&&(luckysheet.jfundo=[],luckysheet.jfredo.push({type:"mergeChange",sheetIndex:luckysheet.currentSheetIndex,data:luckysheet.flowdata,curData:e,range:$.extend(!0,[],luckysheet_select_save),config:$.extend(!0,{},config),curConfig:l})),clearjfundo=!1,luckysheet.jfrefreshgrid(e,luckysheet_select_save,l),clearjfundo=!0},borderfix:function(e,t,l){return[-1,-1,2,2]},menuButtonFocus:function(e,t,l){for(var r=["bl","it","cl","ff","ht","vt","fs","tb","tr"],a=this,s=0;s<r.length;s++){var n,o,c,u,i=r[s],h=a.checkstatus(e,t,l,i);"bl"==i?"0"!=h?$("#luckysheet-icon-bold").addClass("luckysheet-toolbar-button-hover"):$("#luckysheet-icon-bold").removeClass("luckysheet-toolbar-button-hover"):"it"==i?"0"!=h?$("#luckysheet-icon-italic").addClass("luckysheet-toolbar-button-hover"):$("#luckysheet-icon-italic").removeClass("luckysheet-toolbar-button-hover"):"cl"==i?"0"!=h?$("#luckysheet-icon-strikethrough").addClass("luckysheet-toolbar-button-hover"):$("#luckysheet-icon-strikethrough").removeClass("luckysheet-toolbar-button-hover"):"ff"==i?(c=$("#luckysheet-icon-font-family-menuButton"),n="微软雅黑",u=0,null!=h&&(u=luckysheet.isdatatypemulti(h).num?parseInt(h):a.fontjson[h],n=a.fontarray[u]),a.focus(c,u),$("#luckysheet-icon-font-family").find(".luckysheet-toolbar-menu-button-caption").html(" "+n+" ")):"fs"==i?(c=$("#luckysheet-icon-font-size-menuButton"),u=h,o=$("#luckysheet-icon-font-size input"),a.focus(c,u),$("#luckysheet-icon-font-size").attr("itemvalue",u),o.val(u)):"ht"==i?(c=$("#luckysheet-icon-align-menu-menuButton"),$("luckysheet-icon-align"),u="left","0"==h?u="center":"2"==h&&(u="right"),a.focus(c,u),$("#luckysheet-icon-align").attr("type",u).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-"+u),c.hide()):"vt"==i?(c=$("#luckysheet-icon-valign-menu-menuButton"),$("luckysheet-icon-valign"),u="bottom","1"==h?u="top":"0"==h&&(u="middle"),a.focus(c,u),$("#luckysheet-icon-valign").attr("type",u).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-"+u),c.hide()):"tb"==i?(c=$("#luckysheet-icon-textwrap-menu-menuButton"),$("luckysheet-icon-textwrap"),u="clip","1"==h?u="overflow":"2"==h&&(u="wrap"),a.focus(c,u),$("#luckysheet-icon-textwrap").attr("type",u).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-"+u),c.hide()):"tr"==i&&(c=$("#luckysheet-icon-rotation-menu-menuButton"),$("luckysheet-icon-rotation"),u="none","1"==h?u="angledown":"2"==h?u="angleup":"3"==h?u="vertical":"4"==h?u="rotation-down":"5"==h&&(u="rotation-up"),a.focus(c,u),$("#luckysheet-icon-rotation").attr("type",u).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-"+u),c.hide())}},checkstatus:function(e,t,l,r){var a=e[t][l];return r in{bl:1,it:1,ff:1,cl:1}?null!=a&&null!=(a=a[r])||(a="0"):"fc"==r?null==a?a="#000000":(null==(a=a[r])&&(a="#000000"),-1<a.indexOf("rgba")&&(a=luckysheet.rgbTohex(a))):"bg"==r?null==a?a="#ffffff":(null==(a=a[r])&&(a="#ffffff"),-1<a.toString().indexOf("rgba")&&(a=luckysheet.rgbTohex(a))):"bs"==r.substr(0,2)?null!=a&&null!=(a=a[r])||(a="none"):"bc"==r.substr(0,2)?null!=a&&null!=(a=a[r])||(a="#000000"):"ht"==r?(null!=a&&null!=(a=a[r])||(a="1"),-1==["0","1","2"].indexOf(a)&&(a="1")):"vt"==r?(null!=a&&null!=(a=a[r])||(a="2"),-1==["0","1","2"].indexOf(a)&&(a="2")):"ct"==r?null!=a&&null!=(a=a[r])||(a=null):"fs"==r?null!=a&&null!=(a=a[r])||(a="10"):"tb"==r?null!=a&&null!=(a=a[r])||(a="0"):"tr"!=r||null!=a&&null!=(a=a[r])||(a="0"),a},setLineDash:function(e,t,l,r,a,s,n){t={0:"none",1:"Thin",2:"Hair",3:"Dotted",4:"Dashed",5:"DashDot",6:"DashDotDot",7:"Double",8:"Medium",9:"MediumDashed",10:"MediumDashDot",11:"MediumDashDotDot",12:"SlantedDashDot",13:"Thick"}[t.toString()];try{"Hair"==t?e.setLineDash([1,2]):-1<t.indexOf("DashDotDot")?e.setLineDash([2,2,5,2,2]):-1<t.indexOf("DashDot")?e.setLineDash([2,5,2]):-1<t.indexOf("Dotted")?e.setLineDash([2]):-1<t.indexOf("Dashed")?e.setLineDash([3]):e.setLineDash([0])}catch(e){}e.beginPath(),-1<t.indexOf("Medium")?("h"==l?(e.moveTo(r,a-.5),e.lineTo(s,n-.5)):(e.moveTo(r-.5,a),e.lineTo(s-.5,n)),e.lineWidth=2*devicePixelRatio):"Thick"==t?(e.moveTo(r,a),e.lineTo(s,n),e.lineWidth=3*devicePixelRatio):(e.moveTo(r,a),e.lineTo(s,n),e.lineWidth=devicePixelRatio)},moveMergeData:function(e,t,l){if(luckysheet.func_methods.isRealNull(e))return e;for(var r=[],a=[],s=!1,n=0;n<e.length;n++)for(var o=0;o<e[0].length;o++){var c=e[n][o];"object"==luckysheet.getObjType(c)&&"mc"in c&&(null!=c.mc.rs&&(r.push({rs:c.mc.rs,cs:c.mc.cs,r:c.mc.r,c:c.mc.c}),a.push({rs:c.mc.rs,cs:c.mc.cs,r:c.mc.r+t,c:c.mc.c+l}),s=!0),e[n][o].mc.r+=t,e[n][o].mc.c+=l)}return{deleMC:r,insertMC:a,hasMC:s}},getRangeInMerge:function(e,t,l,r,a){var s=[],n=null;if(null!=(n=null!=a?$.extend(!0,{},luckysheet.sheetmanage.getSheetConfig()):$.extend(!0,{},config))&&null!=n.merge)for(var o in n.merge){var c=n.merge[o];e+t-1<c.r||e>c.r+c.rs-1||l+r-1<c.c||l>c.c+c.cs-1||s.push(c)}return s},mergeborer:function(e,t,l){var r=e[t][l];if("object"==luckysheet.getObjType(r)&&"mc"in r){var a=r.mc;l=a.c;for(var s,n,o,c,u,i,h,d,y=e[t=a.r][l].mc.cs,f=e[t][l].mc.rs,m=($("#luckysheet-cell-main").scrollLeft(),$("#luckysheet-cell-main").scrollTop(),e[t][l].mc),k=t;k<m.rs+t;k++)s=0==k?-1:visibledatarow[k-1]-1,n=visibledatarow[k],null==o?(o=s,c=n):c+=n-s-1;for(var p=l;p<m.cs+l;p++)h=0==p?0:visibledatacolumn[p-1],d=visibledatacolumn[p],null==i?(i=h,u=d):u+=d-h;return{row:[o,c,t,t+f-1],column:[i,u,l,l+y-1]}}return null},mergeMoveData:{},mergeMoveMain:function(e,t,l,r,a,s,n){var o=luckysheet.sheetmanage.getSheetMerge();if(null!=o){var c=[];for(var u in o)c.push(u);t[0]>t[1]&&(t[1]=t[0]),e[0]>e[1]&&(e[1]=e[0]);[].concat(e),[].concat(t);var i=!0;for(this.mergeMoveData={};i;){i=!1;for(var h=0;h<c.length;h++){var d,y=o[u=c[h]];u in this.mergeMoveData||(null!=(d=this.mergeMove(y,e,t,l,r,a,s,n))?(this.mergeMoveData[u]=y,e=d[0],t=d[1],r=d[2],a=d[3],s=d[4],n=d[5],i=!0):delete this.mergeMoveData[u])}}return[e,t,r,a,s,n]}},mergeMove:function(e,t,l,r,a,s,n,o){var c,u,i,h,d,y=e.r,f=e.r+e.rs-1,m=e.c,k=e.c+e.cs-1,p=!1;return t[1]<t[0]&&(t[0]=t[1]),l[1]<l[0]&&(l[0]=l[1]),!(t[0]<=m&&t[1]>=k&&l[0]<=y&&l[1]>=f)&&(t[1]<m||t[0]>k||l[1]<y||l[0]>f)||(c=luckysheet.menuButton.mergeborer(luckysheet.flowdata,e.r,e.c))&&(u=c.row[1],i=c.row[0],c.row[2],h=c.column[1],d=c.column[0],c.column[2],0,t[1]<m||t[0]>k||(l[0]<=f&&l[0]>=y&&(s+=a-i,a=i,l[0]=y),l[1]>=y&&l[1]<=f&&(s=(r.row_focus>=y&&r.row_focus,u-a),l[1]=f)),l[1]<y||l[0]>f||(t[0]<=k&&t[0]>=m&&(o+=n-d,n=d,t[0]=m),t[1]>=m&&t[1]<=k&&(o=(r.column_focus>=m&&r.column_focus,h-n),t[1]=k)),p=!0),p?[t,l,a,s,n,o]:null},getCellRealSize:function(e,t,l){var r,a,s,n,o,c,u,i=luckysheet.defaultcollen,h=luckysheet.defaultrowlen,d=e[t][l];return d&&null!=d.mc?(r=d.mc,(a=luckysheet.menuButton.mergeborer(e,r.r,r.c))&&(s=a.row[1],n=a.row[0],a.row[2],a.row[3],o=a.column[1],c=a.column[0],a.column[2],a.column[3],i=o-c-1,h=s-n-1)):(null!=(u=luckysheet.getluckysheetfile()[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].config).columlen&&null!=u.columlen[l]&&(i=u.columlen[l]),null!=u.rowlen&&null!=u.rowlen[t]&&(h=u.rowlen[t])),[i,h]},getTextHeightCache:{},getTextSize:function(e,t){var l=t||"10pt 微软雅黑";if(l in this.getTextHeightCache)return this.getTextHeightCache[l];0==$("#luckysheetTextSizeTest").length&&$('<span id="luckysheetTextSizeTest" style="float:left;white-space:nowrap;visibility:hidden">'+e+"</span>").appendTo($("body"));var r=$("#luckysheetTextSizeTest").text(e).css({font:l}),a=r.width(),s=r.height();return this.getTextHeightCache[l]=[a,s],[a,s]},activeFormulaInput:function(e,t,l,r,a,s){null==s&&(s=!1);var n,o,c,u,i,h,d=luckysheet.rowLocationByIndex(e),y=luckysheet.colLocationByIndex(t);luckysheet.luckysheetupdateCell(d[1],d[0],e,y[1],y[0],t,luckysheet.flowdata,!0),s?(h='<span dir="auto" class="luckysheet-formula-text-color">=</span><span dir="auto" class="luckysheet-formula-text-color">'+a.toUpperCase()+'</span><span dir="auto" class="luckysheet-formula-text-color">(</span><span dir="auto" class="luckysheet-formula-text-color">)</span>',$("#luckysheet-rich-text-editor").html(h),window.getSelection(),n=$("#luckysheet-rich-text-editor").find("span"),luckysheet.formula.setCaretPosition(n.get(n.length-2),0,1)):(o=luckysheet.rowLocationByIndex(l[0])[0],c=luckysheet.rowLocationByIndex(l[1])[1],u=luckysheet.colLocationByIndex(r[0])[0],i=luckysheet.colLocationByIndex(r[1])[1],h='<span dir="auto" class="luckysheet-formula-text-color">=</span><span dir="auto" class="luckysheet-formula-text-color">'+a.toUpperCase()+'</span><span dir="auto" class="luckysheet-formula-text-color">(</span><span class="luckysheet-formula-functionrange-cell" rangeindex="0" dir="auto" style="color:'+luckysheet.jfcolor[0]+';">'+luckysheet.sheetmanage.getRangetxt(luckysheet.currentSheetIndex,{row:l,column:r},luckysheet.currentSheetIndex)+'</span><span dir="auto" class="luckysheet-formula-text-color">)</span>',$("#luckysheet-rich-text-editor").html(h),luckysheet.formula.israngeseleciton(),luckysheet.formula.rangestart=!0,luckysheet.formula.rangedrag_column_start=!1,luckysheet.formula.rangedrag_row_start=!1,luckysheet.formula.rangechangeindex=0,luckysheet.formula.rangeSetValue({row:l,column:r}),luckysheet.formula.func_selectedrange={left:u,width:i-u-1,top:o,height:c-o-1,left_move:u,width_move:i-u-1,top_move:o,height_move:c-o-1,row:[e,e],column:[t,t]},$("#luckysheet-formula-functionrange-select").css({left:u,width:i-u-1,top:o,height:c-o-1}).show(),$("#luckysheet-formula-help-c").hide())},backFormulaInput:function(e,t,l,r,a,s){var n="="+s.toUpperCase()+"("+luckysheet.sheetmanage.getRangetxt(luckysheet.currentSheetIndex,{row:r,column:a},luckysheet.currentSheetIndex)+")",o=luckysheet.formula.execfunction(n,t,l),c={v:o[1],f:o[2]};luckysheet.setcellvalue(t,l,e,c),luckysheet.formula.execFunctionExist.push({r:t,c:l,i:luckysheet.currentSheetIndex}),luckysheet.server.historyParam(e,luckysheet.currentSheetIndex,{row:[t,t],column:[l,l]})},checkNoNullValue:function(e){var t=e;return"object"==luckysheet.getObjType(t)&&(t=t.v),!(luckysheet.func_methods.isRealNull(t)||!luckysheet.isdatatypemulti(t).num||null!=e.ct&&null!=e.ct.t&&"n"!=e.ct.t&&"g"!=e.ct.t)},checkNoNullValueAll:function(e){var t=e;return"object"==luckysheet.getObjType(t)&&(t=t.v),!luckysheet.func_methods.isRealNull(t)},getNoNullValue:function(e,t,l,r){for(var a=null,s=0,n=0,o=l-1;0<=o;o--){var c="c"==r?e[t][o]:e[o][t];if(this.checkNoNullValue(c))a=o;else{if(null!=c&&null!=c.v&&""!=c.v)break;if(40<=++s){if(!(n<=0))break;n=1}}}return a},singleFormulaInput:function(e,t,l,r,a,s,n,o,c){null==n&&(n="r"),null==o&&(o=!0),null==c&&(c=!0);for(var u=this,i=!0,h=!1,d=r;d<=a;d++){var y=null;y="c"==n?e[d][l]:e[l][d],u.checkNoNullValue(y)?h=!(i=!1):u.checkNoNullValueAll(y)&&(i=!1)}if(i&&c){var f=u.getNoNullValue(e,t,l,n);if(null==f)"c"==n?u.activeFormulaInput(t,l,null,null,s,!0):u.activeFormulaInput(l,t,null,null,s,!0);else if(t==r)for(d=r;d<=a;d++){if(null==(f=u.getNoNullValue(e,d,l,n)))break;"c"==n?u.backFormulaInput(e,d,l,[d,d],[f,l-1],s):u.backFormulaInput(e,l,d,[f,l-1],[d,d],s)}else for(d=a;r<=d;d--){if(null==(f=u.getNoNullValue(e,d,l,n)))break;"c"==n?u.backFormulaInput(e,d,l,[d,d],[f,l-1],s):u.backFormulaInput(e,l,d,[f,l-1],[d,d],s)}}else{if(!h||!o)return!0;y=null;if(null!=(y="c"==n?e[a][l]:e[l][a])&&null!=y.v&&0<y.v.toString().length){d=a;for(y="c"==n?e[a][l]:e[l][a];null!=y&&null!=y.v&&0<y.v.toString().length;){d++;if(("c"==n?e.length:e[0].length)<=d)return;y="c"==n?e[d][l]:e[l][d]}"c"==n?u.backFormulaInput(e,d,l,[r,a],[l,l],s):u.backFormulaInput(e,l,d,[l,l],[r,a],s)}else"c"==n?u.backFormulaInput(e,a,l,[r,a],[l,l],s):u.backFormulaInput(e,l,a,[l,l],[r,a],s)}},autoSelectionFormula:function(t){var l=this,r=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),e=!0;luckysheet.formula.execFunctionExist=[];function a(){var e=l.getNoNullValue(r,o,i,"c");null==e?l.activeFormulaInput(o,u,null,null,t,!0):l.activeFormulaInput(o,u,[o,c],[e,i-1],t)}function s(){var e=l.getNoNullValue(r,u,c,"r");null==e?a():l.activeFormulaInput(o,u,[e,c-1],[u,i],t)}for(var n=0;n<luckysheet_select_save.length;n++){var o=luckysheet_select_save[n].row[0],c=luckysheet_select_save[n].row[1],u=luckysheet_select_save[n].column[0],i=luckysheet_select_save[n].column[1],h=luckysheet_select_save[n].row_focus,d=luckysheet_select_save[n].column_focus;if(o==c&&u==i){if(c-1<0&&i-1<0)return void l.activeFormulaInput(o,u,null,null,t,!0);(!(0<=c-1&&l.checkNoNullValue(r[c-1][u]))&&0<=i-1&&l.checkNoNullValue(r[o][i-1])?a:s)()}else if(o==c)e=l.singleFormulaInput(r,d,o,u,i,t,"r");else if(u==i)e=l.singleFormulaInput(r,h,u,o,c,t,"c");else{for(var y=!0,f=o;f<=c;f++)y=l.singleFormulaInput(r,d,f,u,i,t,"r",!0,!1)&&y;for(var m=!0,k=u;k<=i;k++)m=l.singleFormulaInput(r,h,k,o,c,t,"c",!0,!1)&&m;e=!!y&&!!m}e=e&&e}e||(luckysheet.formula.execFunctionExist.reverse(),luckysheet.formula.execFunctionGroup(null,null,null,null,r),luckysheet.jfrefreshgrid(r,[{row:[o,c],column:[u,i]}]),clearTimeout(jfcountfuncTimeout),jfcountfuncTimeout=setTimeout(function(){luckysheet.jfcountfunc()},500))},getStyleByCell:function(e,t,l){var r="",a=luckysheet.alternateformat.getComputeMap(),s=luckysheet.alternateformat.checksAF(t,l,a),n=luckysheet.conditionformat.getComputeMap(),o=luckysheet.conditionformat.checksCF(t,l,n),c=e[t][l];for(var u in c){var i,h=luckysheet.menuButton.checkstatus(e,t,l,u);(null!=s||null!=o&&null!=o.cellColor)&&(null!=o&&null!=o.cellColor?r+="background: "+o.cellColor+";":null!=s&&(r+="background: "+s[1]+";")),"object"!=luckysheet.getObjType(h)&&(("bg"==u||null!=s||null!=o&&null!=o.cellColor)&&(null!=o&&null!=o.cellColor?r+="background: "+o.cellColor+";":r+=null!=s?"background: "+s[1]+";":"background: "+h+";"),"bl"==u&&"0"!=h&&(r+="font-weight: bold;"),"it"==u&&"0"!=h&&(r+="font-style:italic;"),"ff"==u&&"0"!=h&&(i=h,isNaN(parseInt(h))||(i=luckysheet.menuButton.fontarray[parseInt(h)]),r+="font-family: "+i+";"),"fs"==u&&"10"!=h&&(r+="font-size: "+h+"pt;"),("fc"==u&&"#000000"!=h||null!=s||null!=o&&null!=o.textColor)&&(null!=o&&null!=o.textColor?r+="color: "+o.textColor+";":r+=null!=s?"color: "+s[0]+";":"color: "+h+";"),"ht"==u&&"1"!=h&&("0"==h?r+="text-align: center;":"2"==h&&(r+="text-align: right;")),"vt"==u&&"0"!=h&&("1"==h?r+="vertical-align: top;":"2"==h&&(r+="vertical-align: bottom;")))}return r}},luckysheet.server={gridKey:null,loadUrl:null,updateUrl:null,updateImageUrl:null,title:null,historyParam:function(e,t,l){var r=l.row[0],a=l.row[1],s=l.column[0],n=l.column[1];if(r==a&&s==n){var o=e[r][s];this.saveParam("v",t,o,{r:r,c:s})}else for(var c=a-r+1,u=n-s+1,i=Math.floor(1e3/u),h=Math.ceil(c/i),d=0;d<h;d++){var y,f=r+i*d;y=d==h-1?a:r+i*(d+1)-1;for(var o=[],m=f;m<=y;m++){for(var k=[],p=s;p<=n;p++)k.push(e[m][p]);o.push(k)}this.saveParam("rv",t,o,{range:{row:[f,y],column:[s,n]}}),d==h-1&&this.saveParam("rv_end",t,null)}},saveParam:function(e,t,l,r){var a,s;luckysheet.server.allowUpdate&&(null==l&&(l=null),(a={}).t=e,a.i=t,a.v=l,"rv"==e?a.range=r.range:"v"==e||"fu"==e||"fm"==e?(a.r=r.r,a.c=r.c):"fc"==e?(a.op=r.op,a.pos=r.pos):"drc"==e||"arc"==e||"h"==e||"wh"==e?a.rc=r.rc:"c"==e?(a.cid=r.cid,a.op=r.op):"f"==e?(a.op=r.op,a.pos=r.pos):"s"==e||("sh"==e?(a.op=r.op,null!=r.cur&&(a.cur=r.cur)):"cg"!=e&&"all"!=e||(a.k=r.k)),s=pako.gzip(encodeURIComponent(JSON.stringify(a)),{to:"string"}),luckysheet.server.websocket.send(s))},websocket:null,wxErrorCount:0,openWebSocket:function(){"WebSocket"in window?(luckysheet.server.websocket=new WebSocket(luckysheet.server.updateUrl+"?t=111&g="+encodeURIComponent(luckysheet.server.gridKey)),luckysheet.server.websocket.onopen=function(){luckysheet.jfhideloading(),luckysheet.server.wxErrorCount=0,setInterval(function(){luckysheet.server.websocket.send("rub")},6e4)},luckysheet.server.websocket.onmessage=function(result){var data=eval("("+result.data+")"),type=data.type;if(1!=type)if(2==type){var item=JSON.parse(data.data);luckysheet.server.wsUpdateMsg(item)}else if(3==type){var id=data.id,username=data.username,item=JSON.parse(data.data),type=item.t,index=item.i,value=item.v,r,c;"array"!=luckysheet.getObjType(value)&&(value=JSON.parse(value)),index==luckysheet.currentSheetIndex&&(r=value[value.length-1].row[0],c=value[value.length-1].column[0],luckysheet.server.multipleRangeShow(id,username,r,c))}else if(4==type)for(var items=JSON.parse(data.data),i=0;i<items.length;i++)luckysheet.server.wsUpdateMsg(item[i])},luckysheet.server.websocket.onerror=function(){luckysheet.server.wxErrorCount++,3<luckysheet.server.wxErrorCount?luckysheet.jfshowloading("WebSocket连接发生错误, 请刷新页面！"):(luckysheet.jfshowloading("WebSocket连接发生错误, 请耐心等待！"),luckysheet.server.openWebSocket())},luckysheet.server.websocket.onclose=function(){alert("服务器通信发生错误，请刷新页面后再试，如若不行请联系管理员！")}):alert("当前浏览器 Not Support WebSocket")},wsUpdateMsg:function(item){var type=item.t,index=item.i,value=item.v,file=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(index)];if(null!=file)if("v"==type){if(null==file.data||0==file.data.length)return;var r=item.r,c=item.c;file.data[r][c]=value,index==luckysheet.currentSheetIndex&&(luckysheet.flowdata=file.data,null!=value&&null!=value.ps?luckysheet.postil.buildPs(r,c,value.ps):luckysheet.postil.buildPs(r,c,null),setTimeout(function(){luckysheet.luckysheetrefreshgrid()},1))}else if("rv"==type){if(null==file.data||0==file.data.length)return;for(var r1=item.range.row[0],r2=item.range.row[1],c1=item.range.column[0],c2=item.range.column[1],r=r1;r<=r2;r++)for(var c=c1;c<=c2;c++)file.data[r][c]=value[r-r1][c-c1];if(index==luckysheet.currentSheetIndex){luckysheet.flowdata=file.data;for(var r=r1;r<=r2;r++)for(var c=c1;c<=c2;c++)null!=value[r-r1][c-c1]&&null!=value[r-r1][c-c1].ps?luckysheet.postil.buildPs(r,c,value[r-r1][c-c1].ps):luckysheet.postil.buildPs(r,c,null);setTimeout(function(){luckysheet.luckysheetrefreshgrid()},1)}}else if("cg"==type){var k=item.k;if("borderInfo"==k)file.config.borderInfo=value;else for(var key in k in file.config||(file.config[k]={}),value)file.config[k][key]=value[key];index==luckysheet.currentSheetIndex&&(config=file.config,"rowlen"!=k&&"columlen"!=k&&"rowhidden"!=k||luckysheet.jfrefreshgrid_rhcw(luckysheet.flowdata.length,luckysheet.flowdata[0].length),setTimeout(function(){luckysheet.luckysheetrefreshgrid()},1))}else if("all"==type){var k=item.k,luckysheetcurrentSheetitem;file[k]=value,"name"==k?$("#luckysheet-sheet-container-c #luckysheet-sheets-item"+index).find("span.luckysheet-sheets-item-name").html(value):"color"==k?(luckysheetcurrentSheetitem=$("#luckysheet-sheet-container-c #luckysheet-sheets-item"+index),luckysheetcurrentSheetitem.find(".luckysheet-sheets-item-color").remove(),null==value&&""==value||luckysheetcurrentSheetitem.append('<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+value+';"></div>')):"pivotTable"==k||("freezen"==k?index==luckysheet.currentSheetIndex&&(null==file.freezen.horizontal?($("#luckysheet-freezen-btn-horizontal").html('<i class="fa fa-list-alt"></i> 冻结首行'),luckysheet.freezen.freezenhorizontaldata=null,$("#luckysheet-freezebar-horizontal").hide()):luckysheet.freezen.createFreezenHorizontal(file.freezen.horizontal.freezenhorizontaldata,file.freezen.horizontal.top),null==file.freezen.vertical?($("#luckysheet-freezen-btn-vertical").html('<i class="fa fa-indent"></i> 冻结首列'),luckysheet.freezen.freezenverticaldata=null,$("#luckysheet-freezebar-vertical").hide()):luckysheet.freezen.createFreezenVertical(file.freezen.vertical.freezenverticaldata,file.freezen.vertical.left),luckysheet.freezen.createAssistCanvas()):"filter_select"==k?index==luckysheet.currentSheetIndex&&luckysheet.createFilterOptions(value):"filter"==k?index==luckysheet.currentSheetIndex&&luckysheet.createFilterOptions(file.filter_select,value):"luckysheet_conditionformat_save"==k||"luckysheet_alternateformat_save"==k?index==luckysheet.currentSheetIndex&&setTimeout(function(){luckysheet.luckysheetrefreshgrid()},1):"config"==k?index==luckysheet.currentSheetIndex&&(config=value,luckysheet.jfrefreshgrid_rhcw(luckysheet.flowdata.length,luckysheet.flowdata[0].length)):"dynamicArray"==k&&index==luckysheet.currentSheetIndex&&setTimeout(function(){luckysheet.luckysheetrefreshgrid()},1))}else if("fc"==type){var op=item.op,pos=item.pos;"object"!=luckysheet.getObjType(value)&&(value=eval("("+value+")"));var r=value.r,c=value.c,func=value.func,calcChain=null==file.calcChain?[]:file.calcChain;if("add"==op)calcChain.push(value);else if("del"==op)for(var a=0;a<calcChain.length;a++)r==calcChain[a].r&&c==calcChain[a].c&&index==calcChain[a].index&&calcChain.splice(a,1);else if("update"==op)for(var a=0;a<calcChain.length;a++)r==calcChain[a].r&&c==calcChain[a].c&&index==calcChain[a].index&&(calcChain[a].func=func);setTimeout(function(){luckysheet.luckysheetrefreshgrid()},1)}else if("drc"==type){if(null==file.data||0==file.data.length)return;var rc=item.rc,st_i=value.index,len=value.len,mc=value.mc,borderInfo=value.borderInfo,data=file.data;if("r"==rc){file.row-=len,data.splice(st_i,len);for(var row=[],c=0;c<data[0].length;c++)row.push(null);for(var r=0;r<len;r++)data.push(row)}else{file.column-=len;for(var addcol=[],r=0;r<len;r++)addcol.push(null);for(var i=0;i<data.length;i++)data[i].splice(st_i,len),data[i]=data[i].concat(addcol)}for(x in mc){var r=mc[x].r,c=mc[x].c;data[r][c].mc=mc[x]}file.config.merge=mc,file.config.borderInfo=borderInfo,index==luckysheet.currentSheetIndex&&(luckysheet.flowdata=data,config.merge=mc,config.borderInfo=borderInfo,setTimeout(function(){luckysheet.luckysheetrefreshgrid()},1))}else if("arc"==type){if(null==file.data||0==file.data.length)return;var rc=item.rc,st_i=value.index,len=value.len,addData=value.data,mc=value.mc,borderInfo=value.borderInfo,data=file.data;if("r"==rc){file.row+=len;for(var arr=[],i=0;i<len;i++)arr.push(JSON.stringify(addData[i]));eval("data.splice("+st_i+", 0, "+arr.join(",")+")")}else{file.column+=len;for(var i=0;i<data.length;i++)data[i].splice(st_i,0,addData[i])}for(x in mc){var r=mc[x].r,c=mc[x].c;data[r][c].mc=mc[x]}file.config.merge=mc,file.config.borderInfo=borderInfo,index==luckysheet.currentSheetIndex&&(luckysheet.flowdata=data,config.merge=mc,config.borderInfo=borderInfo,setTimeout(function(){luckysheet.luckysheetrefreshgrid()},1))}else if("f"==type){var op=item.op,pos=item.pos,filter=file.filter;null==filter&&(filter={}),"upOrAdd"==op?filter[pos]=value:"del"==op&&delete filter[pos],index==luckysheet.currentSheetIndex&&luckysheet.createFilterOptions(file.filter_select,filter)}else if("fsc"==type)file.filter=null,file.filter_select=null,index==luckysheet.currentSheetIndex&&($("#luckysheet-filter-selected-sheet"+luckysheet.currentSheetIndex+", #luckysheet-filter-options-sheet"+luckysheet.currentSheetIndex).remove(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide());else if("fsr"==type)file.filter=value.filter,file.filter_select=value.filter_select,index==luckysheet.currentSheetIndex&&luckysheet.createFilterOptions(file.filter_select,file.filter);else if("sha"==type){luckysheetfile.push(value);var colorset="";null!=value.color&&(colorset='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+value.color+';"></div>'),$("#luckysheet-sheet-container-c").append(luckysheet.replaceHtml(sheetHTML,{index:value.index,active:"",name:value.name,style:"",colorset:colorset})),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+value.index+'" class="luckysheet-datavisual-selection-set"></div>')}else if("shc"==type){var copyindex=value.copyindex,name=value.name,copyarrindex=luckysheet.sheetmanage.getSheetIndex(copyindex),copyjson=$.extend(!0,{},luckysheetfile[copyarrindex]);copyjson.index=index,copyjson.name=name,luckysheetfile.splice(copyarrindex+1,0,copyjson);var copyobject=$("#luckysheet-sheets-item"+copyindex);$("#luckysheet-sheet-container-c").append(luckysheet.replaceHtml(sheetHTML,{index:copyjson.index,active:"",name:copyjson.name,style:"",colorset:""})),$("#luckysheet-sheets-item"+copyjson.index).insertAfter(copyobject),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+copyjson.index+'" class="luckysheet-datavisual-selection-set"></div>')}else if("shd"==type){for(var i=0;i<luckysheetfile.length;i++)if(luckysheetfile[i].index==value.deleIndex){luckysheet.server.sheetDeleSave.push(luckysheetfile[i]),luckysheetfile.splice(i,1);break}$("#luckysheet-sheets-item"+value.deleIndex).remove(),$("#luckysheet-datavisual-selection-set-"+value.deleIndex).remove()}else if("shr"==type)for(x in value)luckysheetfile[luckysheet.sheetmanage.getSheetIndex(x)].order=value[x];else if("shre"==type){for(var i=0;i<luckysheet.server.sheetDeleSave.length;i++)if(luckysheet.server.sheetDeleSave[i].index==value.reIndex){var datav=luckysheet.server.sheetDeleSave[i];luckysheetfile.push(datav);var colorset="";null!=value.color&&(colorset='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+datav.color+';"></div>'),$("#luckysheet-sheet-container-c").append(luckysheet.replaceHtml(sheetHTML,{index:datav.index,active:"",name:datav.name,style:"",colorset:colorset})),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+datav.index+'" class="luckysheet-datavisual-selection-set"></div>');break}}else if("sh"==type){var op=item.op,cur=item.cur;"hide"==op?(file.hide=1,$("#luckysheet-sheets-item"+index).hide(),index==luckysheet.currentSheetIndex&&($("#luckysheet-sheets-item"+cur).addClass("luckysheet-sheets-item-active"),luckysheet.sheetmanage.changeSheetExec(cur))):"show"==op&&(file.hide=0,$("#luckysheet-sheets-item"+index).show())}else if("c"==type){var op=item.op,cid=item.cid;if("add"==op)file.chart.push(value),luckysheet.insertChartTosheet(value.sheetIndex,value.dataSheetIndex,value.option,value.chartType,value.selfOption,value.defaultOption,value.row,value.column,value.chart_selection_color,value.chart_id,value.chart_selection_id,value.chartStyle,value.rangeConfigCheck,value.rangeRowCheck,value.rangeColCheck,value.chartMarkConfig,value.chartTitleConfig,value.winWidth,value.winHeight,value.scrollLeft1,value.scrollTop1,value.chartTheme,value.myWidth,value.myHeight,value.myLeft,value.myTop,value.myindexrank1,!0);else if("xy"==op||"wh"==op||"update"==op)for(var i=0;i<file.chart.length;i++){var chartjson=file.chart[i];if(chartjson.chart_id==cid){for(var item in chartjson)for(var vitem in value)item==vitem&&(chartjson[item]=value[vitem]);return void luckysheet.sheetmanage.saveChart(chartjson)}}else if("del"==op)for(var i=0;i<file.chart.length;i++){var chartjson=file.chart[i];if(chartjson.chart_id==cid)return file.chart.splice(i,1),$("#"+cid).remove(),void luckysheet.sheetmanage.delChart($("#"+cid).attr("chart_id"),$("#"+cid).attr("sheetIndex"))}}else"na"==type&&$("#luckysheet_info_detail_input").val(value).css("width",10*luckysheet.getByteLen(value))},multipleIndex:0,multipleRangeShow:function(e,t,l,r){var a,s=r2=l,n=c2=r,o=visibledatarow[r2],c=s-1==-1?0:visibledatarow[s-1],u=visibledatacolumn[c2],i=n-1==-1?0:visibledatacolumn[n-1],h=luckysheet.menuButton.mergeborer(luckysheet.flowdata,s,n);h&&(o=h.row[1],c=h.row[0],u=h.column[1],i=h.column[0]),0<$("#luckysheet-multipleRange-show-"+e).length?$("#luckysheet-multipleRange-show-"+e).css({position:"absolute",left:i-1,width:u-i-1,top:c-1,height:o-c-1}):(a='<div id="luckysheet-multipleRange-show-'+e+'" data-color="'+luckysheet.jfcolor[luckysheet.server.multipleIndex]+'" title="'+t+'" style="position: absolute;left: '+(i-1)+"px;width: "+(u-i-1)+"px;top: "+(c-1)+"px;height: "+(o-c-1)+"px;border: 1px solid "+luckysheet.jfcolor[luckysheet.server.multipleIndex]+';z-index: 15;"><div style="width: 100%;height: 100%;position: absolute;top: 0;right: 0;bottom: 0;left: 0;opacity: 0.03;background-color: '+luckysheet.jfcolor[luckysheet.server.multipleIndex]+'"></div></div>',$(a).appendTo($("#luckysheet-cell-main #luckysheet-multipleRange-show")),luckysheet.server.multipleIndex++)},sheetDeleSave:[],submitInterval:1e3,imagesubmitInterval:5e3,submitdatalimit:50,submitcompresslimit:1e3,checksubmit:function(e){var t=this;t.submitTimeout(),clearTimeout(t.imageRequestTimeout),t.imageRequestTimeout=setTimeout(function(){t.imageRequest()},t.imagesubmitInterval)},submitTimeout:function(){var e=this;clearTimeout(e.requestTimeOut),!e.requestLock&&null!=e.requestlast&&e.requestlast.clone().add(1,"seconds").isBefore(moment())&&e.request(),e.requestTimeOut=setTimeout(function(){e.submitTimeout()},e.submitInterval)},requestLock:!1,requestlast:null,firstchange:!0,requestTimeOut:null,request:function(){var _this=this,key=this.gridKey,cahce_key=key+"__qkcache";_this.cachelocaldata(function(cahce_key,params){var compressBeginLen,iscommpress;0!=params.length&&(params=encodeURIComponent(JSON.stringify(params)),compressBeginLen=params.length,iscommpress=!1,_this.requestLock=!0,""!=_this.updateUrl&&$.post(_this.updateUrl,{compress:iscommpress,gridKey:_this.gridKey,data:params},function(data){var re=eval("("+data+")");re.status?($("#luckysheet_info_detail_update").html("最近存档时间:"+moment().format("M-D H:m:s")),$("#luckysheet_info_detail_save").html("同步成功"),_this.clearcachelocaldata()):($("#luckysheet_info_detail_save").html("<span style='color:#ff2121'>同步失败</span>"),_this.restorecachelocaldata()),_this.requestlast=moment(),_this.requestLock=!1}))})},imageRequestLast:null,imageRequestLock:!1,imageRequestTimeout:null,imageRequest:function(){var _this=this;html2canvas($("#"+container).find(".luckysheet-grid-window").get(0),{onrendered:function(canvas){var old=$(canvas).appendTo("body");old.hide();var newwidth=old.width(),newheight=old.height(),imageData=old.get(0).getContext("2d").getImageData(0,0,newwidth,newheight),cutW=newwidth,cutH=newheight;cutH<.54*cutW?cutW=cutH/.54:cutH=.54*cutW;var newCanvas=$("<canvas>").attr("width",cutW).attr("height",cutH)[0];newCanvas.getContext("2d").putImageData(imageData,0,0),old.attr("width",350),old.attr("height",189),old.get(0).getContext("2d").drawImage(newCanvas,0,0,350,189);var base64=old.get(0).toDataURL("image/jpeg",.9),curindex=luckysheet.sheetmanage.getCurSheetnoset();_this.imageRequestLock=!0;var data1=encodeURIComponent(JSON.stringify({t:"thumb",img:base64,curindex:curindex}));old.remove(),""!=_this.updateImageUrl&&$.post(_this.updateImageUrl,{compress:!1,gridKey:_this.gridKey,data:data1},function(data){var re=eval("("+data+")");re.status?imageRequestLast=moment():$("#luckysheet_info_detail_save").html("<span style='color:#ff2121'>网络不稳定</span>"),_this.imageRequestLock=!0})}})},localdata:[],matchOpt:function(e,t){for(var l in e){if("t"==l&&e.t in{drc:1,arc:1,sha:1,shc:1,shd:1})return!1;if("v"!=l){if(!(l in t))return!1;if(t[l]!=e[l])return!1}}return!0},deleteRepeatOpt:function(e,t){var l=e;if(t instanceof Array)for(var r=0;r<t.length;r++)for(var a=t[r],s=0;s<l.length;s++){var n=e[r];this.matchOpt(a,n)&&delete l[s]}else for(s=0;s<l.length;s++){n=l[s];this.matchOpt(t,n)&&delete l[s]}for(var o=[],r=0;r<l.length;r++)null!=l[r]&&o.push(l[r]);return o},setlocaldata:function(t,l){this.gridKey;var r=this;r.getlocaldata(function(e){null==e&&(e=[]),t instanceof Array?e=e.concat(t):e.push(t),r.localdata=e,l(r.localdata)})},getlocaldata:function(e){this.gridKey;e(this.localdata)},clearlocaldata:function(e){this.gridKey;this.localdata=[],e()},cachelocaldata:function(e){var t=this.gridKey+"__qkcache",l=this.localdata,r=l.length;if(1<r){var a=[];a[0]=l[0];for(var s=1;s<r;s++){for(var n=l[s],o=!0,c=0;c<a.length;c++){var u=a[c];if(this.matchOpt(n,u)){a.splice(c,1,n),o=!1;break}}o&&(a=a.concat(n))}l=a}null!=l&&0!=l.length&&this.clearlocaldata(function(){localforage.setItem(t,l).then(function(){e(t,l)})})},clearcachelocaldata:function(l){var e=this.gridKey+"__qkcache";localforage.removeItem(e,function(e,t){l&&"function"==typeof l&&l()})},restorecachelocaldata:function(r){var e=this.gridKey+"__qkcache",a=this;localforage.getItem(e).then(function(e){var l=e;a.getlocaldata(function(e){null==e&&(e=[]);var t=l.concat(e);a.localdata=t,r instanceof Function&&r(a.localdata)})})}},luckysheet.method={addDataAjax:function(e,t,l,r){null==t&&(t=luckysheet.currentSheetIndex),null==l&&(l=luckysheet.server.loadSheetUrl),$("#luckysheet-grid-window-1").append(luckysheetlodingHTML),e.currentPage++;luckysheetfile[luckysheet.sheetmanage.getSheetIndex(t)];var a=sessionStorage.getItem("x-auth-token");$.ajax({method:"POST",url:l,headers:{"x-auth-token":a},data:JSON.stringify(e),contentType:"application/json;charset=UTF-8",success:function(e){"string"==typeof e&&(e=JSON.parse(e));var t=e.data,l=t.celldata;luckysheet.luckysheetextendData(t.row,l),setTimeout(function(){$("#luckysheetloadingdata").fadeOut().remove()},500),r&&"function"==typeof r&&r(t)}})},reload:function(param,index,url,func){var _this=this;null==index&&(index=luckysheet.currentSheetIndex),null==url&&(url=luckysheet.server.loadSheetUrl),$("#luckysheet-grid-window-1").append(luckysheetlodingHTML);var arg={gridKey:luckysheet.server.gridKey,index:index};param=$.extend(!0,param,arg);var file=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(index)];$.post(url,param,function(d){var dataset=eval("("+d+")");file.celldata=dataset[index.toString()];var data=luckysheet.sheetmanage.buildGridData(file);setTimeout(function(){$("#luckysheetloadingdata").fadeOut().remove()},500),file.data=data,luckysheet.flowdata=data,luckysheet.editor.webWorkerFlowDataCache(data),luckysheet.luckysheetcreatesheet(data[0].length,data.length,data,null,!1),file.load="1",luckysheet_select_save=[],luckysheet_selection_range=[],luckysheet.server.saveParam("shs",null,luckysheet.currentSheetIndex),luckysheet.sheetmanage.changeSheet(index),func&&"function"==typeof func&&func()})},clearSheetByIndex:function(e){var t=luckysheet.sheetmanage.getSheetIndex(e),l=luckysheetfile[t];l.isPivotTable?delete l:(l.data=[],l.row=defaultrowNum,l.column=defaultcolumnNum,l.chart=[],l.config=null,l.filter=null,l.filter_select=null,l.celldata=[],l.pivotTable={},l.calcChain=[],l.status=0,l.load=0,luckysheet.flowdata=[],luckysheet.editor.webWorkerFlowDataCache(luckysheet.flowdata),$("#"+container+" .luckysheet-data-visualization-chart").remove(),$("#"+container+" .luckysheet-datavisual-selection-set").remove(),$("#luckysheet-row-count-show, #luckysheet-formula-functionrange-select, #luckysheet-row-count-show, #luckysheet-column-count-show, #luckysheet-change-size-line, #luckysheet-cell-selected-focus, #luckysheet-selection-copy, #luckysheet-cell-selected-extend, #luckysheet-cell-selected-move, #luckysheet-cell-selected").hide(),delete l.load)},clear:function(e){if("all"==e)for(var t=0;t<luckysheetfile.length;t++){var l=luckysheetfile[t];this.clearSheetByIndex(l.index)}else null==e&&(e=luckysheet.currentSheetIndex),this.clearSheetByIndex(e);luckysheet.sheetmanage.changeSheet(luckysheetfile[0].index)},destroy:function(){$("#"+container).empty(),$("body > .luckysheet-cols-menu").remove(),$("#luckysheet-modal-dialog-mask, #luckysheetTextSizeTest, #luckysheet-icon-morebtn-div").remove(),$("#luckysheet-input-box").parent().remove(),$("#luckysheet-formula-help-c").remove(),luckysheet.jfredo=[],luckysheet.jfundo=[],luckysheet.freezen.initialHorizontal=!0,luckysheet.freezen.initialVertical=!0,luckysheetConfigsetting.pointEdit=!1},editorChart:function(e){luckysheetfile[0];var t=luckysheet.jfcolor[0],l="luckysheetEditMode-datav-chart";e.chart_id=l;var r=null==(r=e.chartTheme)?"default0000":r;luckysheet.insertChartTosheet(e.sheetIndex,e.dataSheetIndex,e.option,e.chartType,e.selfOption,e.defaultOption,e.row,e.column,t,l,"luckysheetEditMode-datav-chart_selection",e.chartStyle,e.rangeConfigCheck,e.rangeRowCheck,e.rangeColCheck,e.chartMarkConfig,e.chartTitleConfig,e.winWidth,e.winHeight,e.scrollLeft,e.scrollTop,r,e.myWidth,e.myHeight,null!=e.myLeft?parseFloat(e.myLeft):null,null!=e.myTop?parseFloat(e.myTop):null,e.myindexrank,!0),$("#"+l).find(".luckysheet-modal-controll-update").click()}},luckysheet.jfrefreshchartall=function(e,t,l,r,a){window.generator&&generator.changeChartCellDataHook(e,t,l,r,a)},luckysheet.jfrefreshchart=function($obj,flowdata1,r_st,r_ed,c_st,c_ed){var row=eval("("+$obj.attr("row")+")"),column=eval("("+$obj.attr("column")+")"),type,style,selfOption,defaultOption,chartMarkConfig,chartTitleConfig,chartTheme;r_st>row[1]||r_ed<row[0]||c_st>column[1]||c_ed<column[0]||(type=$obj.attr("chartType"),style=$obj.attr("chartStyle"),selfOption=$obj.attr("selfOption"),defaultOption=$obj.attr("defaultOption"),chartMarkConfig=$obj.attr("chartMarkConfig"),chartTitleConfig=$obj.attr("chartTitleConfig"),chartTheme=$obj.attr("chartTheme"),luckysheet.chartparam.jgridCurrentChartSelection={row:row,column:column},luckysheet.chartparam.jgridCurrentChartData=luckysheet.getdatabyselectionD(flowdata1,luckysheet.chartparam.jgridCurrentChartSelection),rangeConfigCheck=!(luckysheet.chartparam.jgridCurrentChartData.length>=luckysheet.chartparam.jgridCurrentChartData[0].length),rangeRowCheck=1!=luckysheet.chartparam.jgridCurrentChartData.length,rangeColCheck=1!=luckysheet.chartparam.jgridCurrentChartData[0].length,luckysheet.range_config(rangeConfigCheck,rangeRowCheck,rangeColCheck),luckysheet.chartparam.luckysheetcurrentChart=echarts.getInstanceById($obj.find(".luckysheet-modal-dialog-content").attr("_echarts_instance_")),"object"!=luckysheet.getObjType(chartMarkConfig)&&(chartMarkConfig=eval("("+chartMarkConfig+")")),"object"!=luckysheet.getObjType(chartTitleConfig)&&(chartTitleConfig=eval("("+chartTitleConfig+")")),"object"!=luckysheet.getObjType(selfOption)&&(selfOption=eval("("+selfOption+")")),luckysheet.chartparam.luckysheet_chart_mark_config=chartMarkConfig,luckysheet.chartparam.luckysheet_chart_title_config=chartTitleConfig,luckysheet.chartparam.luckysheet_chart_self_config=null==selfOption?{}:selfOption,luckysheet.luckysheet_datavisual_item_active("datachange",type,style),"function"==typeof luckysheet.luckysheetConfigsetting.chartConfigChange&&luckysheet.luckysheetConfigsetting.chartConfigChange({sheetIndex:$obj.attr("sheetIndex"),dataSheetIndex:$obj.attr("dataSheetIndex"),option:luckysheet.chartparam.luckysheetcurrentChart.getOption(),chartType:type,selfOption:selfOption,defaultOption:defaultOption,row:row,column:column,chart_id:$obj.attr("chart_id"),chart_selection_color:$obj.attr("chart_selection_color"),chart_selection_id:$obj.attr("chart_selection_id"),chartStyle:style,rangeConfigCheck:rangeConfigCheck,rangeRowCheck:rangeRowCheck,rangeColCheck:rangeColCheck,chartMarkConfig:chartMarkConfig,chartTitleConfig:chartTitleConfig,chartTheme:chartTheme}))},luckysheet.getcellvalue=function(e,t,l,r){try{if(null==r&&(r="v"),null==l&&(l=luckysheet.flowdata),null!=e&&null!=t)a=l[e][t];else if(null!=e)a=l[e];else{if(null==t)return l;var a=l[0].map(function(e,t){return l.map(function(e){return e[t]})})[t]}var s=a;return"object"==luckysheet.getObjType(a)&&(s=a[r],"f"==r&&null!=s?s=luckysheet.formula.functionHTMLGenerate(s):"f"==r?s=a.v:a&&a.ct&&"yyyy-MM-dd"==a.ct.fa&&(s=a.m)),null==s&&(s=null),s}catch(e){}},luckysheet.setAccuracy=function(e,t){var l,r,a="0.";if("TRUE"==e){if(null==t)return"w";if(0==(r=parseInt(t)))return"w0";a="w0.";for(var s=0;s<r;s++)a+="0";l=a}else{if(null==t)return"General";if(0==(r=parseInt(t)))return"0";for(s=0;s<r;s++)a+="0";l=a}return l.toString()},luckysheet.setcellvalue=function(e,t,l,r){var a,s,n,o,c,u,i=l[e][t];if(a="object"==luckysheet.getObjType(r)?(null!=(i=r).f&&(i.f=r.f),null!=r.spl&&(i.spl=r.spl),"object"==luckysheet.getObjType(r.v)?r.v.v:r.v):r,luckysheet.func_methods.isRealNull(a))return"object"==luckysheet.getObjType(i)?(delete i.m,delete i.v):i=null,void(l[e][t]=i);luckysheet.func_methods.isRealNull(i)&&(i={}),"'"==a.toString().substr(0,1)?(i.m=a.toString().substr(1),i.ct={fa:"@",t:"s"},i.v=a.toString().substr(1)):"TRUE"===a.toString().toUpperCase()?(i.m="TRUE",i.ct={fa:"General",t:"b"},i.v=!0):"FALSE"===a.toString().toUpperCase()?(i.m="FALSE",i.ct={fa:"General",t:"b"},i.v=!1):luckysheet.func_methods.valueIsError(a)?(i.m=a.toString(),i.ct={fa:"General",t:"e"},i.v=a):null!=i.f&&luckysheet.func_methods.isRealNum(a)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(a)?(i.v=parseFloat(a),i.ct={fa:"General",t:"n"},i.v==1/0||i.v==-1/0?i.m=i.v.toString():-1<i.v.toString().indexOf("e")?(5<(s=i.v.toString().split(".")[1].split("e")[0].length)&&(s=5),i.m=i.v.toExponential(s).toString()):(n=luckysheet.mask.genarate(Math.round(1e9*i.v)/1e9),i.m=n[0].toString())):null!=i.ct&&"@"==i.ct.fa?(i.m=a.toString(),i.v=a):null!=i.ct&&null!=i.ct.fa&&"General"!=i.ct.fa?(luckysheet.func_methods.isRealNum(a)&&(a=parseFloat(a)),(n=luckysheet.mask.update(i.ct.fa,a))===a?(n=luckysheet.mask.genarate(a),i.m=n[0].toString(),i.ct=n[1],i.v=n[2]):(i.m=n.toString(),i.v=a)):luckysheet.func_methods.isRealNum(a)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(a)?(a=parseFloat(a),i.v=parseFloat(a),i.ct={fa:"General",t:"n"},i.v==1/0||i.v==-1/0?i.m=i.v.toString():(n=luckysheet.mask.genarate(i.v),i.m=n[0].toString())):(n=luckysheet.mask.genarate(a),i.m=n[0].toString(),i.ct=n[1],i.v=n[2]),luckysheet.server.allowUpdate||luckysheetConfigsetting.pointEdit||null!=i.ct&&0==/^(w|W)((0?)|(0\.0+))$/.test(i.ct.fa)&&"n"==i.ct.t&&null!=i.v&&4<parseInt(i.v).toString().length&&(o="",o=luckysheet.rptSetting&&luckysheet.rptSetting.autoFormatw?luckysheet.rptSetting.autoFormatw.toString().toUpperCase():luckysheetConfigsetting.autoFormatw.toString().toUpperCase(),c=luckysheet.rptSetting&&luckysheet.rptSetting.accuracy?luckysheet.rptSetting.accuracy:luckysheetConfigsetting.accuracy,"General"!=(u=luckysheet.setAccuracy(o,c))&&(i.ct.fa=u,i.m=luckysheet.mask.update(u,i.v))),l[e][t]=i},luckysheet.jfrefreshcell=function(e,t,l){var r;clearjfundo&&(luckysheet.jfundo=[],luckysheet.jfredo.push({type:"cellchange",sheetIndex:luckysheet.currentSheetIndex,value:luckysheet.flowdata[t][l],curvalue:$.extend(!0,{},e),uprow:t,upcolumn:l})),sourcechange&&((r=[].concat(luckysheet.flowdata[t]))[l]=e,luckysheet.flowdata[t]=r);var a=luckysheet.flowdata,s=$("#luckysheetTableContent").get(0).getContext("2d"),n=$("#luckysheet-cell-main").scrollLeft(),o=$("#luckysheet-cell-main").scrollTop(),c=0==t?0:visibledatarow[t-1]-o-1,u=visibledatarow[t]-o,i=0==l?0:visibledatacolumn[l-1]-n,h=visibledatacolumn[l]-n;if(0<$("#luckysheet-data-visualization").length&&$("#luckysheet-data-visualization").is(":visible")&&(luckysheet.chartparam.jgridCurrentChartData=luckysheet.getdatabyselectionD(luckysheet.flowdata,luckysheet.chartparam.jgridCurrentChartSelection),luckysheet.luckysheet_datavisual_item_active()),null!=a[t]&&null!=a[t][l]){var e=luckysheet.getcellvalue(t,l,a),d=defaultcollen;if(null!=config.columlen&&null!=config.columlen[l]&&(d=config.columlen[l]),d<s.measureText(e).width){for(var y="",f=e.toString().split(""),m=0;m<f.length&&!(s.measureText(y+""+f[m]).width+12>d);m++)y+=f[m];e=y+"..."}s.clearRect(i+rowHeaderWidth-1,c+columeHeaderHeight-1,h-i-1,u-c-2),s.fillText(null==e?"":e,i+4+rowHeaderWidth,columeHeaderHeight+c+(u-c)/2-1);var k=defaultrowlen;null!=config.rowlen&&null!=config.rowlen[t]&&(k=config.rowlen[t]),s.clearRect(i+rowHeaderWidth-1+d-1,c+columeHeaderHeight-1,3,u-c-2),luckysheetcurrentisPivotTable||(s.beginPath(),s.moveTo(i+rowHeaderWidth-1+d,c+columeHeaderHeight-1),s.lineTo(i+rowHeaderWidth-1+d,c+columeHeaderHeight-1+k),s.lineWidth=devicePixelRatio,s.strokeStyle=luckysheetdefaultstyle.strokeStyle,s.closePath(),s.stroke())}luckysheet.server.saveParam("v",luckysheet.currentSheetIndex,e,{r:t,c:l}),luckysheet.jfrefreshchartall(luckysheet.flowdata,t,t,l,l),luckysheetConfigsetting.pointEdit&&luckysheet.pointEdit_updateData()},luckysheet.jfrefreshrange=function(e,t,l){luckysheet.formula.execFunctionExist=[];for(var r=0;r<t.length;r++)for(var a=t[r].row[0];a<=t[r].row[1];a++)for(var s=t[r].column[0];s<=t[r].column[1];s++)luckysheet.formula.execFunctionExist.push({r:a,c:s,i:luckysheet.currentSheetIndex});luckysheet.formula.execFunctionExist.reverse(),luckysheet.formula.execFunctionGroup(null,null,null,null,e),luckysheet.formula.execFunctionGroupData=null,clearjfundo&&(luckysheet.jfundo=[],luckysheet.jfredo.push({type:"rangechange",data:luckysheet.flowdata,curdata:e,range:t,sheetIndex:luckysheet.currentSheetIndex,cdformat:$.extend(!0,[],luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_conditionformat_save),curCdformat:l})),luckysheet.flowdata=e,luckysheet.editor.webWorkerFlowDataCache(luckysheet.flowdata),luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].data=luckysheet.flowdata,null!=l&&(luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_conditionformat_save=l),setTimeout(function(){luckysheet.luckysheetrefreshgrid()},1);for(r=0;r<t.length;r++)luckysheet.server.historyParam(luckysheet.flowdata,luckysheet.currentSheetIndex,t[r]),luckysheet.jfrefreshchartall(luckysheet.flowdata,t[r].row[0],t[r].row[1],t[r].column[0],t[r].column[1]);luckysheetConfigsetting.pointEdit&&luckysheet.pointEdit_updateData()},luckysheet.jfrefreshgrid=function(data,range,cfg,cdformat,RowlChange){luckysheet.formula.execFunctionExist=[];for(var s=0,curConfig,curConfig,curCdformat,curCdformat;s<range.length;s++)for(var r=range[s].row[0];r<=range[s].row[1];r++)for(var c=range[s].column[0];c<=range[s].column[1];c++)luckysheet.formula.execFunctionExist.push({r:r,c:c,i:luckysheet.currentSheetIndex});luckysheet.formula.execFunctionExist.reverse(),luckysheet.formula.execFunctionGroup(null,null,null,null,data),luckysheet.formula.execFunctionGroupData=null,clearjfundo&&(luckysheet.jfundo=[],curConfig=null==cfg?$.extend(!0,{},config):$.extend(!0,{},cfg),curCdformat=null==cdformat?$.extend(!0,[],luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_conditionformat_save):cdformat,luckysheet.jfredo.push({type:"datachange",data:luckysheet.flowdata,curdata:data,sheetIndex:luckysheet.currentSheetIndex,range:range,config:$.extend(!0,{},config),curConfig:curConfig,cdformat:$.extend(!0,[],luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_conditionformat_save),curCdformat:curCdformat,RowlChange:RowlChange})),luckysheet.flowdata=data,luckysheet.editor.webWorkerFlowDataCache(luckysheet.flowdata),luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].data=luckysheet.flowdata,null!=cfg&&(config=cfg,luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].config=config,luckysheet.server.saveParam("all",luckysheet.currentSheetIndex,cfg,{k:"config"}),null!=RowlChange&&luckysheet.jfrefreshgrid_rhcw(luckysheet.flowdata.length,luckysheet.flowdata[0].length)),null!=cdformat&&(luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_conditionformat_save=cdformat,luckysheet.server.saveParam("all",luckysheet.currentSheetIndex,cdformat,{k:"luckysheet_conditionformat_save"}));for(var s=0;s<range.length;s++){var r1=range[s].row[0],c1=range[s].column[0],fp,sparklines;null!=luckysheet.flowdata[r1][c1]&&null!=luckysheet.flowdata[r1][c1].spl&&(window.luckysheetCurrentRow=r1,window.luckysheetCurrentColumn=c1,window.luckysheetCurrentFunction=luckysheet.flowdata[r1][c1].f,fp=$.trim(luckysheet.formula.functionParser(luckysheet.flowdata[r1][c1].f)),sparklines=eval(fp),luckysheet.flowdata[r1][c1].spl=sparklines),luckysheet.server.allowUpdate&&luckysheet.server.historyParam(luckysheet.flowdata,luckysheet.currentSheetIndex,range[s]),luckysheet.jfrefreshchartall(luckysheet.flowdata,range[s].row[0],range[s].row[1],range[s].column[0],range[s].column[1])}setTimeout(function(){luckysheet.luckysheetrefreshgrid()},1),window.luckysheet_getcelldata_cache=null,luckysheetConfigsetting.pointEdit&&luckysheet.pointEdit_updateData()},luckysheet.pointEdit_updateData=function(){var e=[];null!=luckysheet.flowdata&&0<luckysheet.flowdata.length&&(e=luckysheet.dataToCelldata(luckysheet.flowdata));var t=$.extend(!0,[],luckysheet.getluckysheetfile());t[0].celldata=e,t[0].row=luckysheet.flowdata.length,t[0].column=luckysheet.flowdata[0].length,delete t[0].data,luckysheetConfigsetting.pointEditUpdate(t)},luckysheet.dataToCelldata=function(e){for(var t=[],l=0;l<e.length;l++)for(var r=0;r<e[0].length;r++){var a,s=e[l][r];null!=s&&(a={r:l,c:r,v:s},t.push(a))}return t},luckysheet.jfrefreshgridall=function(e,t,l,r,a,s,n,o,c){var u={};if("cellRowChange"==s){u.type="cellRowChange",u.config=$.extend(!0,{},config),u.curconfig=$.extend(!0,{},r),u.range=$.extend(!0,[],luckysheet_select_save),u.currange=a,u.ctrlType=s,u.ctrlValue=n;var i=r.rowlen;null==i&&(i={}),luckysheet.server.saveParam("cg",luckysheet.currentSheetIndex,i,{k:"rowlen"})}else if(-1<s.indexOf("extend"))u.type="extend",u.config=$.extend(!0,{},config),u.curconfig=$.extend(!0,{},r),u.range=$.extend(!0,[],luckysheet_select_save),u.currange=a,u.ctrlType=s,u.ctrlValue=n,luckysheet.server.saveParam("arc",luckysheet.currentSheetIndex,{index:n.index,len:n.len,direction:n.direction,mc:r.merge},{rc:n.type});else if(-1<s.indexOf("dele"))u.type="dele",u.config=$.extend(!0,{},config),u.curconfig=$.extend(!0,{},r),u.range=$.extend(!0,[],luckysheet_select_save),u.currange=a,u.ctrlType=s,u.ctrlValue=n,luckysheet.server.saveParam("drc",luckysheet.currentSheetIndex,{index:n.index,len:n.len,mc:r.merge,borderInfo:r.borderInfo},{rc:n.type});else{luckysheet.formula.execFunctionExist=[];for(var h=0;h<a.length;h++)for(var d=a[h].row[0];d<=a[h].row[1];d++)for(var y=a[h].column[0];y<=a[h].column[1];y++)luckysheet.formula.execFunctionExist.push({r:d,c:y,i:luckysheet.currentSheetIndex});luckysheet.formula.execFunctionExist.reverse(),luckysheet.formula.execFunctionGroup(null,null,null,null,l),luckysheet.formula.execFunctionGroupData=null,u.type="datachangeAll",u.range=$.extend(!0,[],luckysheet_select_save),u.currange=a,u.ctrlType=s,u.ctrlValue=n;for(h=0;h<a.length;h++)luckysheet.server.historyParam(l,luckysheet.currentSheetIndex,a[h])}if(clearjfundo&&(luckysheet.jfundo=[],u.data=luckysheet.flowdata,u.curdata=l,u.sheetIndex=luckysheet.currentSheetIndex,u.cdformat=$.extend(!0,[],luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_conditionformat_save),u.curCdformat=o,luckysheet.jfredo.push(u)),luckysheet.flowdata=l,luckysheet.editor.webWorkerFlowDataCache(l),luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].data=luckysheet.flowdata,null!=r&&(config=r,luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].config=config,luckysheet.server.saveParam("all",luckysheet.currentSheetIndex,r,{k:"config"})),null!=o&&(luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].luckysheet_conditionformat_save=o,luckysheet.server.saveParam("all",luckysheet.currentSheetIndex,o,{k:"luckysheet_conditionformat_save"})),0<(luckysheet_select_save=$.extend(!0,[],a)).length&&luckysheet.selectHightlightShow(),luckysheet.jfrefreshgrid_rhcw(t,e),setTimeout(function(){luckysheet.luckysheetrefreshgrid()},1),luckysheet.sheetmanage.storeSheetParamALL(),null==r)for(h=0;h<a.length;h++)luckysheet.jfrefreshchartall(luckysheet.flowdata,a[h].row[0],a[h].row[1],a[h].column[0],a[h].column[1]);window.luckysheet_getcelldata_cache=null,luckysheetConfigsetting.pointEdit&&luckysheet.pointEdit_updateData()},luckysheet.jfrefreshgrid_adRC=function(e,t,l,r,a,s,n,o,c){var u=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)],i=[];for(var h in t.merge)for(var d=t.merge[h],y=d.r;y<=d.r+d.rs-1;y++)for(var f=d.c;f<=d.c+d.cs-1;f++)null==e[y][f]&&(e[y][f]={}),y==d.r&&f==d.c?e[y][f].mc=d:e[y][f].mc={r:d.r,c:d.c},i.push({r:y,c:f});var m=[];if(0<a.length){luckysheet.formula.execFunctionGroupData=e;for(var k=0;k<a.length;k++){var p=a[k],g=p.r,v=p.c,b=(p.index,p.func[2]),_=luckysheet.formula.execfunction(b,g,v,null,!0);p.func=_,e[g][v].f==b&&(luckysheet.setcellvalue(g,v,e,_[1]),m.push({r:g,c:v}))}}clearjfundo&&(luckysheet.jfundo=[],luckysheet.jfredo.push({type:l,sheetIndex:luckysheet.currentSheetIndex,data:luckysheet.flowdata,curData:e,config:$.extend(!0,{},config),curConfig:t,ctrlValue:r,mcData:i,calc:$.extend(!0,[],u.calcChain),curCalc:a,funcData:m,filterObj:{filter_select:$.extend(!0,{},u.filter_select),filter:$.extend(!0,{},u.filter)},curFilterObj:s,cf:$.extend(!0,[],u.luckysheet_conditionformat_save),curCf:n,af:$.extend(!0,[],u.luckysheet_alternateformat_save),curAf:o,freezen:{freezenhorizontaldata:luckysheet.freezen.freezenhorizontaldata,freezenverticaldata:luckysheet.freezen.freezenverticaldata},curFreezen:c}));var w=r.index,x=r.len,C=r.rc;if("addRC"==l){var T,I,R=r.direction,S=[];if(r.restore)if("r"==C){"lefttop"==R?T=w:"rightbottom"==R&&(T=w+1);for(var A=T+x-1,y=T;y<=A;y++){for(var F=[],f=0;f<e[0].length;f++){var N=e[y][f];F.push(N)}S.push(F)}}else if("c"==C){"lefttop"==R?I=w:"rightbottom"==R&&(I=w+1);for(var M=I+x-1,y=0;y<e.length;y++){for(F=[],f=I;f<=M;f++){N=e[y][f];F.push(N)}S.push(F)}}luckysheet.server.saveParam("arc",luckysheet.currentSheetIndex,{index:w,len:x,direction:R,data:S},{rc:C})}else"delRC"==l&&luckysheet.server.saveParam("drc",luckysheet.currentSheetIndex,{index:w,len:x},{rc:C});luckysheet.flowdata=e,luckysheet.editor.webWorkerFlowDataCache(luckysheet.flowdata),u.data=e,config=t,u.config=config,luckysheet.server.saveParam("all",luckysheet.currentSheetIndex,t,{k:"config"});for(k=0;k<i.length;k++){var E=i[k].r,O=i[k].c;luckysheet.server.saveParam("v",luckysheet.currentSheetIndex,luckysheet.flowdata[E][O],{r:E,c:O})}u.calcChain=a,luckysheet.server.saveParam("all",luckysheet.currentSheetIndex,a,{k:"calcChain"});for(k=0;k<m.length;k++){var j=m[k].r,z=m[k].c;luckysheet.server.saveParam("v",luckysheet.currentSheetIndex,luckysheet.flowdata[j][z],{r:j,c:z})}null!=s?(u.filter_select=s.filter_select,u.filter=s.filter):(u.filter_select=null,u.filter=null),luckysheet.createFilterOptions(u.filter_select,u.filter),luckysheet.server.saveParam("all",luckysheet.currentSheetIndex,u.filter_select,{k:"filter_select"}),luckysheet.server.saveParam("all",luckysheet.currentSheetIndex,u.filter,{k:"filter"}),u.luckysheet_conditionformat_save=n,luckysheet.server.saveParam("all",luckysheet.currentSheetIndex,u.luckysheet_conditionformat_save,{k:"luckysheet_conditionformat_save"}),u.luckysheet_alternateformat_save=o,luckysheet.server.saveParam("all",luckysheet.currentSheetIndex,u.luckysheet_alternateformat_save,{k:"luckysheet_alternateformat_save"}),null!=c?(luckysheet.freezen.freezenhorizontaldata=c.freezenhorizontaldata,luckysheet.freezen.freezenverticaldata=c.freezenverticaldata):(luckysheet.freezen.freezenhorizontaldata=null,luckysheet.freezen.freezenverticaldata=null),luckysheet.jfrefreshgrid_rhcw(luckysheet.flowdata.length,luckysheet.flowdata[0].length)},luckysheet.jfrefreshgrid_rhcw=function(rowheight,colwidth){if(null!=rowheight){visibledatarow=[],rh_height=0;for(var i=0;i<rowheight;i++){var rowlen=defaultrowlen;null!=config.rowlen&&null!=config.rowlen[i]&&(rowlen=config.rowlen[i]),null==config.rowhidden||null==config.rowhidden[i]?(rh_height+=rowlen+1,visibledatarow.push(rh_height)):(rowlen=config.rowhidden[i],visibledatarow.push(rh_height))}luckysheetConfigsetting.pointEdit||(rh_height+=110)}if(null!=colwidth){visibledatacolumn=[],ch_width=0;for(var maxColumlen=120,i=0;i<colwidth;i++){var firstcolumlen=defaultcollen;null!=config.columlen&&null!=config.columlen[i]?firstcolumlen=config.columlen[i]:null!=luckysheet.flowdata[0]&&null!=luckysheet.flowdata[0][i]&&(300<firstcolumlen?firstcolumlen=300:firstcolumlen<defaultcollen&&(firstcolumlen=defaultcollen),firstcolumlen!=defaultcollen&&(null==config.columlen&&(config.columlen={}),config.columlen[i]=firstcolumlen)),ch_width+=firstcolumlen+1,visibledatacolumn.push(ch_width),maxColumlen<firstcolumlen+1&&(maxColumlen=firstcolumlen+1)}luckysheetConfigsetting.pointEdit||(ch_width+=maxColumlen)}luckysheet.sheetmanage.storeSheetParam();var calcChain=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].calcChain,row_st,col_st,scrollTop,scrollLeft,top,freezenhorizontaldata,left,freezenverticaldata,row_st,scrollTop,top,freezenhorizontaldata,col_st,scrollLeft,left,freezenverticaldata,luckysheet_filter_save,r1,r2,c1,c2,row,row_pre,col,col_pre;if(null!=calcChain&&0<calcChain.length){null==config.rowlen&&(config.rowlen={}),null==config.columlen&&(config.columlen={});for(var i=0;i<calcChain.length;i++){var r=calcChain[i].r,c=calcChain[i].c,index=calcChain[i].index,fp,sparklines;index==luckysheet.currentSheetIndex&&null!=luckysheet.flowdata[r][c]&&null!=luckysheet.flowdata[r][c].spl&&(r in config.rowlen||c in config.columlen)&&(window.luckysheetCurrentRow=r,window.luckysheetCurrentColumn=c,window.luckysheetCurrentFunction=luckysheet.flowdata[r][c].f,fp=$.trim(luckysheet.formula.functionParser(luckysheet.flowdata[r][c].f)),sparklines=eval(fp),luckysheet.flowdata[r][c].spl=sparklines,luckysheet.server.saveParam("v",luckysheet.currentSheetIndex,luckysheet.flowdata[r][c],{r:r,c:c}))}luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].data=luckysheet.flowdata}luckysheet.postil.positionSync(),luckysheet.selectHightlightShow(),$(".luckysheet-selection-copy").is(":visible")&&luckysheet.selectionCopyShow(),$("#luckysheet-dropCell-icon").is(":visible")&&$("#luckysheet-dropCell-icon").remove(),null!=luckysheet.freezen.freezenhorizontaldata&&null!=luckysheet.freezen.freezenverticaldata?(row_st=luckysheet.freezen.freezenhorizontaldata[1]-1,col_st=luckysheet.freezen.freezenverticaldata[1]-1,scrollTop=luckysheet.freezen.freezenhorizontaldata[2],scrollLeft=luckysheet.freezen.freezenverticaldata[2],top=visibledatarow[row_st]-2-scrollTop+columeHeaderHeight,freezenhorizontaldata=[visibledatarow[row_st],row_st+1,scrollTop,luckysheet.freezen.cutVolumn(visibledatarow,row_st+1),top],left=visibledatacolumn[col_st]-2-scrollLeft+rowHeaderWidth,freezenverticaldata=[visibledatacolumn[col_st],col_st+1,scrollLeft,luckysheet.freezen.cutVolumn(visibledatacolumn,col_st+1),left],luckysheet.freezen.saveFreezen(freezenhorizontaldata,top,freezenverticaldata,left),luckysheet.freezen.createFreezenHorizontal(freezenhorizontaldata,top),luckysheet.freezen.createFreezenVertical(freezenverticaldata,left),luckysheet.freezen.createAssistCanvas()):null!=luckysheet.freezen.freezenhorizontaldata?(row_st=luckysheet.freezen.freezenhorizontaldata[1]-1,scrollTop=luckysheet.freezen.freezenhorizontaldata[2],top=visibledatarow[row_st]-2-scrollTop+columeHeaderHeight,freezenhorizontaldata=[visibledatarow[row_st],row_st+1,scrollTop,luckysheet.freezen.cutVolumn(visibledatarow,row_st+1),top],luckysheet.freezen.saveFreezen(freezenhorizontaldata,top,null,null),luckysheet.freezen.createFreezenHorizontal(freezenhorizontaldata,top),luckysheet.freezen.createAssistCanvas()):null!=luckysheet.freezen.freezenverticaldata?(col_st=luckysheet.freezen.freezenverticaldata[1]-1,scrollLeft=luckysheet.freezen.freezenverticaldata[2],left=visibledatacolumn[col_st]-2-scrollLeft+rowHeaderWidth,freezenverticaldata=[visibledatacolumn[col_st],col_st+1,scrollLeft,luckysheet.freezen.cutVolumn(visibledatacolumn,col_st+1),left],luckysheet.freezen.saveFreezen(null,null,freezenverticaldata,left),luckysheet.freezen.createFreezenVertical(freezenverticaldata,left),luckysheet.freezen.createAssistCanvas()):0<$("#luckysheet-filter-options-sheet"+luckysheet.currentSheetIndex+" .luckysheet-filter-options").length&&$("#luckysheet-filter-options-sheet"+luckysheet.currentSheetIndex+" .luckysheet-filter-options").each(function(e,t){var l=$(t).data("str"),r=$(t).data("cindex"),a=visibledatacolumn[r]-20,s=l-1==-1?0:visibledatarow[l-1];$(t).css({left:a,top:s})}),0<$("#luckysheet-filter-selected-sheet"+luckysheet.currentSheetIndex).length&&(luckysheet_filter_save=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].filter_select,r1=luckysheet_filter_save.row[0],r2=luckysheet_filter_save.row[1],c1=luckysheet_filter_save.column[0],c2=luckysheet_filter_save.column[1],row=visibledatarow[r2],row_pre=r1-1==-1?0:visibledatarow[r1-1],col=visibledatacolumn[c2],col_pre=c1-1==-1?0:visibledatacolumn[c1-1],$("#luckysheet-filter-selected-sheet"+luckysheet.currentSheetIndex).css({left:col_pre,width:col-col_pre-1,top:row_pre,height:row-row_pre-1})),luckysheet.sheetmanage.showSheet(),setTimeout(function(){luckysheet.luckysheetrefreshgrid()},1),luckysheetConfigsetting.pointEdit&&luckysheet.pointEdit_updateData()},luckysheet.jfrefreshgrid_pastcut=function(e,t,l){var r={};luckysheet.formula.execFunctionExist=[];for(var a=e.range.row[0];a<=e.range.row[1];a++)for(var s=e.range.column[0];s<=e.range.column[1];s++)a+"_"+s+"_"+e.sheetIndex in r||(r[a+"_"+s+"_"+e.sheetIndex]=0,luckysheet.formula.execFunctionExist.push({r:a,c:s,i:e.sheetIndex}));for(var n,a=t.range.row[0];a<=t.range.row[1];a++)for(s=t.range.column[0];s<=t.range.column[1];s++)a+"_"+s+"_"+t.sheetIndex in r||(r[a+"_"+s+"_"+t.sheetIndex]=0,luckysheet.formula.execFunctionExist.push({r:a,c:s,i:t.sheetIndex}));if(luckysheet.formula.execFunctionExist.reverse(),luckysheet.formula.execFunctionGroup(null,null,null,null,t.curData),luckysheet.formula.execFunctionGroupData=null,clearjfundo&&(luckysheet.jfundo=[],luckysheet.jfredo.push({type:"pasteCut",source:e,target:t,RowlChange:l})),luckysheet.currentSheetIndex==e.sheetIndex?(config=e.curConfig,n=e.curData.length,luckysheetfile[luckysheet.sheetmanage.getSheetIndex(t.sheetIndex)].config=t.curConfig):luckysheet.currentSheetIndex==t.sheetIndex&&(config=t.curConfig,n=t.curData.length,luckysheetfile[luckysheet.sheetmanage.getSheetIndex(e.sheetIndex)].config=e.curConfig),l){visibledatarow=[];for(var o,c=rh_height=0;c<n;c++){var u=defaultrowlen;null!=config.rowlen&&null!=config.rowlen[c]&&(u=config.rowlen[c]),null==config.rowhidden||null==config.rowhidden[c]?(rh_height+=u+1,visibledatarow.push(rh_height)):(u=config.rowhidden[c],visibledatarow.push(rh_height))}rh_height+=110,luckysheet.sheetmanage.showSheet(),luckysheet.currentSheetIndex==e.sheetIndex?(o=luckysheet.computeRowlenArr(t.curData.length,t.curConfig),luckysheetfile[luckysheet.sheetmanage.getSheetIndex(t.sheetIndex)].visibledatarow=o):luckysheet.currentSheetIndex==t.sheetIndex&&(o=luckysheet.computeRowlenArr(e.curData.length,e.curConfig),luckysheetfile[luckysheet.sheetmanage.getSheetIndex(e.sheetIndex)].visibledatarow=o)}luckysheet.currentSheetIndex==e.sheetIndex?(luckysheet.flowdata=e.curData,luckysheetfile[luckysheet.sheetmanage.getSheetIndex(t.sheetIndex)].data=t.curData):luckysheet.currentSheetIndex==t.sheetIndex&&(luckysheet.flowdata=t.curData,luckysheetfile[luckysheet.sheetmanage.getSheetIndex(e.sheetIndex)].data=e.curData),luckysheet.editor.webWorkerFlowDataCache(luckysheet.flowdata),luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].data=luckysheet.flowdata,0<(luckysheet_select_save=luckysheet.currentSheetIndex==t.sheetIndex?[{row:t.range.row,column:t.range.column}]:[{row:e.range.row,column:e.range.column}]).length&&luckysheet.selectHightlightShow(),luckysheetfile[luckysheet.sheetmanage.getSheetIndex(e.sheetIndex)].luckysheet_conditionformat_save=e.curCdformat,luckysheetfile[luckysheet.sheetmanage.getSheetIndex(t.sheetIndex)].luckysheet_conditionformat_save=t.curCdformat,setTimeout(function(){luckysheet.luckysheetrefreshgrid()},1),luckysheet.sheetmanage.storeSheetParamALL(),luckysheet.jfrefreshchartall(luckysheet.flowdata,0,luckysheet.flowdata.length-1,0,luckysheet.flowdata[0].length-1),luckysheet.server.saveParam("all",e.sheetIndex,e.curConfig,{k:"config"}),luckysheet.server.saveParam("all",t.sheetIndex,t.curConfig,{k:"config"}),luckysheet.server.historyParam(e.curData,e.sheetIndex,{row:e.range.row,column:e.range.column}),luckysheet.server.historyParam(t.curData,t.sheetIndex,{row:t.range.row,column:t.range.column}),luckysheetConfigsetting.pointEdit&&luckysheet.pointEdit_updateData()},luckysheet.luckysheetcreatesheet=function(e,t,l,r,a){null==a&&(a=!0),visibledatarow=[],visibledatacolumn=[],rowsplit=[],colsplit=[],config=null!=r?r:{},(rh_height=ch_width=0)==l.length?luckysheet.flowdata=luckysheet.datagridgrowth(l,t,e):l.length<t&&l[0].length<e?luckysheet.flowdata=luckysheet.datagridgrowth(l,t-l.length,e-l[0].length):l.length<t?luckysheet.flowdata=luckysheet.datagridgrowth(l,t-l.length,0):l[0].length<e?luckysheet.flowdata=luckysheet.datagridgrowth(l,0,e-l[0].length):luckysheet.flowdata=l,luckysheet.editor.webWorkerFlowDataCache(luckysheet.flowdata);for(var s=0;s<e;s++){var n=defaultcollen;null!=config.columlen&&null!=config.columlen[s]?n=config.columlen[s]:null!=l[0]&&null!=l[0][s]&&(300<(n=Math.ceil(11.5*luckysheet.getByteLen(l[0][s])))?n=300:n<defaultcollen&&(n=defaultcollen),n!=defaultcollen&&(null==config.columlen&&(config.columlen={}),config.columlen[s]=n)),ch_width+=n+1,visibledatacolumn.push(ch_width)}for(s=0;s<t;s++){var o=defaultrowlen;null!=config.rowlen&&null!=config.rowlen[s]&&(o=config.rowlen[s]),null==config.rowhidden||null==config.rowhidden[s]?(rh_height+=o+1,visibledatarow.push(rh_height)):(o=config.rowhidden[s],visibledatarow.push(rh_height))}rh_height+=110,ch_width+=120,a&&(luckysheet.sheetmanage.showSheet(),setTimeout(function(){luckysheet.sheetmanage.restoreCache(),luckysheet.formula.execFunctionGroup(),luckysheet.sheetmanage.restoreSheetAll(luckysheet.currentSheetIndex),luckysheet.luckysheetrefreshgrid()},1))},luckysheet.luckysheetrefreshgrid=function(e,t){var l,r,a,s,n,o;luckysheet.formula.groupValuesRefresh(),null==e&&(e=$("#luckysheet-cell-main").scrollLeft()),null==t&&(t=$("#luckysheet-cell-main").scrollTop()),null!=luckysheet.freezen.freezenverticaldata||null!=luckysheet.freezen.freezenhorizontaldata?(n=luckysheetTableContentHW[0],o=luckysheetTableContentHW[1],null!=luckysheet.freezen.freezenverticaldata&&null!=luckysheet.freezen.freezenhorizontaldata?(l=luckysheet.freezen.freezenhorizontaldata[0],luckysheet.freezen.freezenhorizontaldata[1],r=luckysheet.freezen.freezenhorizontaldata[2],a=luckysheet.freezen.freezenverticaldata[0],luckysheet.freezen.freezenverticaldata[1],luckysheetDrawMain(s=luckysheet.freezen.freezenverticaldata[2],r,a,l,1,1,null,null,"freezen_3"),luckysheetDrawMain(e+a-s,r,n-a+s,l,1,1,null,null,"freezen_4"),luckysheetDrawMain(s,t+l-r,a,o-l+r,1,1,null,null,"freezen_7"),luckysheetDrawMain(e+a-s,t+l-r,n-a+s,o-l+r,a-s+rowHeaderWidth,l-r+columeHeaderHeight),luckysheetDrawgridColumnTitle(e+a-s,n-a+s,a-s+rowHeaderWidth),luckysheetDrawgridColumnTitle(s,a,rowHeaderWidth),luckysheetDrawgridRowTitle(t+l-r,o-l+r,l-r+columeHeaderHeight),luckysheetDrawgridRowTitle(r,l,columeHeaderHeight)):null!=luckysheet.freezen.freezenhorizontaldata?(l=luckysheet.freezen.freezenhorizontaldata[0],luckysheet.freezen.freezenhorizontaldata[1],luckysheetDrawMain(e,r=luckysheet.freezen.freezenhorizontaldata[2],n,l,1,1,null,null,"freezen_h"),luckysheetDrawMain(e,t+l-r,n,o-l+r,null,l-r+columeHeaderHeight),luckysheetDrawgridColumnTitle(e,n,null),luckysheetDrawgridRowTitle(t+l-r,o-l+r,l-r+columeHeaderHeight),luckysheetDrawgridRowTitle(r,l,columeHeaderHeight)):null!=luckysheet.freezen.freezenverticaldata&&(a=luckysheet.freezen.freezenverticaldata[0],luckysheet.freezen.freezenverticaldata[1],luckysheetDrawMain(s=luckysheet.freezen.freezenverticaldata[2],t,a,o,1,1,null,null,"freezen_v"),luckysheetDrawMain(e+a-s,t,n-a+s,o,a-s+rowHeaderWidth,null),luckysheetDrawgridRowTitle(t,o,null),luckysheetDrawgridColumnTitle(e+a-s,n-a+s,a-s+rowHeaderWidth),luckysheetDrawgridColumnTitle(s,a,rowHeaderWidth))):luckysheetDrawgrid(e,t)},luckysheet.luckysheetDrawMain=luckysheetDrawMain,luckysheet.luckysheetcreatedom=function(e,t,l,r,a){luckysheetConfigsetting.pointEdit||(t<30&&(t=30),e<22&&(e=22));var s=gridHTML,s=luckysheet.replaceHtml(s,{logotitle:a});s=luckysheet.replaceHtml(s,{menu:menuToolBar}),0==l.length?luckysheet.flowdata=luckysheet.datagridgrowth(l,t,e):l.length<t&&l[0].length<e?luckysheet.flowdata=luckysheet.datagridgrowth(l,t-l.length,e-l[0].length):l.length<t?luckysheet.flowdata=luckysheet.datagridgrowth(l,t-l.length,0):l[0].length<e?luckysheet.flowdata=luckysheet.datagridgrowth(l,0,e-l[0].length):luckysheet.flowdata=l,luckysheet.editor.webWorkerFlowDataCache(luckysheet.flowdata);var n=flow;null==config&&(config={}),visibledatacolumn=[];for(var o=ch_width=0;o<e;o++){var c=defaultcollen;null!=config.columlen&&null!=config.columlen[o]?c=config.columlen[o]:null!=l[0]&&null!=l[0][o]&&(300<(c=Math.ceil(11.5*luckysheet.getByteLen(l[0][o].v)))?c=300:c<defaultcollen&&(c=defaultcollen),c!=defaultcollen&&(null==config.columlen&&(config.columlen={}),config.columlen[o]=c)),ch_width+=c+1,visibledatacolumn.push(ch_width)}visibledatarow=[];for(var u,i,h,d,o=rh_height=0;o<t;o++){var y=defaultrowlen;null!=config.rowlen&&null!=config.rowlen[o]&&(y=config.rowlen[o]),null==config.rowhidden||null==config.rowhidden[o]?(rh_height+=y+1,visibledatarow.push(rh_height)):(y=config.rowhidden[o],visibledatarow.push(rh_height))}luckysheetConfigsetting.pointEdit||(rh_height+=110,ch_width+=120,u=' <span id="luckysheet-bottom-page-info" style="font-size: 14px;color: #f34141;">共'+luckysheetConfigsetting.total+"条，"+luckysheetConfigsetting.pageInfo.totalPage+"页，当前已显示"+luckysheetConfigsetting.pageInfo.currentPage+'页</span> <button id="luckysheet-bottom-page-next" class="btn btn-danger" style="">下一页</button>',i=' <span id="luckysheet-bottom-page-info" style="font-size: 14px;color: #f34141;">共'+luckysheetConfigsetting.total+"条，"+luckysheetConfigsetting.pageInfo.totalPage+"页，当前已显示"+luckysheetConfigsetting.pageInfo.currentPage+"页</span>",h="",luckysheetConfigsetting.enableAddRow&&(h+='<button id="luckysheet-bottom-add-row" class="btn btn-default">添加</button><input id="luckysheet-bottom-add-row-input" type="text" class="luckysheet-datavisual-config-input luckysheet-mousedown-cancel" placeholder="100"><span style="font-size: 14px;">行</span><span style="font-size: 14px;color: #9c9c9c;">(在底部添加)</span>'),luckysheetConfigsetting.enablePage&&(1==parseInt(luckysheetConfigsetting.pageInfo.totalPage)?h+=i:h+=u),h+=' <button id="luckysheet-bottom-bottom-top" class="btn btn-default" style="">回到顶部</button>',d=luckysheet.replaceHtml('<div id="luckysheetcoltable_0" class="luckysheet-cell-flow-col"> <div id ="luckysheet-sheettable_0" class="luckysheet-cell-sheettable" style="height:${height}px;width:${width}px;"></div><div id="luckysheet-bottom-controll-row" class="luckysheet-bottom-controll-row"> '+h+" </div> </div>",{height:rh_height,width:ch_width-1}));var f=luckysheet.replaceHtml(columnHeaderHTML,{width:ch_width,index:0,column:""}),n=luckysheet.replaceHtml(n,{width:ch_width,flow:d,index:0});s=luckysheet.replaceHtml(s,{flow:n,rowHeader:"<div style='height:"+rh_height+"px' id='luckysheetrowHeader_0' class='luckysheetsheetchange'></div>",columnHeader:f,functionButton:luckysheetConfigsetting.functionButton}),$("#"+container).append(s),$("#luckysheet-scrollbar-x div").width(ch_width),$("#luckysheet-scrollbar-y div").height(rh_height-30),$("body").append(maskHTML),$("body").append(colsmenuHTML),$("body").append(rightclickHTML),$("body").append(inputHTML),$("body").append(luckysheet.replaceHtml(filtermenuHTML,{menuid:"filter"})),$("body").append(luckysheet.replaceHtml(filtersubmenuHTML,{menuid:"filter"})),$("body").append(sheetconfigHTML),luckysheet.postil.buildAllPs(luckysheet.flowdata)},function(){function e(){var e,t=function(){this.init.apply(this,arguments)};return 1<arguments.length?(arguments[0]?(t.prototype=$.extend(new arguments[0],arguments[arguments.length-1]),t._super=arguments[0].prototype):t.prototype=arguments[arguments.length-1],2<arguments.length&&((e=Array.prototype.slice.call(arguments,1,-1)).unshift(t.prototype),$.extend.apply($,e))):t.prototype=arguments[0],t.prototype.cls=t}var l=e({fre:/\{\{([\w.]+?)(:(.+?))?\}\}/g,precre:/(\w+)\.(\d+)/,init:function(e,t){this.format=e,this.fclass=t},render:function(e,t,l){var r,a,s,n,o,c=this,u=e;return this.format.replace(this.fre,function(){return a=arguments[1],s=arguments[3],(r=c.precre.exec(a))?(o=r[2],a=r[1]):o=!1,void 0===(n=u[a])?"":s&&t&&t[s]?t[s].get?t[s].get(n)||n:t[s][n]||n:(i(n)&&(n=l.get("numberFormatter")?l.get("numberFormatter")(n):h(n,o,l.get("numberDigitGroupCount"),l.get("numberDigitGroupSep"),l.get("numberDecimalMark"))),n)})}});$.spformat=function(e,t){return new l(e,t)};function E(e,t,l){return e<t?t:l<e?l:e}function w(e,t){var l;return 2===t?(l=Math.floor(e.length/2),e.length%2?e[l]:(e[l-1]+e[l])/2):e.length%2?(l=(e.length*t+t)/4)%1?(e[Math.floor(l)]+e[Math.floor(l)-1])/2:e[l-1]:(l=(e.length*t+2)/4)%1?(e[Math.floor(l)]+e[Math.floor(l)-1])/2:e[l-1]}function O(e){var t;switch(e){case"undefined":e=void 0;break;case"null":e=null;break;case"true":e=!0;break;case"false":e=!1;break;default:e==(t=parseFloat(e))&&(e=t)}return e}function j(e){for(var t=[],l=e.length;l--;)t[l]=O(e[l]);return t}function x(e,t,l){for(var r=t.length;r--;)if((!l||null!==t[r])&&t[r]!==e)return!1;return!0}function z(e,t){for(var l=[],r=0,a=e.length;r<a;r++)e[r]!==t&&l.push(e[r]);return l}var i=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},h=function(e,t,l,r,a){var s,n;for(e=(!1===t?parseFloat(e).toString():e.toFixed(t)).split(""),(s=(s=$.inArray(".",e))<0?e.length:s)<e.length&&(e[s]=a),n=s-l;0<n;n-=l)e.splice(n,0,r);return e.join("")},D=e({init:function(e){var t,l,r=[];for(t in e)e.hasOwnProperty(t)&&"string"==typeof t&&-1<t.indexOf(":")&&((l=t.split(":"))[0]=0===l[0].length?-1/0:parseFloat(l[0]),l[1]=0===l[1].length?1/0:parseFloat(l[1]),l[2]=e[t],r.push(l));this.map=e,this.rangelist=r||!1},get:function(e){var t,l,r,a=this.rangelist;if(void 0!==(r=this.map[e]))return r;if(a)for(t=a.length;t--;)if((l=a[t])[0]<=e&&l[1]>=e)return l[2]}});$.range_map=function(e){return new D(e)},luckysheet.sparkline={defaultOption:{common:{type:"line",lineColor:"#2ec7c9",fillColor:"#CCF3F4",defaultPixelsPerValue:3,width:"auto",height:"auto",composite:!1,tagValuesAttribute:"values",tagOptionsPrefix:"spark",enableTagOptions:!1,enableHighlight:!0,highlightLighten:1.4,tooltipSkipNull:!0,tooltipPrefix:"",tooltipSuffix:"",disableHiddenCheck:!1,numberFormatter:!1,numberDigitGroupCount:3,numberDigitGroupSep:",",numberDecimalMark:".",disableTooltips:!0,disableInteraction:!0,offsetX:0,offsetY:0},line:{spotColor:0,highlightSpotColor:"#5f5",highlightLineColor:"#f22",spotRadius:1.5,minSpotColor:0,maxSpotColor:0,lineWidth:1,normalRangeMin:void 0,normalRangeMax:void 0,normalRangeColor:"#ccc",drawNormalOnTop:!0,chartRangeMin:void 0,chartRangeMax:void 0,chartRangeMinX:void 0,chartRangeMaxX:void 0},bar:{barColor:"#fc5c5c",negBarColor:"#97b552",stackedBarColor:["#2ec7c9","#fc5c5c","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],zeroColor:void 0,nullColor:void 0,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:void 0,chartRangeMin:void 0,chartRangeClip:!1,colorMap:void 0},column:{barColor:"#fc5c5c",negBarColor:"#97b552",stackedBarColor:["#2ec7c9","#fc5c5c","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],zeroColor:void 0,nullColor:void 0,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:void 0,chartRangeMin:void 0,chartRangeClip:!1,colorMap:void 0},tristate:{barWidth:4,barSpacing:1,posBarColor:"#fc5c5c",negBarColor:"#97b552",zeroBarColor:"#999",colorMap:{}},discrete:{lineHeight:"auto",thresholdColor:"#fc5c5c",thresholdValue:0,chartRangeMax:void 0,chartRangeMin:void 0,chartRangeClip:!1},bullet:{targetColor:"#f33",targetWidth:3,performanceColor:"#33f",rangeColors:["#d3dafe","#a8b6ff","#7f94ff","#6D87FF","#5876FF","#4465FF","#2F54FF","#1A43FF","#0532FF"],base:void 0},pie:{offset:0,sliceColors:["#2ec7c9","#fc5c5c","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],borderWidth:0,borderColor:"#000"},box:{raw:!1,boxLineColor:"#000",boxFillColor:"#cdf",whiskerColor:"#000",outlierLineColor:"#5E5E5E",outlierFillColor:"#fff",medianColor:"#f00",showOutliers:!0,outlierIQR:1.5,spotRadius:1.5,target:void 0,targetColor:"#4a2",chartRangeMax:void 0,chartRangeMin:void 0}},line:{type:"line",init:function(e,t,l,r,a){this.vertices=[],this.regionMap=[],this.xvalues=[],this.yvalues=[],this.yminmax=[],this.hightlightSpotId=null,this.lastShapeId=null},getRegion:function(e,t,l){for(var r=this.regionMap,a=r.length;a--;)if(null!==r[a]&&t>=r[a][0]&&t<=r[a][1])return r[a][2]},getCurrentRegionFields:function(){var e=this.currentRegion;return{isNull:null===this.yvalues[e],x:this.xvalues[e],y:this.yvalues[e],color:this.options.get("lineColor"),fillColor:this.options.get("fillColor"),offset:e}},renderHighlight:function(){var e,t,l=this.currentRegion,r=this.target,a=this.vertices[l],s=this.options,n=s.get("spotRadius"),o=s.get("highlightSpotColor"),c=s.get("highlightLineColor");a&&(n&&o&&(e=r.drawCircle(a[0],a[1],n,void 0,o),this.highlightSpotId=e.id,r.insertAfterShape(this.lastShapeId,e)),c&&(t=r.drawLine(a[0],this.canvasTop,a[0],this.canvasTop+this.canvasHeight,c),this.highlightLineId=t.id,r.insertAfterShape(this.lastShapeId,t)))},removeHighlight:function(){var e=this.target;this.highlightSpotId&&(e.removeShapeId(this.highlightSpotId),this.highlightSpotId=null),this.highlightLineId&&(e.removeShapeId(this.highlightLineId),this.highlightLineId=null)},scanValues:function(){for(var e,t,l,r,a=this.values,s=a.length,n=this.xvalues,o=this.yvalues,c=this.yminmax,u=0;u<s;u++)e=a[u],t="string"==typeof a[u],l="object"==typeof a[u]&&a[u]instanceof Array,r=t&&a[u].split(":"),t&&2===r.length?(n.push(Number(r[0])),o.push(Number(r[1])),c.push(Number(r[1]))):l?(n.push(e[0]),o.push(e[1]),c.push(e[1])):(n.push(u),null===a[u]||"null"===a[u]?o.push(null):(o.push(Number(e)),c.push(Number(e))));this.options.get("xvalues")&&(n=this.options.get("xvalues")),this.maxy=this.maxyorg=Math.max.apply(Math,c),this.miny=this.minyorg=Math.min.apply(Math,c),this.maxx=Math.max.apply(Math,n),this.minx=Math.min.apply(Math,n),this.xvalues=n,this.yvalues=o,this.yminmax=c},processRangeOptions:function(){var e=this.options,t=e.get("normalRangeMin"),l=e.get("normalRangeMax");void 0!==t&&(t<this.miny&&(this.miny=t),l>this.maxy&&(this.maxy=l)),void 0!==e.get("chartRangeMin")&&(e.get("chartRangeClip")||e.get("chartRangeMin")<this.miny)&&(this.miny=e.get("chartRangeMin")),void 0!==e.get("chartRangeMax")&&(e.get("chartRangeClip")||e.get("chartRangeMax")>this.maxy)&&(this.maxy=e.get("chartRangeMax")),void 0!==e.get("chartRangeMinX")&&(e.get("chartRangeClipX")||e.get("chartRangeMinX")<this.minx)&&(this.minx=e.get("chartRangeMinX")),void 0!==e.get("chartRangeMaxX")&&(e.get("chartRangeClipX")||e.get("chartRangeMaxX")>this.maxx)&&(this.maxx=e.get("chartRangeMaxX"))},drawNormalRange:function(e,t,l,r,a){var s=this.options.get("normalRangeMin"),n=this.options.get("normalRangeMax"),o=t+Math.round(l-l*((n-this.miny)/a)),c=Math.round(l*(n-s)/a);0==c&&s==n&&(c=1),this.target.drawRect(e,o,r,c,void 0,this.options.get("normalRangeColor")).append()},render:function(e,t){this.vertices=[],this.regionMap=[],this.xvalues=[],this.yvalues=[],this.yminmax=[],this.hightlightSpotId=null,this.lastShapeId=null,this.values=t;var l,r,a,s,n,o,c,u,i,h,d,y,f,m,k,p,g,v,b,_,w,x,C,T,I=this.options,R=this.target,S=e.mergedOptions.width,A=e.mergedOptions.height,F=this.vertices,N=I.get("spotRadius"),M=this.regionMap;if(this.scanValues(),this.processRangeOptions(),x=this.xvalues,C=this.yvalues,this.yminmax.length&&!(this.yvalues.length<2)){for(s=n=0,l=this.maxx-this.minx==0?1:this.maxx-this.minx,r=this.maxy-this.miny==0?1:this.maxy-this.miny,a=this.yvalues.length-1,N&&(S<4*N||A<4*N)&&(N=0),N&&(((_=I.get("highlightSpotColor")&&!I.get("disableInteraction"))||I.get("minSpotColor")||I.get("spotColor")&&C[a]===this.miny)&&(A-=Math.ceil(N)),(_||I.get("maxSpotColor")||I.get("spotColor")&&C[a]===this.maxy)&&(A-=Math.ceil(N),s+=Math.ceil(N)),!_&&(!I.get("minSpotColor")&&!I.get("maxSpotColor")||C[0]!==this.miny&&C[0]!==this.maxy)||(n+=Math.ceil(N),S-=Math.ceil(N)),(_||I.get("spotColor")||I.get("minSpotColor")||I.get("maxSpotColor")&&(C[a]===this.miny||C[a]===this.maxy))&&(S-=Math.ceil(N))),A--,void 0===I.get("normalRangeMin")||I.get("drawNormalOnTop")||this.drawNormalRange(n,s,A,S,r),u=[c=[]],f=null,k=C.length,T=0;T<k;T++)i=x[T],d=x[T+1],h=C[T],m=(y=n+Math.round((i-this.minx)*(S/l)))+((T<k-1?n+Math.round((d-this.minx)*(S/l)):S)-y)/2,M[T]=[f||0,m,T],f=m,null===h?T&&(null!==C[T-1]&&(c=[],u.push(c)),F.push(null)):(h<this.miny&&(h=this.miny),h>this.maxy&&(h=this.maxy),c.length||c.push([y,s+A]),o=[y,s+Math.round(A-A*((h-this.miny)/r))],c.push(o),F.push(o));for(p=[],g=[],v=u.length,T=0;T<v;T++)(c=u[T]).length&&(I.get("fillColor")&&(c.push([c[c.length-1][0],s+A]),g.push(c.slice(0)),c.pop()),2<c.length&&(c[0]=[c[0][0],c[1][1]]),p.push(c));for(v=g.length,T=0;T<v;T++)R.drawShape(g[T],I.get("fillColor"),I.get("fillColor")).append();for(v=p.length,T=0;T<v;T++)R.drawShape(p[T],I.get("lineColor"),void 0,I.get("lineWidth")).append();if(void 0!==I.get("normalRangeMin")&&I.get("drawNormalOnTop")&&this.drawNormalRange(n,s,A,S,r),N&&I.get("valueSpots"))for(void 0===(b=I.get("valueSpots")).get&&(b=new D(b)),T=0;T<k;T++)(w=b.get(C[T]))&&R.drawCircle(n+Math.round((x[T]-this.minx)*(S/l)),s+Math.round(A-A*((C[T]-this.miny)/r)),N,void 0,w).append();N&&I.get("spotColor")&&null!==C[a]&&R.drawCircle(n+Math.round((x[x.length-1]-this.minx)*(S/l)),s+Math.round(A-A*((C[a]-this.miny)/r)),N,void 0,I.get("spotColor")).append(),this.maxy!==this.minyorg&&(N&&I.get("minSpotColor")&&(i=x[$.inArray(this.minyorg,C)],R.drawCircle(n+Math.round((i-this.minx)*(S/l)),s+Math.round(A-A*((this.minyorg-this.miny)/r)),N,void 0,I.get("minSpotColor")).append()),N&&I.get("maxSpotColor")&&(i=x[$.inArray(this.maxyorg,C)],R.drawCircle(n+Math.round((i-this.minx)*(S/l)),s+Math.round(A-A*((this.maxyorg-this.miny)/r)),N,void 0,I.get("maxSpotColor")).append()))}}},bar:{type:"bar",init:function(e,t){var l=this.options,r=e.mergedOptions.height;e.mergedOptions.width;this.canvasWidth=e.mergedOptions.height,this.canvasHeight=e.mergedOptions.width;parseInt(l.get("barWidth"),10);var a,s,n,o,c,u,i,h,d,y,f,m,k,p,g,v,b,_,w,x=parseInt(l.get("barSpacing"),10),C=l.get("chartRangeMin"),T=l.get("chartRangeMax"),I=l.get("chartRangeClip"),R=1/0,S=-1/0;for(N=0,M=(this.values=t).length;N<M;N++)((a="string"==typeof(_=t[N])&&-1<_.indexOf(":"))||$.isArray(_))&&(k=!0,a&&(_=t[N]=j(_.split(":"))),_=z(_,null),(s=Math.min.apply(Math,_))<R&&(R=s),S<(n=Math.max.apply(Math,_))&&(S=n));this.stacked=k,this.regionShapes={},this.barWidth=Math.floor(r/t.length)-x,this.barSpacing=x,this.totalBarWidth=this.barWidth+x,this.width=r,I&&(f=void 0===C?-1/0:C,m=void 0===T?1/0:T),c=[],o=k?[]:c;for(var A=[],F=[],N=0,M=t.length;N<M;N++)if(k)for(p=t[N],t[N]=b=[],A[N]=0,g=o[N]=F[N]=0,v=p.length;g<v;g++)null!==(_=b[g]=I?E(p[g],f,m):p[g])&&(0<_&&(A[N]+=_),R<0&&0<S?_<0?F[N]+=Math.abs(_):o[N]+=_:o[N]+=Math.abs(_),c.push(_));else _=I?E(t[N],f,m):t[N],null!==(_=t[N]=O(_))&&c.push(_);this.max=y=Math.max.apply(Math,c),this.min=d=Math.min.apply(Math,c),this.stackMax=S=k?Math.max.apply(Math,A):y,this.stackMin=R=k?Math.min.apply(Math,c):d,void 0!==l.get("chartRangeMin")&&(l.get("chartRangeClip")||l.get("chartRangeMin")<d)&&(d=l.get("chartRangeMin")),void 0!==l.get("chartRangeMax")&&(l.get("chartRangeClip")||l.get("chartRangeMax")>y)&&(y=l.get("chartRangeMax")),this.zeroAxis=i=l.get("zeroAxis",!0),h=d<=0&&0<=y&&i?0:0==i?d:0<d?0:y,this.xaxisOffset=h,u=k?Math.max.apply(Math,o)+Math.max.apply(Math,F):y-h,this.canvasHeightEf=i&&d<0?this.canvasHeight-2:this.canvasHeight-1,this.isNeg=!1,d<h?(w=Math.floor(this.canvasHeight/2),this.isNeg=!0,w!==Math.ceil(w)&&(this.canvasHeightEf-=2,w=Math.ceil(w))):w=0,this.yoffset=w,$.isArray(l.get("colorMap"))?(this.colorMapByIndex=l.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=l.get("colorMap"),this.colorMapByValue&&void 0===this.colorMapByValue.get&&(this.colorMapByValue=new D(this.colorMapByValue))),this.range=u},getRegion:function(e,t,l){var r=Math.floor(t/this.totalBarWidth);return r<0||r>=this.values.length?void 0:r},getCurrentRegionFields:function(){for(var e,t=this.currentRegion,l=ensureArray(this.values[t]),r=[],a=l.length;a--;)e=l[a],r.push({isNull:null===e,value:e,color:this.calcColor(a,e,t),offset:t});return r},calcColor:function(e,t,l){var r,a=this.colorMapByIndex,s=this.colorMapByValue,n=this.options,o=this.stacked?n.get("stackedBarColor"):t<0?n.get("negBarColor"):n.get("barColor");return 0===t&&void 0!==n.get("zeroColor")&&(o=n.get("zeroColor")),s&&(r=s.get(t))?o=r:a&&a.length>l&&(o=a[l]),$.isArray(o)?o[e%o.length]:o},renderRegion:function(e,t){var l,r,a,s,n,o,c=this.values[e],u=this.options,i=this.xaxisOffset,h=[],d=this.range,y=this.stacked,f=this.target,m=e*this.totalBarWidth,k=this.canvasHeightEf,p=this.yoffset,g=(c=$.isArray(c)?c:[c]).length,v=c[0],b=x(null,c),_=x(i,c,!0);if(b)return u.get("nullColor")?(a=t?u.get("nullColor"):this.calcHighlightColor(u.get("nullColor"),u),l=0<p?p-1:p,f.drawRect(l,m,0,this.barWidth-1,a,a)):void 0;for(s=p,this.isNeg&&(k=Math.floor(k/2)),n=0;n<g;n++){if(v=c[n],y&&v===i){if(!_||o)continue;o=!0}r=0<d?Math.floor(k*(Math.abs(v-i)/d)):k,v<i||v===i&&0===p?(l=s-r,s+=r):y?(l=p,p+=r):(l=p,p-=r),a=this.calcColor(n,v,e),t&&(a=this.calcHighlightColor(a,u)),h.push(f.drawRect(l,m,r-1,this.barWidth-1,a,a))}return 1===h.length?h[0]:h}},column:{type:"column",init:function(e,t){var l=this.options,r=e.mergedOptions.width;e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height;parseInt(l.get("barWidth"),10);var a,s,n,o,c,u,i,h,d,y,f,m,k,p,g,v,b,_,w,x=parseInt(l.get("barSpacing"),10),C=l.get("chartRangeMin"),T=l.get("chartRangeMax"),I=l.get("chartRangeClip"),R=1/0,S=-1/0;for(N=0,M=(this.values=t).length;N<M;N++)((a="string"==typeof(_=t[N])&&-1<_.indexOf(":"))||$.isArray(_))&&(k=!0,a&&(_=t[N]=j(_.split(":"))),_=z(_,null),(s=Math.min.apply(Math,_))<R&&(R=s),S<(n=Math.max.apply(Math,_))&&(S=n));this.stacked=k,this.regionShapes={},this.barWidth=Math.floor(r/t.length)-x,this.barSpacing=x,this.totalBarWidth=this.barWidth+x,this.width=r,I&&(f=void 0===C?-1/0:C,m=void 0===T?1/0:T),c=[],o=k?[]:c;for(var A=[],F=[],N=0,M=t.length;N<M;N++)if(k)for(p=t[N],t[N]=b=[],A[N]=0,g=o[N]=F[N]=0,v=p.length;g<v;g++)null!==(_=b[g]=I?E(p[g],f,m):p[g])&&(0<_&&(A[N]+=_),R<0&&0<S?_<0?F[N]+=Math.abs(_):o[N]+=_:o[N]+=Math.abs(_),c.push(_));else _=I?E(t[N],f,m):t[N],null!==(_=t[N]=O(_))&&c.push(_);this.max=y=Math.max.apply(Math,c),this.min=d=Math.min.apply(Math,c),this.stackMax=S=k?Math.max.apply(Math,A):y,this.stackMin=R=k?Math.min.apply(Math,c):d,void 0!==l.get("chartRangeMin")&&(l.get("chartRangeClip")||l.get("chartRangeMin")<d)&&(d=l.get("chartRangeMin")),void 0!==l.get("chartRangeMax")&&(l.get("chartRangeClip")||l.get("chartRangeMax")>y)&&(y=l.get("chartRangeMax")),this.zeroAxis=i=l.get("zeroAxis",!0),h=d<=0&&0<=y&&i?0:0==i?d:0<d?0:y,this.xaxisOffset=h,u=k?Math.max.apply(Math,o)+Math.max.apply(Math,F):y-h,this.canvasHeightEf=i&&d<0?this.canvasHeight-2:this.canvasHeight-1,this.isNeg=!1,d<h?(w=Math.floor(this.canvasHeight/2),this.isNeg=!0,w!==Math.ceil(w)&&(this.canvasHeightEf-=2,w=Math.ceil(w))):w=this.canvasHeight,this.yoffset=w,$.isArray(l.get("colorMap"))?(this.colorMapByIndex=l.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=l.get("colorMap"),this.colorMapByValue&&void 0===this.colorMapByValue.get&&(this.colorMapByValue=new D(this.colorMapByValue))),this.range=u},getRegion:function(e,t,l){var r=Math.floor(t/this.totalBarWidth);return r<0||r>=this.values.length?void 0:r},getCurrentRegionFields:function(){for(var e,t=this.currentRegion,l=ensureArray(this.values[t]),r=[],a=l.length;a--;)e=l[a],r.push({isNull:null===e,value:e,color:this.calcColor(a,e,t),offset:t});return r},calcColor:function(e,t,l){var r,a=this.colorMapByIndex,s=this.colorMapByValue,n=this.options,o=this.stacked?n.get("stackedBarColor"):t<0?n.get("negBarColor"):n.get("barColor");return 0===t&&void 0!==n.get("zeroColor")&&(o=n.get("zeroColor")),s&&(r=s.get(t))?o=r:a&&a.length>l&&(o=a[l]),$.isArray(o)?o[e%o.length]:o},renderRegion:function(e,t){var l,r,a,s,n,o,c=this.values[e],u=this.options,i=this.xaxisOffset,h=[],d=this.range,y=this.stacked,f=this.target,m=e*this.totalBarWidth,k=this.canvasHeightEf,p=this.yoffset,g=(c=$.isArray(c)?c:[c]).length,v=c[0],b=x(null,c),_=x(i,c,!0);if(b)return u.get("nullColor")?(a=t?u.get("nullColor"):this.calcHighlightColor(u.get("nullColor"),u),l=0<p?p-1:p,f.drawRect(m,l,this.barWidth-1,0,a,a)):void 0;for(s=p,this.isNeg&&(k=Math.floor(k/2)),n=0;n<g;n++){if(v=c[n],y&&v===i){if(!_||o)continue;o=!0}r=0<d?Math.floor(k*(Math.abs(v-i)/d)):k,v<i||v===i&&0===p?(l=s,s+=r):(l=p-r,p-=r),a=this.calcColor(n,v,e),t&&(a=this.calcHighlightColor(a,u)),h.push(f.drawRect(m,l,this.barWidth-1,r-1,a,a))}return 1===h.length?h[0]:h}},tristate:{type:"tristate",init:function(e,t){var l=this.options;e.mergedOptions.width,e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height;var r=parseInt(l.get("barWidth"),10),a=parseInt(l.get("barSpacing"),10);this.regionShapes={},this.barWidth=r,this.barSpacing=a,this.totalBarWidth=r+a,this.values=$.map(t,Number),this.width=t.length*r+(t.length-1)*a,$.isArray(l.get("colorMap"))?(this.colorMapByIndex=l.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=l.get("colorMap"),this.colorMapByValue&&void 0===this.colorMapByValue.get&&(this.colorMapByValue=new D(this.colorMapByValue)))},getRegion:function(e,t,l){return Math.floor(t/this.totalBarWidth)},getCurrentRegionFields:function(){var e=this.currentRegion;return{isNull:void 0===this.values[e],value:this.values[e],color:this.calcColor(this.values[e],e),offset:e}},calcColor:function(e,t){var l,r=this.values,a=this.options,s=this.colorMapByIndex,n=this.colorMapByValue,o=n&&(l=n.get(e))?l:s&&s.length>t?s[t]:r[t]<0?a.get("negBarColor"):0<r[t]?a.get("posBarColor"):a.get("zeroBarColor");return o},renderRegion:function(e,t){var l,r=this.values,a=this.options,s=this.target,n=this.canvasHeight,o=Math.round(n/2),c=e*this.totalBarWidth,u=r[e]<0?(l=o)-1:0<r[e]?(l=0,o-1):(l=o-1,2),i=this.calcColor(r[e],e);if(null!==i)return t&&(i=this.calcHighlightColor(i,a)),s.drawRect(c,l,this.barWidth-1,u-1,i,i)}},discrete:{type:"discrete",init:function(e,t){var l=this.options,r=e.mergedOptions.width;e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height,this.regionShapes={},this.values=t=$.map(t,Number),this.min=Math.min.apply(Math,t),this.max=Math.max.apply(Math,t),this.range=this.max-this.min,this.width=r,this.interval=Math.floor(r/t.length),this.itemWidth=r/t.length,void 0!==l.get("chartRangeMin")&&(l.get("chartRangeClip")||l.get("chartRangeMin")<this.min)&&(this.min=l.get("chartRangeMin")),void 0!==l.get("chartRangeMax")&&(l.get("chartRangeClip")||l.get("chartRangeMax")>this.max)&&(this.max=l.get("chartRangeMax")),this.target&&(this.lineHeight="auto"===l.get("lineHeight")?Math.round(.3*this.canvasHeight):l.get("lineHeight"))},getRegion:function(e,t,l){return Math.floor(t/this.itemWidth)},getCurrentRegionFields:function(){var e=this.currentRegion;return{isNull:void 0===this.values[e],value:this.values[e],offset:e}},renderRegion:function(e,t){var l=this.values,r=this.options,a=this.min,s=this.max,n=this.range,o=this.interval,c=(this.target,this.canvasHeight),u=this.lineHeight,i=c-u,h=E(l[e],a,s),d=e*o,y=Math.round(i-(h-a)/n*i),f=r.get("thresholdColor")&&h<r.get("thresholdValue")?r.get("thresholdColor"):r.get("lineColor");return t&&(f=this.calcHighlightColor(f,r)),this.target.drawRect(d,y,o<=2?1:o-2,u,f,f)}},bullet:{type:"bullet",init:function(e,t){var l,r,a,s=this.options,n=e.mergedOptions.width;e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height,this.values=t=j(t),(a=t.slice())[0]=null===a[0]?a[2]:a[0],a[1]=null===t[1]?a[2]:a[1],l=Math.min.apply(Math,t),r=Math.max.apply(Math,t),l=void 0===s.get("base")?l<0?l:0:s.get("base"),this.min=l,this.max=r,this.range=r-l,this.shapes={},this.valueShapes={},this.regiondata={},this.width=n,t.length||(this.disabled=!0)},getRegion:function(e,t,l){var r=this.target.getShapeAt(e,t,l);return void 0!==r&&void 0!==this.shapes[r]?this.shapes[r]:void 0},getCurrentRegionFields:function(){var e=this.currentRegion;return{fieldkey:e.substr(0,1),value:this.values[e.substr(1)],region:e}},changeHighlight:function(e){var t,l=this.currentRegion,r=this.valueShapes[l];switch(delete this.shapes[r],l.substr(0,1)){case"r":t=this.renderRange(l.substr(1),e);break;case"p":t=this.renderPerformance(e);break;case"t":t=this.renderTarget(e)}this.valueShapes[l]=t.id,this.shapes[t.id]=l,this.target.replaceWithShape(r,t)},renderRange:function(e,t){var l=this.values[e],r=Math.round(this.canvasWidth*((l-this.min)/this.range)),a=this.options.get("rangeColors")[e-2];return t&&(a=this.calcHighlightColor(a,this.options)),this.target.drawRect(0,0,r-1,this.canvasHeight-1,a,a)},renderPerformance:function(e){var t=this.values[1],l=Math.round(this.canvasWidth*((t-this.min)/this.range)),r=this.options.get("performanceColor");return e&&(r=this.calcHighlightColor(r,this.options)),this.target.drawRect(0,Math.round(.3*this.canvasHeight),l-1,Math.round(.4*this.canvasHeight)-1,r,r)},renderTarget:function(e){var t=this.values[0],l=Math.round(this.canvasWidth*((t-this.min)/this.range)-this.options.get("targetWidth")/2),r=Math.round(.1*this.canvasHeight),a=this.canvasHeight-2*r,s=this.options.get("targetColor");return e&&(s=this.calcHighlightColor(s,this.options)),this.target.drawRect(l,r,this.options.get("targetWidth")-1,a-1,s,s)},render:function(e,t){this.init(e,t);for(var l,r=this.values.length,a=(this.target,2);a<r;a++)l=this.renderRange(a).append(),this.shapes[l.id]="r"+a,this.valueShapes["r"+a]=l.id;null!==this.values[1]&&(l=this.renderPerformance().append(),this.shapes[l.id]="p1",this.valueShapes.p1=l.id),null!==this.values[0]&&(l=this.renderTarget().append(),this.shapes[l.id]="t0",this.valueShapes.t0=l.id)}},pie:{type:"pie",init:function(e,t){var l=this.options;e.mergedOptions.width,e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height;var r,a=0;if(this.shapes={},this.valueShapes={},this.values=t=$.map(t,Number),"auto"===l.get("width")&&(this.width=this.height),0<t.length)for(r=t.length;r--;)a+=t[r];this.total=a,this.radius=Math.floor(Math.min(this.canvasWidth,this.canvasHeight)/2)},getRegion:function(e,t,l){var r=this.target.getShapeAt(e,t,l);return void 0!==r&&void 0!==this.shapes[r]?this.shapes[r]:void 0},getCurrentRegionFields:function(){var e=this.currentRegion;return{isNull:void 0===this.values[e],value:this.values[e],percent:this.values[e]/this.total*100,color:this.options.get("sliceColors")[e%this.options.get("sliceColors").length],offset:e}},changeHighlight:function(e){var t=this.currentRegion,l=this.renderSlice(t,e),r=this.valueShapes[t];delete this.shapes[r],this.target.replaceWithShape(r,l),this.valueShapes[t]=l.id,this.shapes[l.id]=t},renderSlice:function(e,t){for(var l,r,a,s=this.target,n=this.options,o=this.radius,c=n.get("borderWidth"),u=n.get("offset"),i=2*Math.PI,h=this.values,d=this.total,y=u?2*Math.PI*(u/360):0,f=h.length,m=0;m<f;m++){if(r=l=y,0<d&&(r=y+i*(h[m]/d)),e===m)return a=n.get("sliceColors")[m%n.get("sliceColors").length],t&&(a=this.calcHighlightColor(a,n)),s.drawPieSlice(o,o,o-c,l,r,void 0,a);y=r}},render:function(e,t){this.init(e,t);var l,r,a=this.target,s=this.values,n=this.options,o=this.radius,c=n.get("borderWidth");for(c&&a.drawCircle(o,o,Math.floor(o-c/2),n.get("borderColor"),void 0,c).append(),r=s.length;r--;)s[r]&&(l=this.renderSlice(r).append(),this.valueShapes[r]=l.id,this.shapes[l.id]=r)}},box:{type:"box",init:function(e,t){var l=this.options,r=e.mergedOptions.width;e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height,this.values=$.map(t,Number),this.width="auto"===l.get("width")?"4.0em":r,this.values.length||(this.disabled=1)},getRegion:function(){return 1},getCurrentRegionFields:function(){var e=[{field:"lq",value:this.quartiles[0]},{field:"med",value:this.quartiles[1]},{field:"uq",value:this.quartiles[2]}];return void 0!==this.loutlier&&e.push({field:"lo",value:this.loutlier}),void 0!==this.routlier&&e.push({field:"ro",value:this.routlier}),void 0!==this.lwhisker&&e.push({field:"lw",value:this.lwhisker}),void 0!==this.rwhisker&&e.push({field:"rw",value:this.rwhisker}),e},render:function(e,t){this.init(e,t);var l,r,a,s,n,o,c,u,i,h,d,y=this.target,f=this.values,m=f.length,k=this.options,p=this.canvasWidth,g=this.canvasHeight,v=void 0===k.get("chartRangeMin")?Math.min.apply(Math,f):k.get("chartRangeMin"),b=void 0===k.get("chartRangeMax")?Math.max.apply(Math,f):k.get("chartRangeMax"),_=0;if(k.get("raw"))k.get("showOutliers")&&5<f.length?(r=f[0],l=f[1],s=f[2],n=f[3],o=f[4],c=f[5],u=f[6]):(l=f[0],s=f[1],n=f[2],o=f[3],c=f[4]);else if(f.sort(function(e,t){return e-t}),s=w(f,1),n=w(f,2),a=(o=w(f,3))-s,k.get("showOutliers")){for(l=c=void 0,i=0;i<m;i++)void 0===l&&f[i]>s-a*k.get("outlierIQR")&&(l=f[i]),f[i]<o+a*k.get("outlierIQR")&&(c=f[i]);r=f[0],u=f[m-1]}else l=f[0],c=f[m-1];this.quartiles=[s,n,o],this.lwhisker=l,this.rwhisker=c,this.loutlier=r,this.routlier=u,d=p/(b-v+1),k.get("showOutliers")&&(_=Math.ceil(k.get("spotRadius")),d=(p-=2*Math.ceil(k.get("spotRadius")))/(b-v+1),r<l&&y.drawCircle((r-v)*d+_,g/2,k.get("spotRadius"),k.get("outlierLineColor"),k.get("outlierFillColor")).append(),c<u&&y.drawCircle((u-v)*d+_,g/2,k.get("spotRadius"),k.get("outlierLineColor"),k.get("outlierFillColor")).append()),y.drawRect(Math.round((s-v)*d+_),Math.round(.1*g),Math.round((o-s)*d),Math.round(.8*g),k.get("boxLineColor"),k.get("boxFillColor")).append(),y.drawLine(Math.round((l-v)*d+_),Math.round(g/2),Math.round((s-v)*d+_),Math.round(g/2),k.get("lineColor")).append(),y.drawLine(Math.round((l-v)*d+_),Math.round(g/4),Math.round((l-v)*d+_),Math.round(g-g/4),k.get("whiskerColor")).append(),y.drawLine(Math.round((c-v)*d+_),Math.round(g/2),Math.round((o-v)*d+_),Math.round(g/2),k.get("lineColor")).append(),y.drawLine(Math.round((c-v)*d+_),Math.round(g/4),Math.round((c-v)*d+_),Math.round(g-g/4),k.get("whiskerColor")).append(),y.drawLine(Math.round((n-v)*d+_),Math.round(.1*g),Math.round((n-v)*d+_),Math.round(.9*g),k.get("medianColor")).append(),k.get("target")&&(h=Math.ceil(k.get("spotRadius")),y.drawLine(Math.round((k.get("target")-v)*d+_),Math.round(g/2-h),Math.round((k.get("target")-v)*d+_),Math.round(g/2+h),k.get("targetColor")).append(),y.drawLine(Math.round((k.get("target")-v)*d+_-h),Math.round(g/2),Math.round((k.get("target")-v)*d+_+h),Math.round(g/2),k.get("targetColor")).append())}},shapeCount:0,shapes:{},shapeseq:[],lastShapeId:null,mergedOptions:null,init:function(e,t){var t=t||{},l=this,r=this.defaultOption,a=r.common,s=r[t.type||a.type];return l.shapeCount=0,l.shapes={},l.shapeseq=[],l.lastShapeId=null,l.mergedOptions=$.extend({},a,s,t),l.mergedOptions.width=devicePixelRatio*l.mergedOptions.width,l.mergedOptions.height=devicePixelRatio*l.mergedOptions.height,l[l.mergedOptions.type].render(l,e),{shapes:l.shapes,shapeseq:l.shapeseq,offsetX:l.mergedOptions.offsetX,offsetY:l.mergedOptions.offsetY,pixelWidth:l.mergedOptions.width,pixelHeight:l.mergedOptions.height}},_getContext:function(e,t,l){var r;return r=null!=this.ctx?this.ctx:$("#"+this._canvasID).get(0).getContext("2d"),void 0!==e&&(r.strokeStyle=e),r.lineWidth=void 0===l?1:l,void 0!==t&&(r.fillStyle=t),r},reset:function(){this._getContext().clearRect(0,0,this.pixelWidth,this.pixelHeight),this.shapes={},this.shapeseq=[],this.currentTargetShapeId=void 0},_drawShape:function(e,t,l,r,a){var s,n,o=this._getContext(l,r,a);for(o.beginPath(),o.moveTo(t[0][0]+.5+this.offsetX,t[0][1]+.5+this.offsetY),s=1,n=t.length;s<n;s++)o.lineTo(t[s][0]+.5+this.offsetX,t[s][1]+.5+this.offsetY);void 0!==l&&o.stroke(),void 0!==r&&o.fill(),void 0!==this.targetX&&void 0!==this.targetY&&o.isPointInPath(this.targetX+this.offsetX,this.targetY+this.offsetY)&&(this.currentTargetShapeId=e)},_drawCircle:function(e,t,l,r,a,s,n){var o=this._getContext(a,s,n);o.beginPath(),t+=this.offsetX,l+=this.offsetY,o.arc(t,l,r,0,2*Math.PI,!1),void 0!==this.targetX&&void 0!==this.targetY&&o.isPointInPath(this.targetX+this.offsetX,this.targetY+this.offsetY)&&(this.currentTargetShapeId=e),void 0!==a&&o.stroke(),void 0!==s&&o.fill()},_drawPieSlice:function(e,t,l,r,a,s,n,o){var c=this._getContext(n,o);t+=this.offsetX,l+=this.offsetY,c.beginPath(),c.moveTo(t,l),c.arc(t,l,r,a,s,!1),c.lineTo(t,l),c.closePath(),void 0!==n&&c.stroke(),o&&c.fill(),void 0!==this.targetX&&void 0!==this.targetY&&c.isPointInPath(this.targetX+this.offsetX,this.targetY+this.offsetY)&&(this.currentTargetShapeId=e)},_drawRect:function(e,t,l,r,a,s,n){return this._drawShape(e,[[t,l],[t+r,l],[t+r,l+a],[t,l+a],[t,l]],s,n)},appendShape:function(e){return this.shapes[e.id]=e,this.shapeseq.push(e.id),this.lastShapeId=e.id,e.id},replaceWithShape:function(e,t){var l,r=this.shapeseq;for(this.shapes[t.id]=t,l=r.length;l--;)r[l]==e&&(r[l]=t.id);delete this.shapes[e]},replaceWithShapes:function(e,t){for(var l,r,a=this.shapeseq,s={},n=e.length;n--;)s[e[n]]=!0;for(n=a.length;n--;)s[l=a[n]]&&(a.splice(n,1),delete this.shapes[l],r=n);for(n=t.length;n--;)a.splice(r,0,t[n].id),this.shapes[t[n].id]=t[n]},insertAfterShape:function(e,t){for(var l=this.shapeseq,r=l.length;r--;)if(l[r]===e)return l.splice(r+1,0,t.id),void(this.shapes[t.id]=t)},removeShapeId:function(e){for(var t=this.shapeseq,l=t.length;l--;)if(t[l]===e){t.splice(l,1);break}delete this.shapes[e]},getShapeAt:function(e,t,l){return this.targetX=t,this.targetY=l,this.render(),this.currentTargetShapeId},_canvasID:"luckysheetTableContent",render:function(e,t,l,r,a,s,n,o){null==n&&(n="luckysheetTableContent"),this._canvasID=n,null!=o&&(this.ctx=o);var c,u,i=e.length;this._getContext();for(this.offsetX=l,this.offsetY=r,this.pixelWidth=a,this.pixelHeight=s,u=0;u<i;u++)this["_draw"+(c=t[e[u]]).type].apply(this,c.args)},drawLine:function(e,t,l,r,a,s){return this.drawShape([[e,t],[l,r]],a,s)},drawShape:function(e,t,l,r){return this._genShape("Shape",[e,t,l,r])},drawCircle:function(e,t,l,r,a,s){return this._genShape("Circle",[e,t,l,r,a,s])},drawPieSlice:function(e,t,l,r,a,s,n){return this._genShape("PieSlice",[e,t,l,r,a,s,n])},drawRect:function(e,t,l,r,a,s){return this._genShape("Rect",[e,t,l,r,a,s])},_genShape:function(e,t){var l=this.shapeCount++;t.unshift(l);var r={id:l,type:e,args:t};return this.shapes[l]=r,this.shapeseq.push(l),this.lastShapeId=l,{append:function(){return r},get:function(){return l}}}};var t=function(e){var t,l=this.currentRegion,r=this.target,a=this.regionShapes[l];a&&(t=this.renderRegion(l,e),$.isArray(t)||$.isArray(a)?(r.replaceWithShapes(a,t),this.regionShapes[l]=$.map(t,function(e){return e.id})):(r.replaceWithShape(a,t),this.regionShapes[l]=t.id))},r=function(e,t){this.init(e,t);for(var l,r,a,s=this.values,n=(this.target,this.regionShapes),o=s.length;o--;)if(l=this.renderRegion(o))if($.isArray(l)){for(r=[],a=l.length;a--;)l[a].append(),r.push(l[a].id);n[o]=r}else l.append(),n[o]=l.id;else n[o]=null},a={get:function(e){return luckysheet.sparkline.mergedOptions[e]}},s={drawLine:function(e,t,l,r,a,s){return luckysheet.sparkline.drawLine(e,t,l,r,a,s)},drawShape:function(e,t,l,r){return luckysheet.sparkline.drawShape(e,t,l,r)},drawCircle:function(e,t,l,r,a,s){return luckysheet.sparkline.drawCircle(e,t,l,r,a,s)},drawPieSlice:function(e,t,l,r,a,s,n){return luckysheet.sparkline.drawPieSlice(e,t,l,r,a,s,n)},drawRect:function(e,t,l,r,a,s){return luckysheet.sparkline.drawRect(e,t,l,r,a,s)}};for(item in luckysheet.sparkline)item in{line:null,bar:null,column:null,tristate:null,discrete:null,bullet:null,pie:null,box:null}&&(luckysheet.sparkline[item].options=a,luckysheet.sparkline[item].target=s),item in{bar:null,column:null,tristate:null,discrete:null}&&(luckysheet.sparkline[item].changeHighlight=t,luckysheet.sparkline[item].render=r)}(),window.luckysheet=luckysheet,window.luckysheetConfigsetting=luckysheetConfigsetting}(),function(luckysheet){window.luckysheet_compareWith=function(){var sp=arguments[1],data_fp=arguments[0],fp;"object"==luckysheet.getObjType(data_fp)&&null!=data_fp.startCell?(fp="&"==sp?luckysheet.func_methods.getCellDataDyadicArr(data_fp,"text"):luckysheet.func_methods.getCellDataDyadicArr(data_fp,"number"),1==fp.length&&1==fp[0].length&&(fp=fp[0][0])):fp=data_fp;var data_tp=arguments[2],tp,result,result,result,result,result,result,result,result;if("object"==luckysheet.getObjType(data_tp)&&null!=data_tp.startCell?(tp="&"==sp?luckysheet.func_methods.getCellDataDyadicArr(data_tp,"text"):luckysheet.func_methods.getCellDataDyadicArr(data_tp,"number"),1==tp.length&&1==tp[0].length&&(tp=tp[0][0])):tp=data_tp,luckysheet.func_methods.valueIsError(fp))return fp;if(luckysheet.func_methods.valueIsError(tp))return tp;if("array"==luckysheet.getObjType(fp)&&"array"==luckysheet.getObjType(fp[0])&&!luckysheet.func_methods.isDyadicArr(fp))return luckysheet.formula.error.v;if("array"==luckysheet.getObjType(tp)&&"array"==luckysheet.getObjType(tp[0])&&!luckysheet.func_methods.isDyadicArr(tp))return luckysheet.formula.error.v;function booleanOperation(e,t,l){return luckysheet.func_methods.isRealNum(e)&&(e=parseFloat(e)),luckysheet.func_methods.isRealNum(l)&&(l=parseFloat(l)),"=="==t?e==l:"!="==t?e!=l:">="==t?l<=e:"<="==t?e<=l:">"==t?l<e:"<"==t?e<l:void 0}function booleanToNum(e){return null==e?e:"true"==e.toString().toLowerCase()?1:"false"==e.toString().toLowerCase()?0:e}if("<>"==sp&&(sp="!="),"="==sp&&(sp="=="),"-"==sp&&null==fp&&(fp=0),"*"==sp){if("array"==luckysheet.getObjType(fp)&&"array"==luckysheet.getObjType(tp)){var result=[];if("array"==luckysheet.getObjType(fp[0])&&"array"==luckysheet.getObjType(tp[0]))if(fp.length==tp.length&&fp[0].length==tp[0].length)for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0,value,value;n<fp[m].length;n++){fp[m][n]=booleanToNum(fp[m][n]),tp[m][n]=booleanToNum(tp[m][n]),value=luckysheet.func_methods.isRealNum(fp[m][n])&&luckysheet.func_methods.isRealNum(tp[m][n])?parseFloat(fp[m][n])*parseFloat(tp[m][n]):luckysheet.formula.error.v,rowArr.push(value)}result.push(rowArr)}else if(fp[0].length==tp.length)for(var rowlen=fp.length,collen=tp[0].length,m=0;m<rowlen;m++){for(var rowArr=[],n=0;n<collen;n++){for(var value=0,p=0;p<fp[0].length;p++)fp[m][p]=booleanToNum(fp[m][p]),tp[p][n]=booleanToNum(tp[p][n]),luckysheet.func_methods.isRealNum(fp[m][p])&&luckysheet.func_methods.isRealNum(tp[p][n])?value+=parseFloat(fp[m][p])*parseFloat(tp[p][n]):value+=luckysheet.formula.error.v;"NaN"==value.toString()&&(value=luckysheet.formula.error.v),rowArr.push(value)}result.push(rowArr)}else{if(fp.length!=tp[0].length)return luckysheet.formula.error.na;for(var rowlen=tp.length,collen=fp[0].length,m=0;m<rowlen;m++){for(var rowArr=[],n=0;n<collen;n++){for(var value=0,p=0;p<tp[0].length;p++)fp[p][n]=booleanToNum(fp[p][n]),tp[m][p]=booleanToNum(tp[m][p]),luckysheet.func_methods.isRealNum(tp[m][p])&&luckysheet.func_methods.isRealNum(fp[p][n])?value+=parseFloat(tp[m][p])*parseFloat(fp[p][n]):value+=luckysheet.formula.error.v;"NaN"==value.toString()&&(value=luckysheet.formula.error.v),rowArr.push(value)}result.push(rowArr)}}else if("array"==luckysheet.getObjType(fp[0]))if(fp[0].length==tp.length)for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0,value,value;n<fp[m].length;n++){fp[m][n]=booleanToNum(fp[m][n]),tp[n]=booleanToNum(tp[n]),value=luckysheet.func_methods.isRealNum(fp[m][n])&&luckysheet.func_methods.isRealNum(tp[n])?parseFloat(fp[m][n])*parseFloat(tp[n]):luckysheet.formula.error.v,rowArr.push(value)}result.push(rowArr)}else{if(1!=fp[0].length)return luckysheet.formula.error.na;for(var rowlen=fp.length,collen=tp.length,m=0;m<rowlen;m++){for(var rowArr=[],n=0,value,value;n<collen;n++){fp[m][0]=booleanToNum(fp[m][0]),tp[n]=booleanToNum(tp[n]),value=luckysheet.func_methods.isRealNum(fp[m][0])&&luckysheet.func_methods.isRealNum(tp[n])?parseFloat(fp[m][0])*parseFloat(tp[n]):luckysheet.formula.error.v,rowArr.push(value)}result.push(rowArr)}}else if("array"==luckysheet.getObjType(tp[0]))if(tp[0].length==fp.length)for(var m=0;m<tp.length;m++){for(var rowArr=[],n=0,value,value;n<tp[m].length;n++){fp[n]=booleanToNum(fp[n]),tp[m][n]=booleanToNum(tp[m][n]),value=luckysheet.func_methods.isRealNum(fp[n])&&luckysheet.func_methods.isRealNum(tp[m][n])?parseFloat(fp[n])*parseFloat(tp[m][n]):luckysheet.formula.error.v,rowArr.push(value)}result.push(rowArr)}else{if(1!=tp[0].length)return luckysheet.formula.error.na;for(var rowlen=tp.length,collen=fp.length,m=0;m<rowlen;m++){for(var rowArr=[],n=0,value,value;n<collen;n++){fp[n]=booleanToNum(fp[n]),tp[m][0]=booleanToNum(tp[m][0]),value=luckysheet.func_methods.isRealNum(fp[n])&&luckysheet.func_methods.isRealNum(tp[m][0])?parseFloat(fp[n])*parseFloat(tp[m][0]):luckysheet.formula.error.v,rowArr.push(value)}result.push(rowArr)}}else{if(fp.length!=tp.length)return luckysheet.formula.error.na;for(var n=0,value,value;n<fp.length;n++){fp[n]=booleanToNum(fp[n]),tp[n]=booleanToNum(tp[n]),value=luckysheet.func_methods.isRealNum(fp[n])&&luckysheet.func_methods.isRealNum(tp[n])?parseFloat(fp[n])*parseFloat(tp[n]):luckysheet.formula.error.v,result.push(value)}}return result}if("array"==luckysheet.getObjType(fp)){tp=booleanToNum(tp);var result=[];if("array"==luckysheet.getObjType(fp[0]))for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0,value,value;n<fp[m].length;n++){fp[m][n]=booleanToNum(fp[m][n]),value=luckysheet.func_methods.isRealNum(fp[m][n])&&luckysheet.func_methods.isRealNum(tp)?parseFloat(fp[m][n])*parseFloat(tp):luckysheet.formula.error.v,rowArr.push(value)}result.push(rowArr)}else for(var n=0,value,value;n<fp.length;n++){fp[n]=booleanToNum(fp[n]),value=luckysheet.func_methods.isRealNum(fp[n])&&luckysheet.func_methods.isRealNum(tp)?parseFloat(fp[n])*parseFloat(tp):luckysheet.formula.error.v,result.push(value)}return result}if("array"==luckysheet.getObjType(tp)){fp=booleanToNum(fp);var result=[];if("array"==luckysheet.getObjType(tp[0]))for(var m=0;m<tp.length;m++){for(var rowArr=[],n=0,value,value;n<tp[m].length;n++){tp[m][n]=booleanToNum(tp[m][n]),value=luckysheet.func_methods.isRealNum(fp)&&luckysheet.func_methods.isRealNum(tp[m][n])?parseFloat(fp)*parseFloat(tp[m][n]):luckysheet.formula.error.v,rowArr.push(value)}result.push(rowArr)}else for(var n=0,value,value;n<tp.length;n++){tp[n]=booleanToNum(tp[n]),value=luckysheet.func_methods.isRealNum(fp)&&luckysheet.func_methods.isRealNum(tp[n])?parseFloat(fp)*parseFloat(tp[n]):luckysheet.formula.error.v,result.push(value)}return result}var result,result,fp=booleanToNum(fp),tp=booleanToNum(tp);return result=luckysheet.func_methods.isRealNum(fp)&&luckysheet.func_methods.isRealNum(tp)?parseFloat(fp)*parseFloat(tp):luckysheet.formula.error.v,result}if("/"==sp){if("array"==luckysheet.getObjType(fp)&&"array"==luckysheet.getObjType(tp)){var result=[];if("array"==luckysheet.getObjType(fp[0])&&"array"==luckysheet.getObjType(tp[0]))if(fp.length==tp.length&&fp[0].length==tp[0].length)for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0,value,value,value;n<fp[m].length;n++){fp[m][n]=booleanToNum(fp[m][n]),tp[m][n]=booleanToNum(tp[m][n]),value=luckysheet.func_methods.isRealNum(fp[m][n])&&luckysheet.func_methods.isRealNum(tp[m][n])?0==parseFloat(tp[m][n])?luckysheet.formula.error.d:parseFloat(fp[m][n])/parseFloat(tp[m][n]):luckysheet.formula.error.v,rowArr.push(value)}result.push(rowArr)}else{if(fp[0].length!=tp.length)return luckysheet.formula.error.na;for(var tp_inverse=luckysheet.matrix_methods.inverse(tp),rowlen=fp.length,collen=tp_inverse[0].length,m=0;m<rowlen;m++){for(var rowArr=[],n=0;n<collen;n++){for(var value=0,p=0;p<fp[0].length;p++)fp[m][p]=booleanToNum(fp[m][p]),tp_inverse[p][n]=booleanToNum(tp_inverse[p][n]),luckysheet.func_methods.isRealNum(fp[m][p])&&luckysheet.func_methods.isRealNum(tp_inverse[p][n])?value+=parseFloat(fp[m][p])*parseFloat(tp_inverse[p][n]):value+=luckysheet.formula.error.v;"NaN"==value.toString()&&(value=luckysheet.formula.error.v),rowArr.push(value)}result.push(rowArr)}}else if("array"==luckysheet.getObjType(fp[0]))if(fp[0].length==tp.length)for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0,value,value,value;n<fp[m].length;n++){fp[m][n]=booleanToNum(fp[m][n]),tp[n]=booleanToNum(tp[n]),value=luckysheet.func_methods.isRealNum(fp[m][n])&&luckysheet.func_methods.isRealNum(tp[n])?0==parseFloat(tp[n])?luckysheet.formula.error.d:parseFloat(fp[m][n])/parseFloat(tp[n]):luckysheet.formula.error.v,rowArr.push(value)}result.push(rowArr)}else{if(1!=fp[0].length)return luckysheet.formula.error.na;for(var rowlen=fp.length,collen=tp.length,m=0;m<rowlen;m++){for(var rowArr=[],n=0,value,value,value;n<collen;n++){fp[m][0]=booleanToNum(fp[m][0]),tp[n]=booleanToNum(tp[n]),value=luckysheet.func_methods.isRealNum(fp[m][0])&&luckysheet.func_methods.isRealNum(tp[n])?0==parseFloat(tp[n])?luckysheet.formula.error.d:parseFloat(fp[m][0])/parseFloat(tp[n]):luckysheet.formula.error.v,rowArr.push(value)}result.push(rowArr)}}else if("array"==luckysheet.getObjType(tp[0]))if(tp[0].length==fp.length)for(var m=0;m<tp.length;m++){for(var rowArr=[],n=0,value,value,value;n<tp[m].length;n++){fp[n]=booleanToNum(fp[n]),tp[m][n]=booleanToNum(tp[m][n]),value=luckysheet.func_methods.isRealNum(fp[n])&&luckysheet.func_methods.isRealNum(tp[m][n])?0==parseFloat(tp[m][n])?luckysheet.formula.error.d:parseFloat(fp[n])/parseFloat(tp[m][n]):luckysheet.formula.error.v,rowArr.push(value)}result.push(rowArr)}else{if(1!=tp[0].length)return luckysheet.formula.error.na;for(var rowlen=tp.length,collen=fp.length,m=0;m<rowlen;m++){for(var rowArr=[],n=0,value,value,value;n<collen;n++){fp[n]=booleanToNum(fp[n]),tp[m][0]=booleanToNum(tp[m][0]),value=luckysheet.func_methods.isRealNum(fp[n])&&luckysheet.func_methods.isRealNum(tp[m][0])?0==parseFloat(tp[m][0])?luckysheet.formula.error.d:parseFloat(fp[n])/parseFloat(tp[m][0]):luckysheet.formula.error.v,rowArr.push(value)}result.push(rowArr)}}else{if(fp.length!=tp.length)return luckysheet.formula.error.na;for(var n=0,value,value,value;n<fp.length;n++){fp[n]=booleanToNum(fp[n]),tp[n]=booleanToNum(tp[n]),value=luckysheet.func_methods.isRealNum(fp[n])&&luckysheet.func_methods.isRealNum(tp[n])?0==parseFloat(tp[n])?luckysheet.formula.error.d:parseFloat(fp[n])/parseFloat(tp[n]):luckysheet.formula.error.v,result.push(value)}}return result}if("array"==luckysheet.getObjType(fp)){tp=booleanToNum(tp);var result=[];if("array"==luckysheet.getObjType(fp[0]))for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0,value,value,value;n<fp[m].length;n++){fp[m][n]=booleanToNum(fp[m][n]),value=luckysheet.func_methods.isRealNum(fp[m][n])&&luckysheet.func_methods.isRealNum(tp)?0==parseFloat(tp)?luckysheet.formula.error.d:parseFloat(fp[m][n])/parseFloat(tp):luckysheet.formula.error.v,rowArr.push(value)}result.push(rowArr)}else for(var n=0,value,value,value;n<fp.length;n++){fp[n]=booleanToNum(fp[n]),value=luckysheet.func_methods.isRealNum(fp[n])&&luckysheet.func_methods.isRealNum(tp)?0==parseFloat(tp)?luckysheet.formula.error.d:parseFloat(fp[n])/parseFloat(tp):luckysheet.formula.error.v,result.push(value)}return result}if("array"!=luckysheet.getObjType(tp))return fp=booleanToNum(fp),tp=booleanToNum(tp),result=luckysheet.func_methods.isRealNum(fp)&&luckysheet.func_methods.isRealNum(tp)?0==parseFloat(tp)?luckysheet.formula.error.d:parseFloat(fp)/parseFloat(tp):luckysheet.formula.error.v,result;fp=booleanToNum(fp);var result=[];if("array"==luckysheet.getObjType(tp[0]))for(var m=0;m<tp.length;m++){for(var rowArr=[],n=0,value,value,value;n<tp[m].length;n++){tp[m][n]=booleanToNum(tp[m][n]),value=luckysheet.func_methods.isRealNum(fp)&&luckysheet.func_methods.isRealNum(tp[m][n])?0==parseFloat(tp[m][n])?luckysheet.formula.error.d:parseFloat(fp)/parseFloat(tp[m][n]):luckysheet.formula.error.v,rowArr.push(value)}result.push(rowArr)}else for(var n=0,value,value,value;n<tp.length;n++){tp[n]=booleanToNum(tp[n]),value=luckysheet.func_methods.isRealNum(fp)&&luckysheet.func_methods.isRealNum(tp[n])?0==parseFloat(tp[n])?luckysheet.formula.error.d:parseFloat(fp)/parseFloat(tp[n]):luckysheet.formula.error.v,result.push(value)}return result}if("+"==sp||"-"==sp||"%"==sp){if("array"==luckysheet.getObjType(fp)&&"array"==luckysheet.getObjType(tp)){var result=[];if("array"==luckysheet.getObjType(fp[0])&&"array"==luckysheet.getObjType(tp[0])){if(fp.length!=tp.length&&fp[0].length!=tp[0].length)return luckysheet.formula.error.na;for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0,value,value,value;n<fp[m].length;n++){fp[m][n]=booleanToNum(fp[m][n]),tp[m][n]=booleanToNum(tp[m][n]),value=luckysheet.func_methods.isRealNum(fp[m][n])&&luckysheet.func_methods.isRealNum(tp[m][n])?"%"==sp&&0==parseFloat(tp[m][n])?luckysheet.formula.error.d:eval(parseFloat(fp[m][n])+sp+parseFloat(tp[m][n])):luckysheet.formula.error.v,rowArr.push(value)}result.push(rowArr)}}else if("array"==luckysheet.getObjType(fp[0])){if(fp[0].length!=tp.length)return luckysheet.formula.error.na;for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0,value,value,value;n<fp[m].length;n++){fp[m][n]=booleanToNum(fp[m][n]),tp[n]=booleanToNum(tp[n]),value=luckysheet.func_methods.isRealNum(fp[m][n])&&luckysheet.func_methods.isRealNum(tp[n])?"%"==sp&&0==parseFloat(tp[n])?luckysheet.formula.error.d:eval(parseFloat(fp[m][n])+sp+parseFloat(tp[n])):luckysheet.formula.error.v,rowArr.push(value)}result.push(rowArr)}}else if("array"==luckysheet.getObjType(tp[0])){if(tp[0].length!=fp.length)return luckysheet.formula.error.na;for(var m=0;m<tp.length;m++){for(var rowArr=[],n=0,value,value,value;n<tp[m].length;n++){fp[n]=booleanToNum(fp[n]),tp[m][n]=booleanToNum(tp[m][n]),value=luckysheet.func_methods.isRealNum(fp[n])&&luckysheet.func_methods.isRealNum(tp[m][n])?"%"==sp&&0==parseFloat(tp[m][n])?luckysheet.formula.error.d:eval(parseFloat(fp[n])+sp+parseFloat(tp[m][n])):luckysheet.formula.error.v,rowArr.push(value)}result.push(rowArr)}}else{if(fp.length!=tp.length)return luckysheet.formula.error.na;for(var n=0,value,value,value;n<fp.length;n++){fp[n]=booleanToNum(fp[n]),tp[n]=booleanToNum(tp[n]),value=luckysheet.func_methods.isRealNum(fp[n])&&luckysheet.func_methods.isRealNum(tp[n])?"%"==sp&&0==parseFloat(tp[n])?luckysheet.formula.error.d:eval(parseFloat(fp[n])+sp+parseFloat(tp[n])):luckysheet.formula.error.v,result.push(value)}}return result}if("array"==luckysheet.getObjType(fp)){tp=booleanToNum(tp);var result=[];if("array"==luckysheet.getObjType(fp[0]))for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0,value,value,value;n<fp[m].length;n++){fp[m][n]=booleanToNum(fp[m][n]),value=luckysheet.func_methods.isRealNum(fp[m][n])&&luckysheet.func_methods.isRealNum(tp)?"%"==sp&&0==parseFloat(tp)?luckysheet.formula.error.d:eval(parseFloat(fp[m][n])+sp+parseFloat(tp)):luckysheet.formula.error.v,rowArr.push(value)}result.push(rowArr)}else for(var n=0,value,value,value;n<fp.length;n++){fp[n]=booleanToNum(fp[n]),value=luckysheet.func_methods.isRealNum(fp[n])&&luckysheet.func_methods.isRealNum(tp)?"%"==sp&&0==parseFloat(tp)?luckysheet.formula.error.d:eval(parseFloat(fp[n])+sp+parseFloat(tp)):luckysheet.formula.error.v,result.push(value)}return result}if("array"!=luckysheet.getObjType(tp))return fp=booleanToNum(fp),tp=booleanToNum(tp),result=luckysheet.func_methods.isRealNum(fp)&&luckysheet.func_methods.isRealNum(tp)?"%"==sp&&0==parseFloat(tp)?luckysheet.formula.error.d:eval(parseFloat(fp)+sp+parseFloat(tp)):luckysheet.formula.error.v,result;fp=booleanToNum(fp);var result=[];if("array"==luckysheet.getObjType(tp[0]))for(var m=0;m<tp.length;m++){for(var rowArr=[],n=0,value,value,value;n<tp[m].length;n++){tp[m][n]=booleanToNum(tp[m][n]),value=luckysheet.func_methods.isRealNum(fp)&&luckysheet.func_methods.isRealNum(tp[m][n])?"%"==sp&&0==parseFloat(tp[m][n])?luckysheet.formula.error.d:eval(parseFloat(fp)+sp+parseFloat(tp[m][n])):luckysheet.formula.error.v,rowArr.push(value)}result.push(rowArr)}else for(var n=0,value,value,value;n<tp.length;n++){tp[n]=booleanToNum(tp[n]),value=luckysheet.func_methods.isRealNum(fp)&&luckysheet.func_methods.isRealNum(tp[n])?"%"==sp&&0==parseFloat(tp[n])?luckysheet.formula.error.d:eval(parseFloat(fp)+sp+parseFloat(tp[n])):luckysheet.formula.error.v,result.push(value)}return result}if("=="==sp||"!="==sp||">="==sp||"<="==sp||">"==sp||"<"==sp){if("array"==luckysheet.getObjType(fp)&&"array"==luckysheet.getObjType(tp)){var result=[];if("array"==luckysheet.getObjType(fp[0])&&"array"==luckysheet.getObjType(tp[0])){if(fp.length!=tp.length&&fp[0].length!=tp[0].length)return luckysheet.formula.error.na;for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0;n<fp[m].length;n++){var value=booleanOperation(fp[m][n],sp,tp[m][n]);rowArr.push(value)}result.push(rowArr)}}else if("array"==luckysheet.getObjType(fp[0])){if(fp[0].length!=tp.length)return luckysheet.formula.error.na;for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0;n<fp[m].length;n++){var value=booleanOperation(fp[m][n],sp,tp[n]);rowArr.push(value)}result.push(rowArr)}}else if("array"==luckysheet.getObjType(tp[0])){if(tp[0].length!=fp.length)return luckysheet.formula.error.na;for(var m=0;m<tp.length;m++){for(var rowArr=[],n=0;n<tp[m].length;n++){var value=booleanOperation(fp[n],sp,tp[m][n]);rowArr.push(value)}result.push(rowArr)}}else{if(fp.length!=tp.length)return luckysheet.formula.error.na;for(var n=0;n<fp.length;n++){var value=booleanOperation(fp[n],sp,tp[n]);result.push(value)}}return result}if("array"==luckysheet.getObjType(fp)){var result=[];if("array"==luckysheet.getObjType(fp[0]))for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0;n<fp[m].length;n++){var value=booleanOperation(fp[m][n],sp,tp);rowArr.push(value)}result.push(rowArr)}else for(var n=0;n<fp.length;n++){var value=booleanOperation(fp[n],sp,tp);result.push(value)}return result}if("array"!=luckysheet.getObjType(tp))return booleanOperation(fp,sp,tp);var result=[];if("array"==luckysheet.getObjType(tp[0]))for(var m=0;m<tp.length;m++){for(var rowArr=[],n=0;n<tp[m].length;n++){var value=booleanOperation(fp,sp,tp[m][n]);rowArr.push(value)}result.push(rowArr)}else for(var n=0;n<tp.length;n++){var value=booleanOperation(fp,sp,tp[n]);result.push(value)}return result}if("&"==sp){if("array"==luckysheet.getObjType(fp)&&"array"==luckysheet.getObjType(tp)){var result=[];if("array"==luckysheet.getObjType(fp[0])&&"array"==luckysheet.getObjType(tp[0])){if(fp.length!=tp.length&&fp[0].length!=tp[0].length)return luckysheet.formula.error.na;for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0;n<fp[m].length;n++)rowArr.push(fp[m][n]+""+tp[m][n]);result.push(rowArr)}}else if("array"==luckysheet.getObjType(fp[0])){if(fp[0].length!=tp.length)return luckysheet.formula.error.na;for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0;n<fp[m].length;n++)rowArr.push(fp[m][n]+""+tp[n]);result.push(rowArr)}}else if("array"==luckysheet.getObjType(tp[0])){if(tp[0].length!=fp.length)return luckysheet.formula.error.na;for(var m=0;m<tp.length;m++){for(var rowArr=[],n=0;n<tp[m].length;n++)rowArr.push(fp[n]+""+tp[m][n]);result.push(rowArr)}}else{if(fp.length!=tp.length)return luckysheet.formula.error.na;for(var n=0;n<fp.length;n++)result.push(fp[n]+""+tp[n])}return result}if("array"==luckysheet.getObjType(fp)){var result=[];if("array"==luckysheet.getObjType(fp[0]))for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0;n<fp[m].length;n++)rowArr.push(fp[m][n]+""+tp);result.push(rowArr)}else for(var n=0;n<fp.length;n++)result.push(fp[n]+""+tp);return result}if("array"!=luckysheet.getObjType(tp))return fp+""+tp;var result=[];if("array"==luckysheet.getObjType(tp[0]))for(var m=0;m<tp.length;m++){for(var rowArr=[],n=0;n<tp[m].length;n++)rowArr.push(fp+""+tp[m][n]);result.push(rowArr)}else for(var n=0;n<tp.length;n++)result.push(fp+""+tp[n]);return result}if("^"==sp){if("array"==luckysheet.getObjType(fp)&&"array"==luckysheet.getObjType(tp)){var result=[];if("array"==luckysheet.getObjType(fp[0])&&"array"==luckysheet.getObjType(tp[0])){if(fp.length!=tp.length&&fp[0].length!=tp[0].length)return luckysheet.formula.error.na;for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0,value,value;n<fp[m].length;n++){fp[m][n]=booleanToNum(fp[m][n]),tp[m][n]=booleanToNum(tp[m][n]),value=luckysheet.func_methods.isRealNum(fp[m][n])&&luckysheet.func_methods.isRealNum(tp[m][n])?Math.pow(parseFloat(fp[m][n]),parseFloat(tp[m][n])):luckysheet.formula.error.v,rowArr.push(value)}result.push(rowArr)}}else if("array"==luckysheet.getObjType(fp[0])){if(fp[0].length!=tp.length)return luckysheet.formula.error.na;for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0,value,value;n<fp[m].length;n++){fp[m][n]=booleanToNum(fp[m][n]),tp[n]=booleanToNum(tp[n]),value=luckysheet.func_methods.isRealNum(fp[m][n])&&luckysheet.func_methods.isRealNum(tp[n])?Math.pow(parseFloat(fp[m][n]),parseFloat(tp[n])):luckysheet.formula.error.v,rowArr.push(value)}result.push(rowArr)}}else if("array"==luckysheet.getObjType(tp[0])){if(tp[0].length!=fp.length)return luckysheet.formula.error.na;for(var m=0;m<tp.length;m++){for(var rowArr=[],n=0,value,value;n<tp[m].length;n++){fp[n]=booleanToNum(fp[n]),tp[m][n]=booleanToNum(tp[m][n]),value=luckysheet.func_methods.isRealNum(fp[n])&&luckysheet.func_methods.isRealNum(tp[m][n])?Math.pow(parseFloat(fp[n]),parseFloat(tp[m][n])):luckysheet.formula.error.v,rowArr.push(value)}result.push(rowArr)}}else{if(fp.length!=tp.length)return luckysheet.formula.error.na;for(var n=0,value,value;n<fp.length;n++){fp[n]=booleanToNum(fp[n]),tp[n]=booleanToNum(tp[n]),value=luckysheet.func_methods.isRealNum(fp[n])&&luckysheet.func_methods.isRealNum(tp[n])?Math.pow(parseFloat(fp[n]),parseFloat(tp[n])):luckysheet.formula.error.v,result.push(value)}}return result}if("array"==luckysheet.getObjType(fp)){tp=booleanToNum(tp);var result=[];if("array"==luckysheet.getObjType(fp[0]))for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0,value,value;n<fp[m].length;n++){fp[m][n]=booleanToNum(fp[m][n]),value=luckysheet.func_methods.isRealNum(fp[m][n])&&luckysheet.func_methods.isRealNum(tp)?Math.pow(parseFloat(fp[m][n]),parseFloat(tp)):luckysheet.formula.error.v,rowArr.push(value)}result.push(rowArr)}else for(var n=0,value,value;n<fp.length;n++){fp[n]=booleanToNum(fp[n]),value=luckysheet.func_methods.isRealNum(fp[n])&&luckysheet.func_methods.isRealNum(tp)?Math.pow(parseFloat(fp[n]),parseFloat(tp)):luckysheet.formula.error.v,result.push(value)}return result}if("array"!=luckysheet.getObjType(tp))return fp=booleanToNum(fp),tp=booleanToNum(tp),result=luckysheet.func_methods.isRealNum(fp)&&luckysheet.func_methods.isRealNum(tp)?Math.pow(parseFloat(fp),parseFloat(tp)):luckysheet.formula.error.v,result;fp=booleanToNum(fp);var result=[];if("array"==luckysheet.getObjType(tp[0]))for(var m=0;m<tp.length;m++){for(var rowArr=[],n=0,value,value;n<tp[m].length;n++){tp[m][n]=booleanToNum(tp[m][n]),value=luckysheet.func_methods.isRealNum(fp)&&luckysheet.func_methods.isRealNum(tp[m][n])?Math.pow(parseFloat(fp),parseFloat(tp[m][n])):luckysheet.formula.error.v,rowArr.push(value)}result.push(rowArr)}else for(var n=0,value,value;n<tp.length;n++){tp[n]=booleanToNum(tp[n]),value=luckysheet.func_methods.isRealNum(fp)&&luckysheet.func_methods.isRealNum(tp[n])?Math.pow(parseFloat(fp),parseFloat(tp[n])):luckysheet.formula.error.v,result.push(value)}return result}},window.luckysheet_getarraydata=function(){var e=arguments[0],t=[];if(-1<(e=e.replace("{","").replace("}","").replace(/\"/g,"")).indexOf(";")){t=e.split(";");for(var l=0;l<t.length;l++)t[l]=t[l].split(",")}else t=e.split(",");return t},window.luckysheet_getcelldata=function(e){if(null==window.luckysheet_getcelldata_cache&&(window.luckysheet_getcelldata_cache={}),e in window.luckysheet_getcelldata_cache)return window.luckysheet_getcelldata_cache[e];var t=luckysheet.getluckysheetfile(),l=e.split("!"),r="",a="",s=-1,n=null;if(1<l.length){for(var o in r=l[0],a=l[1],t)if(r==t[o].name){s=t[o].index,n=t[o].data;break}-1==s&&(s=0)}else{var c=luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex),r=t[c].name,s=t[c].index,n=luckysheet.flowdata,a=l[0];null!=luckysheet.formula.execFunctionGroupData&&(n=luckysheet.formula.execFunctionGroupData)}if(-1==a.indexOf(":")){var u=parseInt(a.replace(/[^0-9]/g,""))-1,i=luckysheet.luckysheetABCatNum(a.replace(/[^A-Za-z]/g,""));if(isNaN(u)||isNaN(i))return[];var h={sheetName:r,startCell:a,rowl:y=1,coll:f=1,data:d=luckysheet.getdatabyselectionD(n,{row:[u,u],column:[i,i]})[0][0]};return window.luckysheet_getcelldata_cache[e]=h}a=a.split(":");i=[];if((u=[])[0]=parseInt(a[0].replace(/[^0-9]/g,""))-1,u[1]=parseInt(a[1].replace(/[^0-9]/g,""))-1,isNaN(u[0])&&(u[0]=0),isNaN(u[1])&&(u[1]=n.length-1),u[0]>u[1])return luckysheet.tooltip.info("选择失败","输入范围错误！"),[];if(i[0]=luckysheet.luckysheetABCatNum(a[0].replace(/[^A-Za-z]/g,"")),i[1]=luckysheet.luckysheetABCatNum(a[1].replace(/[^A-Za-z]/g,"")),isNaN(i[0])&&(i[0]=0),isNaN(i[1])&&(i[1]=n[0].length-1),i[0]>i[1])return luckysheet.tooltip.info("选择失败","输入范围错误！"),[];var d=luckysheet.getdatabyselectionD(n,{row:u,column:i}),y=u[1]-u[0]+1,f=i[1]-i[0]+1,h={sheetName:r,startCell:a[0],rowl:y,coll:f,data:d};return window.luckysheet_getcelldata_cache[e]=h},window.luckysheet_parseData=function(e){if("object"==typeof e){return null==e?"":Array.isArray(e)?luckysheet.mask.genarate(e[0])[2]:Array.isArray(e.data)?luckysheet.formula.error.v:void 0===e.data.v?"":e.data.v}else{if(!luckysheet.formula.isCompareOperator(e).flag)return luckysheet.mask.genarate(e)[2];if("string"==typeof e||"number"==typeof e)return e}return luckysheet.formula.error.v},window.luckysheet_getValue=function(){for(var e=arguments[0],t=0;t<e.length;t++){var l=e[t];"object"==typeof l?l=null==l?"":Array.isArray(l)?luckysheet.mask.genarate(l[0])[2]:Array.isArray(l.data)?l.data:void 0===l.data.v?"":l.data.v:luckysheet.formula.isCompareOperator(l).flag||(l=luckysheet.mask.genarate(l)[2]),e[t]=l}},luckysheet.formula={error:{v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"},errorInfo:function(e){return e},errorParamCheck:function(e,t,l){var r;return"o"==(l<e.length?(r=e[l].type,e[l].require):(r=e[e.length-1].type,e[e.length-1].require))&&(null==t||""==t)||-1<r.indexOf("all")||-1<r.indexOf("range")&&("object"==luckysheet.getObjType(t)||"array"==luckysheet.getObjType(t))||-1<r.indexOf("number")&&(luckysheet.func_methods.isRealNum(t)||"boolean"==luckysheet.getObjType(t))||-1<r.indexOf("string")&&"string"==luckysheet.getObjType(t)||-1<r.indexOf("date")&&luckysheet.datecontroll.isdatetime(t)?[!0,"成功"]:[!1,"参数类型错误"]},getPureValueByData:function(e){if(0==e.length)return[];var t=[];if("array"==luckysheet.getObjType(e))if("array"==luckysheet.getObjType(e[0]))for(var l=0;l<e.length;l++){for(var r=[],a=0;a<e[0].length;a++){var s=e[l][a];"object"==luckysheet.getObjType(s)?r.push(s.v):r.push(s)}t.push(r)}else for(var n=0;n<e.length;n++){s=e[n];"object"==luckysheet.getObjType(s)?t.push(s.v):t.push(s)}else{s=e;"object"==luckysheet.getObjType(s)?t.push(s.v):t.push(s)}return t},readCellDataToOneArray:function(rangeValue){if(null==rangeValue)return[];if("object"!=luckysheet.getObjType(rangeValue))return[rangeValue];var dataformat=[],data=[];if(null==rangeValue||null==rangeValue.data)return null==rangeValue||luckysheet.func_methods.isRealNull(rangeValue.v)?[]:[rangeValue.v];if(data=rangeValue.data,"array"==luckysheet.getObjType(data))data=luckysheet.formula.getPureValueByData(data);else{if("object"==luckysheet.getObjType(data))return data=data.v,[data];/\{.*?\}/.test(data)&&(data=data.replace(/\{/g,"[").replace(/\}/g,"]")),data=eval("("+data+")")}if("array"==luckysheet.getObjType(data[0]))for(var i=0;i<data.length;i++)dataformat=dataformat.concat(data[i]);else dataformat=data;return dataformat},getValueByFuncData:function(e,t){if(null==e)return null;return"array"==luckysheet.getObjType(e)?"avg"==t?window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,e):"sum"==t?window.luckysheet_function.SUM.f.apply(window.luckysheet_function.SUM,e):"object"==luckysheet.getObjType(e[0])?luckysheet.mask.getValueByFormat(e[0]):e[0]:"object"==luckysheet.getObjType(e)?luckysheet.mask.getValueByFormat(e):e},sparklinesColorMap:function(arguments,e){var t=null;null==e&&(e=5);if(arguments.length>e)for(var l=e;l<arguments.length;l++){for(var r=arguments[l],a=luckysheet.formula.readCellDataToOneArray(r),s=0;s<a.length;s++){var n,o=a[s];-1<o.indexOf(":")?(t=t||{},2==(n=o.split(":")).length?t[n[0]]=n[1]:1<n.length&&(t[n[0]+":"+n[1]]=n[2])):(t=t||[]).push(o)}0}return t},colorList:["#2ec7c9","#fc5c5c","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],classlist:{province:{11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"}},oldvalue:null,dontupdate:function(){luckysheetCellUpdate=[],$("#luckysheet-functionbox-cell, #luckysheet-rich-text-editor").html(this.oldvalue),this.cancelNormalSelected(),luckysheet.formula.rangetosheet!=luckysheet.currentSheetIndex&&luckysheet.sheetmanage.changeSheetExec(luckysheet.formula.rangetosheet)},fucntionboxshow:function(e,t){var l=luckysheet.flowdata,r="";null!=l[e]&&null!=l[e][t]&&null!=l[e][t].v&&(r=null!=l[e][t].f?luckysheet.getcellvalue(e,t,l,"f"):luckysheet.mask.valueShowEs(e,t,l)),this.oldvalue=r,$("#luckysheet-functionbox-cell").html(r)},cellOffset:function(e,t,l,r,a){var s=e.startCell,n=(e.rowl,e.coll,parseInt(s.replace(/[^0-9]/g,""))),o=luckysheet.luckysheetABCatNum(s.replace(/[^A-Za-z]/g,"")),c=[],u=[];c[0]=n+t,u[0]=o+l,c[1]=c[0]+r-1,u[1]=u[0]+a-1,u[0]=luckysheet.luckysheetchatatABC(u[0]),u[1]=luckysheet.luckysheetchatatABC(u[1]);var i=u[0]+c[0],h=u[1]+c[1];return i==h?e.sheetName+"!"+i:e.sheetName+"!"+i+":"+h},parseDatetoNum:function(e){if("object"==typeof e&&"number"==typeof e.v)e=e.v;else if("num"==luckysheet.isdatatype(e))e=parseFloat(e);else{if("date"!=luckysheet.isdatatype(e))return luckysheet.formula.error.v;e=luckysheet.mask.genarate(e)[2]}return e},getRangeArray:function(e){var t=[],l="General";if(1==e.length)for(var r=0;r<e[0].length;r++){null!=e[0][r]&&e[0][r].v?(t.push(e[0][r].v),s=e[0][r].ct.fa,l="General"==l?s:l):t.push(null)}else if(1==e[0].length)for(var a=0;a<e.length;a++){null!=e[a][0]&&e[a][0].v?(t.push(e[a][0].v),s=e[a][0].ct.fa,l="General"==l?s:l):t.push(null)}else for(a=0;a<e.length;a++)for(var s,r=0;r<e[a].length;r++){null!=e[a][r]&&e[a][r].v?(t.push(e[a][r].v),s=e[a][r].ct.fa,l="General"==l?s:l):t.push(null)}return[e=t,l]},getRangeArrayTwo:function(e){var t=$.extend(!0,[],e);if(1==t.length)for(var l=0;l<t[0].length;l++)t[0][l]instanceof Object&&(null!=t[0][l]&&t[0][l]instanceof Object&&t[0][l].m?t[0][l]=t[0][l].m:null!=t[0][l]&&t[0][l]instanceof Object&&t[0][l].v?t[0][l]=t[0][l].v:t[0][l]=null);else if(1==t[0].length)for(var r=0;r<t.length;r++)t[r][0]instanceof Object&&(null!=t[r][0]&&t[r][0]instanceof Object&&t[r][0].m?t[r][0]=t[r][0].m:null!=t[r][0]&&t[r][0]instanceof Object&&t[r][0].v?t[r][0]=t[r][0].v:t[r][0]=null);else for(r=0;r<t.length;r++)for(l=0;l<t[r].length;l++)t[r][l]instanceof Object&&(null!=t[r][l]&&t[r][l]instanceof Object&&t[r][l].m?t[r][l]=t[r][l].m:null!=t[r][l]&&t[r][l]instanceof Object&&t[r][l].v?t[r][l]=t[r][l].v:t[r][l]=null);return t},isWildcard:function(e,t){e=e.toString(),t=t.toString(),luckysheet.formula.isCompareOperator(t).flag&&(t=luckysheet.formula.isCompareOperator(t).num);for(var l="",r=0;r<t.length;r++){var a=t.charAt(r);"*"==a?l+=".*":"?"==a?l+=".":"~"==a?"*"==t.charAt(r+1)?(l+="\\*",r++):"?"==t.charAt(r+1)?(l+="\\?",r++):l+="~":l+=a}var s=new RegExp("^"+l+"$","g");return!!e.match(s)},isCompareOperator:function(e){var t="",l="",r=(e=e.toString()).substr(0,1),a=e.substr(1,1),s=!1;return">"==r?"="==a?(t=e.substr(0,2),l=e.substr(2),s=!0):"="!=a&&(t=e.substr(0,1),l=e.substr(1),s=!0):"<"==r?"="==a||">"==a?(t=e.substr(0,2),l=e.substr(2),s=!0):"="!=a&&">"!=a&&(t=e.substr(0,1),l=e.substr(1),s=!0):"="==r&&"="!=a&&(t=e.substr(0,1),l=e.substr(1),s=!0),{flag:s,ope:t,num:l}},acompareb:function(e,t){var l,r,a=!1;if(luckysheet.func_methods.isRealNum(t))a=luckysheet_compareWith(e,"==",t);else if("string"==typeof t){if(-1!=t.indexOf("*")||-1!=t.indexOf("?"))return luckysheet.formula.isWildcard(e,t);a=luckysheet.formula.isCompareOperator(t).flag?(l=luckysheet.formula.isCompareOperator(t).ope,r=luckysheet.formula.isCompareOperator(t).num,luckysheet_compareWith(e,l,r)):luckysheet_compareWith(e,"==",t)}return a},compareParams:function(e,t,l){var r=!1,a=toString.call(e),s=toString.call(t);if(">"==l?t<e&&(r=!0):">="==l?t<=e&&(r=!0):"<"==l?e<t&&(r=!0):"<="==l?e<=t&&(r=!0):"="==l?e==t&&(r=!0):"<>"==l&&e!=t&&(r=!0),"[object Object]"!=a||"[object Object]"!=s)return"[object Array]"==a&&"[object Array]"==s?e.toString()==t.toString():r;var n=Object.getOwnPropertyNames(e),o=Object.getOwnPropertyNames(t);if(n.length!=o.length)return!1;for(var c=0;c<n.length;c++){var u=n[c];if(e[u]!==t[u])return!1}return!0},parseDecimal:function(e){var e=parseFloat(e),t=parseInt(e,10);return 0==t?e:e%=t},getcellrange:function(e){var t=e.split("!"),l="",r="",a=-1,s=null,n=luckysheet.getluckysheetfile();if(1<t.length){for(var o in l=t[0],r=t[1],n)if(l==n[o].name){a=n[o].index,s=n[o].data;break}}else var c=luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex),l=n[c].name,a=n[c].index,s=luckysheet.flowdata,r=t[0];if(-1==r.indexOf(":")){var u=parseInt(r.replace(/[^0-9]/g,""))-1,i=luckysheet.luckysheetABCatNum(r.replace(/[^A-Za-z]/g,""));return isNaN(u)||isNaN(i)?null:{row:[u,u],column:[i,i],sheetIndex:a}}r=r.split(":");i=[];return(u=[])[0]=parseInt(r[0].replace(/[^0-9]/g,""))-1,u[1]=parseInt(r[1].replace(/[^0-9]/g,""))-1,isNaN(u[0])&&(u[0]=0),isNaN(u[1])&&(u[1]=s.length-1),u[0]>u[1]?null:(i[0]=luckysheet.luckysheetABCatNum(r[0].replace(/[^A-Za-z]/g,"")),i[1]=luckysheet.luckysheetABCatNum(r[1].replace(/[^A-Za-z]/g,"")),isNaN(i[0])&&(i[0]=0),isNaN(i[1])&&(i[1]=s[0].length-1),i[0]>i[1]?null:{row:u,column:i,sheetIndex:a})},rangeHightlightHTML:'<div id="luckysheet-formula-functionrange-highlight-${id}" rangeindex="${id}"  class="luckysheet-selection-highlight luckysheet-formula-functionrange-highlight"><div data-type="top" class="luckysheet-selection-copy-top luckysheet-copy"></div><div data-type="right" class="luckysheet-selection-copy-right luckysheet-copy"></div><div data-type="bottom" class="luckysheet-selection-copy-bottom luckysheet-copy"></div><div data-type="left" class="luckysheet-selection-copy-left luckysheet-copy"></div><div class="luckysheet-selection-copy-hc"></div><div data-type="lt" class="luckysheet-selection-highlight-topleft luckysheet-highlight"></div><div data-type="rt" class="luckysheet-selection-highlight-topright luckysheet-highlight"></div><div data-type="lb" class="luckysheet-selection-highlight-bottomleft luckysheet-highlight"></div><div data-type="rb" class="luckysheet-selection-highlight-bottomright luckysheet-highlight"></div></div>',createRangeHightlight:function(){var e=$("#luckysheet-rich-text-editor").find("span.luckysheet-formula-functionrange-cell");$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight").remove(),e.each(function(){var e=$(this).attr("rangeindex"),t=$(this).text();$("#luckysheet-formula-functionrange").append(luckysheet.replaceHtml(luckysheet.formula.rangeHightlightHTML,{id:e}));var l=luckysheet.formula.getcellrange(t),r="luckysheet-formula-functionrange-highlight-"+e;null==l||(l.sheetIndex==luckysheet.currentSheetIndex||-1==l.sheetIndex&&luckysheet.formula.rangetosheet==luckysheet.currentSheetIndex)&&($("#"+r).data("range",l).find(".luckysheet-copy").css({background:luckysheet.jfcolor[e]}).end().find(".luckysheet-highlight").css({background:luckysheet.jfcolor[e]}).end().find(".luckysheet-selection-copy-hc").css({background:luckysheet.jfcolor[e]}),luckysheet.seletedHighlistByindex(r,l.row[0],l.row[1],l.column[0],l.column[1]))}),$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight").show()},searchHTML:'<div id="luckysheet-formula-search-c" class="luckysheet-formula-search-c"></div>',helpHTML:'<div id="luckysheet-formula-help-c" class="luckysheet-formula-help-c"> <div class="luckysheet-formula-help-close" title="关闭"><i class="fa fa-times" aria-hidden="true"></i></div> <div class="luckysheet-formula-help-collapse" title="收起"><i class="fa fa-angle-up" aria-hidden="true"></i></div> <div class="luckysheet-formula-help-title"><div class="luckysheet-formula-help-title-formula"> <span class="luckysheet-arguments-help-function-name">SUM</span> <span class="luckysheet-arguments-paren">(</span> <span class="luckysheet-arguments-parameter-holder"> <span class="luckysheet-arguments-help-parameter luckysheet-arguments-help-parameter-active" dir="auto">A2:A100</span>, <span class="luckysheet-arguments-help-parameter" dir="auto">101</span> </span> <span class="luckysheet-arguments-paren">)</span> </div></div> <div class="luckysheet-formula-help-content"> <div class="luckysheet-formula-help-content-example"> <div class="luckysheet-arguments-help-section-title">示例</div> <div class="luckysheet-arguments-help-formula"> <span class="luckysheet-arguments-help-function-name">SUM</span> <span class="luckysheet-arguments-paren">(</span> <span class="luckysheet-arguments-parameter-holder"> <span class="luckysheet-arguments-help-parameter luckysheet-arguments-help-parameter-active" dir="auto">A2:A100</span>, <span class="luckysheet-arguments-help-parameter" dir="auto">101</span> </span> <span class="luckysheet-arguments-paren">)</span> </div> </div> <div class="luckysheet-formula-help-content-detail"> <div class="luckysheet-arguments-help-section"> <div class="luckysheet-arguments-help-section-title luckysheet-arguments-help-parameter-name">摘要</div> <span class="luckysheet-arguments-help-parameter-content">${detail}</span> </div> </div> <div class="luckysheet-formula-help-content-param"> ${param} </div> </div> <div class="luckysheet-formula-help-foot"></div></div>',getrangeseleciton:function(){var e=window.getSelection(),t=$(e.anchorNode),l=e.anchorOffset;if(t.parent().is("span")&&0!=l){if(0==(a=$.trim(t.text())).length&&0<t.parent().prev().length){var r=t.parent().prev();return(a=$.trim(r.text())).substr(a.length-1,1),r}return a.substr(l-1,1),t.parent()}if(t.is("#luckysheet-rich-text-editor")||t.is("#luckysheet-functionbox-cell")){if(0==(a=$.trim(t.find("span").last().text())).length&&1<t.find("span").length){r=t.find("span");return a=$.trim(r.eq(r.length-2).text()),r}return t.find("span").last()}if((t.parent().is("#luckysheet-rich-text-editor")||t.parent().is("#luckysheet-functionbox-cell")||0==l)&&(0==l&&(t=t.parent()),0<t.prev().length)){var a;(a=$.trim(t.prev().text())).substr(a.length-1,1);return t.prev()}return null},searchFunctionPosition:function(e,t,l,r,a){var s=$(window).height(),n=$(window).width(),o=e.outerWidth(),c=e.outerHeight();null==a&&(a=!1);var u=r,i=l,i=n<l+o?l-o+t.outerWidth():l;s<r+c?u=r-c:(u=r+t.outerHeight(),a||e.html(e.find(".luckysheet-formula-search-item").get().reverse())),u<0&&(u=0),i<0&&(i=0),e.css({top:u,left:i}).show()},searchFunctionCell:null,searchFunction:function(e){var t=this.getrangeseleciton();if(null!=(this.searchFunctionCell=t)&&null!=e){var l=t.text().toUpperCase();if(/^[a-zA-Z]|[a-zA-Z_]+$/.test(l)){for(var r={f:[],s:[],t:[]},a=0,s=0;s<luckysheet.functionlist.length;s++){var n=luckysheet.functionlist[s],o=n.n;if(o==l?(r.f.unshift(n),a++):o.substr(0,l.length)==l?(r.s.unshift(n),a++):-1<o.indexOf(l)&&(r.t.unshift(n),a++),10<=a)break}var c,u,i,h=r.t.concat(r.s.concat(r.f));h.length<=0||(c=this.searchFunctionHTML(h),$("#luckysheet-formula-search-c").html(c).show(),$("#luckysheet-formula-help-c").hide(),i=(u=e.parent()).offset(),this.searchFunctionPosition($("#luckysheet-formula-search-c"),u,i.left,i.top))}}},searchFunctionEnter:function(e){var t=e.data("func");luckysheet.formula.searchFunctionCell.text(t).after('<span dir="auto" class="luckysheet-formula-text-color">(</span>'),luckysheet.formula.setCaretPosition(luckysheet.formula.searchFunctionCell.next().get(0),0,1),$("#luckysheet-formula-search-c").hide(),this.helpFunctionExe(luckysheet.formula.searchFunctionCell.closest("div"),luckysheet.formula.searchFunctionCell.next())},searchFunctionHTML:function(e){0==$("#luckysheet-formula-search-c").length&&($("body").append(this.searchHTML),$("#luckysheet-formula-search-c").on("mouseover",".luckysheet-formula-search-item",function(){$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").removeClass("luckysheet-formula-search-item-active"),$(this).addClass("luckysheet-formula-search-item-active")}).on("mouseout",".luckysheet-formula-search-item",function(){}).on("click",".luckysheet-formula-search-item",function(){null!=luckysheet.formula.searchFunctionCell&&luckysheet.formula.searchFunctionEnter($(this))}));for(var t='<div data-func="${n}" class="luckysheet-formula-search-item ${class}"><div class="luckysheet-formula-search-func">${n}</div><div class="luckysheet-formula-search-detail">${a}</div></div>',l="",r=0;r<e.length;r++){var a=e[r];r==e.length-1?l+=luckysheet.replaceHtml(t,{class:"luckysheet-formula-search-item-active",n:a.n,a:a.a}):l+=luckysheet.replaceHtml(t,{class:"",n:a.n,a:a.a})}return l},functionlistPosition:{},helpFunction:function(e,t,l){var r=luckysheet.functionlist[this.functionlistPosition[$.trim(t).toUpperCase()]];if(null!=r){$("#luckysheet-formula-help-c .luckysheet-arguments-help-function-name").html(r.n),$("#luckysheet-formula-help-c .luckysheet-arguments-help-parameter-content").html(r.d);for(var a,s="",n="",o="",c=0;c<r.p.length;c++){var u=r.p[c],i=u.name,h=u.name;"y"==u.repeat&&(i+=", ...",h+='<span class="luckysheet-arguments-help-argument-info">...-可重复</span>'),"o"==u.require&&(i="["+i+"]",h+='<span class="luckysheet-arguments-help-argument-info">-[可选]</span>'),s+='<span class="luckysheet-arguments-help-parameter" dir="auto">'+i+"</span>, ",n+='<span class="luckysheet-arguments-help-parameter" dir="auto">'+u.example+"</span>, ",o+=luckysheet.replaceHtml('<div class="luckysheet-arguments-help-section"><div class="luckysheet-arguments-help-section-title">${param}</div><span class="luckysheet-arguments-help-parameter-content">${content}</span></div>',{param:h,content:u.detail})}s=s.substr(0,s.length-2),n=n.substr(0,n.length-2),$("#luckysheet-formula-help-c .luckysheet-formula-help-title .luckysheet-arguments-parameter-holder").html(s),$("#luckysheet-formula-help-c .luckysheet-arguments-help-formula .luckysheet-arguments-parameter-holder").html(n),$("#luckysheet-formula-help-c .luckysheet-formula-help-content-param").html(o),null==l?$("#luckysheet-formula-help-c .luckysheet-formula-help-title-formula .luckysheet-arguments-help-function-name").css("font-weight","bold"):($("#luckysheet-formula-help-c .luckysheet-formula-help-title-formula .luckysheet-arguments-help-function-name").css("font-weight","normal"),a=l>=r.p.length?r.p.length-1:l,$("#luckysheet-formula-help-c .luckysheet-formula-help-title .luckysheet-arguments-parameter-holder .luckysheet-arguments-help-parameter").removeClass("luckysheet-arguments-help-parameter-active"),$("#luckysheet-formula-help-c .luckysheet-formula-help-title .luckysheet-arguments-parameter-holder .luckysheet-arguments-help-parameter").eq(a).addClass("luckysheet-arguments-help-parameter-active"),$("#luckysheet-formula-help-c .luckysheet-arguments-help-formula .luckysheet-arguments-parameter-holder .luckysheet-arguments-help-parameter").removeClass("luckysheet-arguments-help-parameter-active"),$("#luckysheet-formula-help-c .luckysheet-arguments-help-formula .luckysheet-arguments-parameter-holder .luckysheet-arguments-help-parameter").eq(a).addClass("luckysheet-arguments-help-parameter-active"),$("#luckysheet-formula-help-c .luckysheet-formula-help-content-param .luckysheet-arguments-help-section").removeClass("luckysheet-arguments-help-parameter-active"),$("#luckysheet-formula-help-c .luckysheet-formula-help-content-param .luckysheet-arguments-help-section").eq(a).addClass("luckysheet-arguments-help-parameter-active"));var d=e.parent(),y=d.offset();this.searchFunctionPosition($("#luckysheet-formula-help-c"),d,y.left,y.top,!0)}},helpFunctionExe:function(e,t){if(0==$("#luckysheet-formula-help-c").length){$("body").after(this.helpHTML),$("#luckysheet-formula-help-c .luckysheet-formula-help-close").click(function(){$("#luckysheet-formula-help-c").hide()}),$("#luckysheet-formula-help-c .luckysheet-formula-help-collapse").click(function(){var e=$("#luckysheet-formula-help-c .luckysheet-formula-help-content");e.slideToggle(100,function(){var e=luckysheet.formula.rangeResizeTo.parent(),t=e.offset();luckysheet.formula.searchFunctionPosition($("#luckysheet-formula-help-c"),e,t.left,t.top,!0)}),e.is(":hidden")?$(this).html('<i class="fa fa-angle-up" aria-hidden="true"></i>'):$(this).html('<i class="fa fa-angle-down" aria-hidden="true"></i>')});for(var l=0;l<luckysheet.functionlist.length;l++)this.functionlistPosition[luckysheet.functionlist[l].n]=l}if(t){var r=t,a=(e.length,e.find("span")),s=t.index(),l=s;if(null!=r){var n=null,o=null;if(a.eq(l).is(".luckysheet-formula-text-func"))n=a.eq(l).text();else for(var c=null,u=[-1,-1];0<--l;)if((c=a.eq(l)).is(".luckysheet-formula-text-func")||$.trim(c.text()).toUpperCase()in this.functionlistPosition){n=c.text();for(var i=!(o=null),h=l;h<=s;h++)if(o=o||0,!(h>=u[0]&&h<=u[1])){if((c=a.eq(h)).is(".luckysheet-formula-text-rpar")){n=null,i=!(u=[l,h]);break}c.is(".luckysheet-formula-text-comma")&&o++}if(i)break}null!=n&&this.helpFunction(e,n,o)}}},rangeHightlightselected:function(e,t){var l,r=this.getrangeseleciton();$("#luckysheet-formula-search-c, #luckysheet-formula-help-c").hide(),$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight .luckysheet-selection-copy-hc").css("opacity","0.03"),$("#luckysheet-formula-search-c, #luckysheet-formula-help-c").hide(),this.helpFunctionExe(e,r),0!=$(r).closest(".luckysheet-formula-functionrange-cell").length?(l=$(r).closest(".luckysheet-formula-functionrange-cell").attr("rangeindex"),$("#"+("luckysheet-formula-functionrange-highlight-"+l)).find(".luckysheet-selection-copy-hc").css({opacity:"0.13"})):this.searchFunction(e)},updatecell:function(e,t){var l=$("#luckysheet-rich-text-editor").text();luckysheet.formula.rangetosheet!=luckysheet.currentSheetIndex&&luckysheet.sheetmanage.changeSheetExec(luckysheet.formula.rangetosheet);var r=luckysheet.flowdata[e][t];if(luckysheet.func_methods.isRealNull(l)){if(null==r||luckysheet.func_methods.isRealNull(r.v))return void this.cancelNormalSelected()}else{if("object"==luckysheet.getObjType(r)&&(l==r.f||l==r.v||l==r.m))return void this.cancelNormalSelected();if(l==r)return void this.cancelNormalSelected()}"="==l.slice(0,1)&&1<l.length||"object"!=luckysheet.getObjType(r)||null==r.ct||null==r.ct.fa||"@"==r.ct.fa||luckysheet.func_methods.isRealNull(l)||(delete r.m,null!=r.f&&(delete r.f,delete r.spl)),window.luckysheet_getcelldata_cache=null;var a,s,n=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata);"object"==luckysheet.getObjType(r)?("string"==luckysheet.getObjType(l)&&"="==l.slice(0,1)&&1<l.length?(a=this.execfunction(l,e,t,!0),(r=this.execFunctionGroupData[e][t]).f=a[2],4==a.length&&"sparklines"==a[3].type&&(delete r.m,delete r.v,s=a[3].data,"array"==luckysheet.getObjType(s)&&"object"!=luckysheet.getObjType(s[0])?r.v=s[0]:r.spl=a[3].data)):(this.delFunctionGroup(e,t),this.execFunctionGroup(e,t,l),delete(r=this.execFunctionGroupData[e][t]).f,delete r.spl),l=r):"string"==luckysheet.getObjType(l)&&"="==l.slice(0,1)&&1<l.length?(l={v:(a=this.execfunction(l,e,t,!0))[1],f:a[2]},4==a.length&&"sparklines"==a[3].type&&(s=a[3].data,"array"==luckysheet.getObjType(s)&&"object"!=luckysheet.getObjType(s[0])?l.v=s[0]:l.spl=a[3].data)):(this.delFunctionGroup(e,t),this.execFunctionGroup(e,t,l)),luckysheet.setcellvalue(e,t,n,l),this.cancelNormalSelected();var o=!1;if("2"==n[e][t].tb&&null!=n[e][t].v){var c=$.extend(!0,{},luckysheet.getluckysheetfile()[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].config);null==c.rowlen&&(c.rowlen={});var u=$("#luckysheetTableContentF").get(0).getContext("2d"),i=luckysheet.luckysheetfontformat(n[e][t]);u.font=i;var h=19;null!=c.rowlen[e]&&(h=c.rowlen[e]);var d=luckysheet.getcellvalue(e,t,n).toString(),y=u.measureText(d).width,f=luckysheet.colLocationByIndex(t)[1]-luckysheet.colLocationByIndex(t)[0]-8;if(f<y){for(var m=[],k=1;k<=d.length;k++){var p=d.substring(m.join("").length,k),g=u.measureText(p).width;f<g?(m.push(d.substring(m.join("").length,k-1)),k-=2):g<=f&&k==d.length&&m.push(p)}h=luckysheet.menuButton.getTextSize("田",i)[1]*m.length}19!=h&&(c.rowlen[e]=h,o=!0)}o?luckysheet.jfrefreshgrid(n,[{row:[e,e],column:[t,t]}],c,null,o):luckysheet.jfrefreshgrid(n,[{row:[e,e],column:[t,t]}]),luckysheetCellUpdate=[],this.execFunctionGroupData=null},cancelNormalSelected:function(){this.canceFunctionrangeSelected(),$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight").remove(),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-input-box-index").hide(),$("#luckysheet-wa-functionbox-cancel, #luckysheet-wa-functionbox-confirm").removeClass("luckysheet-wa-calculate-active"),luckysheet.formula.rangestart=!1,luckysheet.formula.rangedrag_column_start=!1,luckysheet.formula.rangedrag_row_start=!1},canceFunctionrangeSelected:function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show, #luckysheet-column-count-show").hide(),$("#luckysheet-formula-search-c, #luckysheet-formula-help-c").hide()},iscellformat:function(e){},iscelldata:function(e){var t,l=e.split("!"),r=1<l.length?l[1]:l[0];if(-1==r.indexOf(":")){var a=parseInt(r.replace(/[^0-9]/g,""))-1,s=luckysheet.luckysheetABCatNum(r.replace(/[^A-Za-z]/g,""));return!(isNaN(a)||isNaN(s)||!r.toString().match(/^(([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+))$/g))||(isNaN(a)&&isNaN(s),!1)}t=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+)))|((([0-9]+)|([$][0-9]+s))))$/g,r=r.split(":");s=[];return(a=[])[0]=parseInt(r[0].replace(/[^0-9]/g,""))-1,a[1]=parseInt(r[1].replace(/[^0-9]/g,""))-1,!(a[0]>a[1])&&(s[0]=luckysheet.luckysheetABCatNum(r[0].replace(/[^A-Za-z]/g,"")),s[1]=luckysheet.luckysheetABCatNum(r[1].replace(/[^A-Za-z]/g,"")),!(s[0]>s[1])&&!(!r[0].toString().match(t)||!r[1].toString().match(t)))},operator:"==|!=|<>|<=|>=|=|+|-|>|<|/|*|%|&|^",operatorjson:null,functionCopy:function(e,t,l){if(null==luckysheet.formula.operatorjson){for(var r=luckysheet.formula.operator.split("|"),a={},s=0;s<r.length;s++)a[r[s].toString()]=1;luckysheet.formula.operatorjson=a}null==t&&(t="down"),null==l&&(l=1),"="==e.substr(0,1)&&(e=e.substr(1));for(var n=e.split(""),s=0,o="",c="",u={bracket:0,comma:0,squote:0,dquote:0};s<n.length;){var i=n[s];if("("==i&&0==u.dquote)u.bracket+=1,0<o.length?c+=o+"(":c+="(",o="";else if(")"==i&&0==u.dquote)--u.bracket,c+=luckysheet.formula.functionCopy(o,t,l)+")",o="";else if('"'==i&&0==u.squote)0<u.dquote?(c+=o+'"',--u.dquote,o=""):(u.dquote+=1,o+='"');else if(","==i&&0==u.dquote)c+=luckysheet.formula.functionCopy(o,t,l)+",",o="";else if("&"==i&&0==u.dquote)0<o.length?(c+=luckysheet.formula.functionCopy(o,t,l)+"&",o=""):c+="&";else if(i in luckysheet.formula.operatorjson&&0==u.dquote){var h="";s+1<n.length&&(h=n[s+1]);var d=s-1,y=null;if(0<=d)for(;y=n[d--],0<=d&&" "==y;);i+h in luckysheet.formula.operatorjson?(0<o.length?(c+=luckysheet.formula.functionCopy(o,t,l)+i+h,o=""):c+=i+h,s++):!/[^0-9]/.test(h)&&"-"==i&&("("==y||null==y||","==y||" "==y||y in luckysheet.formula.operatorjson)?o+=i:0<o.length?(c+=luckysheet.formula.functionCopy(o,t,l)+i,o=""):c+=i}else o+=i;s==n.length-1&&(luckysheet.formula.iscelldata($.trim(o))?"down"==t?c+=luckysheet.formula.downparam($.trim(o),l):"up"==t?c+=luckysheet.formula.upparam($.trim(o),l):"left"==t?c+=luckysheet.formula.leftparam($.trim(o),l):"right"==t&&(c+=luckysheet.formula.rightparam($.trim(o),l)):c+=$.trim(o)),s++}return c},isfreezonFuc:function(e){var t=e.replace(/[^0-9]/g,""),l=e.replace(/[^A-Za-z]/g,""),r=e.substr(e.indexOf(t)-1,1),a=e.substr(e.indexOf(l)-1,1),s=[!1,!1];return"$"==r&&(s[0]=!0),"$"==a&&(s[1]=!0),s},setfreezonFuceExe:function(e){var t=parseInt(e.replace(/[^0-9]/g,"")),l=luckysheet.luckysheetABCatNum(e.replace(/[^A-Za-z]/g,""));this.isfreezonFuc(e);return isNaN(t)||isNaN(l)?isNaN(t)?isNaN(l)?txt:"$"+luckysheet.luckysheetchatatABC(l):"$"+t:"$"+luckysheet.luckysheetchatatABC(l)+"$"+t},setfreezonFuc:function(e){var t,l,r,a,s,n,o,c,u,i,h=this.getrangeseleciton();this.iscelldata(h.text())&&(t=h.text(),l=window.getSelection().anchorOffset,a="",1<(r=t.split("!")).length?(i=r[1],a=r[0]+"!"):i=r[0],o=n="",o=-1==(s=i.indexOf(":"))?(n=a+this.setfreezonFuceExe(i)).length:(i=i.split(":"),s<l?(n=u=a+i[0]+":"+this.setfreezonFuceExe(i[1]),u.length):(n=u=(c=a+this.setfreezonFuceExe(i[0]))+":"+i[1],c.length)),h.text(a+n),this.setCaretPosition(h.get(0),0,o))},updateparam:function(e,t,l){var r,a=t.split("!"),s="";if(1<a.length?(r=a[1],s=a[0]+"!"):r=a[0],-1==r.indexOf(":")){var n=parseInt(r.replace(/[^0-9]/g,"")),o=luckysheet.luckysheetABCatNum(r.replace(/[^A-Za-z]/g,"")),c=this.isfreezonFuc(r),u=c[0]?"$":"",i=c[1]?"$":"";return"u"!=e||c[0]?"r"!=e||c[1]?"l"!=e||c[1]?c[0]||(n+=l):o-=l:o+=l:n-=l,n[0]<0||o[0]<0?luckysheet.formula.error.r:isNaN(n)||isNaN(o)?isNaN(n)?isNaN(o)?t:s+i+luckysheet.luckysheetchatatABC(o):s+u+n:s+i+luckysheet.luckysheetchatatABC(o)+u+n}r=r.split(":");o=[];(n=[])[0]=parseInt(r[0].replace(/[^0-9]/g,"")),n[1]=parseInt(r[1].replace(/[^0-9]/g,""));var h=this.isfreezonFuc(r[0]);if(n[0]>n[1])return t;var d=this.isfreezonFuc(r[1]);if(o[0]=luckysheet.luckysheetABCatNum(r[0].replace(/[^A-Za-z]/g,"")),o[1]=luckysheet.luckysheetABCatNum(r[1].replace(/[^A-Za-z]/g,"")),o[0]>o[1])return t;var y=h[0]?"$":"",f=h[1]?"$":"",m=d[0]?"$":"",k=d[1]?"$":"";return"u"==e?(h[0]||(n[0]-=l),d[0]||(n[1]-=l)):"r"==e?(h[1]||(o[0]+=l),d[1]||(o[1]+=l)):"l"==e?(h[1]||(o[0]-=l),d[1]||(o[1]-=l)):(h[0]||(n[0]+=l),d[0]||(n[1]+=l)),n[0]<0||o[0]<0?luckysheet.formula.error.r:isNaN(o[0])&&isNaN(o[1])?s+y+n[0]+":"+m+n[1]:isNaN(n[0])&&isNaN(n[1])?s+f+luckysheet.luckysheetchatatABC(o[0])+":"+k+luckysheet.luckysheetchatatABC(o[1]):s+f+luckysheet.luckysheetchatatABC(o[0])+y+n[0]+":"+k+luckysheet.luckysheetchatatABC(o[1])+m+n[1]},downparam:function(e,t){return this.updateparam("d",e,t)},upparam:function(e,t){return this.updateparam("u",e,t)},leftparam:function(e,t){return this.updateparam("l",e,t)},rightparam:function(e,t){return this.updateparam("r",e,t)},functionStrChange:function(e,t,l,r,a,s){if(null==luckysheet.formula.operatorjson){for(var n=luckysheet.formula.operator.split("|"),o={},c=0;c<n.length;c++)o[n[c].toString()]=1;luckysheet.formula.operatorjson=o}"="==e.substr(0,1)&&(e=e.substr(1));for(var u=e.split(""),c=0,i="",h="",d={bracket:0,comma:0,squote:0,dquote:0};c<u.length;){var y=u[c];if("("==y&&0==d.dquote)d.bracket+=1,0<i.length?h+=i+"(":h+="(",i="";else if(")"==y&&0==d.dquote)--d.bracket,h+=luckysheet.formula.functionStrChange(i,t,l,r,a,s)+")",i="";else if('"'==y&&0==d.squote)0<d.dquote?(h+=i+'"',--d.dquote,i=""):(d.dquote+=1,i+='"');else if(","==y&&0==d.dquote)h+=luckysheet.formula.functionStrChange(i,t,l,r,a,s)+",",i="";else if("&"==y&&0==d.dquote)0<i.length?(h+=luckysheet.formula.functionStrChange(i,t,l,r,a,s)+"&",i=""):h+="&";else if(y in luckysheet.formula.operatorjson&&0==d.dquote){var f="";c+1<u.length&&(f=u[c+1]);var m=c-1,k=null;if(0<=m)for(;k=u[m--],0<=m&&" "==k;);y+f in luckysheet.formula.operatorjson?(0<i.length?(h+=luckysheet.formula.functionStrChange(i,t,l,r,a,s)+y+f,i=""):h+=y+f,c++):!/[^0-9]/.test(f)&&"-"==y&&("("==k||null==k||","==k||" "==k||k in luckysheet.formula.operatorjson)?i+=y:0<i.length?(h+=luckysheet.formula.functionStrChange(i,t,l,r,a,s)+y,i=""):h+=y}else i+=y;c==u.length-1&&(luckysheet.formula.iscelldata($.trim(i))?h+=luckysheet.formula.functionStrChange_range($.trim(i),t,l,r,a,s):h+=$.trim(i)),c++}return h},functionStrChange_range:function(e,t,l,r,a,s){var n,o,c,u,i,h=e.split("!"),d="";if(1<h.length?(n=h[1],d=h[0]+"!"):n=h[0],-1==n.indexOf(":")){o=c=parseInt(n.replace(/[^0-9]/g,""))-1,u=i=luckysheet.luckysheetABCatNum(n.replace(/[^A-Za-z]/g,""));var y=this.isfreezonFuc(n),f=g=y[0]?"$":"",m=v=y[1]?"$":""}else{if(n=n.split(":"),o=parseInt(n[0].replace(/[^0-9]/g,""))-1,(c=parseInt(n[1].replace(/[^0-9]/g,""))-1)<o)return e;if(u=luckysheet.luckysheetABCatNum(n[0].replace(/[^A-Za-z]/g,"")),(i=luckysheet.luckysheetABCatNum(n[1].replace(/[^A-Za-z]/g,"")))<u)return e;var k=this.isfreezonFuc(n[0]);f=k[0]?"$":"",m=k[1]?"$":"";var p=this.isfreezonFuc(n[1]),g=p[0]?"$":"",v=p[1]?"$":""}if("del"==t){if("row"==l){if(a<=o&&c<=a+s-1)return luckysheet.formula.error.r;a+s-1<o?o-=s:a<=o&&(o=a),a+s-1<c?c-=s:a<=c&&(c=a-1),o<0&&(o=0),c<o&&(c=o)}else if("col"==l){if(a<=u&&i<=a+s-1)return luckysheet.formula.error.r;a+s-1<u?u-=s:a<=u&&(u=a),a+s-1<i?i-=s:a<=i&&(i=a-1),u<0&&(u=0),i<u&&(i=u)}return o==c&&u==i?isNaN(o)||isNaN(u)?isNaN(o)?isNaN(u)?e:d+m+luckysheet.luckysheetchatatABC(u):d+f+(o+1):d+m+luckysheet.luckysheetchatatABC(u)+f+(o+1):isNaN(u)&&isNaN(i)?d+f+(o+1)+":"+g+(c+1):isNaN(o)&&isNaN(c)?d+m+luckysheet.luckysheetchatatABC(u)+":"+v+luckysheet.luckysheetchatatABC(i):d+m+luckysheet.luckysheetchatatABC(u)+f+(o+1)+":"+v+luckysheet.luckysheetchatatABC(i)+g+(c+1)}if("add"==t)return"row"==l?"lefttop"==r?(a<=o&&(o+=s),a<=c&&(c+=s)):"rightbottom"==r&&(a<o&&(o+=s),a<c&&(c+=s)):"col"==l&&("lefttop"==r?(a<=u&&(u+=s),a<=i&&(i+=s)):"rightbottom"==r&&(a<u&&(u+=s),a<i&&(i+=s))),o==c&&u==i?isNaN(o)||isNaN(u)?isNaN(o)?isNaN(u)?e:d+m+luckysheet.luckysheetchatatABC(u):d+f+(o+1):d+m+luckysheet.luckysheetchatatABC(u)+f+(o+1):isNaN(u)&&isNaN(i)?d+f+(o+1)+":"+g+(c+1):isNaN(o)&&isNaN(c)?d+m+luckysheet.luckysheetchatatABC(u)+":"+v+luckysheet.luckysheetchatatABC(i):d+m+luckysheet.luckysheetchatatABC(u)+f+(o+1)+":"+v+luckysheet.luckysheetchatatABC(i)+g+(c+1)},israngeseleciton:function(e){if(null==luckysheet.formula.operatorjson){for(var t=luckysheet.formula.operator.split("|"),l={},r=0;r<t.length;r++)l[t[r].toString()]=1;luckysheet.formula.operatorjson=l}null==e&&(e=!1);var a=window.getSelection(),s=$(a.anchorNode),n=a.anchorOffset;if(s.parent().is("span")&&0!=n){var o="";if(0==(u=$.trim(s.text())).length&&0<s.parent().prev().length?(c=s.parent().prev(),o=(u=$.trim(c.text())).substr(u.length-1,1),this.rangeSetValueTo=c):(o=u.substr(n-1,1),this.rangeSetValueTo=s.parent()),e&&("("==o||","==o)||!e&&("("==o||","==o||"="==o||o in luckysheet.formula.operatorjson||"&"==o))return!0}else if(s.is("#luckysheet-rich-text-editor")||s.is("#luckysheet-functionbox-cell")){var c,u=$.trim(s.find("span").last().text());if(this.rangeSetValueTo=s.find("span").last(),0==u.length&&1<s.find("span").length&&(c=s.find("span"),u=$.trim(c.eq(c.length-2).text()),this.rangeSetValueTo=c),o=u.substr(u.length-1,1),e&&("("==o||","==o)||!e&&("("==o||","==o||"="==o||o in luckysheet.formula.operatorjson||"&"==o))return!0}else if((s.parent().is("#luckysheet-rich-text-editor")||s.parent().is("#luckysheet-functionbox-cell")||0==n)&&(0==n&&(s=s.parent()),0<s.prev().length)){o=(u=$.trim(s.prev().text())).substr(u.length-1,1);if(this.rangeSetValueTo=s.prev(),e&&("("==o||","==o)||!e&&("("==o||","==o||"="==o||o in luckysheet.formula.operatorjson||"&"==o))return!0}return!1},rangechangeindex:null,rangestart:!1,rangetosheet:null,rangeSetValueTo:null,func_selectedrange:{},rangeSetValue:function(selected,obj){var range=luckysheet.sheetmanage.getRangetxt(luckysheet.currentSheetIndex,selected,this.rangetosheet),$editor;if(luckysheet.formula.rangestart||luckysheet.formula.rangedrag_column_start||luckysheet.formula.rangedrag_row_start)if($("#luckysheet-search-formula-parm").is(":visible")||$("#luckysheet-search-formula-parm-select").is(":visible")){$editor=$("#luckysheet-rich-text-editor"),$("#luckysheet-search-formula-parm-select-input").val(range),$("#luckysheet-search-formula-parm .parmBox").eq(luckysheet.formula.data_parm_index).find(".txt input").val(range);var txtdata=window.luckysheet_getcelldata(range).data;if(txtdata instanceof Array){for(var txtArr=[],i=0;i<txtdata.length;i++)for(var j=0;j<txtdata[i].length;j++)null==txtdata[i][j]?txtArr.push(null):txtArr.push(txtdata[i][j].v);$("#luckysheet-search-formula-parm .parmBox").eq(luckysheet.formula.data_parm_index).find(".val").text(" = {"+txtArr.join(",")+"}")}else $("#luckysheet-search-formula-parm .parmBox").eq(luckysheet.formula.data_parm_index).find(".val").text(" = {"+txtdata.v+"}");var isVal=!0,parmValArr=[],lvi=-1;if($("#luckysheet-search-formula-parm .parmBox").each(function(e,t){var l=$(t).find(".txt input").val();""==l&&"m"==$(t).find(".txt input").attr("data_parm_require")&&(isVal=!1),""!=l&&(lvi=e)}),-1==lvi)var functionHtmlTxt="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"()";else if(0==lvi)var functionHtmlTxt="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"("+$("#luckysheet-search-formula-parm .parmBox").eq(0).find(".txt input").val()+")";else{for(var j=0;j<=lvi;j++)parmValArr.push($("#luckysheet-search-formula-parm .parmBox").eq(j).find(".txt input").val());var functionHtmlTxt="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"("+parmValArr.join(",")+")"}var function_str=luckysheet.formula.functionHTMLGenerate(functionHtmlTxt),fp,result;$("#luckysheet-rich-text-editor").html(function_str),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),1==isVal&&(fp=$.trim(luckysheet.formula.functionParser($("#luckysheet-rich-text-editor").text())),result=eval(fp),$("#luckysheet-search-formula-parm .result span").text(result))}else{var currSelection=window.getSelection(),anchorOffset=currSelection.anchorNode,$editor=$(anchorOffset).closest("div"),$span=$editor.find("span[rangeindex='"+this.rangechangeindex+"']").html(range);luckysheet.formula.setCaretPosition($span.get(0),0,range.length)}else{var function_str='<span class="luckysheet-formula-functionrange-cell" rangeindex="'+this.functionHTMLIndex+'" dir="auto" style="color:'+luckysheet.jfcolor[this.functionHTMLIndex]+';">'+range+"</span>",$t=$(function_str).insertAfter(this.rangeSetValueTo);this.rangechangeindex=this.functionHTMLIndex,$editor=$(this.rangeSetValueTo).closest("div"),luckysheet.formula.setCaretPosition($editor.find("span[rangeindex='"+luckysheet.formula.rangechangeindex+"']").get(0),0,range.length),this.functionHTMLIndex++}"luckysheet-rich-text-editor"==$editor.attr("id")?$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()):$("#luckysheet-rich-text-editor").html($("#luckysheet-functionbox-cell").html())},rangedrag:function(e){var t=luckysheet.mouseposition(e.pageX,e.pageY),l=t[0]+$("#luckysheet-cell-main").scrollLeft(),r=t[1]+$("#luckysheet-cell-main").scrollTop(),a=luckysheet.rowLocation(r),s=a[1],n=a[0],o=a[2],c=luckysheet.colLocation(l),u=c[1],i=c[0],h=c[2],d=0,y=0,f=[],f=this.func_selectedrange.top>n?(d=n,y=this.func_selectedrange.top+this.func_selectedrange.height-n,[o,this.func_selectedrange.row[1]]):this.func_selectedrange.top==n?(d=n,y=this.func_selectedrange.top+this.func_selectedrange.height-n,[o,this.func_selectedrange.row[0]]):(d=this.func_selectedrange.top,y=s-this.func_selectedrange.top-1,[this.func_selectedrange.row[0],o]),m=0,k=0,p=[],p=this.func_selectedrange.left>i?(m=i,k=this.func_selectedrange.left+this.func_selectedrange.width-i,[h,this.func_selectedrange.column[1]]):this.func_selectedrange.left==i?(m=i,k=this.func_selectedrange.left+this.func_selectedrange.width-i,[h,this.func_selectedrange.column[0]]):(m=this.func_selectedrange.left,k=u-this.func_selectedrange.left-1,[this.func_selectedrange.column[0],h]);f[0]=luckysheet.freezen.changeFreezenIndex(f[0],"h"),f[1]=luckysheet.freezen.changeFreezenIndex(f[1],"h"),p[0]=luckysheet.freezen.changeFreezenIndex(p[0],"v"),p[1]=luckysheet.freezen.changeFreezenIndex(p[1],"v");var g,v=luckysheet.menuButton.mergeMoveMain(p,f,this.func_selectedrange,d,y,m,k);null!=v&&(p=v[0],f=v[1],d=v[2],y=v[3],m=v[4],k=v[5]),this.func_selectedrange.row=f,this.func_selectedrange.column=p,this.func_selectedrange.left_move=m,this.func_selectedrange.width_move=k,this.func_selectedrange.top_move=d,this.func_selectedrange.height_move=y,luckysheet.luckysheet_count_show(m,d,k,y,f,p),$("#luckysheet-formula-functionrange-select").css({left:m,width:k,top:d,height:y}).show(),$("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")?(g=luckysheet.sheetmanage.getRangetxt(luckysheet.currentSheetIndex,{row:f,column:p},luckysheet.currentSheetIndex),$("#luckysheet-ifFormulaGenerator-multiRange-dialog input").val(g)):this.rangeSetValue({row:f,column:p}),setTimeout(function(){luckysheetautoadjustmousedown=1},1),luckysheet.freezen.scrollFreezen(f,p)},rangedrag_column_start:!1,rangedrag_row_start:!1,rangedrag_column:function(e){var t=luckysheet.mouseposition(e.pageX,e.pageY),l=t[0]+$("#luckysheet-cell-main").scrollLeft(),r=(t[1],$("#luckysheet-cell-main").scrollTop(),luckysheet.getvisibledatarow()),a=r.length-1,s=r[a],n=luckysheet.colLocation(l),o=n[1],c=n[0],u=n[2],i=0,h=0,d=[];(d=this.func_selectedrange.left>c?(i=c,h=this.func_selectedrange.left+this.func_selectedrange.width-c,[u,this.func_selectedrange.column[1]]):this.func_selectedrange.left==c?(i=c,h=this.func_selectedrange.left+this.func_selectedrange.width-c,[u,this.func_selectedrange.column[0]]):(i=this.func_selectedrange.left,h=o-this.func_selectedrange.left-1,[this.func_selectedrange.column[0],u]))[0]=luckysheet.freezen.changeFreezenIndex(d[0],"v"),d[1]=luckysheet.freezen.changeFreezenIndex(d[1],"v");var y=luckysheet.menuButton.mergeMoveMain(d,[0,a],this.func_selectedrange,0,s-1,i,h);null!=y&&(d=y[0],i=y[4],h=y[5]),this.func_selectedrange.column=d,this.func_selectedrange.left_move=i,this.func_selectedrange.width_move=h,luckysheet.luckysheet_count_show(i,0,h,s-1,[0,a],d),this.rangeSetValue({row:[null,null],column:d}),$("#luckysheet-formula-functionrange-select").css({left:i,width:h,top:0,height:s-1}).show(),setTimeout(function(){luckysheetautoadjustmousedown=1},1),luckysheet.freezen.scrollFreezen([0,a],d)},rangedrag_row:function(e){var t=luckysheet.mouseposition(e.pageX,e.pageY),l=(t[0],$("#luckysheet-cell-main").scrollLeft(),t[1]+$("#luckysheet-cell-main").scrollTop()),r=luckysheet.rowLocation(l),a=r[1],s=r[0],n=r[2],o=luckysheet.getvisibledatacolumn(),c=o.length-1,u=o[c],i=0,h=0,d=[];(d=this.func_selectedrange.top>s?(i=s,h=this.func_selectedrange.top+this.func_selectedrange.height-s,[n,this.func_selectedrange.row[1]]):this.func_selectedrange.top==s?(i=s,h=this.func_selectedrange.top+this.func_selectedrange.height-s,[n,this.func_selectedrange.row[0]]):(i=this.func_selectedrange.top,h=a-this.func_selectedrange.top-1,[this.func_selectedrange.row[0],n]))[0]=luckysheet.freezen.changeFreezenIndex(d[0],"h"),d[1]=luckysheet.freezen.changeFreezenIndex(d[1],"h");var y=luckysheet.menuButton.mergeMoveMain([0,c],d,this.func_selectedrange,i,h,0,u-1);null!=y&&(d=y[1],i=y[2],h=y[3]),this.func_selectedrange.row=d,this.func_selectedrange.top_move=i,this.func_selectedrange.height_move=h,luckysheet.luckysheet_count_show(0,i,u-1,h,d,[0,c]),this.rangeSetValue({row:d,column:[null,null]}),$("#luckysheet-formula-functionrange-select").css({left:0,width:u-1,top:i,height:h}).show(),setTimeout(function(){luckysheetautoadjustmousedown=1},1),luckysheet.freezen.scrollFreezen(d,[0,c])},rangedragged:function(){},rangeResizeObj:null,rangeResize:null,rangeResizeIndex:null,rangeResizexy:null,rangeResizeWinH:null,rangeResizeWinW:null,rangeResizeTo:null,rangeResizeDraging:function(e,t,l,r,a,s,n,o){var c=$("#luckysheet-scrollbar-y").scrollTop(),u=$("#luckysheet-scrollbar-x").scrollLeft(),i=luckysheet.mouseposition(e.pageX,e.pageY),h=i[0]+u,d=i[1]+c,y=luckysheet.rowLocation(d),f=y[1],m=y[0],k=(y[2],luckysheet.colLocation(h)),p=k[1],g=k[0];k[2];if(h<0||d<0)return!1;t.height(),t.width();var v=m-l[1],b=g-l[0],_=l[5],w=l[3],x=l[4],C=l[2];if("lt"==r||"lb"==r){if(l[0]+l[2]<g)return;x=g,C=l[2]-b,x>l[2]+l[4]-p+g?(x=l[2]+l[4]-p+g,C=l[2]-(l[2]+l[4]-p+g-l[0])):x<=0&&(x=0,C=l[2]+l[0])}if("rt"==r||"rb"==r){if(l[6]-l[2]>p)return;(C=l[2]+p-l[6])<p-g-1?C=p-g-1:n-x<=C&&(C=n-x)}if("lt"==r||"rt"==r){if(l[1]+l[3]<m)return;_=m,w=l[3]-v,_>l[3]+l[5]-f+m?(_=l[3]+l[5]-f+m,w=l[3]-(l[3]+l[5]-f+m-l[1])):_<=0&&(_=0,w=l[3]+l[1])}if("lb"==r||"rb"==r){if(l[7]-l[3]>f)return;(w=l[3]+f-l[7])<f-m-1?w=f-m-1:o-_<=w&&(w=o-_)}var T=luckysheet.formula.rangeResizeIndex,I={top:_,left:x,height:w,width:C},R=this.getSelectedFromRange(I),S=luckysheet.sheetmanage.getRangetxt(luckysheet.currentSheetIndex,R,this.rangetosheet);luckysheet.formula.rangeResizeTo.find("span[rangeindex='"+T+"']").html(S);luckysheet.luckysheetRangeLast(luckysheet.formula.rangeResizeTo[0]),t.css(I).data("range",R)},getSelectedFromRange:function(e){var t=e.top+2,l=e.top+e.height-2,r=e.left+2,a=e.left+e.width-2,s={row:[],column:[]},n=luckysheet.rowLocation(t),o=(n[1],n[0],n[2]),c=luckysheet.colLocation(r),u=(c[1],c[0],c[2]);s.row[0]=o,s.column[0]=u;(n=luckysheet.rowLocation(l))[1],n[0];o=n[2],(c=luckysheet.colLocation(a))[1],c[0],u=c[2];return s.row[1]=o,s.column[1]=u,s},rangeResizeDragged:function(e,t,l,r,a,s){luckysheet.formula.rangeResize=null,$("#luckysheet-formula-functionrange-highlight-"+luckysheet.formula.rangeResizeIndex).find(".luckysheet-selection-copy-hc").css("opacity",.03)},rangeMovexy:null,rangeMove:!1,rangeMoveObj:null,rangeMoveIndex:null,rangeMoveRangedata:null,rangeMoveDraging:function(e,t,l,r,a,s){var n=luckysheet.mouseposition(e.pageX,e.pageY),o=$("#luckysheet-scrollbar-x").scrollLeft(),c=$("#luckysheet-scrollbar-y").scrollTop(),u=n[0]+o,i=n[1]+c,h=$(window).height()+c-a-s,d=$(window).width()+o,y=luckysheet.rowLocation(i),f=y[1],m=y[0],k=y[2],p=luckysheet.colLocation(u),g=p[1],v=p[0],b=p[2],_=t[0],w=t[1],x=l.row[0]-_+k,C=l.row[1]-_+k,T=l.column[0]-w+b,I=l.column[1]-w+b;(x<0||i<0)&&(x=0,C=l.row[1]-l.row[0]),(T<0||u<0)&&(T=0,I=l.column[1]-l.column[0]);var R=luckysheet.getvisibledatarow();(C>=R[R.length-1]||h<i)&&(x=R.length-1-l.row[1]+l.row[0],C=R.length-1);var S=luckysheet.getvisibledatacolumn();(I>=S[S.length-1]||d<u)&&(T=S.length-1-l.column[1]+l.column[0],I=S.length-1);var v=T-1==-1?0:S[T-1],g=S[I],m=x-1==-1?0:R[x-1],f=R[C],A=luckysheet.formula.rangeMoveIndex,F={left:v,width:g-v-2,top:m,height:f-m-2,display:"block"},N=this.getSelectedFromRange(F),M=luckysheet.sheetmanage.getRangetxt(luckysheet.currentSheetIndex,N,this.rangetosheet);luckysheet.formula.rangeResizeTo.find("span[rangeindex='"+A+"']").html(M);luckysheet.luckysheetRangeLast(luckysheet.formula.rangeResizeTo[0]),luckysheet.formula.rangeMoveRangedata=N,r.css(F)},rangeMoveDragged:function(e){luckysheet.formula.rangeMove=!1,$("#luckysheet-formula-functionrange-highlight-"+luckysheet.formula.rangeMoveIndex).data("range",luckysheet.formula.rangeMoveRangedata).find(".luckysheet-selection-copy-hc").css("opacity",.03)},functionHTMLIndex:0,functionRangeIndex:null,findrangeindex:function(e,t){var l=/<span.*?>/g,r=e.replace(l,""),a=t.replace(l,""),r=r.split("</span>"),a=a.split("</span>");r.pop(),a.pop();var s=luckysheet.formula.functionRangeIndex,n=0,o=(a.length>r.length?r.length:a.length,a.length),c=r.length;if(o==c){var u=a[n=s[0]],i=r[n];if(null==u)return a.length<=n?s=[a.length-1,a.length-1]:r.length<=n&&(s=[r.length-1,r.length-1]),s;if(u.length==i.length)return null!=a[n+1]&&null!=r[n+1]&&a[n+1].length<r[n+1].length&&(s[0]=s[0]+1,s[1]=1),s;if(u.length>i.length)return null!=u&&null!=r[n+1]&&'"'==r[n+1].substr(0,1)&&(-1<u.indexOf("{")||-1<u.indexOf("}"))&&(s[0]=s[0]+1,s[1]=1),s;if(u.length<i.length)return s[1]>i.length&&(s[1]=i.length),s}else{if(c<o){var h,u=a[n=s[0]];if(null==(i=r[n])){-1<r[n-1].indexOf("{")?(s[0]=s[0]-1,h=r[n-1].search("{"),s[1]=s[1]+h):(s[0]=0,s[1]=0)}else{if(u.length==i.length)return null==r[n+1]||'"'!=r[n+1].substr(0,1)&&"{"!=r[n+1].substr(0,1)&&"}"!=r[n+1].substr(0,1)?null!=u&&2<u.length&&'"'==u.substr(0,1)&&'"'==u.substr(u.length-1,1)||(null!=r[n]&&'")'==r[n]||null!=r[n]&&'"}'==r[n]||null!=r[n]&&"{)"==r[n]?s[1]=1:s[1]=i.length):(s[0]=s[0]+1,s[1]=1),s;if(u.length>i.length)return null==r[n+1]||'"'!=r[n+1].substr(0,1)&&"{"!=r[n+1].substr(0,1)&&"}"!=r[n+1].substr(0,1)||(s[0]=s[0]+1,s[1]=1),s;if(u.length<i.length)return s}return s}if(o<c){var u=a[n=s[0]],i=r[n];if(null==u)s[0]=r.length-1,s[1]=null!=i?i.length:1;else{if(u.length==i.length)return null==a[n+1]||'"'!=a[n+1].substr(0,1)&&"{"!=a[n+1].substr(0,1)&&"}"!=a[n+1].substr(0,1)?null==r[n+1]||'"'!=r[n+1].substr(0,1)||"{"!=r[n+1].substr(0,1)&&"}"!=r[n+1].substr(0,1)?null!=i&&'"'==i.substr(0,1)&&'"'==i.substr(i.length-1,1)&&'"'==u.substr(0,1)&&")"==u.substr(u.length-1,1)||null!=i&&"{"==i.substr(0,1)&&"}"==i.substr(i.length-1,1)&&"{"==u.substr(0,1)&&")"==u.substr(u.length-1,1)?s[1]=i.length:(s[0]=s[0]+c-o,r.length>a.length?s[1]=r[n+1].length:s[1]=1):(s[0]=s[0]+1,s[1]=1):s[1]=i.length,s;if(u.length>i.length)return null!=u&&'"'==u.substr(0,1)?s[1]=i.length:null!=r[n+1]&&/{.*?}/.test(r[n+1])?(s[0]=s[0]+1,s[1]=r[n+1].length):null!=u&&'"'==r[n+1].substr(0,1)&&(-1<u.indexOf("{")||-1<u.indexOf("}"))?(s[0]=s[0]+1,s[1]=1):null!=u&&(-1<u.indexOf("{")||-1<u.indexOf("}"))||(s[0]=s[0]+c-o-1,s[1]=r[n-1].length),s;if(u.length<i.length)return s}return s}}return null},setCaretPosition:function(e,t,l){try{var r=e,a=document.createRange(),s=window.getSelection();a.setStart(r.childNodes[t],l),a.collapse(!0),s.removeAllRanges(),s.addRange(a),r.focus()}catch(e){luckysheet.luckysheetRangeLast(luckysheet.formula.rangeResizeTo[0])}},functionRange:function(e,t,l){var r,a;window.getSelection?(r=window.getSelection(),null==(a=luckysheet.formula.findrangeindex(t,l))?(r.selectAllChildren(e.get(0)),r.collapseToEnd()):this.setCaretPosition(e.find("span").get(a[0]),0,a[1])):document.selection&&(luckysheet.formula.functionRangeIndex.moveToElementText(e),luckysheet.formula.functionRangeIndex.collapse(!1),luckysheet.formula.functionRangeIndex.select())},functionInputHanddler:function(e,t,a){var s,n,o,c;luckysheet.luckysheetConfigsetting.editMode||(s=e,o=(n=t).html(),c=n.text(),setTimeout(function(){var e,t,l,r=n.text();0<r.length&&"="==r.substr(0,1)&&(229!=a||1==r.length)&&(r=luckysheet.formula.functionHTMLGenerate(r),o=luckysheet.formula.functionHTMLGenerate(c),window.getSelection?(e=window.getSelection(),$(e.anchorNode).is("div")?(t=$("#luckysheet-rich-text-editor span").length,luckysheet.formula.functionRangeIndex=[t-1,$("#luckysheet-rich-text-editor").find("span").eq(t-1).text().length]):luckysheet.formula.functionRangeIndex=[$(e.anchorNode).parent().index(),e.anchorOffset]):(l=document.selection.createRange(),luckysheet.formula.functionRangeIndex=l),n.html(r),luckysheet.formula.functionRange(n,r,o),luckysheet.formula.canceFunctionrangeSelected(),luckysheet.formula.createRangeHightlight()),luckysheet.formula.rangestart=!1,luckysheet.formula.rangedrag_column_start=!1,luckysheet.formula.rangedrag_row_start=!1,s.html(r),luckysheet.formula.rangeHightlightselected(n,a)},1))},functionHTMLGenerate:function(e){return 0==e.length||"="!=e.substr(0,1)?e:(this.functionHTMLIndex=0,'<span dir="auto" class="luckysheet-formula-text-color">=</span>'+this.functionHTML(e))},functionHTML:function(e){if(null==luckysheet.formula.operatorjson){for(var t=luckysheet.formula.operator.split("|"),l={},r=0;r<t.length;r++)l[t[r].toString()]=1;luckysheet.formula.operatorjson=l}"="==e.substr(0,1)&&(e=e.substr(1));for(var a=e.split(""),r=0,s="",n="",o={bracket:0,comma:0,squote:0,dquote:0,braces:0};r<a.length;){var c,u,i,h,d=a[r];if("("==d&&0==o.dquote&&0==o.braces)o.bracket+=1,0<s.length?n+='<span dir="auto" class="luckysheet-formula-text-func">'+s+'</span><span dir="auto" class="luckysheet-formula-text-lpar">(</span>':n+='<span dir="auto" class="luckysheet-formula-text-lpar">(</span>',s="";else if(")"==d&&0==o.dquote&&0==o.braces)--o.bracket,n+=luckysheet.formula.functionHTML(s)+'<span dir="auto" class="luckysheet-formula-text-rpar">)</span>',s="";else if("{"==d&&0==o.dquote)s+="{",o.braces+=1;else if("}"==d&&0==o.dquote)s+="}",--o.braces;else if('"'==d&&0==o.squote)s=(0<o.dquote?(0<s.length?n+=s+'"</span>':n+='"</span>',--o.dquote):(o.dquote+=1,0<s.length?n+=luckysheet.formula.functionHTML(s)+'<span dir="auto" class="luckysheet-formula-text-string">"':n+='<span dir="auto" class="luckysheet-formula-text-string">"'),"");else if(","==d&&0==o.dquote&&0==o.braces)n+=luckysheet.formula.functionHTML(s)+'<span dir="auto" class="luckysheet-formula-text-comma">,</span>',s="";else if("&"==d&&0==o.dquote&&0==o.braces)0<s.length?(n+=luckysheet.formula.functionHTML(s)+'<span dir="auto" class="luckysheet-formula-text-calc">&</span>',s=""):n+='<span dir="auto" class="luckysheet-formula-text-calc">&</span>';else if(d in luckysheet.formula.operatorjson&&0==o.dquote&&0==o.braces){var y="";r+1<a.length&&(y=a[r+1]);var f=r-1,m=null;if(0<=f)for(;m=a[f--],0<=f&&" "==m;);d+y in luckysheet.formula.operatorjson?(0<s.length?(n+=luckysheet.formula.functionHTML(s)+'<span dir="auto" class="luckysheet-formula-text-calc">'+d+y+"</span>",s=""):n+='<span dir="auto" class="luckysheet-formula-text-calc">'+d+y+"</span>",r++):!/[^0-9]/.test(y)&&"-"==d&&("("==m||null==m||","==m||" "==m||m in luckysheet.formula.operatorjson)?s+=d:0<s.length?(n+=luckysheet.formula.functionHTML(s)+'<span dir="auto" class="luckysheet-formula-text-calc">'+d+"</span>",s=""):n+='<span dir="auto" class="luckysheet-formula-text-calc">'+d+"</span>"}else s+=d;r==a.length-1&&(luckysheet.formula.iscelldata($.trim(s))?(n+='<span class="luckysheet-formula-functionrange-cell" rangeindex="'+this.functionHTMLIndex+'" dir="auto" style="color:'+luckysheet.jfcolor[this.functionHTMLIndex]+';">'+s+"</span>",this.functionHTMLIndex++):0<o.dquote?n+=s+"</span>":-1==s.indexOf("</span>")&&0<s.length&&((c=/{.*?}/).test($.trim(s))?(u=c.exec(s)[0],h="",0<(i=s.search(c))&&(h+='<span dir="auto" class="luckysheet-formula-text-color">'+s.substr(0,i)+"</span>"),h+='<span dir="auto" style="color:#959a05" class="luckysheet-formula-text-array">'+u+"</span>",i+u.length<s.length&&(h+='<span dir="auto" class="luckysheet-formula-text-color">'+s.substr(i+u.length,s.length)+"</span>"),n+=h):n+='<span dir="auto" class="luckysheet-formula-text-color">'+s+"</span>")),r++}return n},getfunctionParam:function(e){if(null==luckysheet.formula.operatorjson){for(var t=luckysheet.formula.operator.split("|"),l={},r=0;r<t.length;r++)l[t[r].toString()]=1;luckysheet.formula.operatorjson=l}"="==e.substr(0,1)&&(e=e.substr(1));for(var a=e.split(""),r=0,s="",n={bracket:0,comma:0,squote:0,dquote:0,compare:0},o=null,c=[],u=[];r<a.length;){var i=a[r];if("("==i&&0==n.dquote)0<s.length&&0==u.length?(o=s.toUpperCase(),u.push(1),s=""):0==u.length?(u.push(0),s=""):(u.push(0),s+=i);else if(")"==i&&0==n.dquote){u.pop();0==u.length?(c.push(s),s=""):s+=i}else if('"'==i)s+='"',0<n.dquote?(--n.dquote,s=""):n.dquote+=1;else if(","==i&&0==n.dquote)u.length<=1?(c.push(s),s=""):s+=",";else if(i in luckysheet.formula.operatorjson&&0==n.dquote){var h="";r+1<a.length&&(h=a[r+1]);var d=r-1,y=null;if(0<=d)for(;y=a[d--],0<=d&&" "==y;);!/[^0-9]/.test(h)&&"-"==i&&("("==y||null==y||","==y||" "==y||y in luckysheet.formula.operatorjson)?0==n.dquote?s+=$.trim(i):s+=i:s=""}else 0==n.dquote?s+=$.trim(i):s+=i;r++}return{fn:o,param:c}},functionParser1:function(e){if(null==luckysheet.formula.operatorjson){for(var t=luckysheet.formula.operator.split("|"),l={},r=0;r<t.length;r++)l[t[r].toString()]=1;luckysheet.formula.operatorjson=l}"="==e.substr(0,1)&&(e=e.substr(1));for(var a=e.split(""),r=0,s="",n="",o={bracket:0,comma:0,squote:0,dquote:0,compare:0};r<a.length;){var c,u=a[r];"("==u&&0==o.dquote?(o.bracket+=1,0<s.length?n+="luckysheet_function."+s.toUpperCase()+".f(":n+="(",s=""):")"==u&&0==o.dquote?(--o.bracket,n+=luckysheet.formula.functionParser(s),1==o.compare?(n+="))",o.compare=0):n+=")",s=""):'"'==u&&0==o.squote?0<o.dquote?(n+=s+'"',--o.dquote,s=""):(o.dquote+=1,s+='"'):","==u&&0==o.dquote?(n+=luckysheet.formula.functionParser(s),1==o.compare?(n+="),",o.compare=0):n+=",",s=""):u in luckysheet.formula.operatorjson&&0==o.dquote?(c="",r+1<a.length&&(c=a[r+1]),u+c in luckysheet.formula.operatorjson?(0<s.length?(o.compare=1,n+="luckysheet_compareWith("+luckysheet.formula.functionParser(s)+",'"+u+c+"', ",s=""):n+=u+c,r++):0<s.length?(o.compare=1,n+="luckysheet_compareWith("+luckysheet.formula.functionParser(s)+",'"+u+"', ",s=""):n+=u):s+=u,r==a.length-1&&(luckysheet.formula.iscelldata($.trim(s))?n+="luckysheet_getcelldata('"+$.trim(s)+"')":n+=$.trim(s)),r++}return n},calPostfixExpression:function(e){if(0==e.length)return"";for(var t=[],l=e.length-1;0<=l;l--){var r,a,s=e[l];s in luckysheet.formula.operatorjson?(r=t.pop(),a="luckysheet_compareWith("+t.pop()+",'"+s+"', "+r+")",t.push(a)):t.push(s)}return 0<t.length?t[0]:""},checkBracketNum:function(e){var t=e.match(/\(/g),l=e.match(/\)/g),r=e.match(/(['"])(?:(?!\1).)*?\1/g);bra_tr_txt=e.match(/(['"])(?:(?!\1).)*?\1/g);var a=0,s=0;null!=t&&(a+=t.length),null!=l&&(s+=l.length);var n=0,o=0;if(null!=r)for(var c=0;c<r.length;c++){var u=r[c].match(/\(/g);null!=u&&(n+=u.length)}if(null!=bra_tr_txt)for(c=0;c<bra_tr_txt.length;c++){var i=bra_tr_txt[c].match(/\)/g);null!=i&&(o+=i.length)}return(a-=n)==(s-=o)},operatorPriority:{"^":0,"%":1,"*":1,"/":1,"+":2,"-":2},functionParser:function(e){if(null==luckysheet.formula.operatorjson){for(var t=luckysheet.formula.operator.split("|"),l={},r=0;r<t.length;r++)l[t[r].toString()]=1;luckysheet.formula.operatorjson=l}"="==e.substr(0,1)&&(e=e.substr(1));for(var a=e.split(""),r=0,s="",n="",o={bracket:0,comma:0,squote:0,dquote:0,compare:0,braces:0},c=[],u=[],i=[];r<a.length;){var h=a[r];if("("==h&&0==o.dquote&&0==o.braces)0<s.length&&0==i.length?(n+="luckysheet_function."+s.toUpperCase()+".f(",i.push(1),s=""):0==i.length?(n+="(",i.push(0),s=""):(i.push(0),s+=h);else if(")"==h&&0==o.dquote&&0==o.braces){i.pop();0==i.length?(n+=luckysheet.formula.functionParser(s)+")",s=""):s+=h}else if("{"==h&&0==o.dquote)s+="{",o.braces+=1;else if("}"==h&&0==o.dquote)s+="}",--o.braces;else if('"'==h)s+='"',0<o.dquote?--o.dquote:o.dquote+=1;else if(","==h&&0==o.dquote&&0==o.braces)i.length<=1?(n+=luckysheet.formula.functionParser(s)+",",s=""):s+=",";else if(h in luckysheet.formula.operatorjson&&0==o.dquote&&0==o.braces){var d="",l=luckysheet.formula.operatorPriority;if(r+1<a.length&&(d=a[r+1]),h+d in luckysheet.formula.operatorjson){if(0==i.length){if(0<$.trim(s).length?u.unshift(luckysheet.formula.functionParser($.trim(s))):0<$.trim(n).length&&u.unshift($.trim(n)),c[0]in luckysheet.formula.operatorjson)for(var y=l[c[0]];0<c.length&&null!=y;)u.unshift(c.shift()),y=l[c[0]];c.unshift(h+d),s=n=""}else s+=h+d;r++}else if(0==i.length){if(0<$.trim(s).length?u.unshift(luckysheet.formula.functionParser($.trim(s))):0<$.trim(n).length&&u.unshift($.trim(n)),c[0]in luckysheet.formula.operatorjson){y=null==(y=l[c[0]])?1e3:y;for(var f=null==(f=l[h])?1e3:f;0<c.length&&y<=f;)u.unshift(c.shift()),y=null==(y=l[c[0]])?1e3:y}c.unshift(h),s=n=""}else s+=h}else 0==o.dquote?s+=$.trim(h):s+=h;if(r==a.length-1){var m,k,p,g="";if(luckysheet.formula.iscelldata($.trim(s))?g="luckysheet_getcelldata('"+$.trim(s)+"')":(s=$.trim(s),(m=/{.*?}/).test(s)&&'"'!=s.substr(0,1)&&'"'!=s.substr(s.length-1,1)?(k=m.exec(s)[0],0<(p=s.search(m))&&(g+=s.substr(0,p)),g+="luckysheet_getarraydata('"+k+"')",p+k.length<s.length&&(g+=s.substr(p+k.length,s.length))):g=s),0<g.length&&u.unshift(g),0<c.length)for(0<n.length&&(u.unshift(n),n="");0<c.length;)u.unshift(c.shift());0<u.length?n=luckysheet.formula.calPostfixExpression(u):n+=g}r++}return n},addFunctionGroup:function(e,t,l,r){null==r&&(r=luckysheet.currentSheetIndex);var a=luckysheet.getluckysheetfile(),s=a[luckysheet.sheetmanage.getSheetIndex(r)];null==s.calcChain&&(s.calcChain=[]);var n={r:e,c:t,index:r,func:l};s.calcChain.push(n),luckysheet.server.saveParam("fc",r,JSON.stringify(n),{op:"add",pos:s.calcChain.length-1}),luckysheet.setluckysheetfile(a)},getFunctionGroup:function(e){null==e&&(e=luckysheet.currentSheetIndex);var t=luckysheet.getluckysheetfile()[luckysheet.sheetmanage.getSheetIndex(e)];return null==t.calcChain?[]:t.calcChain},updateFunctionGroup:function(e,t,l,r){null==r&&(r=luckysheet.currentSheetIndex);var a=luckysheet.getluckysheetfile(),s=a[luckysheet.sheetmanage.getSheetIndex(r)].calcChain;if(null!=s)for(var n=0;n<s.length;n++){var o=s[n];if(o.r==e&&o.c==t&&o.index==r){s[n].func=l,luckysheet.server.saveParam("fc",r,JSON.stringify(o),{op:"update",pos:n});break}}luckysheet.setluckysheetfile(a)},insertUpdateFunctionGroup:function(e,t,l,r){if(null==r&&(r=luckysheet.currentSheetIndex),null!=l){var a=luckysheet.getluckysheetfile(),s=a[luckysheet.sheetmanage.getSheetIndex(r)],n=s.calcChain;null==n&&(n=[]);for(var o=0;o<n.length;o++){var c=n[o];if(c.r==e&&c.c==t&&c.index==r)return c.func=l,void luckysheet.server.saveParam("fc",r,JSON.stringify(c),{op:"update",pos:o})}var u={r:e,c:t,index:r,func:l};n.push(u),s.calcChain=n,luckysheet.server.saveParam("fc",r,JSON.stringify(u),{op:"add",pos:s.calcChain.length-1}),luckysheet.setluckysheetfile(a)}else this.delFunctionGroup(e,t,r)},isFunctionRangeSave:!1,isFunctionRange:function(e,t,l){if(null==luckysheet.formula.operatorjson){for(var r=luckysheet.formula.operator.split("|"),a={},s=0;s<r.length;s++)a[r[s].toString()]=1;luckysheet.formula.operatorjson=a}"="==e.substr(0,1)&&(e=e.substr(1));for(var n=e.split(""),s=0,o="",c="",u={bracket:0,comma:0,squote:0,dquote:0},i=luckysheet.getluckysheetfile(),h=null==i[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].dynamicArray_compute?{}:i[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)].dynamicArray_compute;s<n.length;){var d,y=n[s];if("("==y&&0==u.dquote?(u.bracket+=1,0<o.length?c+="luckysheet_function."+o.toUpperCase()+".f(":c+="(",o=""):")"==y&&0==u.dquote?(--u.bracket,c+=luckysheet.formula.isFunctionRange(o,t,l)+")",o=""):","==y&&0==u.dquote?(c+=luckysheet.formula.isFunctionRange(o,t,l)+",",o=""):y in luckysheet.formula.operatorjson&&0==u.dquote?(d="",s+1<n.length&&(d=n[s+1]),y+d in luckysheet.formula.operatorjson?(0<o.length?(c+=luckysheet.formula.isFunctionRange(o,t,l)+y+d,o=""):c+=y+d,s++):0<o.length?(c+=luckysheet.formula.isFunctionRange(o,t,l)+y,o=""):c+=y):o+=y,s==n.length-1&&luckysheet.formula.iscelldata($.trim(o)))if(null!=t&&null!=l){var f=this.getcellrange($.trim(o)),m=f.row,k=f.column;if(t+"_"+l in h){for(var p=!1,g=m[0];g<=m[1];g++)for(var v=k[0];v<=k[1];v++)g+"_"+v in h&&h[g+"_"+v].r==t&&h[g+"_"+v].c==l&&(p=!0);this.isFunctionRangeSave=p?this.isFunctionRangeSave||!0:this.isFunctionRangeSave||!1}else t>=m[0]&&t<=m[1]&&l>=k[0]&&l<=k[1]?this.isFunctionRangeSave=this.isFunctionRangeSave||!0:this.isFunctionRangeSave=this.isFunctionRangeSave||!1}else{1<$.trim(o).split("!").length?this.isFunctionRangeSave=this.isFunctionRangeSave||!0:this.isFunctionRangeSave=this.isFunctionRangeSave||!1}s++}return c},execvertex:{},execFunctionGroupData:null,execFunctionExist:null,execFunctionGroup:function(origin_r,origin_c,value,index,data){null==data&&(data=luckysheet.flowdata),this.execFunctionGroupData=$.extend(!0,[],data),null!=value&&luckysheet.setcellvalue(origin_r,origin_c,this.execFunctionGroupData,value),null==index&&(index=luckysheet.currentSheetIndex);var group=this.getFunctionGroup(index),vertex1={},stack=[],count=0;if(this.execvertex={},null==this.execFunctionExist)for(var luckysheetfile=luckysheet.getluckysheetfile(),i=0;i<group.length;i++){var item=group[i],cell=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(item.index)].data[item.r][item.c];null!=cell&&null!=cell.f&&cell.f==item.func[2]&&(item instanceof Object||(item=eval("("+item+")")),item.color="w",item.parent=null,item.chidren={},item.times=0,vertex1["r"+item.r.toString()+"c"+item.c.toString()]=item,this.isFunctionRangeSave=!1,null!=origin_r&&null!=origin_c?this.isFunctionRange(item.func[2],origin_r,origin_c):this.isFunctionRange(item.func[2]),this.isFunctionRangeSave&&(stack.push(item),this.execvertex["r"+item.r.toString()+"c"+item.c.toString()]=item,count++))}else for(var x=0;x<this.execFunctionExist.length;x++){var cell=this.execFunctionExist[x];if(!("r"+cell.r.toString()+"c"+cell.c.toString()in vertex1))for(var i=0;i<group.length;i++){var item=group[i];item.color="w",item.parent=null,item.chidren={},item.times=0,vertex1["r"+item.r.toString()+"c"+item.c.toString()]=item,this.isFunctionRangeSave=!1,this.isFunctionRange(item.func[2],cell.r,cell.c),this.isFunctionRangeSave&&(stack.push(item),this.execvertex["r"+item.r.toString()+"c"+item.c.toString()]=item,count++)}}for(var x=0,x1=0;0<stack.length;){var u=stack.shift(),v;for(var name in vertex1){u.r==vertex1[name].r&&u.c==vertex1[name].c||(this.isFunctionRangeSave=!1,this.isFunctionRange(vertex1[name].func[2],u.r,u.c),this.isFunctionRangeSave&&(v=vertex1[name],name in this.execvertex||(stack.push(v),this.execvertex[name]=v),count++,this.execvertex[name].chidren["r"+u.r.toString()+"c"+u.c.toString()]=1))}}this.groupValuesRefreshData=[];for(var i=0;i<count;)for(var name in this.execvertex){var u=this.execvertex[name];"w"==u.color?this.functionDFS(u):"b"==u.color&&i++}this.execFunctionExist=null},functionDFS:function(u){for(var chd in u.color="g",u.times+=1,u.chidren){var v=this.execvertex[chd];"w"==v.color&&(v.parent="r"+u.r.toString()+"c"+u.c.toString(),this.functionDFS(v))}u.color="b",window.luckysheet_getcelldata_cache=null;var v=luckysheet.formula.execfunction(u.func[2],u.r,u.c),value=this.execFunctionGroupData[u.r][u.c],fp,sparklines;null==value&&(value={}),value.v=v[1],value.f=v[2],null!=value.spl&&(window.luckysheetCurrentRow=u.r,window.luckysheetCurrentColumn=u.c,window.luckysheetCurrentFunction=this.execFunctionGroupData[u.r][u.c].f,fp=$.trim(luckysheet.formula.functionParser(this.execFunctionGroupData[u.r][u.c].f)),sparklines=eval(fp),value.spl=sparklines),this.groupValuesRefreshData.push({r:u.r,c:u.c,v:value,i:luckysheet.currentSheetIndex}),this.execFunctionGroupData[u.r][u.c]=value},groupValuesRefreshData:[],groupValuesRefresh:function(){if(0<this.groupValuesRefreshData.length){for(var e=0;e<this.groupValuesRefreshData.length;e++){var t=this.groupValuesRefreshData[e];t.i==luckysheet.currentSheetIndex&&(luckysheet.setcellvalue(t.r,t.c,luckysheet.flowdata,t.v),luckysheet.server.saveParam("v",luckysheet.currentSheetIndex,t.v,{r:t.r,c:t.c}))}luckysheet.editor.webWorkerFlowDataCache(luckysheet.flowdata)}},delFunctionGroup:function(e,t,l){null==l&&(l=luckysheet.currentSheetIndex);var r=luckysheet.getluckysheetfile(),a=r[luckysheet.sheetmanage.getSheetIndex(l)].calcChain;if(null!=a)for(var s=0;s<a.length;s++){var n=a[s];if(n.r==e&&n.c==t&&n.index==l){a.splice(s,1),luckysheet.server.saveParam("fc",l,null,{op:"del",pos:s});break}}luckysheet.setluckysheetfile(r)},execfunction1:function(txt,r,c,isrefresh){var fp=$.trim(this.functionParser(txt)),funcf=fp.match(/luckysheet_function/g),funcg=fp.match(/luckysheet_getcelldata/g),funcc=fp.match(/luckysheet_compareWith/g),funclen=0;null==isrefresh&&(isrefresh=!1),null!=funcf&&(funclen+=funcf.length),null!=funcg&&(funclen+=funcg.length),null!=funcc&&(funclen+=funcc.length);var quota1=fp.match(/\(/g),quota2=fp.match(/\)/g),quotalen=0;if(null!=quota1&&(quotalen+=quota1.length),null!=quota2&&(quotalen+=quota2.length),"luckysheet_function."!=fp.substr(0,16)&&"luckysheet_compareWith"!=fp.substr(0,18)||funclen==quotalen/2||(fp+=")","luckysheet_function."==fp.substr(0,16)&&(txt+=")"),this.functionHTMLIndex=0,$("#luckysheet-functionbox-cell").html('<span dir="auto" class="luckysheet-formula-text-color">=</span>'+this.functionHTML(txt))),!this.testFunction(txt,fp))return luckysheet.tooltip.info("提示","公式存在错误"),[!1,this.error.n,txt];var result=null;window.luckysheetCurrentRow=r,window.luckysheetCurrentColumn=c,window.luckysheetCurrentFunction=txt;try{result=eval(fp)}catch(e){var err=e;err=luckysheet.formula.errorInfo(err),result=[luckysheet.formula.error.n,err]}return result instanceof Array?result=result[0]:result instanceof Object&&(result=result.data,result instanceof Array&&(result=result[0])),window.luckysheetCurrentRow=null,window.luckysheetCurrentColumn=null,window.luckysheetCurrentFunction=null,"luckysheet_getcelldata("==fp.substr(0,19)&&(result instanceof Array?result=result.join(","):result instanceof Object&&(result=result.v)),null!=r&&null!=c&&(isrefresh&&this.execFunctionGroup(r,c,result),this.insertUpdateFunctionGroup(r,c,[!0,result,txt])),[!0,result,txt]},execfunction:function(txt,r,c,isrefresh,notInsertFunc){if(-1<txt.indexOf(this.error.r))return[!1,this.error.r,txt];this.checkBracketNum(txt)||(txt+=")");var fp=$.trim(this.functionParser(txt));if("luckysheet_function."!=fp.substr(0,16)&&"luckysheet_compareWith"!=fp.substr(0,18)||(this.functionHTMLIndex=0),!this.testFunction(txt,fp)||""==fp)return luckysheet.tooltip.info("提示","公式存在错误"),[!1,this.error.n,txt];var result=null;window.luckysheetCurrentRow=r,window.luckysheetCurrentColumn=c,window.luckysheetCurrentFunction=txt;var sparklines=null,isErr,luckysheetfile,file,dynamicArray,result;try{if(-1<fp.indexOf("luckysheet_getcelldata"))for(var funcg=fp.split("luckysheet_getcelldata('"),i=1;i<funcg.length;i++){var funcgStr=funcg[i].split("')")[0],funcgRange=luckysheet.formula.getcellrange(funcgStr);if(funcgRange.row[0]<0||funcgRange.column[0]<0)return[!0,luckysheet.formula.error.r,txt];if(funcgRange.sheetIndex==luckysheet.currentSheetIndex&&r>=funcgRange.row[0]&&r<=funcgRange.row[1]&&c>=funcgRange.column[0]&&c<=funcgRange.column[1])return luckysheet.luckysheetConfigsetting.editMode?alert("公式不可引用其本身的单元格"):luckysheet.tooltip.info("公式不可引用其本身的单元格，会导致计算结果不准确",""),[!1,0,txt]}result=eval(fp),-1<fp.indexOf("SPLINES")&&(sparklines=result,result="")}catch(e){var err=e;err=luckysheet.formula.errorInfo(err),result=[luckysheet.formula.error.n,err]}return"object"==luckysheet.getObjType(result)&&null!=result.startCell&&(result="array"==luckysheet.getObjType(result.data)?luckysheet.formula.error.v:null==result.data||luckysheet.func_methods.isRealNull(result.data.v)?0:result.data.v),"array"==luckysheet.getObjType(result)&&(isErr=!1,"array"!=luckysheet.getObjType(result[0])&&2==result.length&&(isErr=luckysheet.func_methods.valueIsError(result[0])),result=isErr?result[0]:"array"==luckysheet.getObjType(result[0])&&1==result.length&&1==result[0].length?result[0][0]:(luckysheetfile=luckysheet.getluckysheetfile(),file=luckysheetfile[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)],dynamicArray=null==file.dynamicArray?[]:file.dynamicArray,dynamicArray.push({r:r,c:c,f:txt,data:result}),file.dynamicArray=dynamicArray,luckysheet.setluckysheetfile(luckysheetfile),"")),window.luckysheetCurrentRow=null,window.luckysheetCurrentColumn=null,window.luckysheetCurrentFunction=null,null!=r&&null!=c&&(isrefresh&&this.execFunctionGroup(r,c,result),notInsertFunc||this.insertUpdateFunctionGroup(r,c,[!0,result,txt])),sparklines?[!0,result,txt,{type:"sparklines",data:sparklines}]:[!0,result,txt]},testFunction:function(e,t){return"="==e.substr(0,1)},functionResizeData:{},functionResizeStatus:!1,functionResizeTimeout:null,data_parm_index:0},luckysheet.functionlist=[{n:"SUMIF",t:0,d:"对范围中符合指定条件的值求和。",a:"对范围中符合指定条件的值求和。",m:[2,3],p:[{name:"范围",detail:"要根据条件进行检测的范围。",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"条件",detail:"要应用于范围的模式或测试条件。\n\n如果范围包含的是要检测的文本，则条件必须为字符串。条件可以包含通配符，包括用于匹配单个字符的?或用于匹配零个或连续多个字符的*。要匹配问号星号本身，请在该字符前面加上波浪号(~)前缀（即~?和~*）。字符串条件必须用引号括起来。函数会检查范围中的每个单元格与条件是否相等或匹配（如果使用了通配符）。\n\n如果范围包含的是要检测的数字，则条件可以是字符串也可以是数字。如果给定的条件是一个数字，则检查范围中的每个单元格是否等于条件。另外，条件也可能是包含数字的字符串（也将对其进行相等检测），或者带有以下前缀的数字：=（检查是否相等）、>（检查范围单元格的值是否大于条件值）或<（检查范围单元格的值是否小于条件值）",example:'">20"',require:"m",repeat:"n",type:"rangeall"},{name:"求和范围",detail:"要求和的范围（如果与范围不同）。",example:"B1:B10",require:"o",repeat:"n",type:"range"}]},{n:"TAN",t:0,d:"返回已知角度的正切值。",a:"返回已知角度的正切值。",m:[1,1],p:[{name:"角度",detail:"要求其正切值的角度，以弧度表示。",example:"45*PI()/180",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TANH",t:0,d:"返回给定实数的双曲正切值。",a:"返回给定实数的双曲正切值。",m:[1,1],p:[{name:"值",detail:"要计算其双曲正切值的实数。",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CEILING",t:0,d:"将数值向上取整为最接近的指定因数的倍数。",a:"将数值向上取整为最接近的指定因数的倍数。",m:[2,2],p:[{name:"值",detail:"要向上舍入的数值。",example:"23.25",require:"m",repeat:"n",type:"rangenumber"},{name:"因数",detail:"要将值舍入到此数的整数倍。",example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ATAN",t:0,d:"返回数值的反正切值，以弧度表示。",a:"返回数值的反正切值",m:[1,1],p:[{name:"值",detail:"要计算其反正切值的数值。",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ASINH",t:0,d:"返回数值的反双曲正弦值。",a:"返回数值的反双曲正弦值。",m:[1,1],p:[{name:"值",detail:"要计算其反双曲正弦值的数值。",example:"0.9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ABS",t:0,d:"返回数值的绝对值。",a:"返回数值的绝对值。",m:[1,1],p:[{name:"value",detail:"要返回其绝对值的数。",example:"-2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ACOS",t:0,d:"返回数值的反余弦值，以弧度表示。",a:"返回数值的反余弦值",m:[1,1],p:[{name:"值",detail:"要计算其反余弦值的数值。必须介于-1和1之间，包括两端值。",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ACOSH",t:0,d:"返回数值的反双曲余弦值。",a:"返回数值的反双曲余弦值。",m:[1,1],p:[{name:"值",detail:"要计算其反双曲余弦值的数值。必须大于等于1。",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MULTINOMIAL",t:0,d:"返回参数和的阶乘除以各参数阶乘的乘积后得到的值。",a:"返回参数和的阶乘除以各参数阶乘的乘积后得到的值。",m:[1,255],p:[{name:"值1",detail:"用于计算的第一项数值或范围。",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"值2",detail:"用于计算的其他数值或范围。",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"ATANH",t:0,d:"返回数值的反双曲正切值。",a:"返回数值的反双曲正切值。",m:[1,1],p:[{name:"值",detail:"要计算其反双曲正切值的数值。必须介于-1和1之间（不包括-1和1）。",example:"0.9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ATAN2",t:0,d:"以弧度为单位返回 x 轴与从原点 (0,0) 到指定坐标点 (`x`,`y`) 之间连线的夹角。",a:"以弧度为单位返回 x 轴与从原点 (0,0) 到指定坐标点 (`x`,`y`) 之间连线的夹角。",m:[2,2],p:[{name:"x",detail:"要计算其与x轴夹角大小的线段的终点x坐标。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"y",detail:"要计算其与x轴夹角大小的线段的终点y坐标。",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUNTBLANK",t:1,d:"返回给定范围内的空单元格数。",a:"返回给定范围内的空单元格数。",m:[1,1],p:[{name:"范围",detail:"要统计空白单元格数量的范围。",example:"A2:C100",require:"m",repeat:"n",type:"range"}]},{n:"COSH",t:0,d:"返回给定实数的双曲余弦值。",a:"返回给定实数的双曲余弦值。",m:[1,1],p:[{name:"值",detail:"要计算其双曲余弦值的实数值。",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"INT",t:0,d:"将数值向下取整为小于或等于该数的最接近的整数。",a:"将数值向下取整为小于或等于该数的最接近的整数。",m:[1,1],p:[{name:"值",detail:"要向下取整为最接近的整数的数值。",example:"99.44",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ISEVEN",t:0,d:"检查所提供的数值是否为偶数。",a:"检查所提供的数值是否为偶数。",m:[1,1],p:[{name:"值",detail:"要验证其是否为偶数的数值。\n\n如果值为偶数或指向包含偶数的单元格的引用，ISEVEN将返回TRUE，否则返回FALSE。",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ISODD",t:0,d:"检查所提供的数值是否为奇数。",a:"检查所提供的数值是否为奇数。",m:[1,1],p:[{name:"值",detail:"要验证其是否为奇数的数值。\n\n如果值为奇数或指向包含奇数的单元格，ISODD将返回TRUE，否则返回FALSE。",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LCM",t:0,d:"返回一个或多个整数的最小公倍数。",a:"返回一个或多个整数的最小公倍数。",m:[1,255],p:[{name:"值1",detail:"要在求最小公倍数数的计算中检查其因数的第一项数值或范围。",example:"A2:A5",require:"m",repeat:"n",type:"rangeall"},{name:"值2",detail:"[可选] - 在求最小公倍数时要考虑其因数的其他数值或范围。",example:"3",require:"o",repeat:"y",type:"rangeall"}]},{n:"LN",t:0,d:"返回数值以 e（欧拉数）为底的对数。",a:"返回数值以 e（欧拉数）为底的对数。",m:[1,1],p:[{name:"值",detail:"要以 e 为底数计算其对数的值。\n\n值必须为正数。",example:"100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LOG",t:0,d:"根据指定底数返回数字的对数。",a:"根据指定底数返回数字的对数。",m:[1,2],p:[{name:"值",detail:"想要计算其对数的正实数。",example:"128",require:"m",repeat:"n",type:"rangenumber"},{name:"底数",detail:"[可选] - 对数的底数。",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"LOG10",t:0,d:"返回数值以10为底的对数。",a:"返回数值以10为底的对数。",m:[1,1],p:[{name:"值",detail:"要计算其以10为底的对数的数值。\n\n值必须为正值。",example:"100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MOD",t:0,d:"返回两数相除的余数, 结果的符号与除数相同。",a:"返回两数相除的余数。",m:[2,2],p:[{name:"被除数",detail:"要将其相除以得到余数的数值。",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"除数",detail:"用于除其他数的数值。",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MROUND",t:0,d:"将数值取整为另一整数最接近的整数倍。",a:"将数值取整为另一整数最接近的整数倍。",m:[2,2],p:[{name:"值",detail:"要取整为另一整数最接近的整数倍的数值。",example:"21",require:"m",repeat:"n",type:"rangenumber"},{name:"因数",detail:"值将取此因数的整数倍。",example:"14",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ODD",t:0,d:"将数值向上取整为最接近的奇整数。",a:"将数值向上取整为最接近的奇整数。",m:[1,1],p:[{name:"值",detail:"要向上取整的数值，取整值为大于此值的最接近的奇数。\n\n如果值为负数，则将其取整为绝对值大于该值的相邻负奇数。",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMSQ",t:0,d:"返回一组数值和/或单元格的平方总和。",a:"返回一组数值和/或单元格的平方总和。",m:[1,255],p:[{name:"值1",detail:"要将其平方相加的第一个数值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"值2, ...",detail:"[可选] - 要将其平方与值1的平方相加的其他数值或范围。",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"COMBIN",t:0,d:"给定集合中的对象总数和要选择的对象数量，返回共有多少种不同选择方式。",a:"给定集合中的对象总数和要选择的对象数量",m:[2,2],p:[{name:"n",detail:"要从中进行选择的对象集合的大小。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"k",detail:"要选择的对象数量。",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUM",t:0,d:"返回一组数值和/或单元格的总和。",a:"返回一组数值和/或单元格的总和。",m:[1,255],p:[{name:"值1",detail:"要相加的第一个数值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"值2",detail:"[可选] - 要相加的其他数值或范围。",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"SUBTOTAL",t:0,d:"使用指定的汇总函数，返回一系列纵向单元格的分类汇总。",a:"使用指定的汇总函数",m:[2,256],p:[{name:"函数代码",detail:"用于计算分类汇总的函数。\n\n1代表AVERAGE\n\n2代表COUNT\n\n3代表COUNTA\n\n4代表MAX\n\n5代表MIN\n\n6代表PRODUCT\n\n7代表STDEV\n\n8代表STDEVP\n\n9代表SUM\n\n10代表VAR\n\n11代表VARP\n\n通过在这些2位代码前附加10（对于1位代码）或1（对于2位代码），可以将隐藏值忽略。例如，102代表忽略隐藏单元格的COUNT，而110则代表忽略隐藏值的VAR。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"范围1",detail:"要计算分类汇总的第一个范围。",example:"A2:A5",require:"m",repeat:"n",type:"range"},{name:"范围2",detail:"[可选] - 要计算分类汇总的其他范围。",example:"B2:B8",require:"o",repeat:"y",type:"range"}]},{n:"ASIN",t:0,d:"返回数值的反正弦值，以弧度表示。",a:"返回数值的反正弦值",m:[1,1],p:[{name:"值",detail:"要计算其反正弦值的数值。必须介于-1和1之间，包括两端值。",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUNTIF",t:1,d:"返回范围内满足某个条件的单元格的数量。",a:"返回范围内满足某个条件的单元格的数量。",m:[2,2],p:[{name:"范围",detail:"要根据条件进行检测的范围。",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"条件",detail:"要应用于范围的模式或测试条件。\n\n如果范围包含的是要检测的文本，则条件必须为字符串。条件可以包含通配符，包括用于匹配单个字符的?或用于匹配零个或连续多个字符的*。要匹配问号星号本身，请在该字符前面加上波浪号(~)前缀（即~?和~*）。字符串条件必须用引号括起来。函数会检查范围中的每个单元格与条件是否相等或匹配（如果使用了通配符）。\n\n如果范围包含的是要检测的数字，则条件可以是字符串也可以是数字。如果给定的条件是一个数字，则检查范围中的每个单元格是否等于条件。另外，条件也可能是包含数字的字符串（也将对其进行相等检测），或者带有以下前缀的数字：=、>、>=、<或<=，这些条件将分别用于检查范围中的单元格是否等于、大于、大于等于、小于、小于等于条件值。",example:'">20"',require:"m",repeat:"n",type:"rangeall"}]},{n:"RADIANS",t:0,d:"将以度表示的角度值转换为弧度。",a:"将以度表示的角度值转换为弧度。",m:[1,1],p:[{name:"角度",detail:"要从度转换为弧度的角度。",example:"180",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RAND",t:0,d:"返回一个介于0和1之间（包括0但不包括1）的随机数。",a:"返回一个介于0和1之间（包括0但不包括1）的随机数。",m:[0,0],p:[]},{n:"COUNTUNIQUE",t:0,d:"计算一列指定值和范围中不重复数值的个数。",a:"计算一列指定值和范围中不重复数值的个数。",m:[1,255],p:[{name:"值1",detail:"要检查其是否唯一的第一个值或范围。",example:"A1:C100",require:"m",repeat:"n",type:"rangeall"},{name:"值2",detail:"[可选] - 要检查是否唯一的其他值或范围。",example:"1",require:"o",repeat:"n",type:"rangeall"}]},{n:"DEGREES",t:0,d:"将以弧度表示的角度值转换为度。",a:"将以弧度表示的角度值转换为度。",m:[1,1],p:[{name:"角度",detail:"要从弧度转换为度的角度。",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ERFC",t:9,d:"返回数值的互补高斯误差函数。",a:"返回数值的互补高斯误差函数。",m:[1,1],p:[{name:"z",detail:"要为其计算互补高斯误差函数的数值。",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EVEN",t:0,d:"将数值向上取整为最接近的偶整数。",a:"将数值向上取整为最接近的偶整数。",m:[1,1],p:[{name:"值",detail:"要向上取整的数值，取整值为大于此值的最接近的偶数。\n\n如果值为负数，则将其取整为绝对值大于该值的相邻负偶数。",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EXP",t:0,d:"返回欧拉数 e (~2.718) 的指定次幂。",a:"返回欧拉数 e (~2.718) 的指定次幂。",m:[1,1],p:[{name:"指数",detail:"指定e的自乘幂次值。",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FACT",t:0,d:"返回数值的阶乘。",a:"返回数值的阶乘。",m:[1,1],p:[{name:"值",detail:"要计算并返回其阶乘的数字或对数字（所在单元格）的引用。",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FACTDOUBLE",t:0,d:"返回数值的“双阶乘”。",a:"返回数值的“双阶乘”。",m:[1,1],p:[{name:"值",detail:"要计算并返回其双阶乘的数字或对数字（所在单元格）的引用。",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PI",t:0,d:"返回带有14位小数的 PI 值。",a:"返回带有14位小数的 PI 值。",m:[0,0],p:[]},{n:"FLOOR",t:0,d:"将数值向下取整为指定因数的最接近的整数倍。",a:"将数值向下取整为指定因数的最接近的整数倍。",m:[2,2],p:[{name:"值",detail:"要向下舍入为因数的最接近整数倍的数值。",example:"23.25",require:"m",repeat:"n",type:"rangenumber"},{name:"因数",detail:"要将值舍入到此数的整数倍。\n\n因数不得为0。",example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GCD",t:0,d:"返回一个或多个整数的最大公约数。",a:"返回一个或多个整数的最大公约数。",m:[1,255],p:[{name:"值1",detail:"要在查找最大公约数的计算中检查其因数的第一项数值或范围。",example:"A2:A5",require:"m",repeat:"n",type:"rangeall"},{name:"值2",detail:"[可选] - 在求最大公约数时要考虑其因数的其他数值或范围。",example:"96",require:"o",repeat:"y",type:"rangeall"}]},{n:"RANDBETWEEN",t:0,d:"返回介于两个整数之间（包括这两个整数）的随机数。",a:"返回介于两个整数之间（包括这两个整数）的随机数。",m:[2,2],p:[{name:"下界",detail:"随机值范围的下界。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"上界",detail:"随机值范围的上界。",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUND",t:0,d:"将数字四舍五入到指定的位数。",a:"将数字四舍五入到指定的位数。",m:[2,2],p:[{name:"值",detail:"要四舍五入的数字。",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"位数",detail:"要进行四舍五入运算的位数。\n\n位数可以取负值，在这种情况下会将值的小数点左侧部分舍入到指定的位数。",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUNDDOWN",t:0,d:"朝着零的方向将数字进行向下舍入。",a:"朝着零的方向将数字进行向下舍入。",m:[2,2],p:[{name:"值",detail:"需要向下舍入的任意实数。",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"位数",detail:"要通过舍入达到的小数位数。\n\n位数可以取负值，在这种情况下会将值的小数点左侧部分舍入到指定的位数。",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUNDUP",t:0,d:"朝着远离 0（零）的方向将数字进行向上舍入。",a:"朝着远离 0（零）的方向将数字进行向上舍入。",m:[2,2],p:[{name:"值",detail:"要将其舍入为位数位数字的值，始终向上舍入。",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"位数",detail:"要通过舍入达到的小数位数。\n\n位数可以取负值，在这种情况下会将值的小数点左侧部分舍入到指定的位数。",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SERIESSUM",t:0,d:"给定参数 x、n、m 和 a，返回幂级数的和 a1xn + a2x(n+m) + ... + aix(n+(i-1)m)，其中 i 为范围 a 中的项数。",a:"给定参数 x、n、m 和 a",m:[4,4],p:[{name:"x",detail:"幂级数的输入值。随相应的近似类型而变，有可能为角度、指数或其他一些值。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"n",detail:"在幂级数中x的初始自乘幂次。",example:"0",require:"m",repeat:"n",type:"rangenumber"},{name:"m",detail:"x的幂次中的附加增量。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"a",detail:"包含幂级数系数的数组或范围。",example:"{FACT(0)",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SIGN",t:0,d:"给定输入数值，如果为负返回-1；如果为正返回1；如果为零则返回0。",a:"给定输入数值",m:[1,1],p:[{name:"值",detail:"要返回其符号的数值。",example:"-42",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SIN",t:0,d:"给定角度（以弧度表示），返回其正弦值。",a:"给定角度（以弧度表示）",m:[1,1],p:[{name:"角度",detail:"要返回其正弦值的角度，以弧度表示。",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SINH",t:0,d:"返回给定实数的双曲正弦值。",a:"返回给定实数的双曲正弦值。",m:[1,1],p:[{name:"值",detail:"要计算其双曲正弦值的实数值。",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SQRT",t:0,d:"返回一个正数的正平方根。",a:"返回一个正数的正平方根。",m:[1,1],p:[{name:"值",detail:"要计算其正平方根的数值。\n\n值必须为正数；如果为负，SQRT 将返回 #NUM! 错误。",example:"9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SQRTPI",t:0,d:"返回 PI 与给定正数乘积的正平方根。",a:"返回 PI 与给定正数乘积的正平方根。",m:[1,1],p:[{name:"值",detail:"要将其与 PI 相乘并返回该乘积的平方根的数值\n\n值必须为正数；如果为负数，SQRTPI 将返回 #NUM! 错误。",example:"9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GAMMALN",t:1,d:"返回指定伽玛函数的以 e（欧拉数）为底的对数。",a:"返回指定伽玛函数的以 e（欧拉数）为底的对数。",m:[1,1],p:[{name:"值",detail:"伽玛函数的输入值。返回的将是伽玛 (值) 的自然对数。\n\n值必须为正数。",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COS",t:0,d:"返回给定角度的余弦值（角度以弧度表示）。",a:"返回给定角度的余弦值（角度以弧度表示）。",m:[1,1],p:[{name:"角度",detail:"要取其余弦值的角度，以弧度表示。",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRUNC",t:0,d:"截除指定有效位之外的部分，取数据的指定有效位。",a:"截除指定有效位之外的部分",m:[1,2],p:[{name:"值",detail:"要截取的数据。",example:"3.141592654",require:"m",repeat:"n",type:"rangenumber"},{name:"位数",detail:"[可选 - 默认值为0] - 小数点右侧要保留的有效位数。\n\n如果位数大于值中的有效位数，则将“值”原样返回。\n\n位数可以取负值，在这种情况下会将小数点左侧指定位数的值更改为零。小数点右侧的所有位数都会被舍弃。如果值的所有位都被更改为零，则TRUNC会返回0。",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"QUOTIENT",t:0,d:"返回以一个数除以另一个数所得的结果，不包含余数。",a:"返回以一个数除以另一个数所得的结果",m:[2,2],p:[{name:"被除数",detail:"要被除的数值。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"除数",detail:"用于除其他数的数值。\n\n除数不得为0。",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"POWER",t:0,d:"返回数值的指定次幂。",a:"返回数值的指定次幂。",m:[2,2],p:[{name:"底数",detail:"要计算其指数次幂的数值。\n\n如果底数为负，则指数必须为整数。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"指数",detail:"指定底数的自乘幂次值。",example:"0.5",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMIFS",t:0,d:"根据多项条件返回范围之和。",a:"根据多项条件返回范围之和。",m:[3,257],p:[{name:"求和范围",detail:"要对其求和的范围。",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"条件范围1",detail:"要在哪个范围内检查条件1。",example:" B1:B10",require:"m",repeat:"n",type:"range"},{name:"条件1",detail:"要应用于条件范围1的模式或测试条件。",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"条件范围2, 条件2...",detail:"[ 可选 ] - 要检查的其他范围和条件。",example:" C1:C10",require:"o",repeat:"y",type:"rangeall"}]},{n:"COUNTIFS",t:1,d:"根据多项条件返回范围中的单元格数量。",a:"根据多项条件返回范围中的单元格数量。",m:[2,256],p:[{name:"条件范围1",detail:"要在哪个范围内检查条件1。",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"条件1",detail:"要应用于条件范围1的模式或测试条件。",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"条件范围2, 条件2...",detail:"[ 可选 ] - 要检查的其他范围和条件，可重复。",example:" B1:B10",require:"o",repeat:"y",type:"rangeall"}]},{n:"PRODUCT",t:0,d:"返回将一组数相乘所得的结果。",a:"返回将一组数相乘所得的结果。",m:[1,255],p:[{name:"乘数1",detail:"用于计算乘积的第一个数值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"乘数2 ... 乘数30",detail:"[可选] - 要相乘的其他数值。",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"HARMEAN",t:1,d:"计算数据集的调和平均值。",a:"计算数据集的调和平均值。",m:[1,255],p:[{name:"值1",detail:"样本中的第一项值或范围。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"值2, ...",detail:"[可选] - 数据集中包含的其他数值或范围。",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"HYPGEOMDIST",t:1,d:"返回超几何分布。 如果已知样本量、总体成功次数和总体大小，则 HYPGEOM.DIST 返回样本取得已知成功次数的概率。",a:"返回超几何分布。",m:[5,5],p:[{name:"Sample_s",detail:"样本中成功的次数。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"Number_sample",detail:"样本量。",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"Population_s",detail:"总体中成功的次数。",example:"20",require:"m",repeat:"n",type:"rangenumber"},{name:"Number_pop",detail:"总体大小。",example:"40",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"决定函数形式的逻辑值。\n\n如果 cumulative 为 TRUE()，则 HYPGEOM.DIST 返回累积分布函数；\n\n如果为 FALSE()，则返回概率密度函数。",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"INTERCEPT",t:1,d:"计算数据集的线性回归方程直线与 Y 轴的相交点 (x=0) 的 y 值。",a:"计算数据集的线性回归方程直线与 Y 轴的相交点 (x=0) 的 y 值。",m:[2,2],p:[{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"KURT",t:1,d:"计算数据集的峭度，该指标指示数据集（分布）的形态，尤其是该形态的陡峭程度。",a:"计算数据集的峭度",m:[1,255],p:[{name:"值1",detail:"数据集中的第一个值或范围。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"值2, ...",detail:"[可选] - 数据集中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"LARGE",t:1,d:"返回数据集中第 n 个最大元素，n 由用户指定。",a:"返回数据集中第 n 个最大元素",m:[2,2],p:[{name:"数据",detail:"包含相关数据集的数组或范围。",example:"A2:B100",require:"m",repeat:"n",type:"rangenumber"},{name:"n",detail:"要返回的元素的排行位置（从大到小顺序）。\n\n例如，将n设为4将使LARGE返回数据中排名第4的最大元素。",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"STDEVA",t:1,d:"基于样本计算标准偏差，将文本取值为0。",a:"基于样本计算标准偏差",m:[1,255],p:[{name:"值1",detail:"样本中的第一项值或范围。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"值2,…",detail:"[可选] - 样本中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"STDEVP",t:1,d:"基于样本总体计算标准偏差。",a:"基于样本总体计算标准偏差。",m:[1,255],p:[{name:"值1",detail:"数据集中的第一个值或范围。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"值2, ...",detail:"[可选] - 数据集中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"GEOMEAN",t:1,d:"计算数据集的几何平均值。",a:"计算数据集的几何平均值。",m:[1,255],p:[{name:"值1",detail:"样本中的第一项值或范围。",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"值2, ...",detail:"[可选] - 数据集中包含的其他数值或范围。",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"RANK_EQ",t:1,d:"返回指定值在数据集中的排名。如果相同的值在数据集中存在多项，则返回其中的最高排名。",a:"返回指定值在数据集中的排名。如果相同的值在数据集中存在多项，则返回其中的最高排名。",m:[2,3],p:[{name:"number",detail:"要确定其排名的值。",example:"A10",require:"m",repeat:"n",type:"rangenumber"},{name:"ref",detail:"包含相关数据集的数组或范围。",example:"A1:A100",require:"m",repeat:"n",type:"range"},{name:"order",detail:"[可选 - 默认为按降序 (FALSE()) ] - 要按升序还是按降序考虑“data”中的值。",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"RANK_AVG",t:1,d:"返回指定值在数据集中的排名。如果相同的值在数据集中存在多项，则返回这些项排名的平均值。",a:"返回指定值在数据集中的排名。如果相同的值在数据集中存在多项，则返回这些项排名的平均值。",m:[2,3],p:[{name:"number",detail:"要确定其排名的值。",example:"A10",require:"m",repeat:"n",type:"rangenumber"},{name:"ref",detail:"包含相关数据集的数组或范围。",example:"A1:A100",require:"m",repeat:"n",type:"range"},{name:"order",detail:"[可选 - 默认为按降序 (FALSE()) ] - 要按升序还是按降序考虑“data”中的值。",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"PERCENTRANK_EXC",t:1,d:"以百分数形式返回指定值在给定数据集中的百分比排名（介于0和1之间，不包括两端值）。",a:"以百分数形式返回指定值在给定数据集中的百分比排名（介于0和1之间，不包括两端值）。",m:[2,3],p:[{name:"data",detail:"包含相关数据集的数组或范围。",example:"A1:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"x",detail:"要确定其百分比排位的值。",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"significance",detail:"[可选 - 默认值为 3] - 要在计算中使用的有效位数。",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PERCENTRANK_INC",t:1,d:"以百分比形式返回指定值在给定数据集中的百分比排名（介于0和1之间，包括两端值）。",a:"以百分比形式返回指定值在给定数据集中的百分比排名（介于0和1之间，包括两端值）。",m:[2,3],p:[{name:"data",detail:"包含相关数据集的数组或范围。",example:"A1:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"x",detail:"要确定其百分比排位的值。",example:" A2",require:"m",repeat:"n",type:"rangenumber"},{name:"significance",detail:"[可选 - 默认值为 3] - 要在计算中使用的有效位数。",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FORECAST",t:1,d:"基于数据集的线性回归，计算指定 x 的预期 y 值。",a:"基于数据集的线性回归",m:[3,3],p:[{name:"x",detail:"x轴上用于预测的值。",example:"A1",require:"m",repeat:"n",type:"rangenumber"},{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FISHERINV",t:1,d:"返回指定数值的 Fisher 逆变换。",a:"返回指定数值的 Fisher 逆变换。",m:[1,1],p:[{name:"y",detail:"要计算其Fisher逆变换的数值。",example:"0.962",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FISHER",t:1,d:"返回指定数值的 Fisher 变换。",a:"返回指定数值的 Fisher 变换。",m:[1,1],p:[{name:"x",detail:"要计算其Fisher变换的数值。",example:"0.962",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MODE_SNGL",t:1,d:"返回数据集中出现次数最多的值。",a:"返回数据集中出现次数最多的值。",m:[1,255],p:[{name:"值1",detail:"计算模式时要检查的第一个值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"值2, ...",detail:"[可选] - 在计算模式时要考虑的其他数值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"WEIBULL_DIST",t:1,d:"给定形状和尺度，返回韦伯分布函数（或韦伯累积分布函数）的值。",a:"给定形状和尺度",m:[4,4],p:[{name:"x",detail:"WEIBULL 分布函数的输入值。",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"alpha",detail:"Weibull 分布函数的形状参数。\n\nalpha 值必须大于 0。",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"beta",detail:"Weibull 分布函数的尺度参数。\n\nbeta 值必须大于 0。",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"TRUE() 表示使用累积分布函数，FALSE() 则表示使用概率密度函数。",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"COUNT",t:1,d:"返回数据集中数值的个数。",a:"返回数据集中数值的个数。",m:[1,255],p:[{name:"值1",detail:"计数时要检查的第一个值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"值2, ...",detail:"[可选] - 在计数时要检查的其他值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"COUNTA",t:1,d:"返回数据集中值的数量。",a:"返回数据集中值的数量。",m:[1,255],p:[{name:"值1",detail:"计数时要检查的第一个值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"值2, ...",detail:"[可选] - 在计数时要检查的其他值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"AVEDEV",t:1,d:"计算数据与数据集均值之间的偏差大小的平均值。",a:"计算数据与数据集均值之间的偏差大小的平均值。",m:[1,255],p:[{name:"值1",detail:"样本中的第一项值或范围。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"值2, ...",detail:"[可选] - 样本中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"AVERAGE",t:1,d:"返回数据集的算术平均值，对文本忽略不计。",a:"返回数据集的算术平均值",m:[1,255],p:[{name:"值1",detail:"计算平均值时用到的第一个数值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"值2, ...",detail:"[可选] - 在计算平均值时要考虑的其他数值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"AVERAGEA",t:1,d:"返回数据集的算术平均值。",a:"返回数据集的算术平均值。",m:[1,255],p:[{name:"值1",detail:"计算平均值时用到的第一个数值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"值2, ...",detail:"[可选] - 在计算平均值时要考虑的其他数值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"BINOM_DIST",t:1,d:"返回一元二项式分布的概率。",a:"返回一元二项式分布的概率。",m:[4,4],p:[{name:"number_s",detail:"试验的成功次数。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"trials",detail:"独立检验的次数。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"probability_s",detail:"任一给定检验的成功概率。",example:"0.005",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"是否使用二项式累积分布。",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"BINOM_INV",t:1,d:"计算累积二项式分布大于或等于指定条件的最小值。",a:"计算累积二项式分布大于或等于指定条件的最小值。",m:[3,3],p:[{name:"trials",detail:"贝努利试验次数。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"probability_s",detail:"任一次给定检验的成功概率。",example:"0.005",require:"m",repeat:"n",type:"rangenumber"},{name:"alpha",detail:"期望的临界概率。",example:"0.8",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONFIDENCE_NORM",t:1,d:"计算正态分布的置信区间的一半宽度。",a:"计算正态分布的置信区间的一半宽度。",m:[3,3],p:[{name:"alpha",detail:"用来计算置信水平的显著性水平。\n\n置信水平等于 100*(1 - alpha)%，亦即，如果 alpha 为 0.05，则置信水平为 95%。",example:"0.05",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"数据区域的总体标准偏差。",example:"1.6",require:"m",repeat:"n",type:"rangenumber"},{name:"size",detail:"样本总量的大小。",example:"250",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CORREL",t:1,d:"计算给定数据集的皮尔逊积矩相关系数 r。",a:"计算给定数据集的皮尔逊积矩相关系数 r。",m:[2,2],p:[{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COVARIANCE_P",t:1,d:"计算数据集的总体协方差。",a:"计算数据集的总体协方差。",m:[2,2],p:[{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"},{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COVARIANCE_S",t:1,d:"计算数据集的样本协方差。",a:"计算数据集的样本协方差。",m:[2,2],p:[{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DEVSQ",t:1,d:"基于样本计算其偏差的平方和。",a:"基于样本计算其偏差的平方和。",m:[1,255],p:[{name:"值1",detail:"样本中的第一项值或范围。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"值2, ...",detail:"[可选] - 样本中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"EXPON_DIST",t:1,d:"返回带有指定 Lambda 和指定值的指数分布函数的值。",a:"返回带有指定 Lambda 和指定值的指数分布函数的值。",m:[3,3],p:[{name:"x",detail:"指数分布函数的输入值。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"lambda",detail:"用于指定指数分布函数的 lambda 值。",example:"0.5",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"是否使用指数累积分布。",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"AVERAGEIF",t:1,d:"根据条件返回范围的平均值。",a:"根据条件返回范围的平均值。",m:[2,3],p:[{name:"criteria_range",detail:"要对其检查 criterion 的范围。",example:"A1:A10",require:"m",repeat:"n",type:"rangeall"},{name:"criterion",detail:'要应用于 criteria_range 的模式或测试条件。\n\n等于："文本" 或 1 或 "=文本" 或 "=1"\n\n大于：">1"\n\n大于等于：">=1"\n\n小于："<1"\n\n小于等于："<=1"\n\n不等于："<>1"或"<>文本"',example:'">20"',require:"m",repeat:"n",type:"rangeall"},{name:"average_range",detail:"[可选] - 要计算平均值的范围。如果未提供此参数，则改用 criteria_range 来计算平均值。",example:"B1:B10",require:"o",repeat:"n",type:"rangeall"}]},{n:"AVERAGEIFS",t:1,d:"根据多项条件返回范围的平均值。",a:"根据多项条件返回范围的平均值。",m:[2,255],p:[{name:"average_range",detail:"要计算平均值的范围。",example:"A1:A10",require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range1",detail:"要对其检查 criterion1 的范围。",example:" B1:B10",require:"m",repeat:"n",type:"rangeall"},{name:"criterion1",detail:"要应用于 criteria_range1 的模式或测试条件。",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range2, criterion2, ...",detail:"[可选] - 要检查的其他范围和条件。",example:" C1:C10",require:"m",repeat:"n",type:"rangeall"}]},{n:"PERMUT",t:1,d:"返回可从数字对象中选择的给定数目对象的排列数。",a:"返回可从数字对象中选择的给定数目对象的排列数。",m:[2,2],p:[{name:"number",detail:"表示对象个数的整数。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"number_chosen",detail:"表示每个排列中对象个数的整数。",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRIMMEAN",t:1,d:"在排除数据集高低两端的部分数据之后计算所得的均值。",a:"在排除数据集高低两端的部分数据之后计算所得的均值。",m:[2,2],p:[{name:"数据",detail:"包含相关数据集的数组或范围。",example:"A2:A100",require:"m",repeat:"n",type:"range"},{name:"排除比例",detail:"要从数据集的极值部分排除的数据占数据集的比例。\n\n排除比例必须大于等于0且小于1。",example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PERCENTILE_EXC",t:1,d:"返回数组的 K 百分点值，K 介于 0 到 1 之间，不含 0 与 1。",a:"返回数组的 K 百分点值，K 介于 0 到 1 之间，不含 0 与 1。",m:[2,2],p:[{name:"array",detail:"定义相对位置的数组或数据区域。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"k",detail:"0 到 1 之间的百分点值，不包含 0 和 1。",example:"0.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PERCENTILE_INC",t:1,d:"返回数组的 K 百分点值，K 介于 0 到 1 之间，包含 0 与 1。",a:"返回数组的 K 百分点值，K 介于 0 到 1 之间，包含 0 与 1。",m:[2,2],p:[{name:"array",detail:"定义相对位置的数组或数据区域。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"k",detail:"0 到 1 之间的百分点值，包含 0 和 1。",example:"0.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PEARSON",t:1,d:"返回皮尔生(Pearson)乘积矩相关系数 r。",a:"返回皮尔生(Pearson)乘积矩相关系数 r。",m:[2,2],p:[{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_S_INV",t:1,d:"返回标准正态累积分布函数的反函数值。 该分布的平均值为 0，标准偏差为 1。",a:"返回标准正态累积分布函数的反函数值。 该分布的平均值为 0，标准偏差为 1。",m:[1,1],p:[{name:"probability",detail:"对应于正态分布的概率。",example:"0.75",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_S_DIST",t:1,d:"返回标准正态分布函数（该分布的平均值为 0，标准偏差为 1）。",a:"返回标准正态分布函数（该分布的平均值为 0，标准偏差为 1）。",m:[2,2],p:[{name:"z",detail:"需要计算其分布的数值。",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"决定函数形式的逻辑值。\n\n如果为 TRUE()，则返回累积分布函数；\n\n如果为 FALSE()，则返回概率密度函数。",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"NORM_INV",t:1,d:"返回指定平均值和标准偏差的正态累积分布函数的反函数值。",a:"返回指定平均值和标准偏差的正态累积分布函数的反函数值。",m:[3,3],p:[{name:"probability",detail:"对应于正态分布的概率。",example:"0.75",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"分布的算术平均值。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"分布的标准偏差。",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_DIST",t:1,d:"返回指定平均值和标准偏差的正态分布函数。",a:"返回指定平均值和标准偏差的正态分布函数。",m:[4,4],p:[{name:"x",detail:"需要计算其分布的数值。",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"分布的算术平均值。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"分布的标准偏差。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"决定函数形式的逻辑值。\n\n如果为 TRUE()，则返回累积分布函数；\n\n如果为 FALSE()，则返回概率密度函数。",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"NEGBINOM_DIST",t:1,d:"返回负二项式分布。",a:"返回负二项式分布。",m:[4,4],p:[{name:"number_f",detail:"要模拟的失败次数。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"number_s",detail:"要模拟的成功次数。",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"probability_s",detail:"任一次给定检验的成功概率。",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"决定函数形式的逻辑值。\n\n如果为 TRUE()，则返回累积分布函数；\n\n如果为 FALSE()，则返回概率密度函数。",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"MINA",t:1,d:"返回数据集中的最小数值。",a:"返回数据集中的最小数值。",m:[1,255],p:[{name:"值1",detail:"计算最小值时所用的第一个值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"值2",detail:"[可选] - 在计算最小值时要考虑的其他数值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MIN",t:1,d:"返回数值数据集中的最小值。",a:"返回数值数据集中的最小值。",m:[1,255],p:[{name:"值1",detail:"计算最小值时所用的第一个值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"值2",detail:"[可选] - 在计算最小值时要考虑的其他数值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MEDIAN",t:1,d:"返回数值数据集中的中值。",a:"返回数值数据集中的中值。",m:[1,255],p:[{name:"值1",detail:"计算中值时所用的第一个数值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"值2",detail:"[可选] - 在计算中值时要考虑的其他数值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MAXA",t:1,d:"返回数据集中的最大数值。",a:"返回数据集中的最大数值。",m:[1,255],p:[{name:"值1",detail:"计算最大值时所用的第一个值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"值2, ...",detail:"[可选] - 在计算最大值时要考虑的其他数值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MAX",t:1,d:"返回数值数据集中的最大值。",a:"返回数值数据集中的最大值。",m:[1,255],p:[{name:"值1",detail:"计算最大值时所用的第一个值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"值2",detail:"[可选] - 在计算最大值时要考虑的其他数值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"LOGNORM_INV",t:1,d:"返回 x 的对数累积分布函数的反函数值。",a:"返回 x 的对数累积分布函数的反函数值。",m:[3,3],p:[{name:"probability",detail:"与对数分布相关的概率，介于 0 与 1 之间（不含 0 与 1）。",example:"0.4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"ln(x) 的平均值。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"ln(x) 的标准偏差，正数。",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LOGNORM_DIST",t:1,d:"返回 x 的对数分布函数。",a:"返回 x 的对数分布函数。",m:[4,4],p:[{name:"x",detail:"用来计算函数的值。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"ln(x) 的平均值。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"ln(x) 的标准偏差，正数。",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"决定函数形式的逻辑值。\n\n如果为 TRUE()，则返回累积分布函数；\n\n如果为 FALSE()，则返回概率密度函数。",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"Z_TEST",t:1,d:"返回 z 检验的单尾 P 值。",a:"返回 z 检验的单尾 P 值。",m:[2,3],p:[{name:"array",detail:"用来检验 x 的数组或数据区域。",example:"A2:A100",require:"m",repeat:"n",type:"range"},{name:"x",detail:"要测试的值。",example:"B2",require:"m",repeat:"n",type:"rangenumber"},{name:"sigma",detail:"[可选] - 总体（已知）标准偏差。 如果省略，则使用样本标准偏差。",example:"3",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PROB",t:1,d:"返回区域中的数值落在指定区间内的概率。",a:"返回区域中的数值落在指定区间内的概率。",m:[3,4],p:[{name:"x_range",detail:"具有各自相应概率值的 x 数值区域。",example:"A3:A6",require:"m",repeat:"n",type:"range"},{name:"prob_range",detail:"与 x_range 中的值相关联的一组概率值。",example:"2",require:"m",repeat:"n",type:"range"},{name:"lower_limit",detail:"要计算其概率的数值下界。",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"upper_limit",detail:"[可选 - 默认值为下界] - 要计算其概率的可选数值上界。\n\n如果省略上界，PROB则计算随机选取相应值的次数恰好等于下界的概率。",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"QUARTILE_EXC",t:1,d:"基于 0 到 1 之间（不包括 0 和 1）的百分点值返回数据集的四分位数。",a:"基于 0 到 1 之间（不包括 0 和 1）的百分点值返回数据集的四分位数。",m:[2,2],p:[{name:"array",detail:"要求得四分位数值的数组或数字型单元格区域。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"quart",detail:"要返回第几个四分位值。\n\n1返回数据中最靠近第一个四分位值的值（25%标记）。\n\n2返回数据中最接近中值的值（50%标记）。\n\n3返回数据中最接近第三个四分位值的值（75%标记）。",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"QUARTILE_INC",t:1,d:"根据 0 到 1 之间的百分点值（包含 0 和 1）返回数据集的四分位数。",a:"根据 0 到 1 之间的百分点值（包含 0 和 1）返回数据集的四分位数。",m:[2,2],p:[{name:"array",detail:"要求得四分位数值的数组或数字型单元格区域。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"quart",detail:"要返回第几个四分位值。\n\n0返回数据中的最小值（0%标记）。\n\n1返回数据中最靠近第一个四分位值的值（25%标记）。\n\n2返回数据中最接近中值的值（50%标记）。\n\n3返回数据中最接近第三个四分位值的值（75%标记）。\n\n4返回数据中的最大值（100%标记）。",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"POISSON_DIST",t:1,d:"返回泊松分布。",a:"返回泊松分布。",m:[3,3],p:[{name:"x",detail:"事件数。",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"期望值。非负数",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"一逻辑值，确定所返回的概率分布的形式。\n\n如果为 TRUE()，则返回发生的随机事件数在零（含零）和 x（含 x）之间的累积泊松概率；\n\n如果为 FALSE()，则返回发生的事件数正好是 x 的泊松概率密度函数。",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"RSQ",t:1,d:"返回皮尔生(Pearson)乘积矩相关系数 r 的平方。",a:"返回皮尔生(Pearson)乘积矩相关系数 r 的平方。",m:[2,2],p:[{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_DIST",t:1,d:"返回学生的左尾 t 分布。",a:"返回学生的左尾 t 分布。",m:[3,3],p:[{name:"x",detail:"T-分布函数的输入。",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"自由度数值。",example:"30",require:"m",repeat:"n",type:"rangenumber"},{name:"tails",detail:"决定函数形式的逻辑值。\n\n如果 cumulative 为 TRUE()，则 HYPGEOM.DIST 返回累积分布函数；\n\n如果为 FALSE()，则返回概率密度函数。",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"T_DIST_2T",t:1,d:"返回学生的双尾 t 分布。",a:"返回学生的双尾 t 分布。",m:[2,2],p:[{name:"x",detail:"T-分布函数的输入。",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"自由度数值。",example:"30",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_DIST_RT",t:1,d:"返回学生的右尾 t 分布。",a:"返回学生的右尾 t 分布。",m:[2,2],p:[{name:"x",detail:"T-分布函数的输入。",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"自由度数值。",example:"30",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_INV",t:1,d:"返回学生的 t 分布的左尾反函数。",a:"返回学生的 t 分布的左尾反函数。",m:[2,2],p:[{name:"probability",detail:"与学生的 t 分布相关的概率。\n\n必须大于 0 且小于 1。",example:"0.35",require:"m",repeat:"n",type:"rangenumber"},{name:"deg_freedom",detail:"自由度数值。\n\n如果所提供的参数不是整数，将截取其整数部分。\n\n必须大于等于 1。",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_INV_2T",t:1,d:"返回学生 t 分布的双尾反函数。",a:"返回学生 t 分布的双尾反函数。",m:[2,2],p:[{name:"probability",detail:"与学生的 t 分布相关的概率。\n\n必须大于 0 且小于1。",example:"0.35",require:"m",repeat:"n",type:"rangenumber"},{name:"deg_freedom",detail:"自由度数值。\n\n如果所提供的参数不是整数，将截取其整数部分。\n\n必须大于等于 1。",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_TEST",t:1,d:"返回与t-检验相关的概率。用于判断两个样本是否可能是出自平均值相同的两个样本总体。",a:"返回与t-检验相关的概率。用于判断两个样本是否可能是出自平均值相同的两个样本总体。",m:[4,4],p:[{name:"array1",detail:"将用于 t 检验的第一个数据样本或第一组单元格。",example:"A1:A4",require:"m",repeat:"n",type:"rangenumber"},{name:"array2",detail:"将用于 t 检验的第二个数据样本或第二组单元格。",example:"B1:B4",require:"m",repeat:"n",type:"rangenumber"},{name:"tails",detail:"指定分布的尾数。\n\n如果为 1：使用单尾分布。\n\n如果为 2：使用双尾分布。",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"指定 t 检验的类型。\n\n如果为 1：执行配对检验。\n\n如果为 2：执行双样本等方差（同方差）检验。\n\n如果为3：执行双样本不等方差（异方差）检验。",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"F_DIST",t:1,d:"给定输入值 x，计算两个数据集的左尾 F 概率分布（差异程度）。此分布也称为 Fisher-Snedecor 分布或 Snedecor F 分布。",a:"给定输入值 x",m:[4,4],p:[{name:"x",detail:"用来计算函数的值。",example:"15.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom1",detail:"分子自由度。",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom2",detail:"分母自由度。",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"用于确定函数形式的逻辑值。默认值为 FALSE。\n\n如果为 TRUE()：F.DIST 将返回累积分布函数值。\n\n如果为 FALSE()：F.DIST 将返回概率密度函数值。",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"F_DIST_RT",t:1,d:"给定输入x，计算两个数据集的右尾F概率分布（差异程度）。 此分布也称为Fisher-Snedecor分布或Snedecor F分布。",a:"给定输入x",m:[3,3],p:[{name:"x",detail:"用来计算函数的值。",example:"15.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom1",detail:"分子自由度。",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom2",detail:"分母自由度。",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"VAR_P",t:1,d:"基于样本总体计算方差。",a:"基于样本总体计算方差。",m:[1,255],p:[{name:"值1",detail:"数据集中的第一个值或范围。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"值2, …",detail:"[可选] - 数据集中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VAR_S",t:1,d:"基于样本计算方差。",a:"基于样本计算方差。",m:[1,255],p:[{name:"值1",detail:"样本中的第一项值或范围。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"值2, …",detail:"[可选] - 样本中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VARA",t:1,d:"基于样本计算方差，将文本取值为0。",a:"基于样本计算方差",m:[1,255],p:[{name:"value1",detail:"样本中的第一项值或范围。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2, ...",detail:"[可选] - 样本中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VARPA",t:1,d:"基于样本总体计算方差，将文本取值为0。",a:"基于样本总体计算方差",m:[1,255],p:[{name:"值1",detail:"样本中的第一项值或范围。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"值2, ...",detail:"[可选] - 数据集中包含的其他数值或范围。",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"STEYX",t:1,d:"返回通过线性回归法预测每个 x 的 y 值时所产生的标准误差。",a:"返回通过线性回归法预测每个 x 的 y 值时所产生的标准误差。",m:[2,2],p:[{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"STANDARDIZE",t:1,d:"给定分布的均值和标准偏差，计算一个随机变量正态化的相应值。",a:"给定分布的均值和标准偏差，计算一个随机变量正态化的相应值。",m:[3,3],p:[{name:"x",detail:"要正态化的随机变量值。",example:"96",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"分布的均值。",example:"80",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"分布的标准偏差。",example:"6.7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SMALL",t:1,d:"返回数据集中的第 k 个最小值。",a:"返回数据集中的第 k 个最小值。",m:[2,2],p:[{name:"array",detail:"需要找到第 k 个最小值的数组或数值数据区域。",example:"A2:B100",require:"m",repeat:"n",type:"range"},{name:"k",detail:"要返回的数据在数组或数据区域里的位置（从小到大）。",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SLOPE",t:1,d:"计算通过数据集的线性回归得到的直线的斜率。",a:"计算通过数据集的线性回归得到的直线的斜率。",m:[2,2],p:[{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SKEW",t:1,d:"返回分布的偏斜度。 偏斜度表明分布相对于平均值的不对称程度。 正偏斜度表明分布的不对称尾部趋向于更多正值。 负偏斜度表明分布的不对称尾部趋向于更多负值。",a:"返回分布的偏斜度。",m:[1,255],p:[{name:"值1",detail:"数据集中的第一个值或范围。",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"值2, ...",detail:"[可选] - 数据集中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"SKEW_P",t:1,d:"返回基于样本总体的分布不对称度：表明分布相对于平均值的不对称程度。",a:"返回基于样本总体的分布不对称度：表明分布相对于平均值的不对称程度。",m:[1,255],p:[{name:"值1",detail:"数据集中的第一个值或范围。",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"值2, ...",detail:"[可选] - 数据集中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"VLOOKUP",t:2,d:"纵向查找。在范围的第一列中自上而下搜索某个键值，并返回所找到的行中指定单元格的值。",a:"纵向查找。在范围的第一列中自上而下搜索某个键值",m:[3,4],p:[{name:"搜索键值",detail:'要搜索的值，如 42、"Cats" 或 I24。',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:"范围",detail:"要进行搜索的范围。VLOOKUP 将在该范围的第一列中搜索搜索键值中指定的键值。",example:"A2:B26",require:"m",repeat:"n",type:"rangeall"},{name:"索引",detail:"要返回的值的列索引，范围中的第一列编号为 1。\n\n如果索引不是介于 1 和范围中的列数之间，将返回 #VALUE! 。",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"已排序",detail:"[默认值为 TRUE() ] - 指示要搜索的列（指定范围的第一列）是否已排序。大多数情况下，建议设为 FALSE()。\n\n建议将已排序设为 FALSE。如果设为 FALSE，将返回完全匹配项。如果存在多个匹配值，将返回找到的第一个值对应的单元格的内容，如果找不到匹配值，则返回 #N/A。\n\n如果将已排序设为 TRUE 或省略，将返回（小于或等于搜索键值的）最接近的匹配项。如果搜索的列中所有的值均大于搜索键值，则返回 #N/A。",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"HLOOKUP",t:2,d:"横向查找。在范围的第一行中搜索某个键值，并返回所找到的列中指定单元格的值。",a:"横向查找。在范围的第一行中搜索某个键值",m:[3,4],p:[{name:"搜索键值",detail:'要搜索的值。例如，42、"Cats"或I24。',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:"范围",detail:"要进行搜索的范围。将在该范围的第一行中搜索在搜索键值中指定的键值。",example:"A2:Z6",require:"m",repeat:"n",type:"rangeall"},{name:"索引",detail:"要返回的值的行索引，范围中的第一行编号为1。\n\n如果索引不是介于1和范围中的行数之间，将返回#VALUE!。",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"已排序",detail:"[可选 - 默认值为TRUE()] - 指示要搜索的行（指定范围的第一行）是否已排序。\n\n如果将已排序设为TRUE或省略，将返回最接近的匹配值（小于或等于搜索键值）。如果在搜索的行中所有的值均大于搜索键值，则返回#N/A。\n\n如果将已排序设为TRUE或将其省略，而范围的首行并非处于已排序状态，则返回值可能会是错误的。\n\n如果将已排序设为FALSE，则仅返回完全匹配。如果存在多个匹配值，将返回与找到的第一个值对应的单元格的内容，如果找不到匹配值则返回#N/A。",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LOOKUP",t:2,d:"在行或列中查找相应键，并将相应单元格的值返回到与搜索行或列所在位置相同的结果范围中。",a:"在行或列中查找相应键",m:[2,3],p:[{name:"搜索键值",detail:'要在行或列中搜索的值。例如，42、"Cats" 或 I24。',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:"搜索范围 | 搜索结果数组",detail:"使用 LOOKUP 的一种方法是给定单行或单列形式的搜索范围进行搜索查找，这种方式要用到另一个参数结果范围。另一种方式是将这两个参数合并为一个搜索结果数组，其中第一行或第一列用于搜索，并将返回值放在该数组的最后一行或最后一列中。",example:"A1:A100",require:"m",repeat:"n",type:"rangeall"},{name:"结果范围",detail:"[ 可选 ] - 用于存放返回结果的范围。返回值对应于在搜索范围中找到搜索键值的位置。此范围必须仅为单行或单列，而如果您使用的是搜索结果数组方式，则不应提供此参数。",example:"B1:B100",require:"o",repeat:"n",type:"rangeall"}]},{n:"ADDRESS",t:2,d:"返回字符串形式的单元格引用。",a:"返回字符串形式的单元格引用。",m:[2,5],p:[{name:"row_num",detail:"一个数值，指定要在单元格引用中使用的行号。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"column_num",detail:"一个数值，指定要在单元格引用中使用的列号（而非名称）。A列的编号为1。",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"abs_num",detail:"[可选 - 默认值为1] - 一个数值，指定要返回的引用类型。\n\n1 表示行列均采用绝对值（例如$A$1）；\n\n2 表示采用绝对行号，相对列标（例如A$1）；\n\n3 表示采用相对行号，绝对列标（例如$A1）；\n\n4 表示行列均采用相对值（例如A1）。",example:"4",require:"o",repeat:"n",type:"rangenumber"},{name:"A1",detail:"[可选 - 默认值为TRUE()] - 一个布尔值，指示采用A1标记形式(TRUE)还是R1C1标记形式(FALSE)。",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"},{name:"sheet_text",detail:"[可选 - 默认缺省] - 用于指定地址所指向的工作表名称。",example:'"Sheet2"',require:"o",repeat:"n",type:"rangeall"}]},{n:"INDIRECT",t:2,d:"返回以字符串指定的单元格引用。",a:"返回以字符串指定的单元格引用。",m:[1,2],p:[{name:"ref_text",detail:"以带引号的字符串形式提供的单元格引用。",example:'"Sheet2!"&B10',require:"m",repeat:"n",type:"rangeall"},{name:"A1",detail:"[可选 - 默认值为TRUE()] - 一个布尔值，指示采用A1标记形式(TRUE)还是R1C1标记形式(FALSE)。",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"ROW",t:2,d:"返回指定单元格的行号",a:"返回指定单元格的行号",m:[0,1],p:[{name:"reference",detail:"[可选 - 默认为此公式所在的单元格] - 要返回其行号的单元格。\n\n如果单元格引用指向的范围其宽度大于一个单元格，而此公式不是用作数组公式的，这时会仅返回单元格引用中首行的编号值。",example:"A9",require:"o",repeat:"n",type:"rangeall"}]},{n:"ROWS",t:2,d:"返回指定数组或范围中的行数。",a:"返回指定数组或范围中的行数。",m:[1,1],p:[{name:"array",detail:"要返回其行数的范围。",example:"A9:A62",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COLUMN",t:2,d:"按照 `A=1` 的规则返回指定单元格的列号。",a:"按照 `A=1` 的规则返回指定单元格的列号。",m:[0,1],p:[{name:"reference",detail:"[可选 - 默认为包含此公式的单元格] - 要返回其列号的单元格。A列对应的编号为1。\n\n如果单元格引用是宽度超过一个单元格的范围，而此公式不是作为数组公式来使用的，因此将返回单元格引用中的第一列的位置。",example:"A9",require:"o",repeat:"n",type:"rangeall"}]},{n:"COLUMNS",t:2,d:"返回指定数组或范围中的列数。",a:"返回指定数组或范围中的列数。",m:[1,1],p:[{name:"array",detail:"要返回其列数的范围。",example:"A9:W62",require:"m",repeat:"n",type:"rangenumber"}]},{n:"OFFSET",t:2,d:"给定某范围的起始单元格引用以及该范围涵盖的行列数量，返回该范围的引用。",a:"给定某范围的起始单元格引用以及该范围涵盖的行列数量，返回该范围的引用。",m:[3,5],p:[{name:"reference",detail:"用于计算行列偏移量的起点。",example:"A2",require:"m",repeat:"n",type:"range"},{name:"rows",detail:"要偏移的行数。\n\n行偏移量必须是整数，但也可以是负数。如果提供的参数带有小数，小数部分将被截去。",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"cols",detail:"要偏移的列数。\n\n列偏移量必须是整数，但也可以是负数。如果提供的参数带有小数，小数部分将被截去。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"height",detail:"[可选] - 要从偏移目标开始返回的范围的高度。",example:"2",require:"o",repeat:"n",type:"rangenumber"},{name:"width",detail:"[可选] - 要从偏移目标开始返回的范围的宽度。",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MATCH",t:2,d:"在单元格中搜索指定项，然后返回该项在单元格区域中的相对位置。",a:"在单元格中搜索指定项，然后返回该项在单元格区域中的相对位置。",m:[2,3],p:[{name:"lookup_value",detail:"要在 lookup_array 中匹配的值。",example:'"Sunday"',require:"m",repeat:"n",type:"rangeall"},{name:"lookup_array",detail:"要搜索的单元格区域。\n\n如果所用的范围的高度和宽度均大于1，MATCH将返回#N/A!。",example:"A2:A9",require:"m",repeat:"n",type:"range"},{name:"match_type",detail:"[可选 - 默认值为1] - 要采用的搜索方式。\n\n1为默认类型，此时MATCH会假设范围已按升序排序，并返回小于等于搜索键值的最大值。\n\n0表示完全匹配，在范围未排序的情况下需要使用此方式。\n\n-1让MATCH假设范围是按降序排序的，并返回大于等于搜索键值的最小值。",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"INDEX",t:2,d:"返回表格或中的元素值，此元素由行号和列号的索引值给定。",a:"返回表格或中的元素值，此元素由行号和列号的索引值给定。",m:[3,3],p:[{name:"array",detail:"单元格区域或数组常量。",example:"A1:C20",require:"m",repeat:"n",type:"range"},{name:"row_num",detail:"选择数组中的某行，函数从该行返回数值。",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"column_num",detail:"选择数组中的某列，函数从该列返回数值。",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GETPIVOTDATA",t:2,d:"从与指定行和列标题对应的数据透视表中提取汇总值。",a:"从与指定行和列标题对应的数据透视表中提取汇总值。",m:[2,254],p:[{name:"data_field",detail:"您想从数据透视表中获取其数据的值名称。\n值名称必须括在引号中或是指向包含相关文本的任何单元格的引用。\n如果有多个值字段，则必须使用数据透视表中显示的确切名称（如“销售总额”）。",example:'"SUM of number of units"',require:"m",repeat:"n",type:"rangeall"},{name:"pivot_table",detail:"目标数据透视表中的任何单元格的引用（推荐位于顶角的单元格）。",example:"'Pivot table'!A1",require:"m",repeat:"n",type:"rangeall"},{name:"field1",detail:"[可选] - 源数据集（不是数据透视表）中列的名称。",example:'"division"',require:"o",repeat:"y",type:"rangeall"},{name:"item1",detail:"[可选] - 数据透视表中显示的与您要检索的字段名称 1 相对应的行或列的名称。",example:'"east"',require:"o",repeat:"y",type:"rangeall"}]},{n:"CHOOSE",t:2,d:"基于索引返回选项列表中的元素。",a:"基于索引返回选项列表中的元素。",m:[2,255],p:[{name:"index_num",detail:"指定要返回哪一项。\n\n如果索引为零、负值或大于提供的选择数量，将返回#VALUE!错误。",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"value1",detail:"一项可能的返回值。必须提供。可以是单元格引用或单独的值。",example:'"A"',require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"[可选] - 其他可以选择的值。选择",example:'"B"',require:"o",repeat:"y",type:"rangeall"}]},{n:"HYPERLINK",t:2,d:"在单元格内创建一个超链接。",a:"在单元格内创建一个超链接。",p:[{name:"网址",detail:"以引号括住的链接位置的完整网址，或对包含这种网址的单元格的引用。\n\n仅允许某些链接类型。其中包括：http://、https://、mailto:、aim:、ftp://、gopher://、telnet://和news://，明确禁用使用其他协议。如果指定的是其他协议，将会在单元格中显示链接标签，但该标签不会以链接形式呈现。\n\n如果未指定协议，则假设使用http://，并将其作为网址的前缀。",example:'"http://www.google.com/"',require:"m",repeat:"n",type:"rangeall"},{name:"链接标签",detail:'[可选 - 默认为网址] - 要在单元格中作为链接显示的文本（用引号括起来的），或者指向包含这种标签的单元格的引用。\n\n如果链接标签是指向某个空单元格的引用，如果网址有效，就将其作为链接显示，否则作为纯文本显示。\n\n如果链接标签为空字符串常量("")，所在单元格显示的内容将为空白，但通过点击该单元格或转入该单元格仍然可以访问链接。',example:'"Google"',require:"m",repeat:"n",type:"rangeall"}]},{n:"TIME",t:6,d:"将给定的小时、分钟和秒转换为时间。",a:"将给定的小时、分钟和秒转换为时间。",m:[3,3],p:[{name:"小时",detail:"0（零）到 32767 之间的数字，代表小时。\n\n任何大于 23 的值都会除以 24，余数将作为小时值。",example:"11",require:"m",repeat:"n",type:"rangenumber"},{name:"分钟",detail:"0（零）到 32767 之间的数字，代表分钟。\n\n任何大于 59 的值将转换为小时和分钟。",example:"40",require:"m",repeat:"n",type:"rangenumber"},{name:"秒",detail:"0（零）到 32767 之间的数字，代表秒。\n\n任何大于 59 的值将转换为小时、分钟和秒。",example:"59",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TIMEVALUE",t:6,d:"按一天24小时返回该时间的分数表示。",a:"按一天24小时返回该时间的分数表示。",m:[1,1],p:[{name:"time_text",detail:"用于表示时间的字符串。",example:'"2:15 PM"',require:"m",repeat:"n",type:"rangeall"}]},{n:"EOMONTH",t:6,d:"返回某个月份最后一天的序列号，该月份在另一个日期之前或之后的数个月（月数由参数指定）。",a:"返回某个月份最后一天的序列号",m:[2,2],p:[{name:"start_date",detail:"用于计算结果的参照日期。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"months",detail:"用于计算的起始日期之前（负）或之后（正）的月数。返回的是计算所得月份的最后那天。",example:"7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EDATE",t:6,d:"返回表示某个日期的序列号，该日期在另一个日期的数月之前/之后。",a:"返回表示某个日期的序列号",m:[2,2],p:[{name:"start_date",detail:"用于计算结果的参照日期。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"months",detail:"用于计算的起始日期之前（负）或之后（正）的月数。",example:"7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SECOND",t:6,d:"返回时间值的秒数。 秒数是 0（零）到 59 范围内的整数。",a:"返回时间值的秒数。 秒数是 0（零）到 59 范围内的整数。",m:[1,1],p:[{name:"时间",detail:"用于计算秒钟部分的时间。必须为以下值之一：指向包含日期/时间值的单元格的引用、返回日期/时间的函数或者数字。",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"MINUTE",t:6,d:"以数字格式返回特定时间的分钟部分。",a:"以数字格式返回特定时间的分钟部分。",m:[1,1],p:[{name:"时间",detail:"用于计算分钟部分的时间。必须为以下值之一：指向包含日期/时间值的单元格的引用、返回日期/时间的函数或者数字。",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"HOUR",t:6,d:"以数字格式返回特定时间的小时部分。",a:"以数字格式返回特定时间的小时部分。",m:[1,1],p:[{name:"时间",detail:"用于计算小时部分的时间。必须为以下值之一：指向包含日期/时间值的单元格的引用、返回日期/时间的函数或者数字。",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"NOW",t:6,d:"以日期值格式返回当前日期和时间。",a:"以日期值格式返回当前日期和时间。",m:[0,0],p:[]},{n:"NETWORKDAYS",t:6,d:"返回所提供的两个日期之间的净工作日天数。",a:"返回所提供的两个日期之间的净工作日天数。",m:[2,3],p:[{name:"start_date",detail:"用于计算净工作日天数的时间段开始日期。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"用于计算净工作日天数的时间段结束日期。",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"holidays",detail:"[可选] - 一个范围或数组常量，其中包含作为节假日的日期序号。\n\n在节假日数组中提供的值必须是日期序号值（例如由N所返回的值）或日期值（例如由DATE、DATEVALUE或TO_DATE返回的值）。由范围指定的值应该是标准的日期值或日期序数值。",example:"16)",require:"o",repeat:"n",type:"rangeall"}]},{n:"NETWORKDAYS_INTL",t:6,d:"返回给定的两个日期之间的净工作日天数（排除指定的周末和节假日）。",a:"返回给定的两个日期之间的净工作日天数（排除指定的周末和节假日）。",m:[2,4],p:[{name:"start_date",detail:"用于计算净工作日天数的时间段开始日期。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"用于计算净工作日天数的时间段结束日期。",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"weekend",detail:"[可选 - 默认值为1] - 用于表示哪些天为周末的数字或字符串。\n字符串方式：可以使用由0和1组成的字符串来指定周末，串中的第一个数字字符代表周一，最后一个则代表周日。零表示这一天是工作日，1表示这一天为周末。例如，“0000011”表示将周六和周日作为周末。\n数字方式：这种方式不使用上述字符串形式，而是使用一个数字。1 =周六/周日为周末，2 =周日/周一为周末，依此类推则7 =周五/周六。11 =周日为唯一周末，12 =周一为唯一周末，依此类推则17 =周六为唯一周末。",example:"16)",require:"o",repeat:"n",type:"rangeall"},{name:"holidays",detail:"[ 可选 ] - 这是一个范围或数组常量，其中包含作为节假日的日期。\n在节假日数组内提供的值必须为日期序数值（例如N的返回值）或日期值（例如DATE、DATEVALUE或TO_DATE的返回值）。由范围指定的值应该是标准的日期值或日期序数值。",example:"DATE(1969",require:"o",repeat:"n",type:"rangeall"}]},{n:"ISOWEEKNUM",t:6,d:"返回给定日期在全年中的 ISO 周数。",a:"返回给定日期在全年中的 ISO 周数。",m:[1,1],p:[{name:"date",detail:"用于日期和时间计算的日期-时间代码。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"WEEKNUM",t:6,d:"返回特定日期的周数。",a:"返回特定日期的周数。",m:[1,2],p:[{name:"serial_number",detail:"要确定其位于第几周的日期，必须是对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"return_type",detail:"[可选 - 默认值为 1 ] - 代表一周起始日的数字，系统也使用该数字来确定一年的第一周（1=周日，2=周一）。",example:"7",require:"o",repeat:"n",type:"rangenumber"}]},{n:"WEEKDAY",t:6,d:"返回一个数字，对应于给定日期所在的星期几。",a:"返回一个数字，对应于给定日期所在的星期几。",m:[1,2],p:[{name:"serial_number",detail:"要为其确定星期几的日期。必须是对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"return_type",detail:"[可选 - 默认值为 1] - 以数字指示使用哪种编号顺序来表示星期几。默认情况下，按星期日 (= 1) 开始计算。\n\n如果类型为 1，则星期值将从星期日开始算起，并且星期日的值为 1，因此星期六的值就是 7。\n\n如果类型为 2，则星期值将从星期一开始算起，并且星期一的值为 1，因此星期日的值就是 7。\n\n如果类型为 3，则星期值将从星期一算起，并且星期一的值为 0，因此星期日的值就是 6。",example:"7",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DAY",t:6,d:"以数字格式返回特定日期所在的当月几号。",a:"以数字格式返回特定日期所在的当月几号。",m:[1,1],p:[{name:"serial_number",detail:"要从中提取具体几号的日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"DAYS",t:6,d:"返回两个日期之间的天数。",a:"返回两个日期之间的天数。",m:[2,2],p:[{name:"end_date",detail:"计算中要使用的结束日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"2011-3-15",require:"m",repeat:"n",type:"rangeall"},{name:"start_date",detail:"计算中要使用的开始日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"2011-2-1",require:"m",repeat:"n",type:"rangeall"}]},{n:"DAYS360",t:6,d:"按照每年360天，返回两个日期之间的差（用于计算利息）。",a:"按照每年360天，返回两个日期之间的差（用于计算利息）。",m:[2,3],p:[{name:"start_date",detail:"计算中要使用的开始日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"计算中要使用的结束日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"method",detail:"[可选 - 默认为FALSE()] - 指示要使用哪种天数计算方法。\n\nFALSE - 采用美国 (NASD) 方法时，如果起始日期为某月的最后一天，为便于计算，会将起始日期的当月几号更改为30。此外，如果结束日期是所在月份的最后一天，而且起始日期在其所在月的30号之前，则将结束日期更改为结束日期之后那个月的第一天，否则将结束日期更改为该月的30号。\n\nTRUE - 采用欧洲方法时，会将所有日期在31号的起始日期或结束日期更改为当月的30号。",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"DATE",t:6,d:"将提供的年、月、日转换为日期。",a:"将提供的年、月、日转换为日期。",m:[3,3],p:[{name:"year",detail:"日期的年份部分，包含一到四位数字。\n\n介于 0（零）到 1899 之间，会将该值与 1900 相加来计算年份；\n\n介于 1900 到 9999 之间，将使用该数值作为年份；\n\n小于 0 或大于等于 10000，返回 错误值 #NUM!。",example:"1969",require:"m",repeat:"n",type:"rangenumber"},{name:"month",detail:"日期的月份部分，一个正整数或负整数。\n\n如果 month 大于 12，则 month 会将该月份数与指定年中的第一个月相加。\n\n如果 month 小于 1，month 则从指定年份的一月份开始递减该月份数，然后再加上 1 个月。",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"day",detail:"日期的日部分，一个正整数或负整数。\n\n如果 day 大于月中指定的天数，则 day 会将天数与该月中的第一天相加。\n\n如果 day 小于 1，则 day 从指定月份的第一天开始递减该天数，然后再加上 1 天。",example:"20",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DATEVALUE",t:6,d:"将提供的日期字符串转换为日期的序列号。",a:"将提供的日期字符串转换为日期的序列号。",m:[1,1],p:[{name:"date_text",detail:"表示日期的字符串。",example:'"1969-7-20"',require:"m",repeat:"n",type:"rangeall"}]},{n:"DATEDIF",t:6,d:"计算两个日期之间的天数、月数或年数。",a:"计算两个日期之间的天数、月数或年数。",m:[3,3],p:[{name:"起始日期",detail:"计算中要使用的开始日期。必须是对包含DATE值的单元格的引用、返回DATE类型的函数或数字。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"结束日期",detail:"计算中要使用的结束日期。必须是对包含DATE值的单元格的引用、返回DATE类型的函数或数字。",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"单位",detail:'时间单位的缩写文字。例如 "M" 代表月。有效值包括："Y"、"M"、"D"、"MD"、"YM" 和 "YD"。\n\n"Y"：返回起始日期和结束日期之间的整年数。\n\n"M"：返回起始日期和结束日期之间的整月数。\n\n"D"：返回起始日期和结束日期之间的天数。\n\n"MD"：返回起始日期和结束日期之间的天数（不计整月数）。\n\n"YM"：返回起始日期和结束日期之间的整月数（不计整年数）。\n\n"YD"：返回起始日期和结束日期之间的天数（假设起始日期和结束日期的间隔不超过一年）。',example:"16)",require:"m",repeat:"n",type:"rangeall"}]},{n:"WORKDAY",t:6,d:"指定工作日天数，计算结束日期。",a:"指定工作日天数，计算结束日期。",m:[2,3],p:[{name:"start_date",detail:"计算的开始日期。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"days",detail:"start_date 之前或之后不含周末及节假日的天数。\n\n为正值将生成未来日期；\n\n为负值生成过去日期。",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"holidays",detail:"[可选] - 一个范围或数组常量，其中包含作为节假日的日期序号。\n\n在节假日数组中提供的值必须是日期序号值（例如由N所返回的值）或日期值（例如由DATE、DATEVALUE或TO_DATE返回的值）。由范围指定的值应该是标准的日期值或日期序数值。",example:"16)",require:"o",repeat:"n",type:"rangeall"}]},{n:"WORKDAY_INTL",t:6,d:"返回指定的若干个工作日之前或之后的日期的序列号（使用自定义周末参数）。 ",a:"返回指定的若干个工作日之前或之后的日期的序列号（使用自定义周末参数）。 ",m:[2,4],p:[{name:"start_date",detail:"开始日期（将被截尾取整）。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"days",detail:"start_date 之前或之后的工作日的天数。\n\n正值表示未来日期；\n\n负值表示过去日期；\n\n零值表示开始日期。",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"weekend",detail:"[可选 - 默认值为1] - 用于表示哪些天为周末的数字或字符串。\n字符串方式：可以使用由0和1组成的字符串来指定周末，串中的第一个数字字符代表周一，最后一个则代表周日。零表示这一天是工作日，1表示这一天为周末。例如，“0000011”表示将周六和周日作为周末。\n数字方式：这种方式不使用上述字符串形式，而是使用一个数字。1 =周六/周日为周末，2 =周日/周一为周末，依此类推则7 =周五/周六。11 =周日为唯一周末，12 =周一为唯一周末，依此类推则17 =周六为唯一周末。",example:"16)",require:"o",repeat:"n",type:"rangeall"},{name:"holidays",detail:"[ 可选 ] - 这是一个范围或数组常量，其中包含作为节假日的日期。\n在节假日数组内提供的值必须为日期序数值（例如N的返回值）或日期值（例如DATE、DATEVALUE或TO_DATE的返回值）。由范围指定的值应该是标准的日期值或日期序数值。",example:"DATE(1969",require:"o",repeat:"n",type:"rangeall"}]},{n:"YEAR",t:6,d:"返回对应于某个日期的年份。 Year 作为 1900 - 9999 之间的整数返回。",a:"返回对应于某个日期的年份。 Year 作为 1900 - 9999 之间的整数返回。",m:[1,1],p:[{name:"serial_number",detail:"用于计算年份的日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"YEARFRAC",t:6,d:"返回 start_date 和 end_date 之间的天数占全年天数的百分比。",a:"返回 start_date 和 end_date 之间的天数占全年天数的百分比。",m:[2,3],p:[{name:"start_date",detail:"计算中要使用的开始日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"计算中要使用的结束日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"basis",detail:"[可选 - 默认为0] - 要使用的日计数基准类型。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"16)",require:"o",repeat:"n",type:"rangenumber"}]},{n:"TODAY",t:6,d:"以日期值格式返回当前日期。",a:"以日期值格式返回当前日期。",m:[0,0],p:[]},{n:"MONTH",t:6,d:"返回日期（以序列数表示）中的月份。 月份是介于 1（一月）到 12（十二月）之间的整数。",a:"返回日期（以序列数表示）中的月份。 月份是介于 1（一月）到 12（十二月）之间的整数。",m:[1,1],p:[{name:"serial_number",detail:"要从中提取月份的日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"EFFECT",t:8,d:"根据名义利率及每年的复利计息期数来计算实际年利率。",a:"根据名义利率及每年的复利计息期数来计算实际年利率。",m:[2,2],p:[{name:"nominal_rate",detail:"每年的名义利率。",example:"0.99",require:"m",repeat:"n",type:"rangenumber"},{name:"npery",detail:"每年的复利计算期数。",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLAR",t:12,d:"将数字格式设置为与语言区域相对应的货币格式。",a:"将数字格式设置为与语言区域相对应的货币格式。",m:[1,2],p:[{name:"number",detail:"要设置格式的值。",example:"1.2351",require:"m",repeat:"n",type:"rangenumber"},{name:"decimals",detail:"[可选 - 默认值为 2] - 要显示的小数位数。\n\n如果这是负数，则将数字四舍五入到小数点左侧。",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLARDE",t:8,d:"将以整数部分和分数部分转换为以小数部分表示的金额数字",a:"将以整数部分和分数部分转换为以小数部分表示的金额数字",m:[2,2],p:[{name:"fractional_dollar",detail:"以整数部份和分数部分表示的数字，用小数点隔开。",example:"100.10",require:"m",repeat:"n",type:"rangenumber"},{name:"fraction",detail:"用作分数中的分母的整数。",example:"32",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLARFR",t:8,d:"将小数转换为分数表示的金额数字。",a:"将小数转换为分数表示的金额数字。",m:[2,2],p:[{name:"decimal_dollar",detail:"小数。",example:"100.125",require:"m",repeat:"n",type:"rangenumber"},{name:"fraction",detail:"用作分数中的分母的整数。",example:"32",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DB",t:8,d:"使用固定余额递减法，返回指定期间内某项固定资产的折旧值。",a:"使用固定余额递减法，返回指定期间内某项固定资产的折旧值。",m:[4,5],p:[{name:"cost",detail:"资产原值。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"折旧末尾时的值（有时也称为资产残值）。",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"资产的折旧期数（有时也称作资产的使用寿命）。",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"在使用期限内要计算折旧的折旧期。",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"month",detail:"[可选 - 默认值为12] - 折旧第一年中的月数。",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DDB",t:8,d:"用双倍余额递减法，返回指定期间内某项固定资产的折旧值。",a:"用双倍余额递减法，返回指定期间内某项固定资产的折旧值。",m:[4,5],p:[{name:"cost",detail:"资产原值。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"折旧末尾时的值（有时也称为资产残值）。",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"资产的折旧期数（有时也称作资产的使用寿命）。",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"在使用期限内要计算折旧的折旧期。",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"factor",detail:"[可选 - 默认值为2] - 折旧的递减系数。",example:"2.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RATE",t:8,d:"返回年金每期的利率。",a:"返回年金每期的利率。",m:[3,6],p:[{name:"nper",detail:"年金的付款总期数。",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pmt",detail:"每期的付款金额，在年金周期内不能更改。",example:"-100",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"现值即一系列未来付款当前值的总和。",example:"400",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[可选 - 默认值为0] - 未来值，或在最后一次付款后希望得到的现金余额。",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"type",detail:"[可选 - 默认值为0] - 指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"guess",detail:"[可选 - 默认值为0.1] - 预期利率。",example:"0.1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"CUMPRINC",t:8,d:"基于等额分期付款和固定利率，计算投资在多个付款期内的累计本金偿还额。",a:"基于等额分期付款和固定利率，计算投资在多个付款期内的累计本金偿还额。",m:[6,6],p:[{name:"rate",detail:"利率。",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"总付款期数。",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"年金的现值。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"start_period",detail:"开始累计计算的付款期序号。\n\n首期必须大于等于1。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"end_period",detail:"结束累计计算的付款期序号。\n\n末期必须大于首期。",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUPNUM",t:8,d:"返回在结算日和到期日之间的付息次数，向上舍入到最近的整数。",a:"返回在结算日和到期日之间的付息次数，向上舍入到最近的整数。",m:[3,4],p:[{name:"settlement",detail:"有价证券的结算日。有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。到期日是有价证券有效期截止时的日期。",example:"02",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SYD",t:8,d:"返回在指定期间内资产按年限总和折旧法计算的折旧。",a:"返回在指定期间内资产按年限总和折旧法计算的折旧。",m:[4,4],p:[{name:"cost",detail:"资产原值。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"折旧末尾时的值（有时也称为资产残值）。",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"资产的折旧期数（有时也称作资产的使用寿命）。",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"在使用期限内要计算折旧的折旧期。",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLEQ",t:8,d:"基于贴现率计算美国政府短期债券的等效年化收益率。",a:"基于贴现率计算美国政府短期债券的等效年化收益率。",m:[3,3],p:[{name:"settlement",detail:"债券的结算日期，此日期为债券发行后交付给买家的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"债券的到期或结束日期，届时可将其以面值或票面价值赎回。",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"债券购买时的贴现率。",example:"2)",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLYIELD",t:8,d:"基于价格计算美国政府短期债券的收益率。",a:"基于价格计算美国政府短期债券的收益率。",m:[3,3],p:[{name:"settlement",detail:"债券的结算日期，此日期为债券发行后交付给买家的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"债券的到期或结束日期，届时可将其以面值或票面价值赎回。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"pr",detail:"债券的购买价格。",example:"95",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLPRICE",t:8,d:"基于贴现率计算美国政府短期债券的价格。",a:"基于贴现率计算美国政府短期债券的价格。",m:[3,3],p:[{name:"settlement",detail:"债券的结算日期，此日期为债券发行后交付给买家的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"债券的到期或结束日期，届时可将其以面值或票面价值赎回。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"债券购买时的贴现率。",example:"0.09",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PV",t:8,d:"基于等额分期付款和固定利率，计算年金投资的现值。",a:"基于等额分期付款和固定利率，计算年金投资的现值。",m:[3,5],p:[{name:"rate",detail:"各期利率。",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"年金的付款总期数。",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pmt",detail:"每期的付款金额，在年金周期内不能更改。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[可选] - 未来值，或在最后一次付款后希望得到的现金余额。",example:"D2",require:"o",repeat:"n",type:"rangenumber"},{name:"type",detail:"[可选 - 默认值为0] - 指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"ACCRINT",t:8,d:"返回定期付息证券的应计利息。",a:"返回定期付息证券的应计利息。",m:[6,8],p:[{name:"issue",detail:"有价证券的发行日。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"first_interest",detail:"有价证券的首次计息日。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"有价证券的年息票利率。",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"par",detail:"证券的票面值。",example:"10000",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示““欧洲30/360”方法” - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"calc_method",detail:"[可选 - 默认为TRUE()] - 一个逻辑值，指定当结算日期晚于首次计息日期时用于计算总应计利息的方法。\n\n如果值为 TRUE，则返回从发行日到结算日的总应计利息。\n\n如果值为 FALSE，则返回从首次计息日到结算日的应计利息。",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"ACCRINTM",t:8,d:"返回在到期日支付利息的有价证券的应计利息。",a:"返回在到期日支付利息的有价证券的应计利息。",m:[4,5],p:[{name:"issue",detail:"有价证券的发行日。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"settlement",detail:"有价证券的到期日。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"有价证券的年息票利率。",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"par",detail:"证券的票面值。",example:"1000",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYBS",t:8,d:"返回从付息期开始到结算日的天数。",a:"返回从付息期开始到结算日的天数。",m:[3,4],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYS",t:8,d:"返回结算日所在的付息期的天数。",a:"返回结算日所在的付息期的天数。",m:[3,4],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYSNC",t:8,d:"返回从结算日到下一票息支付日之间的天数。",a:"返回从结算日到下一票息支付日之间的天数。",m:[3,4],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPNCD",t:8,d:"计算结算日之后的下一票息或利息派发日期。",a:"计算结算日之后的下一票息或利息派发日期。",m:[3,4],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"01)",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"DATE(2019",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPPCD",t:8,d:"计算结算日之前的最后一个票息或利息支付日。",a:"计算结算日之前的最后一个票息或利息支付日。",m:[3,4],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"01)",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"DATE(2019",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FV",t:8,d:"基于等额分期付款和固定利率，计算年金投资的未来价值。",a:"基于等额分期付款和固定利率，计算年金投资的未来价值。",m:[3,5],p:[{name:"rate",detail:"各期利率。",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"年金的付款总期数。",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pmt",detail:"各期所应支付的金额，在整个年金期间保持不变。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"[可选 - 默认值为 0 ] - 现值，或一系列未来付款的当前值的累积和。",example:"400",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"[可选 - 默认值为 0 ] - 指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FVSCHEDULE",t:8,d:"返回应用一系列复利率计算的初始本金的未来值。",a:"返回应用一系列复利率计算的初始本金的未来值。",m:[2,2],p:[{name:"principal",detail:"现值。",example:"10000",require:"m",repeat:"n",type:"rangenumber"},{name:"schedule",detail:"用于计算本金复利的一组利率。\n\n利率表必须是范围或数组，其中包含要用于计算复利的一组利率。这些利率值应该以十进制小数形式表示，或者使用UNARY_PERCENT以百分比形式表示，即表示为0.09或UNARY_PERCENT(9)，而不要表示为9。",example:"A2:A100",require:"m",repeat:"n",type:"range"}]},{n:"YIELD",t:8,d:"返回定期支付利息的债券的收益率。",a:"返回定期支付利息的债券的收益率。",m:[6,7],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"有价证券的年息票利率。",example:"0.057",require:"m",repeat:"n",type:"rangenumber"},{name:"pr",detail:"有价证券的价格。",example:"95",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"有价证券的清偿价值。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"YIELDDISC",t:8,d:"基于价格计算折价发行的（不带息）债券的年收益率。",a:"基于价格计算折价发行的（不带息）债券的年收益率。",m:[4,5],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"pr",detail:"有价证券的价格。",example:"95",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"有价证券的清偿价值。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NOMINAL",t:8,d:"基于给定的实际利率和年复利期数，返回名义年利率。",a:"基于给定的实际利率和年复利期数，返回名义年利率。",m:[2,2],p:[{name:"effect_rate",detail:"每年的实际利率。",example:"0.85",require:"m",repeat:"n",type:"rangenumber"},{name:"npery",detail:"每年的复利期数。",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"XIRR",t:8,d:"返回一组不一定定期发生的现金流的内部收益率。",a:"返回一组不一定定期发生的现金流的内部收益率。",m:[2,3],p:[{name:"values",detail:"其中含有投资相关收益或支出的数组或范围。\n\n现金流数额中必须至少包含一项负的和一项正的现金流金额才能计算回报率。",example:"B2:B25",require:"m",repeat:"n",type:"range"},{name:"dates",detail:"与现金流数额参数中的现金流对应的日期数组或范围。",example:"C2:C25",require:"m",repeat:"n",type:"range"},{name:"guess",detail:"[可选 - 默认值为0.1] - 对内部回报率的估算值。",example:"250",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MIRR",t:8,d:"返回一系列定期现金流的修改后内部收益率。",a:"返回一系列定期现金流的修改后内部收益率。",m:[3,3],p:[{name:"values",detail:"其中含有投资相关收益或支出的数组或范围。\n\n现金流数额中必须至少包含一项负的和一项正的现金流金额才能计算回报率。",example:"A2:A25",require:"m",repeat:"n",type:"range"},{name:"finance_rate",detail:"现金流中使用的资金支付的利率。",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"reinvest_rate",detail:"将现金流再投资的收益率。",example:"0.12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"IRR",t:8,d:"返回由值中的数字表示的一系列现金流的内部收益率。 ",a:"返回由值中的数字表示的一系列现金流的内部收益率。 ",m:[1,2],p:[{name:"values",detail:"其中含有投资相关收益或支出的数组或范围。\n\n现金流数额中必须至少包含一项负的和一项正的现金流金额才能计算回报率。",example:"A2:A25",require:"m",repeat:"n",type:"range"},{name:"guess",detail:"[可选 - 默认为 0.1] - 内部收益率的估值。",example:"200",require:"o",repeat:"n",type:"rangenumber"}]},{n:"NPV",t:8,d:"使用贴现率和一系列未来支出（负值）和收益（正值）来计算一项投资的净现值。",a:"使用贴现率和一系列未来支出（负值）和收益（正值）来计算一项投资的净现值。",m:[2,255],p:[{name:"rate",detail:"某一期间的贴现率。",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"value1",detail:"第一笔支出（负值）和收益（正值）。",example:"200",require:"m",repeat:"n",type:"rangeall"},{name:"value2, ...",detail:"[可选] - 其他支出（负值）和收益（正值）。",example:"250",require:"o",repeat:"y",type:"rangeall"}]},{n:"XNPV",t:8,d:"返回一组现金流的净现值，这些现金流不一定定期发生。",a:"返回一组现金流的净现值，这些现金流不一定定期发生。",m:[3,3],p:[{name:"rate",detail:"应用于现金流的贴现率。",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"values",detail:"与 dates 中的支付时间相对应的一系列现金流。",example:"B2:B25",require:"m",repeat:"n",type:"range"},{name:"dates",detail:"与现金流支付相对应的支付日期表。",example:"C2:C25",require:"m",repeat:"n",type:"range"}]},{n:"CUMIPMT",t:8,d:"基于等额分期付款和固定利率，计算投资在一系列付款期内的累计利息。",a:"基于等额分期付款和固定利率，计算投资在一系列付款期内的累计利息。",m:[6,6],p:[{name:"rate",detail:"利息率。",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"总付款期数。",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"现值。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"start_period",detail:"开始累计计算的付款期序号。\n\n首期必须大于等于1。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"end_period",detail:"结束累计计算的付款期序号。\n\n末期必须大于首期。",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PMT",t:8,d:"用于根据固定付款额和固定利率计算贷款的付款额。",a:"用于根据固定付款额和固定利率计算贷款的付款额。",m:[3,5],p:[{name:"rate",detail:"贷款利率。",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"该项贷款的付款总数。",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"现值，或一系列未来付款额现在所值的总额，也叫本金。",example:" 100000",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[可选 - 默认值为 0] - 未来值，或在最后一次付款后希望得到的现金余额。",example:"D2",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"[可选 - 默认值为 0] - 指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"IPMT",t:8,d:"基于固定利率及等额分期付款方式，返回给定期数内对投资的利息偿还额。",a:"基于固定利率及等额分期付款方式，返回给定期数内对投资的利息偿还额。",m:[4,6],p:[{name:"rate",detail:"各期利率。",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"per",detail:"用于计算其利息数额的期数，必须在 1 到 nper 之间。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"年金的付款总期数。",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"现值，或一系列未来付款的当前值的累积和。",example:"80000",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[可选 - 默认值为 0] - 未来值，或在最后一次付款后希望得到的现金余额。",example:"E2",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"[可选 - 默认值为 0] - 指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PPMT",t:8,d:"返回根据定期固定付款和固定利率而定的投资在已知期间内的本金偿付额。",a:"返回根据定期固定付款和固定利率而定的投资在已知期间内的本金偿付额。",m:[4,6],p:[{name:"rate",detail:"各期利率。",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"per",detail:"指定期数，该值必须在 1 到 nper 范围内。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"年金的付款总期数。",example:"3*12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"现值即一系列未来付款当前值的总和。",example:"100000",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[可选 - 默认值为 0] - 未来值，或在最后一次付款后希望得到的现金余额。",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"type",detail:"[可选 - 默认值为 0] - 指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"INTRATE",t:8,d:"返回完全投资型证券的利率。",a:"返回完全投资型证券的利率。",m:[4,5],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"investment",detail:"有价证券的投资额。",example:"100000",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"有价证券到期时的兑换值。",example:"101200",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PRICE",t:8,d:"返回定期付息的面值 ￥100 的有价证券的价格。",a:"返回定期付息的面值 ￥100 的有价证券的价格。",m:[6,7],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"有价证券的年息票利率。",example:"0.057",require:"m",repeat:"n",type:"rangenumber"},{name:"yld",detail:"有价证券的年收益率。",example:"0.065",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"面值 ￥100 的有价证券的清偿价值。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PRICEDISC",t:8,d:"返回折价发行的面值 ￥100 的有价证券的价格。",a:"返回折价发行的面值 ￥100 的有价证券的价格。",m:[4,5],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"有价证券的贴现率。",example:"0.0525",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"面值 ￥100 的有价证券的清偿价值。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PRICEMAT",t:8,d:"返回到期付息的面值 ￥100 的有价证券的价格。",a:"返回到期付息的面值 ￥100 的有价证券的价格。",m:[5,6],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"issue",detail:"有价证券的发行日。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"有价证券在发行日的利率。",example:"0.061",require:"m",repeat:"n",type:"rangenumber"},{name:"yld",detail:"有价证券的年收益率。",example:"0.061",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"RECEIVED",t:8,d:"返回一次性付息的有价证券到期收回的金额。",a:"返回一次性付息的有价证券到期收回的金额。",m:[4,5],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"investment",detail:"有价证券的投资额。",example:"10000000",require:"m",repeat:"n",type:"rangenumber"},{name:"discount",detail:"有价证券的贴现率。",example:"0.0575",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"12",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DISC",t:8,d:"返回有价证券的贴现率。",a:"返回有价证券的贴现率。",m:[4,5],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"pr",detail:"有价证券的价格（按面值为 ￥100 计算）。",example:"97.975",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"面值 ￥100 的有价证券的清偿价值。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"12",require:"o",repeat:"n",type:"rangenumber"}]},{n:"NPER",t:8,d:"基于固定利率及等额分期付款方式，返回某项投资的总期数。",a:"基于固定利率及等额分期付款方式，返回某项投资的总期数。",m:[3,5],p:[{name:"rate",detail:"各期利率。",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"pmt",detail:"各期所应支付的金额，在整个年金期间保持不变。",example:"500",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"现值，或一系列未来付款的当前值的累积和。",example:"40000",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[可选 - 默认值为0] - 未来值，或在最后一次付款后希望得到的现金余额。",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"type",detail:"[可选 - 默认值为0] - 指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SLN",t:8,d:"返回一个期间内的资产的直线折旧。",a:"返回一个期间内的资产的直线折旧。",m:[3,3],p:[{name:"cost",detail:"资产原值。",example:"300000",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"折旧末尾时的值（有时也称为资产残值）。",example:"75000",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"资产的折旧期数（有时也称作资产的使用寿命）。",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DURATION",t:8,d:"返回假设面值 ￥100 的定期付息有价证券的修正期限。",a:"返回假设面值 ￥100 的定期付息有价证券的修正期限。",m:[5,6],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"coupon",detail:"有价证券的年息票利率。",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"yld",detail:"有价证券的年收益率。",example:"0.09",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MDURATION",t:8,d:"返回假设面值 ￥100 的有价证券的 Macauley 修正期限。",a:"返回假设面值 ￥100 的有价证券的 Macauley 修正期限。",m:[5,6],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"coupon",detail:"有价证券的年息票利率。",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"yld",detail:"有价证券的年收益率。",example:"0.09",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"BIN2DEC",t:9,d:"将二进制数转换为十进制数。",a:"将二进制数转换为十进制数。",m:[1,1],p:[{name:"number",detail:'要转换为十进制数的带符号的10位二进制数值（以字符串形式提供）。\n\n带符号的二进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n对于此函数，最大的正数输入值为0111111111，最小的负数输入值为1000000000。\n\n如果所提供的带符号的二进制数是有效的二进制数，会自动将其转换为相应的字符串输入。例如，BIN2DEC(100)和BIN2DEC("100")得出的结果相同，均为4。',example:"101",require:"m",repeat:"n",type:"rangeall"}]},{n:"BIN2HEX",t:9,d:"将二进制数转换为十六进制数。",a:"将二进制数转换为十六进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的十六进制数的带符号的10位二进制数值（以字符串形式提供）。\n\n带符号的二进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n对于此函数，最大的正数输入值为0111111111，最小的负数输入值为1000000000。\n\n如果所提供的带符号的二进制数是有效的二进制数，会自动将其转换为相应的字符串输入。例如，BIN2HEX(11111)和BIN2HEX("11111")得出 的结果相同，均为1F。',example:"101",require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:'[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。例如，BIN2HEX("11111",8)所得的结果值为0000001F。\n\n如果带符号的二进制数的最高位为1，则忽略此值；即当提供的带符号的二进制数大于等于1000000000时忽略此值。',example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"BIN2OCT",t:9,d:"将二进制数转换为八进制数。",a:"将二进制数转换为八进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的八进制数的带符号的10位二进制数值（以字符串形式提供）。\n\n带符号的二进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n对于此函数，最大的正数输入值为0111111111，最小的负数输入值为1000000000。\n\n如果所提供的带符号的二进制数是有效的二进制数，会自动将其转换为相应的字符串输入。例如，BIN2OCT(11111)和BIN2OCT("11111")得出的结果相同，均为37。',example:"101",require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:'[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。例如，BIN2OCT("11111")得到的结果值为00000037。\n\n如果带符号的二进制数的最高位为1，则忽略此值；即当提供的带符号的二进制数大于等于1000000000时忽略此值。',example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2BIN",t:9,d:"将十进制数转换为二进制数。",a:"将十进制数转换为二进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的二进制数的十进制数值（以字符串形式提供）。\n\n对于此函数，最大的正数输入值为511，最小的负数输入值为-512。\n\n如果所提供的十进制数是有效的十进制数，会自动将其转换为相应的字符串输入。例如，DEC2BIN(199)和DEC2BIN("199")得出的结果相同，均为11000111。',example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。\n\n如果十进制数为负数，则忽略此值。",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2HEX",t:9,d:"将十进制数转换为十六进制数。",a:"将十进制数转换为十六进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的十六进制数的十进制数值（以字符串形式提供）。\n\n此函数可接受的最大正数值为549755813887，最小负数值为-549755814888。\n\n如果所提供的十进制数是有效的十进制数，会自动将其转换为相应的字符串输入。例如，DEC2HEX(100)和DEC2HEX("100")得出的结果相同，均为64。',example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。\n\n如果十进制数为负数，则忽略此值。",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2OCT",t:9,d:"将十进制数转换为八进制数。",a:"将十进制数转换为八进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的八进制数的十进制数值（以字符串形式提供）。\n\n此函数可接受的最大正数值为536870911，最小负数值为-53687092。\n\n如果所提供的十进制数是有效的十进制数，会自动将其转换为相应的字符串输入。例如，DEC2OCT(199)和DEC2OCT("199")得出的结果相同，均为307。',example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。\n\n如果十进制数为负数，则忽略此值。",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"HEX2BIN",t:9,d:"将十六进制数转换为二进制数。",a:"将十六进制数转换为二进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的二进制数的带符号的40位十六进制数值（以字符串形式提供）。\n\n带符号的十六进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n此函数可接受的最大正数值为1FF，最小负数值为FFFFFFFE00。\n\n如果所提供的带符号的十六进制数是有效的十六进制数，函数会自动将其转换为相应的字符串输入。例如，HEX2BIN(199)和HEX2BIN("199")得出的结果相同，均为110011001。',example:'"f3"',require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:"[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。\n\n如果带符号的十六进制数的最高位为1，则忽略此值；即当提供的带符号的十六进制数大于等于8000000000时忽略此值。",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"HEX2DEC",t:9,d:"将十六进制数转换为十进制数。",a:"将十六进制数转换为十进制数。",m:[1,1],p:[{name:"number",detail:'要转换为十进制数的带符号的40位十六进制数值（以字符串形式提供）。\n\n带符号的十六进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n此函数可接受的最大正数值为7fffffffff，最小负数值为8000000000。\n\n如果所提供的带符号的十六进制数是有效的十六进制数，函数会自动将其转换为相应的字符串输入。例如，HEX2DEC(199)和HEX2DEC("199")得出的结果相同，均为409。',example:'"f3"',require:"m",repeat:"n",type:"rangeall"}]},{n:"HEX2OCT",t:9,d:"将十六进制数转换为八进制数。",a:"将十六进制数转换为八进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的八进制数的带符号的40位十六进制数值（以字符串形式提供）。\n\n带符号的十六进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n此函数可接受的最大正数值为1FFFFFFF，最小负数值为FFE0000000。\n\n如果所提供的带符号的十六进制数是有效的十六进制数，函数会自动将其转换为相应的字符串输入。例如，HEX2OCT(199)和HEX2OCT("199")得出的结果相同，均为631。',example:'"f3"',require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:"[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。\n\n如果带符号的十六进制数的最高位为1，则忽略此值；即当给定的带符号的十六进制数大于等于8000000000时忽略此值。",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"OCT2BIN",t:9,d:"将八进制数转换为二进制数。",a:"将八进制数转换为二进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的二进制数的带符号的30位八进制数值（以字符串形式提供）。\n\n带符号的八进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n此函数可接受的最大正数值为777，最小负数值为7777777000。\n\n如果所提供的带符号的八进制数是有效的八进制数，函数会自动将其转换为相应的字符串输入。例如，OCT2BIN(177)和OCT2BIN("177")得出的结果相同，均为1111111。',example:"37",require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:"[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。\n\n如果带符号的八进制数的最高位为1，则忽略此值；即当给定的带符号的八进制数大于等于4000000000时忽略此值。",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"OCT2DEC",t:9,d:"将八进制数转换为十进制数。",a:"将八进制数转换为十进制数。",m:[1,1],p:[{name:"number",detail:'要转换为十进制数的带符号的30位八进制数值（以字符串形式提供）。\n\n带符号的ba进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n此函数可接受的最大正数值为3777777777，最小负数值为4000000000。\n\n如果所提供的带符号的八进制数是有效的八进制数，函数会自动将其转换为相应的字符串输入。例如，OCT2DEC(177)和OCT2DEC("177")得出的结果相同，均为127。',example:"37",require:"m",repeat:"n",type:"rangeall"}]},{n:"OCT2HEX",t:9,d:"将八进制数转换为十六进制数。",a:"将八进制数转换为十六进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的十六进制数的带符号的30位八进制数值（以字符串形式提供）。\n\n带符号的ba进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n此函数可接受的最大正数值为3777777777，最小负数值为4000000000。\n\n如果所提供的带符号的八进制数是有效的八进制数，函数会自动将其转换为相应的字符串输入。例如，OCT2HEX(177)和OCT2HEX("177")得出的结果相同，均为7F。',example:"37",require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:"[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。\n\n如果带符号的八进制数的最高位为1，则忽略此值；即当给定的带符号的八进制数大于等于4000000000时忽略此值。",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COMPLEX",t:9,d:"将实系数及虚系数转换为 x+yi 或 x+yj 形式的复数。",a:"将实系数及虚系数转换为 x+yi 或 x+yj 形式的复数。",m:[2,3],p:[{name:"real_num",detail:"复数的实系数。",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"i_num",detail:"复数的虚系数。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"suffix",detail:'[可选 - 默认为 "i"] - 复数中虚系数的后缀。',example:'"j"',require:"o",repeat:"n",type:"rangestring"}]},{n:"IMREAL",t:9,d:"返回以 x+yi 或 x+yj 文本格式表示的复数的实系数。",a:"返回以 x+yi 或 x+yj 文本格式表示的复数的实系数。",m:[1,1],p:[{name:"inumber",detail:"需要计算其实系数的复数。",example:'"4+5i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMAGINARY",t:9,d:"返回以 x+yi 或 x+yj 文本格式表示的复数的虚系数。",a:"返回以 x+yi 或 x+yj 文本格式表示的复数的虚系数。",m:[1,1],p:[{name:"inumber",detail:"需要计算其虚系数的复数。",example:'"4+5i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMCONJUGATE",t:9,d:"返回以 x+yi 或 x+yj 文本格式表示的复数的共轭复数。",a:"返回以 x+yi 或 x+yj 文本格式表示的复数的共轭复数。",m:[1,1],p:[{name:"inumber",detail:"需要计算其共轭数的复数。",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMABS",t:9,d:"返回以 x+yi 或 x+yj 文本格式表示的复数的绝对值（模）。",a:"返回以 x+yi 或 x+yj 文本格式表示的复数的绝对值（模）。",m:[1,1],p:[{name:"inumber",detail:"要计算其绝对值的复数。",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"DELTA",t:9,d:"检验两个值是否相等。 如果 number1=number2，则返回 1；否则返回 0。",a:"检验两个值是否相等。 如果 number1=number2，则返回 1；否则返回 0。",m:[1,2],p:[{name:"number1",detail:"第一个数字。",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"number2",detail:"[可选 - 默认为 0] - 第二个数字。",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"IMSUM",t:9,d:"返回以 x+yi 或 x+yj 文本格式表示的 1 至 255 个复数的和。",a:"返回以 x+yi 或 x+yj 文本格式表示的 1 至 255 个复数的和。",m:[1,255],p:[{name:"inumber1",detail:"要相加的第一个复数",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"},{name:"inumber2, …",detail:"[可选] - 要与值1 相加的其他复数",example:'"5-3i"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IMSUB",t:9,d:"返回以 x+yi 或 x+yj 文本格式表示的两个复数的差。",a:"返回以 x+yi 或 x+yj 文本格式表示的两个复数的差。",m:[2,2],p:[{name:"inumber1",detail:"从（复）数中减去 inumber2。",example:'"6+5i"',require:"m",repeat:"n",type:"rangeall"},{name:"inumber2",detail:"从 inumber1 中减（复）数。",example:'"2+3i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMPRODUCT",t:9,d:"返回以 x+yi 或 x+yj 文本格式表示的 1 至 255 个复数的乘积。",a:"返回以 x+yi 或 x+yj 文本格式表示的 1 至 255 个复数的乘积。",m:[1,255],p:[{name:"inumber1",detail:"用于计算乘积的第一个复数",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"},{name:"inumber2, …",detail:"[可选] - 要相乘的其他复数。",example:'"5-3i"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IMDIV",t:9,d:"返回以 x+yi 或 x+yj 文本格式表示的两个复数的商。",a:"返回以 x+yi 或 x+yj 文本格式表示的两个复数的商。",m:[2,2],p:[{name:"inumber1",detail:"复数分子或被除数。",example:'"11+16i"',require:"m",repeat:"n",type:"rangeall"},{name:"inumber2",detail:"复数分母或除数。",example:'"3+2i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"NOT",t:10,d:"返回某个逻辑值的相反值 - “NOT(TRUE())”将返回 FALSE；“NOT(FALSE())”将返回 TRUE。",a:"返回某个逻辑值的相反值 - “NOT(TRUE())”将返回 FALSE；“NOT(FALSE())”将返回 TRUE。",m:[1,1],p:[{name:"logical",detail:"计算结果为 TRUE 或 FALSE 的任何值或表达式。",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TRUE",t:10,d:"返回逻辑值 TRUE。",a:"返回逻辑值 TRUE。",m:[0,0],p:[]},{n:"FALSE",t:10,d:"返回逻辑值 FALSE。",a:"返回逻辑值 FALSE。",m:[0,0],p:[]},{n:"AND",t:10,d:"所有参数的计算结果为 TRUE 时，返回 TRUE；只要有一个参数的计算结果为 FALSE，即返回 FALSE。",a:"所有参数的计算结果为 TRUE 时，返回 TRUE；只要有一个参数的计算结果为 FALSE，即返回 FALSE。",m:[1,255],p:[{name:"logical1",detail:"要测试的第一个条件，其计算结果可以为 TRUE 或 FALSE。",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"logical2,...",detail:"[可选] - 要测试的其他条件，其计算结果可以为 TRUE 或 FALSE，最多可包含 255 个条件。",example:'A3 = "bar"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IFERROR",t:10,d:"如果第一个参数不是错误值，就返回第一个参数；否则，返回第二个参数。",a:"如果第一个参数不是错误值",m:[2,2],p:[{name:"value",detail:"检查是否存在错误的参数。",example:"A1",require:"m",repeat:"n",type:"rangeall"},{name:"value_if_error",detail:"公式的计算结果错误时返回的值。 计算以下错误类型：#N/A、#VALUE!、#REF!、#DIV/0!、#NUM!、#NAME? 或 #NULL!。",example:'"Error in cell A1"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IF",t:10,d:"当逻辑表达式的值为 TRUE 时返回一个值，而当其为 FALSE 时返回另一个值。",a:"当逻辑表达式的值为 TRUE 时返回一个值，而当其为 FALSE 时返回另一个值。",m:[2,3],p:[{name:"logical_test",detail:"一个表达式或对包含表达式的单元格的引用，该表达式代表某种逻辑值（即TRUE或FALSE）。",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"value_if_true",detail:"当逻辑表达式为TRUE时的返回值。",example:'"A2 is foo"',require:"m",repeat:"n",type:"rangeall"},{name:"value_if_false",detail:"[可选 - 默认为空白] - 当逻辑表达式等于FALSE时的函数返回值。",example:'"A2 was false"',require:"o",repeat:"n",type:"rangeall"}]},{n:"OR",t:10,d:"只要有一个参数的计算结果为 TRUE 时，返回 TRUE；所有参数的计算结果为 FALSE，即返回 FALSE。",a:"只要有一个参数的计算结果为 TRUE 时，返回 TRUE；所有参数的计算结果为 FALSE，即返回 FALSE。",m:[1,255],p:[{name:"logical1",detail:"要测试的第一个条件，其计算结果可以为 TRUE 或 FALSE。",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"逻辑表达式2",detail:"[可选] - 其他表达式或对包含表达式的单元格的引用，这些表达式代表某种逻辑值（即TRUE或FALSE）或者可以强制转换为逻辑值。",example:' A3 = "bar"',require:"m",repeat:"n",type:"rangeall"}]},{n:"NE",t:11,d:"如果指定的值不相等，则返回“TRUE”；否则返回“FALSE”。相当于“<>”运算符。",a:"如果指定的值不相等，则返回“TRUE”；否则返回“FALSE”。相当于“<>”运算符。",m:[2,2],p:[{name:"value1",detail:"第一个值。",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"要检查是否与 value1 不相等的值。",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"EQ",t:11,d:"如果指定的值相等，则返回“TRUE”；否则返回“FALSE”。相当于“=”运算符。",a:"如果指定的值相等，则返回“TRUE”；否则返回“FALSE”。相当于“=”运算符。",m:[2,2],p:[{name:"value1",detail:"第一个值。",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"要检查是否与 value1 相等的值。",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"GT",t:11,d:"如果第一个参数严格大于第二个，则返回 TRUE；否则返回 FALSE。相当于“>”运算符。",a:"如果第一个参数严格大于第二个，则返回 TRUE；否则返回 FALSE。相当于“>”运算符。",m:[2,2],p:[{name:"value1",detail:"要测试其是否大于 value2 的值。",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"第二个值。",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"GTE",t:11,d:"如果第一个参数大于或等于第二个，则返回 TRUE；否则返回 FALSE。相当于“>=”运算符。",a:"如果第一个参数大于或等于第二个，则返回 TRUE；否则返回 FALSE。相当于“>=”运算符。",m:[2,2],p:[{name:"value1",detail:"要测试其是否大于等于 value2 的值。",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"第二个值。",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"LT",t:11,d:"如果第一个参数严格小于第二个，则返回 TRUE；否则返回 FALSE。相当于“<”运算符。",a:"如果第一个参数严格小于第二个，则返回 TRUE；否则返回 FALSE。相当于“<”运算符。",m:[2,2],p:[{name:"value1",detail:"要测试其是否小于 value2 的值。",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"第二个值。",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"LTE",t:11,d:"如果第一个参数小于或等于第二个，则返回 TRUE；否则返回 FALSE。相当于“<=”运算符。",a:"如果第一个参数小于或等于第二个，则返回 TRUE；否则返回 FALSE。相当于“<=”运算符。",m:[2,2],p:[{name:"value1",detail:"要测试其是否小于等于 value2 的值。",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"第二个值。",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"ADD",t:11,d:"返回两个数值之和。相当于 `+` 运算符。",a:"返回两个数值之和。相当于 `+` 运算符。",m:[2,2],p:[{name:"value1",detail:"第一个加数。",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"第二个加数。",example:"A3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MINUS",t:11,d:"返回两个数值之差。相当于“-”运算符。",a:"返回两个数值之差。相当于“-”运算符。",m:[2,2],p:[{name:"value1",detail:"被减数，即要对其计减的数值。",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"减数，即要从 value1 中减除的数值。",example:"A3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MULTIPLY",t:11,d:"返回两个数的乘积。相当于“*”运算符。",a:"返回两个数的乘积。相当于“*”运算符。",m:[2,2],p:[{name:"value1",detail:"第一个乘数。",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"第二个乘数。",example:"B2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DIVIDE",t:11,d:"返回两个参数相除所得的结果。相当于 `/` 运算符。",a:"返回两个参数相除所得的结果。相当于 `/` 运算符。",m:[2,2],p:[{name:"value1",detail:"要被除的数值。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"用于除其他数的数值。\n\n除数不得为0。",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONCAT",t:11,d:"返回两个值的串联。相当于 `&` 运算符。",a:"返回两个值的串联。相当于 `&` 运算符。",m:[2,2],p:[{name:"value1",detail:"value2 将附于其后的值。",example:'"de"',require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"要附于 value1 之后的值。",example:'"mystify"',require:"m",repeat:"n",type:"rangeall"}]},{n:"UNARY_PERCENT",t:11,d:"返回按百分比解释的数值。例如，“UNARY_PERCENT(100)”等于1。",a:"返回按百分比解释的数值。例如，“UNARY_PERCENT(100)”等于1。",m:[1,1],p:[{name:"number",detail:"要作为百分比解释的数值。",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONCATENATE",t:12,d:"将两个或多个文本字符串联接为一个字符串。",a:"将两个或多个文本字符串联接为一个字符串。",m:[1,255],p:[{name:"text1",detail:"初始字符串。",example:'"Super"',require:"m",repeat:"n",type:"rangeall"},{name:"text2 ...",detail:"[可选] - 要按顺序连接在一起的其他字符串。",example:'"calla"',require:"o",repeat:"y",type:"rangeall"}]},{n:"CODE",t:12,d:"返回所提供的字符串中首字符的 Unicode 映射值。",a:"返回所提供的字符串中首字符的 Unicode 映射值。",m:[1,1],p:[{name:"text",detail:"要返回其首字符的Unicode映射值的字符串。",example:'"a"',require:"m",repeat:"n",type:"rangeall"}]},{n:"CHAR",t:12,d:"按照当前 Unicode 编码表，将数字转换为对应的字符。",a:"按照当前 Unicode 编码表，将数字转换为对应的字符。",m:[1,1],p:[{name:"number",detail:"介于 1 到 255 之间的数字。",example:"97",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ARABIC",t:12,d:"将罗马数字转换为阿拉伯数字。",a:"将罗马数字转换为阿拉伯数字。",m:[1,1],p:[{name:"text",detail:"要转换格式的罗马数字",example:'"XIV"',require:"m",repeat:"n",type:"rangeall"}]},{n:"ROMAN",t:12,d:"将数字格式设置为罗马数字形式。",a:"将数字格式设置为罗马数字形式。",m:[1,1],p:[{name:"number",detail:"要设置格式的数字，介于1到3999之间（包括这两个数字）。",example:"499",require:"m",repeat:"n",type:"rangenumber"}]},{n:"REGEXEXTRACT",t:12,d:"按照正则表达式提取匹配的子串。",a:"按照正则表达式提取匹配的子串。",m:[2,2],p:[{name:"text",detail:"输入文本。",example:'"Needle in a haystack"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"此函数将返回文本中符合此表达式的第一个子串。",example:'".e{2}dle"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REGEXMATCH",t:12,d:"判断一段文本是否与正则表达式相匹配。",a:"判断一段文本是否与正则表达式相匹配。",m:[2,2],p:[{name:"text",detail:"要用正则表达式测试的文本。",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"用来测试文本的正则表达式。",example:'"S.r"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REGEXREPLACE",t:12,d:"使用正则表达式将文本字符串中的一部分替换为其他文本字符串。",a:"使用正则表达式将文本字符串中的一部分替换为其他文本字符串。",m:[3,3],p:[{name:"text",detail:"要对其局部进行替换操作的文本。",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"正则表达式。 text 中所有匹配的实例都将被替换。",example:'"S.*d"',require:"m",repeat:"n",type:"rangeall"},{name:"replacement",detail:"要插入到原有文本中的文本。",example:'"Bed"',require:"m",repeat:"n",type:"rangeall"}]},{n:"T",t:12,d:"返回文本格式的字符串参数。",a:"返回文本格式的字符串参数。",m:[1,1],p:[{name:"value",detail:"要转换为文本的参数。\n\n如果值为文本，T将返回值本身。\n\n如果值为指向包含文本的单元格的引用，T将返回值中的内容。\n\n如果值为错误值或包含错误值的单元格，T将返回该错误值。\n\n对于所有其他情况，T将返回空串。",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"FIXED",t:12,d:"以固定的小数位数设置数字的格式。",a:"以固定的小数位数设置数字的格式。",m:[1,3],p:[{name:"number",detail:"要进行舍入并转换为文本的数字。",example:"3.141592653",require:"m",repeat:"n",type:"rangenumber"},{name:"decimals",detail:"[可选 - 默认值为2] - 结果中要显示的小数位数。\n\n如果数值的有效位数小于小数位数，将以零填充。如果数值的有效位数大于小数位数，则将其舍入到所需的小数位数而不是将其截断。",example:"2",require:"o",repeat:"n",type:"rangenumber"},{name:"no_commas",detail:"[可选 - 默认值为FALSE()] - 一个逻辑值，如果为 TRUE()，则会禁止 FIXED 在返回的文本中包含逗号。",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FIND",t:12,d:"返回字符串在文本中首次出现的位置（区分大小写）。",a:"返回字符串在文本中首次出现的位置（区分大小写）。",m:[2,3],p:[{name:"find_text",detail:"要在要搜索的文本中查找的字符串。",example:'"n"',require:"m",repeat:"n",type:"rangeall"},{name:"within_text",detail:"要在其中搜索搜索字符串的首次出现位置的文本。",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"[可选 - 默认值为1] - 要在要搜索的文本中开始搜索的字符位置。",example:"14",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FINDB",t:12,d:"返回某个字符串在文本中首次出现的位置（每个双字节字符占两个位置）。",a:"返回某个字符串在文本中首次出现的位置（每个双字节字符占两个位置）。",m:[2,3],p:[{name:"find_text",detail:"要在要搜索的文本中查找的字符串。",example:'"新"',require:"m",repeat:"n",type:"rangeall"},{name:"within_text",detail:"要在其中搜索搜索字符串的首次出现位置的文本。",example:'"农历新年"',require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"[可选 - 默认值为 1] - 要在要搜索的文本中开始搜索的字符位置。",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"JOIN",t:12,d:"将一个或多个使用指定定界符的一维数组的元素连接到一起。",a:"将一个或多个使用指定定界符的一维数组的元素连接到一起。",m:[2,255],p:[{name:"separator",detail:"置于相互连接的值之间的字符或字符串。\n\n定界符可以为空，例如JOIN(,{1,2,3})。",example:'" and-a "',require:"m",repeat:"n",type:"rangeall"},{name:"array1",detail:"要使用定界符连接的一个或多个值。",example:"{1",require:"m",repeat:"n",type:"rangeall"},{name:"array2, ...",detail:"[可选] - 要使用定界符连接的其他值或数组。",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"LEFT",t:12,d:"从文本字符串的第一个字符开始返回指定个数的字符。",a:"从文本字符串的第一个字符开始返回指定个数的字符。",m:[1,2],p:[{name:"text",detail:"包含要提取的字符的文本字符串。",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"num_chars",detail:"[可选 - 默认值为1] - 指定要由 LEFT 提取的字符的数量。",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RIGHT",t:12,d:"根据所指定的字符数返回文本字符串中最后一个或多个字符。",a:"根据所指定的字符数返回文本字符串中最后一个或多个字符。",m:[1,2],p:[{name:"text",detail:"包含要提取的字符的文本字符串。",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"num_chars",detail:"[可选 - 默认值为1] - 指定要由 RIGHT 提取的字符的数量。",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MID",t:12,d:"返回文本字符串中从指定位置开始的特定数目的字符。",a:"返回文本字符串中从指定位置开始的特定数目的字符。",m:[3,3],p:[{name:"text",detail:"包含要提取的字符的文本字符串。",example:'"get this"',require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"要从字符串中开始提取的位置。字符串中第一个字符的索引为1。",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"num_chars",detail:"指定要由 MID 提取的字符的数量。\n\n如果提取的字符数尚不足提取长度个字符时就到达了字符串尾部，则MID返回从开始位置到字符串尾部的字符。",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LEN",t:12,d:"返回给定字符串的长度。",a:"返回给定字符串的长度。",m:[1,1],p:[{name:"text",detail:"要返回其长度的字符串。",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"LENB",t:12,d:"返回文本中所包含的字符数。与双字节字符集(DBCS)一起使用。",a:"返回文本中所包含的字符数。与双字节字符集(DBCS)一起使用。",m:[1,1],p:[{name:"text",detail:"要返回其字节数的字符串。（一个汉字为两个字节数）",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"LOWER",t:12,d:"将指定字符串中的字母转换为小写。",a:"将指定字符串中的字母转换为小写。",m:[1,1],p:[{name:"text",detail:"要转换为小写的字符串。",example:'"LOREM IPSUM"',require:"m",repeat:"n",type:"rangeall"}]},{n:"UPPER",t:12,d:"将指定字符串中的字母转换为大写。",a:"将指定字符串中的字母转换为大写。",m:[1,1],p:[{name:"text",detail:"要转换为大写的字符串。",example:'"lorem ipsum"',require:"m",repeat:"n",type:"rangeall"}]},{n:"EXACT",t:12,d:"比较两个字符串是否相同。",a:"比较两个字符串是否相同。",m:[2,2],p:[{name:"text1",detail:"要比较的第一个字符串。",example:"A1",require:"m",repeat:"n",type:"rangeall"},{name:"text2",detail:"要比较的第二个字符串。",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"REPLACE",t:12,d:"将文本字符串的一部分替换为其他文本字符串。",a:"将文本字符串的一部分替换为其他文本字符串。",m:[4,4],p:[{name:"old_text",detail:"要对其局部进行替换操作的文本。",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"开始进行替换操作的位置（文本开头位置为 1）。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"num_chars",detail:"要在文本中替换的字符个数。",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"new_text",detail:"要插入到原有文本中的文本。",example:'"Bed"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REPT",t:12,d:"返回指定文本的多次重复。",a:"返回指定文本的多次重复。",m:[2,2],p:[{name:"text",detail:"要重复的字符或字符串。",example:'"ha"',require:"m",repeat:"n",type:"rangeall"},{name:"number_times",detail:"要重复的文本要在返回值中出现的次数。\n\n最大重复次数为100。即使重复次数大于100，REPT也仅将相应文本重复100次。",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SEARCH",t:12,d:"返回字符串在文本中首次出现的位置（不区分大小写）。",a:"返回字符串在文本中首次出现的位置（不区分大小写）。",m:[2,3],p:[{name:"find_text",detail:"要在要搜索的文本中查找的字符串。",example:'"n"',require:"m",repeat:"n",type:"rangeall"},{name:"within_text",detail:"要在其中搜索搜索字符串的首次出现位置的文本。",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"[ 可选 - 默认值为1 ] - 要在要搜索的文本中开始搜索的字符位置。",example:"14",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUBSTITUTE",t:12,d:"在文本字符串中用 new_text 替换 old_text。",a:"在文本字符串中用 new_text 替换 old_text。",m:[3,4],p:[{name:"text",detail:"需要替换其中字符的文本，或对含有文本（需要替换其中字符）的单元格的引用。",example:'"search for it"',require:"m",repeat:"n",type:"rangeall"},{name:"old_text",detail:"需要替换的文本。",example:'"search for"',require:"m",repeat:"n",type:"rangeall"},{name:"new_text",detail:"用于替换 old_text 的文本。",example:'"Google"',require:"m",repeat:"n",type:"rangeall"},{name:"instance_num",detail:"[ 可选 ] - 指定要用 new_text 替换 old_text 的事件。 如果指定了 instance_num，则只有满足要求的 old_text 被替换。 否则，文本中出现的所有 old_text 都会更改为 new_text。",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CLEAN",t:12,d:"移除文本中的不可打印 ASCII 字符后将其返回。",a:"移除文本中的不可打印 ASCII 字符后将其返回。",m:[1,1],p:[{name:"text",detail:"要移除其中不可打印字符的文本。",example:'"AF"&CHAR(31)',require:"m",repeat:"n",type:"rangeall"}]},{n:"TEXT",t:12,d:"按照指定格式将数字转换为文本。",a:"按照指定格式将数字转换为文本。",m:[2,2],p:[{name:"value",detail:"要设置格式的数字、日期或时间。",example:"1.23",require:"m",repeat:"n",type:"rangenumber"},{name:"format_text",detail:'以括号括起来的模式串，将按该模式设置数字的格式。\n\n0表示在数值位数少于格式指定的位数时必定以零填充。例如，TEXT(12.3,"000.00")将返回012.30。当数值的小数位数超过模式指定的小数位数时，四舍五入为指定的小数位数。例如，TEXT(12.305,"00.00")将返回12.31。\n\n#类似于0，但并不是在小数点的两侧都以零填充。例如，TEXT(12.3,"###.##")将返回12.3。',example:'"$0.00"',require:"m",repeat:"n",type:"rangeall"}]},{n:"TRIM",t:12,d:"删除指定字符串前后的空格。",a:"删除指定字符串前后的空格。",m:[1,1],p:[{name:"text",detail:"要修剪的字符串或指向包含该字符串的单元格的引用。",example:'" lorem ipsum"',require:"m",repeat:"n",type:"rangeall"}]},{n:"VALUE",t:12,d:"将可识别的任何日期、时间或数字格式的字符串转换为数字。",a:"将可识别的任何日期、时间或数字格式的字符串转换为数字。",m:[1,1],p:[{name:"text",detail:"包含要转换的值的字符串。",example:'"123"',require:"m",repeat:"n",type:"rangeall"}]},{n:"PROPER",t:12,d:"将指定字符串中每个单词的首字母转为大写。",a:"将指定字符串中每个单词的首字母转为大写。",m:[1,1],p:[{name:"text",detail:"要转换的文本，其中每个单词的首字母都将转为大写，所有其他字母则转为小写。",example:'"united states"',require:"m",repeat:"n",type:"rangeall"}]},{n:"CONVERT",t:13,d:"将数字从一种度量系统转换为另一种度量系统。",a:"将数字从一种度量系统转换为另一种度量系统。",m:[3,3],p:[{name:"number",detail:"是以 from_unit 为单位的需要进行转换的数值。",example:"5.1",require:"m",repeat:"n",type:"rangenumber"},{name:"from_unit",detail:"是数值的单位。",example:'"g"',require:"m",repeat:"n",type:"rangeall"},{name:"to_unit",detail:"是结果的单位。",example:'"kg"',require:"m",repeat:"n",type:"rangeall"}]},{n:"SUMX2MY2",t:14,d:"返回两数组中对应数值的平方差之和。",a:"返回两数组中对应数值的平方差之和。",m:[2,2],p:[{name:"array_x",detail:"第一个数组或数值区域。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"第二个数组或数值区域。",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMX2PY2",t:14,d:"返回两数组中对应数值的平方和之和。",a:"返回两数组中对应数值的平方和之和。",m:[2,2],p:[{name:"array_x",detail:"第一个数组或数值区域。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"第二个数组或数值区域。",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMXMY2",t:14,d:"返回两数组中对应数值之差的平方和。",a:"返回两数组中对应数值之差的平方和。",m:[2,2],p:[{name:"array_x",detail:"第一个数组或数值区域。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"第二个数组或数值区域。",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRANSPOSE",t:14,d:"将数组或单元格范围的行列转置。",a:"将数组或单元格范围的行列转置。",m:[1,1],p:[{name:"array",detail:"要将其行列互换的数组或范围。",example:"{1,2}",require:"m",repeat:"n",type:"range"}]},{n:"TREND",t:14,d:"返回线性趋势值。",a:"返回线性趋势值。",m:[1,4],p:[{name:"known_y",detail:"关系表达式 y = mx + b 中已知的 y 值集合。\n\n如果 known_y 为二维数组或范围，则 known_x 的维数必须与之相同，或者省略此参数。\n\n如果 known_y 为一维数组或范围，known_x 则可代表二维数组或范围中的多个自变量。也就是说，如果 known_y 为单行，则将 known_x 中的每行解释为各自独立的值，类似情况也适用于 known_y 为单列的情况。",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_x",detail:"[可选 - 默认该数组为{1,2,3,...},其大小与 known_y 相同] - 关系表达式 y = mx + b 中已知的可选 x 值集合。\n\n如果 known_y 为一维数组或范围，known_x 则可代表二维数组或范围中的多个自变量。也就是说，如果 known_y 为单行，则将 known_x 中的每行解释为各自独立的值，类似情况也适用于 known_y 为单列的情况。",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"new_x",detail:"[可选 - 默认与 known_x 相同] -  需要函数 TREND 返回对应 y 值的新 x 值。",example:"A11:A13",require:"o",repeat:"n",type:"rangenumber"},{name:"const",detail:"[可选 - 默认值为TRUE()] - 一个逻辑值，用于指定是否将常量 b 强制设为 0。\n\nTRUE() 表示 b 将按正常计算；\n\nFALSE() 表示 b 将被设为 0（零），m 将被调整以使 y = mx。",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FREQUENCY",t:14,d:"计算数值在某个区域内的出现频率，然后返回一个垂直数组。",a:"计算数值在某个区域内的出现频率，然后返回一个垂直数组。",m:[2,2],p:[{name:"data_array",detail:"要对其频率进行计数的一组数值或对这组数值的引用。",example:"A2:A40",require:"m",repeat:"n",type:"rangenumber"},{name:"bins_array",detail:"要将 data_array 中的值插入到的间隔数组或对间隔的引用。\n\n为清晰起见，应将类别排序，但如果未排序，FREQUENCY会在内部对这些指定的值进行排序并返回正确结果。",example:"B2:B5",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GROWTH",t:14,d:"使用现有数据计算预测的指数等比。",a:"使用现有数据计算预测的指数等比。",m:[1,4],p:[{name:"known_y",detail:"关系表达式 y = b*m^x 中已知的 y 值集合。\n\n如果已知数据_y为二维数组或范围，则已知数据_x的维数必须与之相同，或者省略此参数。\n\n如果已知数据_y为一维数组或范围，已知数据_x则可代表二维数组或范围中的多个自变量。也就是说，如果已知数据_y为单行，则将已知数据_x中的每行解释为各自独立的值，类似情况也适用于已知数据_y为单列的情况。",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_x",detail:"[可选 - 默认该数组为{1,2,3,...},其大小与 known_y 相同] - 关系表达式 y = b*m^x 中已知的可选 x 值集合。\n\n如果已知数据_y为一维数组或范围，已知数据_x则可代表二维数组或范围中的多个自变量。也就是说，如果已知数据_y为单行，则将已知数据_x中的每行解释为各自独立的值，类似情况也适用于已知数据_y为单列的情况。",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"new_x",detail:"[可选 - 默认与 known_x 相同] - 需要函数 GROWTH 返回对应 y 值的新 x 值。",example:"A11:A13",require:"o",repeat:"n",type:"rangenumber"},{name:"const",detail:"[可选 - 默认值为TRUE()] -一个逻辑值，用于指定是否将常量 b 强制设为 1。\n\nTRUE() 表示 b 将按正常计算；\n\nFALSE() 表示 b 将被设为 1，m 将被调整以使 y = m^x。",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LINEST",t:14,d:"可通过使用最小二乘法计算与现有数据最佳拟合的直线，来计算某直线的统计值，然后返回描述此直线的数组。",a:"可通过使用最小二乘法计算与现有数据最佳拟合的直线，来计算某直线的统计值，然后返回描述此直线的数组。",m:[1,4],p:[{name:"known_y",detail:"关系表达式 y = mx + b 中已知的 y 值集合。\n\n如果 known_y 为二维数组或范围，则 known_x 的维数必须与之相同，或者省略此参数。\n\n如果 known_y 为一维数组或范围，known_x 则可代表二维数组或范围中的多个自变量。也就是说，如果 known_y 为单行，则将 known_x 中的每行解释为各自独立的值，类似情况也适用于 known_y 为单列的情况。",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_x",detail:"[可选 - 默认该数组为{1,2,3,...},其大小与 known_y 相同] - 关系表达式 y = mx + b 中已知的可选 x 值集合。\n\n如果 known_y 为一维数组或范围，known_x 则可代表二维数组或范围中的多个自变量。也就是说，如果 known_y 为单行，则将 known_x 中的每行解释为各自独立的值，类似情况也适用于 known_y 为单列的情况。",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"const",detail:"[可选 - 默认值为TRUE()] - 一个逻辑值，用于指定是否将常量 b 强制设为 0。\n\nTRUE() 表示 b 将按正常计算；\n\nFALSE() 表示 b 将被设为 0（零），m 将被调整以使 y = mx。",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{name:"stats",detail:"[可选 - 默认值为FALSE()] - 一个逻辑值，用于指定是否返回附加回归统计值。\n\n如果详细为TRUE，除了对应于每个自变量的一组线性系数和y截距之外，LINEST还返回以下信息：\n\n每项系数和截距的标准误差、\n\n限定系数（介于0和1之间，1表示完全相关）、\n\n因变量值的标准误差、\n\nF统计或F观测值，指示所观测到的因变量和自变量变量之间的关系是随机的还是线性的、\n\n自由度，用于在参照表中查找F统计值以估算可信度、\n\n回归平方和，以及\n\n残差平方和。",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LOGEST",t:14,d:"在回归分析中，计算最符合数据的指数回归拟合曲线，并返回描述该曲线的数值数组。",a:"在回归分析中，计算最符合数据的指数回归拟合曲线，并返回描述该曲线的数值数组。",m:[1,4],p:[{name:"known_y",detail:"关系表达式 y = mx + b 中已知的 y 值集合。\n\n如果 known_y 为二维数组或范围，则 known_x 的维数必须与之相同，或者省略此参数。\n\n如果 known_y 为一维数组或范围，known_x 则可代表二维数组或范围中的多个自变量。也就是说，如果 known_y 为单行，则将 known_x 中的每行解释为各自独立的值，类似情况也适用于 known_y 为单列的情况。",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_x",detail:"[可选 - 默认该数组为{1,2,3,...},其大小与 known_y 相同] - 关系表达式 y = mx + b 中已知的可选 x 值集合。\n\n如果 known_y 为一维数组或范围，known_x 则可代表二维数组或范围中的多个自变量。也就是说，如果 known_y 为单行，则将 known_x 中的每行解释为各自独立的值，类似情况也适用于 known_y 为单列的情况。",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"const",detail:"[可选 - 默认值为TRUE()] - 一个逻辑值，用于指定是否将常量 b 强制设为 0。\n\nTRUE() 表示 b 将按正常计算；\n\nFALSE() 表示 b 将被设为 0（零），m 将被调整以使 y = mx。",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{name:"stats",detail:"[可选 - 默认值为FALSE()] - 一个逻辑值，用于指定是否返回附加回归统计值。\n\n如果详细为TRUE，则除了为每个自变量和系数 b 返回一组指数值之外，LOGEST 还将返回以下数据：\n\n每项指数和系数的标准误差、\n\n限定系数（介于 0 和 1 之间，1 表示完全相关）、\n\n因变量值的标准误差、\n\nF 统计或 F 观测值，指示所观测到的因变量和自变量之间的关系是随机的还是指数的、\n\n自由度 - 用于在参照表中查找 F 统计值以估算可信度、\n\n回归平方和，以及\n\n残差平方和。",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"MDETERM",t:14,d:"返回一个数组的矩阵行列式的值。",a:"返回一个数组的矩阵行列式的值。",m:[1,1],p:[{name:"array",detail:"行数和列数相等的数值数组。",example:"A1:D4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MINVERSE",t:14,d:"返回数组中存储的矩阵的逆矩阵。",a:"返回数组中存储的矩阵的逆矩阵。",m:[1,1],p:[{name:"array",detail:"行数和列数相等的数值数组。",example:"A1:D4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MMULT",t:14,d:"返回两个数组的矩阵乘积。结果矩阵的行数与 array1 的行数相同，矩阵的列数与 array2 的列数相同。",a:"返回两个数组的矩阵乘积。结果矩阵的行数与 array1 的行数相同，矩阵的列数与 array2 的列数相同。",m:[2,2],p:[{name:"array1",detail:"要进行矩阵乘法运算的第一个矩阵数组。\n\narray1 列数必须与 array2 的行数相同",example:"A1:B3",require:"m",repeat:"n",type:"rangenumber"},{name:"array2",detail:"要进行矩阵乘法运算的第二个矩阵数组。\n\narray2 的行数必须与 array1 列数相同",example:"C1:F2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMPRODUCT",t:14,d:"在给定的几组数组中，将数组间对应的元素相乘，并返回乘积之和。",a:"在给定的几组数组中，将数组间对应的元素相乘，并返回乘积之和。",m:[1,255],p:[{name:"array1",detail:"其相应元素需要进行相乘并求和的第一个数组参数。",example:"A2:C5",require:"m",repeat:"n",type:"rangenumber"},{name:"array2",detail:"[可选] - 其相应元素需要进行相乘并求和的其它数组参数。",example:"D2:F5",require:"o",repeat:"y",type:"rangenumber"}]},{n:"ISFORMULA",t:15,d:"检查公式是否位于引用的单元格中。",a:"检查公式是否位于引用的单元格中。",m:[1,1],p:[{name:"cell",detail:"要检查是否存在公式的单元格。\n\n如果 cell 为包含公式的单元格，则 ISFORMULA 将返回 TRUE。如果 cell 为相应单元格范围，则当该范围内的首个单元格包含公式时，系统会返回 TRUE。如果是任何其他值，系统都将返回 FALSE。",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"CELL",t:15,d:"返回有关单元格的格式、位置或内容的信息。",a:"返回有关单元格的格式、位置或内容的信息。",m:[2,2],p:[{name:"info_type",detail:"一个文本值，指定要返回的单元格信息的类型。",example:'"type"',require:"m",repeat:"n",type:"rangeall"},{name:"reference",detail:"需要其相关信息的单元格。",example:"C2",require:"m",repeat:"n",type:"range"}]},{n:"NA",t:15,d:"返回错误值 #N/A。",a:"返回错误值 #N/A。",m:[0,0],p:[]},{n:"ERROR_TYPE",t:15,d:"返回与其他单元格中的错误值相对应的数字。",a:"返回与其他单元格中的错误值相对应的数字。",m:[1,1],p:[{name:"error_val",detail:"用于查找错误号的单元格，虽然您也可以直接提供错误值。",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISBLANK",t:15,d:"检查所引用的单元格是否为空。",a:"检查所引用的单元格是否为空。",m:[1,1],p:[{name:"value",detail:"对要检查其是否为空的单元格的引用。\n\n如果是空单元格，则 TRUE；否则返回 FALSE。",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"ISERR",t:15,d:"检查某个值是否为 #N/A 以外的错误值。",a:"检查某个值是否为 #N/A 以外的错误值。",m:[1,1],p:[{name:"value",detail:"要验证其是否为#N/A以外的错误类型的值。\n\n如果值是除#N/A之外的任何错误（包括#DIV/0!、#NAME?、#NULL!、#NUM!、#VALUE!和#REF!），ISERR将返回TRUE。",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISERROR",t:15,d:"检查某个值是否为错误值。",a:"检查某个值是否为错误值。",m:[1,1],p:[{name:"value",detail:"要验证其是否为错误类型的值。\n\n只要值是某种错误值（包括#DIV/0!、#N/A、#NAME?、#NULL!、#NUM!、#VALUE!和#REF!），ISERROR就会返回TRUE。",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISLOGICAL",t:15,d:"检查某个值是 TRUE 还是 FALSE。",a:"检查某个值是 TRUE 还是 FALSE。",m:[1,1],p:[{name:"value",detail:"要验证其为逻辑TRUE还是逻辑FALSE的值。\n\n*如果值为TRUE或FALSE，或为指向值为TRUE或FALSE的单元格的引用，ISLOGICAL将返回TRUE。",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNA",t:15,d:"检查某个值是否为错误值 #N/A。",a:"检查某个值是否为错误值 #N/A。",m:[1,1],p:[{name:"value",detail:"要与错误值#N/A进行比较的值。\n\n*如果值为#N/A或指向包含#N/A的单元格的引用，则ISNA将返回TRUE，否则返回FALSE。",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNONTEXT",t:15,d:"检查某个值是否为非文本。",a:"检查某个值是否为非文本。",m:[1,1],p:[{name:"value",detail:"要检查的文本。\n\n*如果参数为文本值或指向包含文本的单元格的引用，ISNONTEXT将返回FALSE，否则返回TRUE。\n\n当值为指向空单元格的引用时，ISNONTEXT会返回TRUE。\n\n当值为空字符串时，ISNONTEXT将返回FALSE，因为空串被视作文本。",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNUMBER",t:15,d:"检查某个值是否为数字。",a:"检查某个值是否为数字。",m:[1,1],p:[{name:"value",detail:"要验证其是否为数字的值。\n\n*如果参数为数字或指向内容为数字值的单元格的引用，ISNUMBER将返回TRUE，否则返回FALSE。",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISREF",t:15,d:"检查某个值是否为有效的单元格引用。",a:"检查某个值是否为有效的单元格引用。",m:[1,1],p:[{name:"value",detail:"要验证其是否为单元格引用的值。\n\n*如果参数是有效的单元格引用，ISREF将返回TRUE，否则返回FALSE。",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"ISTEXT",t:15,d:"检查某个值是否为文本。",a:"检查某个值是否为文本。",m:[1,1],p:[{name:"value",detail:"要验证其是否为文本的值。\n\n如果参数为文本值或指向包含文本值的单元格的引用，ISTEXT将返回TRUE，否则返回FALSE。",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TYPE",t:15,d:"返回数值的类型。",a:"返回数值的类型。",m:[1,1],p:[{name:"value",detail:"要确定其类型的数据。\n\n数字 返回 1;\n\n文本 返回 2;\n\n逻辑值 返回 4;\n\n错误值 返回 16;\n\n数组 返回 64;",example:"C4",require:"m",repeat:"n",type:"rangeall"}]},{n:"N",t:15,d:"返回转化为数值后的值。",a:"返回转化为数值后的值。",m:[1,1],p:[{name:"value",detail:"要转换为数字的参数。\n\n如果值为数字，则返回该数字。\n\n如果值为日期，则返回该日期的序列号。\n\n如果值为TRUE，则返回1。\n\n如果值为FALSE，则返回0。\n\n如果值为错误值，则返回错误值。\n\n如果值为其他值，则返回0。",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_DATE",t:16,d:"将指定的数字转换为日期。",a:"将指定的数字转换为日期。",m:[1,1],p:[{name:"value",detail:"要转换为日期的参数或其单元格引用。\n\n如果值为数字或指向内容为数值的单元格的引用，TO_DATE会将值转换为相应的日期并返回，值代表从十二月30日到对应的日期之间的天数，\n\n负值表示对应的日期在十二月30日之前，而小数值则代表一天中从午夜算起的时间。\n如果值不是数字或指向内容为数值的单元格的引用，则TO_DATE将在不做任何修改的情况下返回值。",example:"25405",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TO_PURE_NUMBER",t:16,d:"将给定的日期/时间、百分比、货币金额或其他格式的数值转换为不带格式的纯数字。",a:"将给定的日期/时间、百分比、货币金额或其他格式的数值转换为不带格式的纯数字。",m:[1,1],p:[{name:"value",detail:"要转换为纯数字的参数或其单元格引用。\n\n如果值为数字或指向包含数值的单元格的引用，TO_PURE_NUMBER将以不带任何格式与解释的形式返回值。\n\n如果值不是数字或指向内容为数值的单元格的引用，则TO_PERCENT将在不做任何修改的情况下返回值。",example:"50%",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_TEXT",t:16,d:"将给定的数字值转换为文本格式。",a:"将给定的数字值转换为文本格式。",m:[1,1],p:[{name:"value",detail:"要转换为文本的参数或其单元格引用。\n\n如果值为数字或指向包含数值的单元格的引用，TO_TEXT将返回字符串形式的值，并保持现有格式。即原为货币的仍为货币，原为十进制数的仍为十进制数，原为百分比的仍为百分比，原为日期的仍为日期。\n\n如果值不是数字或指向内容为数值的单元格的引用，则TO_TEXT将在不做任何修改的情况下返回值。",example:"24",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_DOLLARS",t:16,d:"将指定的数字转换为美元金额。",a:"将指定的数字转换为美元金额。",m:[1,1],p:[{name:"value",detail:"要转换为美元金额的参数或其单元格引用。\n\n如果值不是数字或指向内容为数值的单元格的引用，则 TO_DOLLARS 将在不做任何修改的情况下返回值。",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TO_PERCENT",t:16,d:"将指定的数字转换为百分比。",a:"将指定的数字转换为百分比。",m:[1,1],p:[{name:"value",detail:"要转换为百分比的参数或其单元格引用。\n\n如果值为数字或指向包含数值的单元格的引用，TO_PERCENT会以1 = 100%为标准，将值转换为百分比。\n\n如果值不是数字或指向内容为数值的单元格的引用，则TO_PERCENT将在不做任何修改的情况下返回值。",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DGET",t:17,d:"使用 SQL 式查询，从列表或数据库的列中提取符合指定条件的单个值。",a:"使用 SQL 式查询，从列表或数据库的列中提取符合指定条件的单个值。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DMAX",t:17,d:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的最大数字。",a:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的最大数字。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DMIN",t:17,d:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的最小数字。",a:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的最小数字。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DAVERAGE",t:17,d:"使用 SQL 式查询，对列表或数据库中满足指定条件的记录字段（列）中的数值求平均值。",a:"使用 SQL 式查询，对列表或数据库中满足指定条件的记录字段（列）中的数值求平均值。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DCOUNT",t:17,d:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中包含数字的单元格的个数。",a:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中包含数字的单元格的个数。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DCOUNTA",t:17,d:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的非空单元格的个数。",a:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的非空单元格的个数。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DPRODUCT",t:17,d:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的数值的乘积。",a:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的数值的乘积。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSTDEV",t:17,d:"使用 SQL 式查询，返回利用列表或数据库中满足指定条件的记录字段（列）中的数字作为一个样本估算出的总体标准偏差。",a:"使用 SQL 式查询，返回利用列表或数据库中满足指定条件的记录字段（列）中的数字作为一个样本估算出的总体标准偏差。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSTDEVP",t:17,d:"使用 SQL 式查询，返回利用列表或数据库中满足指定条件的记录字段（列）中的数字作为样本总体计算出的总体标准偏差。",a:"使用 SQL 式查询，返回利用列表或数据库中满足指定条件的记录字段（列）中的数字作为样本总体计算出的总体标准偏差。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSUM",t:17,d:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的数字之和。",a:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的数字之和。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DVAR",t:17,d:"使用 SQL 式查询，返回利用列表或数据库中满足指定条件的记录字段（列）中的数字作为一个样本估算出的总体方差。",a:"使用 SQL 式查询，返回利用列表或数据库中满足指定条件的记录字段（列）中的数字作为一个样本估算出的总体方差。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DVARP",t:17,d:"使用 SQL 式查询，通过使用列表或数据库中满足指定条件的记录字段（列）中的数字计算样本总体的样本总体方差。",a:"使用 SQL 式查询，通过使用列表或数据库中满足指定条件的记录字段（列）中的数字计算样本总体的样本总体方差。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"AGE_BY_IDCARD",t:"3",d:"根据中国身份证号计算出年龄。支持15为或18位身份证",a:"根据身份证号得到年龄。",m:[1,2],p:[{name:"身份证号",example:"A1",detail:"15位或者18位的身份证号或范围。",require:"m",repeat:"n",type:"rangeall"},{name:"截止日期",example:'"2017-10-01"',detail:"年龄计算的截止日期或范围，默认为当日。",require:"o",repeat:"n",type:"rangedatetime"}]},{n:"SEX_BY_IDCARD",t:"3",d:"根据中国身份证号计算出性别。支持15为或18位身份证",a:"根据身份证号得到性别。",m:[1,1],p:[{name:"身份证号",example:'"31033519900101XXXX"',detail:"15位或者18位的身份证号或范围。",require:"m",repeat:"n",type:"rangeall"}]},{n:"BIRTHDAY_BY_IDCARD",t:"3",d:"根据中国身份证号计算出生日。支持15为或18位身份证",a:"根据身份证号得到生日。",m:[1,2],p:[{name:"身份证号",example:'"31033519900101XXXX"',detail:"15位或者18位的身份证号或范围。",require:"m",repeat:"n",type:"rangeall"},{name:"生日格式",example:"0",detail:"日期类型,默认0:[1900/01/01], 1:[1900-01-01], 2:[1900年1月1日]",require:"o",repeat:"n",type:"rangeall"}]},{n:"PROVINCE_BY_IDCARD",t:"3",d:"根据中国身份证号计算出籍贯的省份。支持15为或18位身份证",a:"根据身份证号得到籍贯的省份。",m:[1,1],p:[{name:"身份证号",example:'"31033519900101XXXX"',detail:"15位或者18位的身份证号或范围。",require:"m",repeat:"n",type:"rangeall"}]},{n:"CITY_BY_IDCARD",t:"3",d:"根据中国身份证号计算出籍贯的城市。支持15为或18位身份证",a:"根据身份证号得到籍贯的城市。",m:[1,1],p:[{name:"身份证号",example:'"31033519900101XXXX"',detail:"15位或者18位的身份证号或范围。",require:"m",repeat:"n",type:"rangeall"}]},{n:"STAR_BY_IDCARD",t:"3",d:"根据中国身份证号计算出星座。支持15为或18位身份证",a:"根据身份证号得到星座。",m:[1,1],p:[{name:"身份证号",example:'"31033519900101XXXX"',detail:"15位或者18位的身份证号或范围。",require:"m",repeat:"n",type:"rangeall"}]},{n:"ANIMAL_BY_IDCARD",t:"3",d:"根据中国身份证号计算出生肖（鼠、牛、虎、兔...）。支持15为或18位身份证",a:"根据身份证号得到生肖。",m:[1,1],p:[{name:"身份证号",example:'"31033519900101XXXX"',detail:"15位或者18位的身份证号或范围。",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISIDCARD",t:"3",d:"验证身份证的格式是否正确。支持15为或18位身份证",a:"验证身份证格式正确性。",m:[1,1],p:[{name:"身份证号",example:'"31033519900101XXXX"',detail:"15位或者18位的身份证号或范围。",require:"m",repeat:"n",type:"rangeall"}]},{n:"DM_TEXT_CUTWORD",t:"4",d:"文本分词。把一连串文字拆分为一系列单独词语",a:"中文文本分词。",m:[1,2],p:[{name:"文本",example:'"我来到北京清华大学"',detail:"任意需要分词的文本。",require:"m",repeat:"n",type:"rangeall"},{name:"分词模式",example:"0",detail:"默认为0[精确模式], 1[全模式], 2[搜索引擎模式]。",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DM_TEXT_TFIDF",t:"4",d:"采用tf-idf算法进行关键词提取。从一连串文字中识别关键词",a:"tf-idf关键词识别。",m:[1,3],p:[{name:"文本",example:'"我来到北京清华大学"',detail:"任意需要分词的文本。",require:"m",repeat:"n",type:"rangeall"},{name:"关键词个数",example:"20",detail:"算法返回的关键词个数，默认20",require:"o",repeat:"n",type:"rangenumber"},{name:"语料库",example:"1",detail:"选择特定领域的语料库，默认0[通用], 1[金融], 2[医疗]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DM_TEXT_TEXTRANK",t:"4",d:"采用TextRank算法进行关键词提取。从一连串文字中识别关键词",a:"TextRank关键词识别。",m:[1,3],p:[{name:"文本",example:'"我来到北京清华大学"',detail:"任意需要分词的文本。",require:"m",repeat:"n",type:"rangeall"},{name:"关键词个数",example:"20",detail:"算法返回的关键词个数，默认20",require:"o",repeat:"n",type:"rangenumber"},{name:"语料库",example:"1",detail:"选择特定领域的语料库，默认0[通用], 1[金融], 2[医疗]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_CLOSE",t:"5",d:"根据股票代码和日期，返回A股对应股票收盘价。",a:"返回A股对应股票收盘价。",m:[1,3],p:[{name:"股票代码",example:'"000001"',detail:"6位股票代码，必填项。",require:"m",repeat:"n",type:"rangeall"},{name:"日期",example:"2015-01-08",detail:"股票的交易日，默认为最新交易日",require:"o",repeat:"n",type:"rangedate"},{name:"复权除权",example:"0",detail:"选择股票的除权复权类型，默认0[前复权], 1[原始价格], 2[后复权]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_OPEN",t:"5",d:"根据股票代码和日期，返回A股对应股票开盘价。",a:"返回A股对应股票开盘价。",m:[1,3],p:[{name:"股票代码",example:'"000001"',detail:"6位股票代码，必填项。",require:"m",repeat:"n",type:"rangeall"},{name:"日期",example:"2015-01-08",detail:"股票的交易日，默认为最新交易日",require:"o",repeat:"n",type:"rangedate"},{name:"复权除权",example:"0",detail:"选择股票的除权复权类型，默认0[前复权], 1[原始价格], 2[后复权]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_MAX",t:"5",d:"根据股票代码和日期，返回A股对应股票最高价。",a:"返回A股对应股票最高价。",m:[1,3],p:[{name:"股票代码",example:'"000001"',detail:"6位股票代码，必填项。",require:"m",repeat:"n",type:"rangeall"},{name:"日期",example:"2015-01-08",detail:"股票的交易日，默认为最新交易日",require:"o",repeat:"n",type:"rangedate"},{name:"复权除权",example:"0",detail:"选择股票的除权复权类型，默认0[前复权], 1[原始价格], 2[后复权]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_MIN",t:"5",d:"根据股票代码和日期，返回A股对应股票最低价。",a:"返回A股对应股票最低价。",m:[1,3],p:[{name:"股票代码",example:'"000001"',detail:"6位股票代码，必填项。",require:"m",repeat:"n",type:"rangeall"},{name:"日期",example:"2015-01-08",detail:"股票的交易日，默认为最新交易日",require:"o",repeat:"n",type:"rangedate"},{name:"复权除权",example:"0",detail:"选择股票的除权复权类型，默认0[前复权], 1[原始价格], 2[后复权]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_VOLUMN",t:"5",d:"根据股票代码和日期，返回A股对应股票成交量。",a:"返回A股对应股票成交量。",m:[1,3],p:[{name:"股票代码",example:'"000001"',detail:"6位股票代码，必填项。",require:"m",repeat:"n",type:"rangeall"},{name:"日期",example:"2015-01-08",detail:"股票的交易日，默认为最新交易日",require:"o",repeat:"n",type:"rangedate"},{name:"复权除权",example:"0",detail:"选择股票的除权复权类型，默认0[前复权], 1[原始价格], 2[后复权]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_AMOUNT",t:"5",d:"根据股票代码和日期，返回A股对应股票成交额。",a:"返回A股对应股票成交额。",m:[1,3],p:[{name:"股票代码",example:'"000001"',detail:"6位股票代码，必填项。",require:"m",repeat:"n",type:"rangeall"},{name:"日期",example:"2015-01-08",detail:"股票的交易日，默认为最新交易日",require:"o",repeat:"n",type:"rangedate"},{name:"复权除权",example:"0",detail:"选择股票的除权复权类型，默认0[前复权], 1[原始价格], 2[后复权]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"ISDATE",t:"6",d:"验证日期的格式是否正确。支持多种日期格式",a:"验证日期格式正确性。",m:[1,1],p:[{name:"日期",example:'"1990-01-01"',detail:"日期值，例如1990/01/01, 1990年1月1日等。",require:"m",repeat:"n",type:"rangeall"}]},{n:"LINESPLINES",t:"3",d:"生成嵌入在单元格内的折线图sparklines，用于描述数据的连续走势",a:"生成单元格折线图",m:[1,8],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeall"},{name:"线条颜色",example:"#2ec7c9",detail:"线图的线条颜色，可以是否个范围A1、色表索引数值或者具体颜色值，设置为0或false则不显示，支持regx、rgb、rgba等。默认#2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"线条粗细",example:"1",detail:"折线图线段粗细，默认为1px",require:"o",repeat:"n",type:"rangeall"},{name:"辅助线",example:"avg",detail:"一条横线，可以是min、max、avg、median、范围或自定义数值，默认0无",require:"o",repeat:"n",type:"rangeall"},{name:"辅助线颜色",example:"#000",detail:"辅助线的颜色设置，同线条颜色配置，默认#000",require:"o",repeat:"n",type:"rangeall"},{name:"最大值标识",example:"#fc5c5c",detail:"标识线图最大值，同线条颜色配置，默认0不显示",require:"o",repeat:"n",type:"rangeall"},{name:"最小值标识",example:"#fc5c5c",detail:"标识线图最大值，同线条颜色配置，默认0不显示",require:"o",repeat:"n",type:"rangeall"},{name:"标识大小",example:"1.5",detail:"最大值和最小值的标识大小设置，默认为1.5",require:"o",repeat:"n",type:"rangeall"}]},{n:"AREASPLINES",t:"3",d:"生成嵌入在单元格内的面积图sparklines，一般用于描述数据的连续累积值走势",a:"生成单元格面积图",m:[1,5],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeall"},{name:"线条颜色",example:"#2ec7c9",detail:"线图的线条颜色，可以是否个范围A1、色表索引数值或者具体颜色值，设置为0或false则不显示，支持regx、rgb、rgba等。默认#2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"填充颜色",example:"#CCF3F4",detail:"形成面积图，同线条颜色配置，默认0不显示",require:"o",repeat:"n",type:"rangeall"},{name:"线条粗细",example:"1",detail:"折线图线段粗细，默认为1px",require:"o",repeat:"n",type:"rangeall"},{name:"辅助线",example:"avg",detail:"一条横线，可以是min、max、avg、median、范围或自定义数值，默认0无",require:"o",repeat:"n",type:"rangeall"},{name:"辅助线颜色",example:"#000",detail:"辅助线的颜色设置，同线条颜色配置，默认#000",require:"o",repeat:"n",type:"rangeall"}]},{n:"COLUMNSPLINES",t:"3",d:"生成嵌入在单元格内的垂直柱状图sparklines，一般用于描述离散数据之间的大小情况",a:"生成单元格垂直柱状图",m:[1,6],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeall"},{name:"柱条间隔",example:"1",detail:"柱条之间的间隔距离，默认为1",require:"o",repeat:"n",type:"rangeall"},{name:"柱条颜色",example:"#fc5c5c",detail:"线图的线条颜色，可以是否个范围A1、色表索引数值或者具体颜色值，设置为0或false则不显示，支持regx、rgb、rgba等。默认#fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"负向柱条颜色",example:"#97b552",detail:"负向柱条颜色设置，代表负值的颜色，同柱条颜色配置，默认#97b552",require:"o",repeat:"n",type:"rangeall"},{name:"最大值",example:"100",detail:"柱图最大值，用于规范柱图长度，默认为自动计算false、auto、null",require:"o",repeat:"n",type:"rangeall"},{name:"色板",example:"#97b552",detail:"调色板可以单独设置每个柱条的颜色，可设置多个，支持两种格式：1颜色例如#000，代表第一个柱的颜色是黑色；2数值范围:颜色，例如-2:#000表示数值为-2的柱为黑色，0:5:#000表示数值0-5的柱为黑色，默认为空",require:"o",repeat:"y",type:"rangeall"}]},{n:"STACKCOLUMNSPLINES",t:"3",d:"生成嵌入在单元格内的累积垂直柱状图sparklines，一般用于描述离散数据多个维度的数值大小",a:"生成单元格累积垂直柱状图",m:[1,5],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeall"},{name:"按列堆积",example:"1",detail:"如果需要按行堆积则本项设为false或0，默认为是1",require:"o",repeat:"n",type:"rangeall"},{name:"柱条间隔",example:"1",detail:"柱条之间的间隔距离，默认为1",require:"o",repeat:"n",type:"rangeall"},{name:"最大值",example:"100",detail:"累积柱图最大值，用于规范柱图长度，默认为自动计算false、auto、null",require:"o",repeat:"n",type:"rangeall"},{name:"累积色板",example:"#97b552",detail:"调色板可以单独设置每个维度的柱条颜色，可设置为A1:A10等范围，默认为#2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"BARSPLINES",t:"3",d:"生成嵌入在单元格内的横向条形图sparklines，一般用于描述离散数据之间的大小情况",a:"生成单元格横向条形图",m:[1,6],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeall"},{name:"柱条间隔",example:"1",detail:"柱条之间的间隔距离，默认为1",require:"o",repeat:"n",type:"rangeall"},{name:"柱条颜色",example:"#fc5c5c",detail:"线图的线条颜色，可以是否个范围A1、色表索引数值或者具体颜色值，设置为0或false则不显示，支持regx、rgb、rgba等。默认#fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"负向柱条颜色",example:"#97b552",detail:"负向柱条颜色设置，代表负值的颜色，同柱条颜色配置，默认#97b552",require:"o",repeat:"n",type:"rangeall"},{name:"最大值",example:"100",detail:"柱图最大值，用于规范柱图长度，默认为自动计算false、auto、null",require:"o",repeat:"n",type:"rangeall"},{name:"色板",example:"#97b552",detail:"调色板可以单独设置每个柱条的颜色，可设置多个，支持两种格式：1颜色例如#000，代表第一个柱的颜色是黑色；2数值范围:颜色，例如-2:#000表示数值为-2的柱为黑色，0:5:#000表示数值0-5的柱为黑色，默认为空",require:"o",repeat:"y",type:"rangeall"}]},{n:"STACKBARSPLINES",t:"3",d:"生成嵌入在单元格内的累积横向条形图sparklines，一般用于描述离散数据多个维度的数值大小",a:"生成单元格累积横向条形图",m:[1,5],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeall"},{name:"按列堆积",example:"1",detail:"如果需要按行堆积则本项设为false或0，默认为是1",require:"o",repeat:"n",type:"rangeall"},{name:"柱条间隔",example:"1",detail:"柱条之间的间隔距离，默认为1",require:"o",repeat:"n",type:"rangeall"},{name:"最大值",example:"100",detail:"累积柱图最大值，用于规范柱图长度，默认为自动计算false、auto、null",require:"o",repeat:"n",type:"rangeall"},{name:"累积色板",example:"#97b552",detail:"调色板可以单独设置每个维度的柱条颜色，可设置为A1:A10等范围，默认为#2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"DISCRETESPLINES",t:"3",d:"生成嵌入在单元格内的离散图sparklines，一般用于描述离散数据走势",a:"生成单元格离散图",m:[1,4],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeall"},{name:"分割阈值",example:"1",detail:"离散图柱形颜色的区分，例如：该值为0，则大于0为蓝色，小于0为红色，默认为0",require:"o",repeat:"n",type:"rangeall"},{name:"阈值以上颜色",example:"#2ec7c9",detail:"线图的线条颜色，可以是否个范围A1、色表索引数值或者具体颜色值，设置为0或false则不显示，支持regx、rgb、rgba等。默认#2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"阈值以下颜色",example:"#fc5c5c",detail:"阈值以下柱条颜色设置，同阈值以上颜色，默认#fc5c5c",require:"o",repeat:"n",type:"rangeall"}]},{n:"TRISTATESPLINES",t:"3",d:"生成嵌入在单元格内的三态图sparklines，一般用于描述三种态势的走势例如胜负平",a:"生成单元格离散图",m:[1,6],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeall"},{name:"柱条间隔",example:"1",detail:"柱条之间的间隔距离，默认为1",require:"o",repeat:"n",type:"rangeall"},{name:"柱条颜色",example:"#fc5c5c",detail:"线图的线条颜色，可以是否个范围A1、色表索引数值或者具体颜色值，设置为0或false则不显示，支持regx、rgb、rgba等。默认#fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"负向柱条颜色",example:"#97b552",detail:"负向柱条颜色设置，代表负值的颜色，同柱条颜色配置，默认#97b552",require:"o",repeat:"n",type:"rangeall"},{name:"零值柱条颜色",example:"#999",detail:"零值柱条颜色设置，代表0值颜色，同柱条颜色配置，默认#999",require:"o",repeat:"n",type:"rangeall"},{name:"色板",example:"#97b552",detail:"调色板可以单独设置每个柱条的颜色，可设置多个，支持两种格式：1颜色例如#000，代表第一个柱的颜色是黑色；2数值范围:颜色，例如-2:#000表示数值为-2的柱为黑色，0-5:#000表示数值0-5的柱为黑色，默认为空",require:"o",repeat:"y",type:"rangeall"}]},{n:"PIESPLINES",t:"3",d:"生成嵌入在单元格内的饼图sparklines，一般用于描述数据占比",a:"生成单元格饼图",m:[1,5],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeall"},{name:"旋转角度",example:"0",detail:"饼图的旋转角度，默认为0",require:"o",repeat:"n",type:"rangeall"},{name:"饼图边框",example:"0",detail:"饼图边框大小，默认为无0",require:"o",repeat:"n",type:"rangeall"},{name:"边框颜色",example:"#000",detail:"饼图边框颜色，默认为#000",require:"o",repeat:"n",type:"rangeall"},{name:"饼图色板",example:"#97b552",detail:"调色板可以设置切片的颜色，可设置为A1:A10等范围，默认为#2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"BOXSPLINES",t:"3",d:"生成嵌入在单元格内的箱线图sparklines，一般用于描述数据集的统计分布",a:"生成单元格箱线图",m:[1,4],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeall"},{name:"离群点比例",example:"1.5",detail:"离群点的阈值范围，如果为0或false则不显示，默认为1.5倍",require:"o",repeat:"n",type:"rangeall"},{name:"目标点值",example:"10",detail:"箱线图上的目标值设置，默认为false不显示",require:"o",repeat:"n",type:"rangeall"},{name:"数据点大小",example:"1.5",detail:"目标点和利群点的半径大小设置，默认为1.5",require:"o",repeat:"n",type:"rangeall"}]},{n:"BULLETSPLINES",t:"3",d:"生成嵌入在单元格内的子弹图sparklines，一般用于描述任务达成率",a:"生成单元格子弹图",m:[2,3],p:[{name:"目标",example:"10",detail:"达成的目标值，数值才能被有效计算，例如A1， 100等。",require:"m",repeat:"n",type:"rangeall"},{name:"实际完成",example:"8",detail:"目前完成值，数值才能被有效计算，例如A1， 100等。",require:"m",repeat:"n",type:"rangeall"},{name:"对比值",example:"12",detail:"对比值，例如超额、最低、获奖底线等，数值才能被有效计算，例如A1， 100等。可以设置最多9个对比值",require:"o",repeat:"y",type:"rangeall"}]},{n:"COMPOSESPLINES",t:"3",d:"支持多个类型的图画在同一个单元格,每个参数代表一个sparklines图",a:"组合sparklines图到一个单元格",m:[1,1],p:[{name:"图设置",example:"PIESPLINES(A1:A20)",detail:"sparklines图设置，例如A1:A20， 一个完成的饼图、线图设置等。",require:"m",repeat:"y",type:"rangeall"}]},{n:"SORT",t:"14",d:"返回数组中元素的排序数组。返回的数组与提供的数组参数形状相同。",a:"返回数组中元素的排序数组。返回的数组与提供的数组参数形状相同。",m:[1,4],p:[{name:"array",detail:"要排序的范围或数组。",example:"A2:A17",require:"m",repeat:"n",type:"rangenumber"},{name:"sort_index",detail:"[可选] - 表示要排序的行或列的数字。（默认row1/col1）",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"sort_order",detail:"[可选] - 表示所需排序顺序的数字；1表示升序（默认），-1表示降序。",example:"-1",require:"o",repeat:"n",type:"rangenumber"},{name:"by_col",detail:"[可选] - 表示所需排序方向的逻辑值；按行排序为FALSE()（默认），按列排序为TRUE()。",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FILTER",t:"14",d:"基于一个布尔（真/假）数组过滤一个数组。",a:"基于一个布尔（真/假）数组过滤一个数组。",m:[2,3],p:[{name:"array",detail:"要筛选的数组或范围。",example:"A5:D20",require:"m",repeat:"n",type:"range"},{name:"include",detail:"布尔数组，其高度或宽度与数组相同",example:"1",require:"m",repeat:"n",type:"range"},{name:"if_empty",detail:"[可选] - 如果包含数组中的所有值都为空(filter不返回任何值)，则返回的值。",example:'""',require:"o",repeat:"n",type:"rangeall"}]},{n:"UNIQUE",t:"14",d:"返回列表或区域中的唯一值的列表。",a:"返回列表或区域中的唯一值的列表。",m:[1,3],p:[{name:"array",detail:"从其返回唯一值的数组或区域。",example:"A2:B26",require:"m",repeat:"n",type:"rangenumber"},{name:"by_col",detail:"[可选] - 逻辑值，指示如何比较；按行 = FALSE() 或省略；按列 = TRUE()。",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{name:"occurs_once",detail:"[可选] - 逻辑值，仅返回唯一值中出现一次 = TRUE()；包括所有唯一值 = FALSE() 或省略。",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"RANDARRAY",t:"14",d:"返回 0 到 1 之间的随机数字数组。",a:"返回 0 到 1 之间的随机数字数组。",m:[0,2],p:[{name:"rows",detail:"[可选] - 要返回的行数。",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"cols",detail:"[可选] - 要返回的列数。",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SEQUENCE",t:"14",d:"生成数字序列的列表。",a:"生成数字序列的列表。",m:[1,4],p:[{name:"rows",detail:"要返回的行数。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"cols",detail:"[可选] - 要返回的列数。",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"start",detail:"[可选] - 序列中的第一个数字。",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"step",detail:"[可选] - 序列中每个序列值的增量。",example:"1",require:"o",repeat:"n",type:"rangenumber"}]}],luckysheet.functionImplementation={SUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!0))}else if("object"==luckysheet.getObjType(l)&&null!=l.startCell)t=t.concat(luckysheet.func_methods.getCellDataArr(l,"number",!0));else if(luckysheet.func_methods.isRealNum(l))t.push(l);else{if("boolean"!=luckysheet.getObjType(l))return luckysheet.formula.error.v;"true"==l.toString().toLowerCase()?t.push(1):"false"==l.toString().toLowerCase()&&t.push(0)}}var r=0;if(0<t.length)for(e=0;e<t.length;e++){if(luckysheet.func_methods.valueIsError(t[e]))return t[e];luckysheet.func_methods.isRealNum(t[e])&&(r+=parseFloat(t[e]))}return r}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},AVERAGE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l))if("array"==luckysheet.getObjType(l[0])){if(!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!0))}else t=t.concat(l);else"object"==luckysheet.getObjType(l)&&null!=l.startCell?t=t.concat(luckysheet.func_methods.getCellDataArr(l,"text",!0)):t.push(l)}for(var r=0,a=0,e=0;e<t.length;e++){if(luckysheet.func_methods.valueIsError(t[e]))return t[e];if(!luckysheet.func_methods.isRealNum(t[e]))return luckysheet.formula.error.v;r+=parseFloat(t[e]),a++}return 0==a?luckysheet.formula.error.d:r/a}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},COUNT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l))if("array"==luckysheet.getObjType(l[0])){if(!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!0))}else t=t.concat(l);else"object"==luckysheet.getObjType(l)&&null!=l.startCell?t=t.concat(luckysheet.func_methods.getCellDataArr(l,"text",!0)):"boolean"==luckysheet.getObjType(l)?"true"==l.toString().toLowerCase()?t.push(1):"false"==l.toString().toLowerCase()&&t.push(0):t.push(l)}for(var r=0,e=0;e<t.length;e++)luckysheet.func_methods.isRealNum(t[e])&&r++;return r}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},COUNTA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l))if("array"==luckysheet.getObjType(l[0])){if(!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l))}else t=t.concat(l);else"object"==luckysheet.getObjType(l)&&null!=l.startCell?t=t.concat(luckysheet.func_methods.getCellDataArr(l,"text",!0)):t.push(l)}return t.length}catch(e){return e=luckysheet.formula.errorInfo(e),[luckysheet.formula.error.v,e]}},MAX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l))if("array"==luckysheet.getObjType(l[0])){if(!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!0))}else t=t.concat(l);else"object"==luckysheet.getObjType(l)&&null!=l.startCell?t=t.concat(luckysheet.func_methods.getCellDataArr(l,"number",!0)):t.push(l)}for(var r=null,e=0;e<t.length;e++){if(luckysheet.func_methods.valueIsError(t[e]))return t[e];luckysheet.func_methods.isRealNum(t[e])&&(null==r||parseFloat(t[e])>r)&&(r=parseFloat(t[e]))}return null==r?0:r}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},MIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l))if("array"==luckysheet.getObjType(l[0])){if(!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!0))}else t=t.concat(l);else"object"==luckysheet.getObjType(l)&&null!=l.startCell?t=t.concat(luckysheet.func_methods.getCellDataArr(l,"number",!0)):t.push(l)}for(var r=null,e=0;e<t.length;e++){if(luckysheet.func_methods.valueIsError(t[e]))return t[e];luckysheet.func_methods.isRealNum(t[e])&&(null==r||parseFloat(t[e])<r)&&(r=parseFloat(t[e]))}return null==r?0:r}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},AGE_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return luckysheet.formula.error.v;var l=window.luckysheet_function.BIRTHDAY_BY_IDCARD.f(t);if(luckysheet.func_methods.valueIsError(l))return l;l=moment(l);var r=moment();if(2==arguments.length){if(r=luckysheet.func_methods.getFirstValue(arguments[1]),luckysheet.func_methods.valueIsError(r))return r;r=moment(r)}var a=r.diff(l,"years");return a<0||"NaN"==a.toString()?luckysheet.formula.error.v:a}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},SEX_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:window.luckysheet_function.ISIDCARD.f(t)?parseInt(t.substr(16,1))%2==1?"男":"女":luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},BIRTHDAY_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return luckysheet.formula.error.v;var l="";15==t.length?l="19"+t.substring(6,8)+"/"+t.substring(8,10)+"/"+t.substring(10,12):18==t.length&&(l=t.substring(6,10)+"/"+t.substring(10,12)+"/"+t.substring(12,14));var r=0;if(null!=arguments[1]&&(r=luckysheet.func_methods.getFirstValue(arguments[1]),luckysheet.func_methods.valueIsError(r)))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;if((r=parseInt(r))<0||2<r)return luckysheet.formula.error.v;if(0==parseInt(r))return l;if(1==parseInt(r))return moment(l).format("YYYY-MM-DD");if(2==parseInt(r))return moment(l).format("YYYY年M月D日")}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},PROVINCE_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return luckysheet.formula.error.v;var l="未知",r=luckysheet.formula.classlist.province;return t.substring(0,2)in r&&(l=r[t.substring(0,2)]),l}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},CITY_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return luckysheet.formula.error.v;for(var l=cityData.length,r="未知",e=0;e<l;e++)if(t.substring(0,6)==cityData[e].code){r=cityData[e].title;break}return r}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},STAR_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return luckysheet.formula.error.v;var l=window.luckysheet_function.BIRTHDAY_BY_IDCARD.f(t);if(luckysheet.func_methods.valueIsError(l))return l;var r=(l=new Date(l)).getMonth(),a=l.getDate(),s=new Date(1999,r,a,0,0,0),n=[];n.push(["魔羯座",new Date(1999,0,1,0,0,0)]),n.push(["水瓶座",new Date(1999,0,20,0,0,0)]),n.push(["双鱼座",new Date(1999,1,19,0,0,0)]),n.push(["白羊座",new Date(1999,2,21,0,0,0)]),n.push(["金牛座",new Date(1999,3,21,0,0,0)]),n.push(["双子座",new Date(1999,4,21,0,0,0)]),n.push(["巨蟹座",new Date(1999,5,22,0,0,0)]),n.push(["狮子座",new Date(1999,6,23,0,0,0)]),n.push(["处女座",new Date(1999,7,23,0,0,0)]),n.push(["天秤座",new Date(1999,8,23,0,0,0)]),n.push(["天蝎座",new Date(1999,9,23,0,0,0)]),n.push(["射手座",new Date(1999,10,22,0,0,0)]),n.push(["魔羯座",new Date(1999,11,22,0,0,0)]);for(e=n.length-1;0<=e;e--)if(s>=n[e][1])return n[e][0];return"未找到匹配星座信息"}catch(e){var o=e;return o=luckysheet.formula.errorInfo(o),[luckysheet.formula.error.v,o]}},ANIMAL_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return luckysheet.formula.error.v;var l=window.luckysheet_function.BIRTHDAY_BY_IDCARD.f(t);if(luckysheet.func_methods.valueIsError(l))return l;l=new Date(l);var r=new Array("猪","鼠","牛","虎","兔","龙","蛇","马","羊","猴","鸡","狗"),a=(parseInt(l.getFullYear())+9)%12;return null==a||isNaN(a)?"未找到匹配生肖信息":r[a]}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},ISIDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;return!!/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(t)}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},DM_TEXT_CUTWORD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var l=window.luckysheetCurrentRow,r=window.luckysheetCurrentColumn,a=window.luckysheetCurrentFunction,t=luckysheet.func_methods.getFirstValue(arguments[0],"text");if(luckysheet.func_methods.valueIsError(t))return t;var s=0;return null!=arguments[1]&&(s=luckysheet.func_methods.getFirstValue(arguments[1]),luckysheet.func_methods.valueIsError(s))?s:!luckysheet.func_methods.isRealNum(s)||0!=(s=parseInt(s))&&1!=s&&2!=s?luckysheet.formula.error.v:($.post("/dataqk/tu/api/cutword",{text:t,type:s},function(e){var t=[].concat(luckysheet.flowdata);luckysheet.formula.execFunctionGroup(l,r,e),t[l][r]={v:e,f:a},luckysheet.jfrefreshgrid(t,[{row:[l,l],column:[r,r]}])}),"loading...")}catch(e){var n=e;return n=luckysheet.formula.errorInfo(n),[luckysheet.formula.error.v,n]}},DM_TEXT_TFIDF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var l=window.luckysheetCurrentRow,r=window.luckysheetCurrentColumn,a=window.luckysheetCurrentFunction,t=luckysheet.func_methods.getFirstValue(arguments[0],"text");if(luckysheet.func_methods.valueIsError(t))return t;var s=20;if(null!=arguments[1]&&(s=luckysheet.func_methods.getFirstValue(arguments[1]),luckysheet.func_methods.valueIsError(s)))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseInt(s);var n=0;return null!=arguments[2]&&(n=luckysheet.func_methods.getFirstValue(arguments[2]),luckysheet.func_methods.valueIsError(n))?n:luckysheet.func_methods.isRealNum(n)?(n=parseInt(n),s<0||0!=n&&1!=n&&2!=n?luckysheet.formula.error.v:($.post("/dataqk/tu/api/tfidf",{text:t,count:s,set:n},function(e){var t=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata);luckysheet.formula.execFunctionGroup(l,r,e),t[l][r]={v:e,f:a},luckysheet.jfrefreshgrid(t,[{row:[l,l],column:[r,r]}])}),"loading...")):luckysheet.formula.error.v}catch(e){var o=e;return o=luckysheet.formula.errorInfo(o),[luckysheet.formula.error.v,o]}},DM_TEXT_TEXTRANK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var l=window.luckysheetCurrentRow,r=window.luckysheetCurrentColumn,a=window.luckysheetCurrentFunction,t=luckysheet.func_methods.getFirstValue(arguments[0],"text");if(luckysheet.func_methods.valueIsError(t))return t;var s=20;if(null!=arguments[1]&&(s=luckysheet.func_methods.getFirstValue(arguments[1]),luckysheet.func_methods.valueIsError(s)))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseInt(s);var n=0;return null!=arguments[2]&&(n=luckysheet.func_methods.getFirstValue(arguments[2]),luckysheet.func_methods.valueIsError(n))?n:luckysheet.func_methods.isRealNum(n)?(n=parseInt(n),s<0||0!=n&&1!=n&&2!=n?luckysheet.formula.error.v:($.post("/dataqk/tu/api/tfidf",{text:t,count:s,set:n},function(e){var t=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata);luckysheet.formula.execFunctionGroup(l,r,e),t[l][r]={v:e,f:a},luckysheet.jfrefreshgrid(t,[{row:[l,l],column:[r,r]}])}),"loading...")):luckysheet.formula.error.v}catch(e){var o=e;return o=luckysheet.formula.errorInfo(o),[luckysheet.formula.error.v,o]}},DATA_CN_STOCK_CLOSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var r=window.luckysheetCurrentRow,a=window.luckysheetCurrentColumn,s=window.luckysheetCurrentFunction,t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;var l=null;if(null!=arguments[1]){var n=arguments[1];if("array"==luckysheet.getObjType(n))return luckysheet.formula.error.v;if("object"==luckysheet.getObjType(n)&&null!=n.startCell){if(null==n.data||"array"==luckysheet.getObjType(n.data)||null==n.data.ct||"d"!=n.data.ct.t)return luckysheet.formula.error.v;l=luckysheet.mask.update("yyyy-mm-dd",n.data.v)}else l=n;if(!luckysheet.datecontroll.isdatetime(l))return[luckysheet.formula.error.v,"日期错误"];l=moment(l).format("YYYY-MM-DD")}var o=0;return null!=arguments[2]&&(o=luckysheet.func_methods.getFirstValue(arguments[2]),luckysheet.func_methods.valueIsError(o))?o:!luckysheet.func_methods.isRealNum(o)||0!=(o=parseInt(o))&&1!=o&&2!=o?luckysheet.formula.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:t,date:l,price:o,type:"0"},function(e){var t=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata),l=luckysheet.numFormat(e);null==l&&(l=e),luckysheet.formula.execFunctionGroup(r,a,l),t[r][a]={v:l,f:s},luckysheet.jfrefreshgrid(t,[{row:[r,r],column:[a,a]}])}),"loading...")}catch(e){var c=e;return c=luckysheet.formula.errorInfo(c),[luckysheet.formula.error.v,c]}},DATA_CN_STOCK_OPEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var l=window.luckysheetCurrentRow,r=window.luckysheetCurrentColumn,a=window.luckysheetCurrentFunction,t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;var s=null;if(null!=arguments[1]){var n=arguments[1];if("array"==luckysheet.getObjType(n))return luckysheet.formula.error.v;if("object"==luckysheet.getObjType(n)&&null!=n.startCell){if(null==n.data||"array"==luckysheet.getObjType(n.data)||null==n.data.ct||"d"!=n.data.ct.t)return luckysheet.formula.error.v;s=luckysheet.mask.update("yyyy-mm-dd",n.data.v)}else s=n;if(!luckysheet.datecontroll.isdatetime(s))return[luckysheet.formula.error.v,"日期错误"];s=moment(s).format("YYYY-MM-DD")}var o=0;return null!=arguments[2]&&(o=luckysheet.func_methods.getFirstValue(arguments[2]),luckysheet.func_methods.valueIsError(o))?o:!luckysheet.func_methods.isRealNum(o)||0!=(o=parseInt(o))&&1!=o&&2!=o?luckysheet.formula.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:t,date:s,price:o,type:"1"},function(e){var t=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata);luckysheet.formula.execFunctionGroup(l,r,e),t[l][r]={v:e,f:a},luckysheet.jfrefreshgrid(t,[{row:[l,l],column:[r,r]}])}),"loading...")}catch(e){var c=e;return c=luckysheet.formula.errorInfo(c),[luckysheet.formula.error.v,c]}},DATA_CN_STOCK_MAX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var l=window.luckysheetCurrentRow,r=window.luckysheetCurrentColumn,a=window.luckysheetCurrentFunction,t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;var s=null;if(null!=arguments[1]){var n=arguments[1];if("array"==luckysheet.getObjType(n))return luckysheet.formula.error.v;if("object"==luckysheet.getObjType(n)&&null!=n.startCell){if(null==n.data||"array"==luckysheet.getObjType(n.data)||null==n.data.ct||"d"!=n.data.ct.t)return luckysheet.formula.error.v;s=luckysheet.mask.update("yyyy-mm-dd",n.data.v)}else s=n;if(!luckysheet.datecontroll.isdatetime(s))return[luckysheet.formula.error.v,"日期错误"];s=moment(s).format("YYYY-MM-DD")}var o=0;return null!=arguments[2]&&(o=luckysheet.func_methods.getFirstValue(arguments[2]),luckysheet.func_methods.valueIsError(o))?o:!luckysheet.func_methods.isRealNum(o)||0!=(o=parseInt(o))&&1!=o&&2!=o?luckysheet.formula.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:t,date:s,price:o,type:"2"},function(e){var t=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata);luckysheet.formula.execFunctionGroup(l,r,e),t[l][r]={v:e,f:a},luckysheet.jfrefreshgrid(t,[{row:[l,l],column:[r,r]}])}),"loading...")}catch(e){var c=e;return c=luckysheet.formula.errorInfo(c),[luckysheet.formula.error.v,c]}},DATA_CN_STOCK_MIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var l=window.luckysheetCurrentRow,r=window.luckysheetCurrentColumn,a=window.luckysheetCurrentFunction,t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;var s=null;if(null!=arguments[1]){var n=arguments[1];if("array"==luckysheet.getObjType(n))return luckysheet.formula.error.v;if("object"==luckysheet.getObjType(n)&&null!=n.startCell){if(null==n.data||"array"==luckysheet.getObjType(n.data)||null==n.data.ct||"d"!=n.data.ct.t)return luckysheet.formula.error.v;s=luckysheet.mask.update("yyyy-mm-dd",n.data.v)}else s=n;if(!luckysheet.datecontroll.isdatetime(s))return[luckysheet.formula.error.v,"日期错误"];s=moment(s).format("YYYY-MM-DD")}var o=0;return null!=arguments[2]&&(o=luckysheet.func_methods.getFirstValue(arguments[2]),luckysheet.func_methods.valueIsError(o))?o:!luckysheet.func_methods.isRealNum(o)||0!=(o=parseInt(o))&&1!=o&&2!=o?luckysheet.formula.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:t,date:s,price:o,type:"3"},function(e){var t=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata);luckysheet.formula.execFunctionGroup(l,r,e),t[l][r]={v:e,f:a},luckysheet.jfrefreshgrid(t,[{row:[l,l],column:[r,r]}])}),"loading...")}catch(e){var c=e;return c=luckysheet.formula.errorInfo(c),[luckysheet.formula.error.v,c]}},DATA_CN_STOCK_VOLUMN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var l=window.luckysheetCurrentRow,r=window.luckysheetCurrentColumn,a=window.luckysheetCurrentFunction,t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;var s=null;if(null!=arguments[1]){var n=arguments[1];if("array"==luckysheet.getObjType(n))return luckysheet.formula.error.v;if("object"==luckysheet.getObjType(n)&&null!=n.startCell){if(null==n.data||"array"==luckysheet.getObjType(n.data)||null==n.data.ct||"d"!=n.data.ct.t)return luckysheet.formula.error.v;s=luckysheet.mask.update("yyyy-mm-dd",n.data.v)}else s=n;if(!luckysheet.datecontroll.isdatetime(s))return[luckysheet.formula.error.v,"日期错误"];s=moment(s).format("YYYY-MM-DD")}var o=0;return null!=arguments[2]&&(o=luckysheet.func_methods.getFirstValue(arguments[2]),luckysheet.func_methods.valueIsError(o))?o:!luckysheet.func_methods.isRealNum(o)||0!=(o=parseInt(o))&&1!=o&&2!=o?luckysheet.formula.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:t,date:s,price:o,type:"4"},function(e){var t=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata);luckysheet.formula.execFunctionGroup(l,r,e),t[l][r]={v:e,f:a},luckysheet.jfrefreshgrid(t,[{row:[l,l],column:[r,r]}])}),"loading...")}catch(e){var c=e;return c=luckysheet.formula.errorInfo(c),[luckysheet.formula.error.v,c]}},DATA_CN_STOCK_AMOUNT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var l=window.luckysheetCurrentRow,r=window.luckysheetCurrentColumn,a=window.luckysheetCurrentFunction,t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;var s=null;if(null!=arguments[1]){var n=arguments[1];if("array"==luckysheet.getObjType(n))return luckysheet.formula.error.v;if("object"==luckysheet.getObjType(n)&&null!=n.startCell){if(null==n.data||"array"==luckysheet.getObjType(n.data)||null==n.data.ct||"d"!=n.data.ct.t)return luckysheet.formula.error.v;s=luckysheet.mask.update("yyyy-mm-dd",n.data.v)}else s=n;if(!luckysheet.datecontroll.isdatetime(s))return[luckysheet.formula.error.v,"日期错误"];s=moment(s).format("YYYY-MM-DD")}var o=0;return null!=arguments[2]&&(o=luckysheet.func_methods.getFirstValue(arguments[2]),luckysheet.func_methods.valueIsError(o))?o:!luckysheet.func_methods.isRealNum(o)||0!=(o=parseInt(o))&&1!=o&&2!=o?luckysheet.formula.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:t,date:s,price:o,type:"5"},function(e){var t=luckysheet.editor.deepCopyFlowData(luckysheet.flowdata);luckysheet.formula.execFunctionGroup(l,r,e),t[l][r]={v:e,f:a},luckysheet.jfrefreshgrid(t,[{row:[l,l],column:[r,r]}])}),"loading...")}catch(e){var c=e;return c=luckysheet.formula.errorInfo(c),[luckysheet.formula.error.v,c]}},ISDATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");return luckysheet.func_methods.valueIsError(t)?t:luckysheet.datecontroll.isdatetime(t)}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},SUMIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=0,l=arguments[0].data,r=arguments[0].rowl,a=arguments[0].coll,s=luckysheet_parseData(arguments[1]),l=luckysheet.formula.getRangeArray(l)[0];if(arguments[2]){var n,o,c,u,i=[],h=arguments[2].startCell,d=arguments[2].rowl,y=arguments[2].coll,f=arguments[2].sheetName;i=r==d&&a==y?arguments[2].data:(o=[],0,(n=[])[0]=parseInt(h.replace(/[^0-9]/g,""))-1,o[0]=luckysheet.luckysheetABCatNum(h.replace(/[^A-Za-z]/g,"")),n[1]=n[0]+r-1,o[1]=o[0]+a-1,c=luckysheet.luckysheetchatatABC(o[1]),u=n[1]+1,luckysheet_getcelldata(f+"!"+h+":"+(c+u)).data),i=luckysheet.formula.getRangeArray(i)[0];for(e=0;e<l.length;e++){if((m=l[e])&&luckysheet.formula.acompareb(m,s)){if(!luckysheet.func_methods.isRealNum(i[e]))continue;t+=parseFloat(i[e])}}}else for(var m,e=0;e<l.length;e++){if((m=l[e])&&luckysheet.formula.acompareb(m,s)){if(!luckysheet.func_methods.isRealNum(m))continue;t+=parseFloat(m)}}return t}catch(e){var k=e;return k=luckysheet.formula.errorInfo(k),[luckysheet.formula.error.v,k]}},TAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseFloat(t),Math.tan(t)):luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},TANH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=Math.exp(2*t);return(l-1)/(l+1)}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},CEILING:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:luckysheet.func_methods.isRealNum(l)?0==(l=parseFloat(l))?0:0<t&&l<0?luckysheet.formula.error.nm:Math.ceil(t/l)*l:luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},ATAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseFloat(t),Math.atan(t)):luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},ASINH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseFloat(t),Math.log(t+Math.sqrt(t*t+1))):luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},ABS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseFloat(t),Math.abs(t)):luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},ACOS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseFloat(t))<-1||1<t?luckysheet.formula.error.nm:Math.acos(t):luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},ACOSH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseFloat(t))<1?luckysheet.formula.error.nm:Math.log(t+Math.sqrt(t*t-1)):luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},MULTINOMIAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!0))}else"object"==luckysheet.getObjType(l)&&null!=l.startCell?t=t.concat(luckysheet.func_methods.getCellDataArr(l,"number",!0)):t.push(l)}for(var r=0,a=1,e=0;e<t.length;e++){var s=t[e];if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;if((s=parseFloat(s))<0)return luckysheet.formula.error.nm;r+=s,a*=luckysheet.func_methods.factorial(s)}return luckysheet.func_methods.factorial(r)/a}catch(e){var n=e;return n=luckysheet.formula.errorInfo(n),[luckysheet.formula.error.v,n]}},ATANH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseFloat(t))<=-1||1<=t?luckysheet.formula.error.nm:Math.log((1+t)/(1-t))/2:luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},ATAN2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:luckysheet.func_methods.isRealNum(l)?(l=parseFloat(l),0==t&&0==l?luckysheet.formula.error.d:Math.atan2(l,t)):luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},COUNTBLANK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=0;if("object"==luckysheet.getObjType(t)&&null!=t.startCell){if(null==t.data)return 1;if("array"==luckysheet.getObjType(t.data))for(var r=0;r<t.data.length;r++)for(var a=0;a<t.data[r].length;a++)null!=t.data[r][a]&&!luckysheet.func_methods.isRealNull(t.data[r][a].v)||l++;else luckysheet.func_methods.isRealNull(t.data.v)&&l++}return l}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},COSH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseFloat(t),(Math.exp(t)+Math.exp(-t))/2):luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},INT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0];if("array"==luckysheet.getObjType(t))return"array"==luckysheet.getObjType(t[0])?luckysheet.func_methods.isDyadicArr(t)&&luckysheet.func_methods.isRealNum(t[0][0])?Math.floor(parseFloat(t[0][0])):luckysheet.formula.error.v:luckysheet.func_methods.isRealNum(t[0])?Math.floor(parseFloat(t[0])):luckysheet.formula.error.v;if("object"==luckysheet.getObjType(t)&&null!=t.startCell){if(1<t.coll)return luckysheet.formula.error.v;if(1<t.rowl){var l=luckysheet.formula.getcellrange(t.startCell).row[0];if(window.luckysheetCurrentRow<l||window.luckysheetCurrentRow>l+t.rowl-1)return luckysheet.formula.error.v;var r=t.data[window.luckysheetCurrentRow-l][0]}else r=t.data;return null==r||luckysheet.func_methods.isRealNull(r.v)?0:luckysheet.func_methods.isRealNum(r.v)?Math.floor(parseFloat(r.v)):luckysheet.formula.error.v}if("boolean"==luckysheet.getObjType(t)){if("true"==t.toString().toLowerCase())return 1;if("false"==t.toString().toLowerCase())return 0}return luckysheet.func_methods.isRealNum(t)?Math.floor(parseFloat(t)):luckysheet.formula.error.v}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},ISEVEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseInt(t),!(1&Math.abs(t))):luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},ISODD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseInt(t),!!(1&Math.abs(t))):luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},LCM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l))if("array"==luckysheet.getObjType(l[0])){if(!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l))}else t=t.concat(l);else"object"==luckysheet.getObjType(l)&&null!=l.startCell?t=t.concat(luckysheet.func_methods.getCellDataArr(l,"number",!0)):t.push(l)}for(var r=0;r<t.length;r++){var a=t[r];if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;if((a=parseInt(a))<0)return luckysheet.formula.error.nm;t[r]=a}for(var s,n,o,c=1;void 0!==(n=t.pop());)for(0==n&&(c=0);1<n;){if(n%2){for(e=3,s=Math.floor(Math.sqrt(n));e<=s&&n%e;e+=2);o=e<=s?e:n}else o=2;for(n/=o,c*=o,e=t.length;e;t[--e]%o==0&&1==(t[e]/=o)&&t.splice(e,1));}return c>=Math.pow(2,53)?luckysheet.formula.error.nm:c}catch(e){var u=e;return u=luckysheet.formula.errorInfo(u),[luckysheet.formula.error.v,u]}},LN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseFloat(t))<=0?luckysheet.formula.error.nm:Math.log(t):luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},LOG:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;if((t=parseFloat(t))<=0)return luckysheet.formula.error.nm;if(2==arguments.length){var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;if((l=parseFloat(l))<=0)return luckysheet.formula.error.nm}else l=10;return Math.log(t)/Math.log(l)}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},LOG10:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseFloat(t))<=0?luckysheet.formula.error.nm:Math.log(t)/Math.log(10):luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},MOD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;if(0==(l=parseFloat(l)))return luckysheet.formula.error.d;var r=Math.abs(t%l);return 0<l?r:-r}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},MROUND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:luckysheet.func_methods.isRealNum(l)?t*(l=parseFloat(l))<0?luckysheet.formula.error.nm:Math.round(t/l)*l:luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},ODD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=1&(l=Math.ceil(Math.abs(t)))?l:l+1;return 0<=t?l:-l}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},SUMSQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!0))}else"object"==luckysheet.getObjType(l)&&null!=l.startCell?t=t.concat(luckysheet.func_methods.getCellDataArr(l,"number",!0)):t.push(l)}var r=0;if(0<t.length)for(e=0;e<t.length;e++){var a=t[e];if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;r+=(a=parseFloat(a))*a}return r}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},COMBIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseInt(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:luckysheet.func_methods.isRealNum(l)?(l=parseInt(l),t<0||l<0||t<l?luckysheet.formula.error.nm:luckysheet.func_methods.factorial(t)/(luckysheet.func_methods.factorial(l)*luckysheet.func_methods.factorial(t-l))):luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},SUBTOTAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t,l=arguments[0];if("array"==luckysheet.getObjType(l))if("array"==luckysheet.getObjType(l[0])){if(!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=[];for(e=0;e<l.length;e++){for(var r=[],a=0;a<l[e].length;a++)r.push(l[e][a]);t.push(r)}}else{t=[];for(e=0;e<l.length;e++)t.push(l[e])}else t="object"==luckysheet.getObjType(l)&&null!=l.startCell?luckysheet.func_methods.getFirstValue(l):l;var s=Array.prototype.slice.apply(arguments);if(s.shift(),"array"!=luckysheet.getObjType(t))return luckysheet.func_methods.valueIsError(t)?t:!luckysheet.func_methods.isRealNum(t)||(t=parseInt(t))<1||111<t||11<t&&t<101?luckysheet.formula.error.v:c(t);var n=[];if("array"==luckysheet.getObjType(t[0]))for(e=0;e<t.length;e++){for(r=[],a=0;a<t[e].length;a++){var o=t[e][a];luckysheet.func_methods.valueIsError(o)?r.push(o):!luckysheet.func_methods.isRealNum(o)||(o=parseInt(o))<1||111<o||11<o&&o<101?r.push(luckysheet.formula.error.v):r.push(c(o))}n.push(r)}else for(e=0;e<t.length;e++){o=t[e];luckysheet.func_methods.valueIsError(o)?n.push(o):!luckysheet.func_methods.isRealNum(o)||(o=parseInt(o))<1||111<o||11<o&&o<101?n.push(luckysheet.formula.error.v):n.push(c(o))}return n;function c(e){switch(e){case 1:case 101:return window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,s);case 2:case 102:return window.luckysheet_function.COUNT.f.apply(window.luckysheet_function.COUNT,s);case 3:case 103:return window.luckysheet_function.COUNTA.f.apply(window.luckysheet_function.COUNTA,s);case 4:case 104:return window.luckysheet_function.MAX.f.apply(window.luckysheet_function.MAX,s);case 5:case 105:return window.luckysheet_function.MIN.f.apply(window.luckysheet_function.MIN,s);case 6:case 106:return window.luckysheet_function.PRODUCT.f.apply(window.luckysheet_function.PRODUCT,s);case 7:case 107:return window.luckysheet_function.STDEVA.f.apply(window.luckysheet_function.STDEVA,s);case 8:case 108:return window.luckysheet_function.STDEVP.f.apply(window.luckysheet_function.STDEVP,s);case 9:case 109:return window.luckysheet_function.SUM.f.apply(window.luckysheet_function.SUM,s);case 10:case 110:return window.luckysheet_function.VAR_S.f.apply(window.luckysheet_function.VAR_S,s);case 11:case 111:return window.luckysheet_function.VAR_P.f.apply(window.luckysheet_function.VAR_P,s)}}}catch(e){var u=e;return u=luckysheet.formula.errorInfo(u),[luckysheet.formula.error.v,u]}},ASIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseFloat(t))<-1||1<t?luckysheet.formula.error.nm:Math.asin(t):luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},COUNTIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var i=0;i<arguments.length;i++){var p=luckysheet.formula.errorParamCheck(this.p,arguments[i],i);if(!p[0])return luckysheet.formula.error.v}try{var data_range=arguments[0],range;if("object"!=luckysheet.getObjType(data_range)||null==data_range.startCell)return luckysheet.formula.error.v;range=data_range.data;var data_criteria=arguments[1],criteria;if("array"==luckysheet.getObjType(data_criteria))if(criteria=[],"array"==luckysheet.getObjType(data_criteria[0])){if(!luckysheet.func_methods.isDyadicArr(data_criteria))return luckysheet.formula.error.v;for(var i=0;i<data_criteria.length;i++){for(var rowArr=[],j=0;j<data_criteria[i].length;j++)rowArr.push(data_criteria[i][j]);criteria.push(rowArr)}}else for(var i=0;i<data_criteria.length;i++)criteria.push(data_criteria[i]);else if("object"==luckysheet.getObjType(data_criteria)&&null!=data_criteria.startCell){if(1<data_criteria.rowl||1<data_criteria.coll)return 0;criteria=data_criteria.data}else criteria=data_criteria;if("array"!=luckysheet.getObjType(criteria))return getCriteriaResult(range,criteria);var result=[];if("array"==luckysheet.getObjType(criteria[0]))for(var i=0;i<criteria.length;i++){for(var rowArr=[],j=0;j<criteria[i].length;j++)rowArr.push(getCriteriaResult(range,criteria[i][j]));result.push(rowArr)}else for(var i=0;i<criteria.length;i++)result.push(getCriteriaResult(range,criteria[i]));return result;function getCriteriaResult(range,criter){/[<>=!*?]/.test(criter)||(criter='=="'+criter+'"'),criter=criter.replace("<>","!=");var matches=0,value;if("array"==luckysheet.getObjType(range))for(var i=0;i<range.length;i++)for(var j=0,value;j<range[i].length;j++){null==range[i][j]||luckysheet.func_methods.isRealNull(range[i][j].v)||(value=range[i][j].v,-1<criter.indexOf("*")||-1<criter.indexOf("?")?luckysheet.formula.isWildcard(value,criter)&&matches++:"string"!=typeof value?eval(value+criter)&&matches++:eval('"'+value+'"'+criter)&&matches++)}else null==range||luckysheet.func_methods.isRealNull(range.v)||(value=range.v,-1<criter.indexOf("*")||-1<criter.indexOf("?")?luckysheet.formula.isWildcard(value,criter)&&matches++:"string"!=typeof value?eval(value+criter)&&matches++:eval('"'+value+'"'+criter)&&matches++);return matches}}catch(e){var err=e;return err=luckysheet.formula.errorInfo(err),[luckysheet.formula.error.v,err]}},RADIANS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseFloat(t))*Math.PI/180:luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},RAND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;try{return Math.floor(1e9*Math.random())/1e9}catch(e){var t=e;return t=luckysheet.formula.errorInfo(t),[luckysheet.formula.error.v,t]}},COUNTUNIQUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!0))}else"object"==luckysheet.getObjType(l)&&null!=l.startCell?t=t.concat(luckysheet.func_methods.getCellDataArr(l,"text",!0)):t.push(l)}return window.luckysheet_function.UNIQUE.f(t)}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},DEGREES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?180*(t=parseFloat(t))/Math.PI:luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},ERFC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseFloat(t),jStat.erfc(t)):luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},EVEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=1&(l=Math.ceil(Math.abs(t)))?l+1:l;return 0<t?l:-l}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},EXP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseFloat(t),Math.exp(t)):luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},FACT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t)){if("boolean"!=luckysheet.getObjType(t))return luckysheet.formula.error.v;"true"==t.toString().toLowerCase()?t=1:"false"==t.toString().toLowerCase()&&(t=0)}return(t=parseInt(t))<0?luckysheet.formula.error.nm:luckysheet.func_methods.factorial(t)}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},FACTDOUBLE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t)){if("boolean"!=luckysheet.getObjType(t))return luckysheet.formula.error.v;"true"==t.toString().toLowerCase()?t=1:"false"==t.toString().toLowerCase()&&(t=0)}return(t=parseInt(t))<0?luckysheet.formula.error.nm:luckysheet.func_methods.factorialDouble(t)}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},PI:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;try{return Math.PI}catch(e){var t=e;return t=luckysheet.formula.errorInfo(t),[luckysheet.formula.error.v,t]}},FLOOR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;if(0==(l=parseFloat(l)))return luckysheet.formula.error.d;if(0<t&&l<0)return luckysheet.formula.error.nm;var r=-Math.floor(Math.log(Math.abs(l))/Math.log(10));return 0<=t?Math.floor(t/l)*l*Math.pow(10,r)/Math.pow(10,r):-(Math.ceil(Math.abs(t)/l)*l*Math.pow(10,r))/Math.pow(10,r)}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},GCD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!1))}else"object"==luckysheet.getObjType(l)&&null!=l.startCell?t=t.concat(luckysheet.func_methods.getCellDataArr(l,"number",!1)):t.push(l)}if(!luckysheet.func_methods.isRealNum(t[0]))return luckysheet.formula.error.v;var r=parseInt(t[0]);if(r<0||r>=Math.pow(2,53))return luckysheet.formula.error.nm;for(e=1;e<t.length;e++){var a=t[e];if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;if((a=parseInt(a))<0||a>=Math.pow(2,53))return luckysheet.formula.error.nm;for(;r&&a;)a<r?r%=a:a%=r;r+=a}return r}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},RANDBETWEEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseInt(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:luckysheet.func_methods.isRealNum(l)?(l=parseInt(l))<t?luckysheet.formula.error.nm:t+Math.ceil((l-t+1)*Math.random())-1:luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},ROUND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:luckysheet.func_methods.isRealNum(l)?(l=parseInt(l),(0<t?1:-1)*Math.round(Math.abs(t)*Math.pow(10,l))/Math.pow(10,l)):luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},ROUNDDOWN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:luckysheet.func_methods.isRealNum(l)?(l=parseInt(l),(0<t?1:-1)*Math.floor(Math.abs(t)*Math.pow(10,l))/Math.pow(10,l)):luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},ROUNDUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:luckysheet.func_methods.isRealNum(l)?(l=parseInt(l),(0<t?1:-1)*Math.ceil(Math.abs(t)*Math.pow(10,l))/Math.pow(10,l)):luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},SERIESSUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseFloat(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=arguments[3],s=[];if("array"==luckysheet.getObjType(a)){if("array"==luckysheet.getObjType(a[0])&&!luckysheet.func_methods.isDyadicArr(a))return luckysheet.formula.error.v;s=s.concat(luckysheet.func_methods.getDataArr(a,!1))}else"object"==luckysheet.getObjType(a)&&null!=a.startCell?s=s.concat(luckysheet.func_methods.getCellDataArr(a,"number",!1)):s.push(a);if(!luckysheet.func_methods.isRealNum(s[0]))return luckysheet.formula.error.v;for(var n=parseFloat(s[0])*Math.pow(t,l),e=1;e<s.length;e++){var o=s[e];if(!luckysheet.func_methods.isRealNum(o))return luckysheet.formula.error.v;n+=parseFloat(o)*Math.pow(t,l+e*r)}return n}catch(e){var c=e;return c=luckysheet.formula.errorInfo(c),[luckysheet.formula.error.v,c]}},SIGN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;if(0<(t=parseFloat(t)))return 1;if(0==t)return 0;if(t<0)return-1}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},SIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseFloat(t),Math.sin(t)):luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},SINH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseFloat(t),(Math.exp(t)-Math.exp(-t))/2):luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},SQRT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseFloat(t))<0?luckysheet.formula.error.nm:Math.sqrt(t):luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},SQRTPI:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseFloat(t))<0?luckysheet.formula.error.nm:Math.sqrt(t*Math.PI):luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},GAMMALN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseFloat(t))<=0?luckysheet.formula.error.nm:jStat.gammaln(t):luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},COS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseFloat(t),Math.cos(t)):luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},TRUNC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;if(t=parseFloat(t),2==arguments.length){var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l)}else l=0;return(0<t?1:-1)*Math.floor(Math.abs(t)*Math.pow(10,l))/Math.pow(10,l)}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},QUOTIENT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:luckysheet.func_methods.isRealNum(l)?0==(l=parseFloat(l))?luckysheet.formula.error.d:parseInt(t/l,10):luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},POWER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:luckysheet.func_methods.isRealNum(l)?(l=parseFloat(l),0==t&&0==l||t<0&&-1<l.toString().indexOf(".")?luckysheet.formula.error.nm:Math.pow(t,l)):luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},SUMIFS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=0,l=arguments;luckysheet_getValue(l);for(var r=luckysheet.formula.getRangeArray(l[0])[0],a=new Array(r.length),e=0;e<a.length;e++)a[e]=!0;for(e=1;e<l.length;e+=2)for(var s=luckysheet.formula.getRangeArray(l[e])[0],n=l[e+1],o=0;o<s.length;o++){var c=s[o];a[o]=a[o]&&!!c&&luckysheet.formula.acompareb(c,n)}for(e=0;e<r.length;e++)a[e]&&(t+=parseFloat(r[e]));return t}catch(e){var u=e;return u=luckysheet.formula.errorInfo(u),[luckysheet.formula.error.v,u]}},COUNTIFS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments;luckysheet_getValue(t);for(var l=new Array(luckysheet.formula.getRangeArray(t[0])[0].length),e=0;e<l.length;e++)l[e]=!0;for(e=0;e<t.length;e+=2)for(var r=luckysheet.formula.getRangeArray(t[e])[0],a=t[e+1],s=0;s<r.length;s++){var n=r[s];l[s]=l[s]&&!!n&&luckysheet.formula.acompareb(n,a)}for(var o=0,e=0;e<l.length;e++)l[e]&&o++;return o}catch(e){var c=e;return c=luckysheet.formula.errorInfo(c),[luckysheet.formula.error.v,c]}},PRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!0))}else"object"==luckysheet.getObjType(l)&&null!=l.startCell?t=t.concat(luckysheet.func_methods.getCellDataArr(l,"number",!0)):t.push(l)}for(var r=1,e=0;e<t.length;e++){var a=t[e];if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;r*=parseFloat(a)}return r}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},HARMEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!0))}else"object"==luckysheet.getObjType(l)&&null!=l.startCell?t=t.concat(luckysheet.func_methods.getCellDataArr(l,"number",!0)):t.push(l)}for(var r=0,a=0,e=0;e<t.length;e++){var s=t[e];if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;if((s=parseFloat(s))<=0)return luckysheet.formula.error.nm;r+=1/s,a++}return a/r}catch(e){var n=e;return n=luckysheet.formula.errorInfo(n),[luckysheet.formula.error.v,n]}},HYPGEOMDIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseInt(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseInt(r);var a=luckysheet.func_methods.getFirstValue(arguments[3]);if(luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseInt(a);var s=luckysheet.func_methods.getCellBoolen(arguments[4]);if(luckysheet.func_methods.valueIsError(s))return s;if(t<0||t>Math.min(l,r)||t<Math.max(0,l-a+r))return luckysheet.formula.error.nm;if(l<=0||a<l)return luckysheet.formula.error.nm;if(r<=0||a<r)return luckysheet.formula.error.nm;if(a<=0)return luckysheet.formula.error.nm;function n(e,t,l,r){return luckysheet.func_methods.factorial(l)/(luckysheet.func_methods.factorial(e)*luckysheet.func_methods.factorial(l-e))*(luckysheet.func_methods.factorial(r-l)/(luckysheet.func_methods.factorial(t-e)*luckysheet.func_methods.factorial(r-l-t+e)))/(luckysheet.func_methods.factorial(r)/(luckysheet.func_methods.factorial(t)*luckysheet.func_methods.factorial(r-t)))}return(s?function(e,t,l,r){for(var a=0,s=0;s<=e;s++)a+=n(s,t,l,r);return a}:n)(t,l,r,a)}catch(e){var o=e;return o=luckysheet.formula.errorInfo(o),[luckysheet.formula.error.v,o]}},INTERCEPT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("array"==luckysheet.getObjType(t)){if("array"==luckysheet.getObjType(t[0])&&!luckysheet.func_methods.isDyadicArr(t))return luckysheet.formula.error.v;l=l.concat(luckysheet.func_methods.getDataArr(t,!1))}else"object"==luckysheet.getObjType(t)&&null!=t.startCell?l=l.concat(luckysheet.func_methods.getCellDataArr(t,"text",!1)):l.push(t);var r=arguments[1],a=[];if("array"==luckysheet.getObjType(r)){if("array"==luckysheet.getObjType(r[0])&&!luckysheet.func_methods.isDyadicArr(r))return luckysheet.formula.error.v;a=a.concat(luckysheet.func_methods.getDataArr(r,!1))}else"object"==luckysheet.getObjType(r)&&null!=r.startCell?a=a.concat(luckysheet.func_methods.getCellDataArr(r,"text",!1)):a.push(r);if(l.length!=a.length)return luckysheet.formula.error.na;for(var s=[],n=[],e=0;e<l.length;e++){var o=l[e],c=a[e];luckysheet.func_methods.isRealNum(o)&&luckysheet.func_methods.isRealNum(c)&&(s.push(parseFloat(o)),n.push(parseFloat(c)))}if(0==luckysheet.func_methods.variance_s(n))return luckysheet.formula.error.d;for(var u=jStat.mean(n),i=jStat.mean(s),h=n.length,d=0,y=0,e=0;e<h;e++)d+=(n[e]-u)*(s[e]-i),y+=Math.pow(n[e]-u,2);var f=d/y;return i-f*u+0*f}catch(e){var m=e;return m=luckysheet.formula.errorInfo(m),[luckysheet.formula.error.v,m]}},KURT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!0))}else"object"==luckysheet.getObjType(l)&&null!=l.startCell?t=t.concat(luckysheet.func_methods.getCellDataArr(l,"text",!0)):t.push(l)}for(var r=[],a=0;a<t.length;a++){var s=t[a];if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseFloat(s),r.push(s)}if(r.length<4||0==luckysheet.func_methods.standardDeviation_s(r))return luckysheet.formula.error.d;for(var n=jStat.mean(r),o=r.length,c=0,e=0;e<o;e++)c+=Math.pow(r[e]-n,4);return o*(o+1)/((o-1)*(o-2)*(o-3))*(c/=Math.pow(jStat.stdev(r,!0),4))-3*(o-1)*(o-1)/((o-2)*(o-3))}catch(e){var u=e;return u=luckysheet.formula.errorInfo(u),[luckysheet.formula.error.v,u]}},LARGE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=[];if("array"==luckysheet.getObjType(arguments[0])){if("array"==luckysheet.getObjType(arguments[0][0])&&!luckysheet.func_methods.isDyadicArr(arguments[0]))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(arguments[0],!0))}else"object"==luckysheet.getObjType(arguments[0])&&null!=arguments[0].startCell?t=t.concat(luckysheet.func_methods.getCellDataArr(arguments[0],"text",!0)):t.push(arguments[0]);for(var l=[],r=0;r<t.length;r++){var a=t[r];if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseFloat(a),l.push(a)}if("array"==luckysheet.getObjType(arguments[1])){if("array"==luckysheet.getObjType(arguments[1][0])&&!luckysheet.func_methods.isDyadicArr(arguments[1]))return luckysheet.formula.error.v;s=luckysheet.func_methods.getDataArr(arguments[1])}else if("object"==luckysheet.getObjType(arguments[1])&&null!=arguments[1].startCell){if(1<arguments[1].rowl||1<arguments[1].coll)return luckysheet.formula.error.v;var s,n=arguments[1].data;s=null==n||luckysheet.func_methods.isRealNull(n.v)?0:n.v}else s=arguments[1];if("array"!=luckysheet.getObjType(s))return luckysheet.func_methods.isRealNum(s)?(s=Math.ceil(parseFloat(s)),0==l.length||s<=0||s>l.length?luckysheet.formula.error.nm:t.sort(function(e,t){return t-e})[s-1]):luckysheet.formula.error.v;if(0==l.length)return luckysheet.formula.error.nm;for(var o=[],e=0;e<s.length;e++)luckysheet.func_methods.isRealNum(s[e])?(s[e]=Math.ceil(parseFloat(s[e])),s[e]<=0||s[e]>l.length?o.push(luckysheet.formula.error.nm):o.push(t.sort(function(e,t){return t-e})[s[e]-1])):o.push(luckysheet.formula.error.v);return o}catch(e){var c=e;return c=luckysheet.formula.errorInfo(c),[luckysheet.formula.error.v,c]}},STDEVA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!1))}else"object"==luckysheet.getObjType(l)&&null!=l.startCell?t=t.concat(luckysheet.func_methods.getCellDataArr(l,"text",!1)):t.push(l)}for(var r=[],a=0;a<t.length;a++){var s=t[a],s=luckysheet.func_methods.isRealNum(s)?parseFloat(s):"true"==s.toString().toLowerCase()?1:0;r.push(s)}return 0==r.length?0:1==r.length?luckysheet.formula.error.d:luckysheet.func_methods.standardDeviation_s(r)}catch(e){var n=e;return n=luckysheet.formula.errorInfo(n),[luckysheet.formula.error.v,n]}},STDEVP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!0))}else"object"==luckysheet.getObjType(l)&&null!=l.startCell?t=t.concat(luckysheet.func_methods.getCellDataArr(l,"text",!0)):t.push(l)}for(var r=[],a=0;a<t.length;a++){var s=t[a];if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseFloat(s),r.push(s)}return 0==r.length?0:1==r.length?luckysheet.formula.error.d:luckysheet.func_methods.standardDeviation(r)}catch(e){var n=e;return n=luckysheet.formula.errorInfo(n),[luckysheet.formula.error.v,n]}},GEOMEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!0))}else if("object"==luckysheet.getObjType(l)&&null!=l.startCell)t=t.concat(luckysheet.func_methods.getCellDataArr(l,"text",!0));else if("boolean"==luckysheet.getObjType(l))"true"==l.toString().toLowerCase()?t.push(1):"false"==l.toString().toLowerCase()&&t.push(0);else{if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;t.push(l)}}for(var r=[],a=0;a<t.length;a++){var s=t[a];if(luckysheet.func_methods.isRealNum(s)){if((s=parseFloat(s))<=0)return luckysheet.formula.error.nm;r.push(s)}}return 0==r.length?luckysheet.formula.error.nm:jStat.geomean(r)}catch(e){var n=e;return n=luckysheet.formula.errorInfo(n),[luckysheet.formula.error.v,n]}},RANK_EQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=arguments[1],r=[];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;r=r.concat(luckysheet.func_methods.getDataArr(l,!0))}else"object"==luckysheet.getObjType(l)&&null!=l.startCell?r=r.concat(luckysheet.func_methods.getCellDataArr(l,"number",!0)):r.push(l);for(var a=[],s=0;s<r.length;s++){var n=r[s];if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;n=parseFloat(n),a.push(n)}if(3==arguments.length){var o=luckysheet.func_methods.getCellBoolen(arguments[2]);if(luckysheet.func_methods.valueIsError(o))return o}else o=!1;var c=o?function(e,t){return e-t}:function(e,t){return t-e},u=(a=a.sort(c)).indexOf(t);return-1==u?luckysheet.formula.error.na:u+1}catch(e){var i=e;return i=luckysheet.formula.errorInfo(i),[luckysheet.formula.error.v,i]}},RANK_AVG:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=arguments[1],r=[];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;r=r.concat(luckysheet.func_methods.getDataArr(l,!0))}else"object"==luckysheet.getObjType(l)&&null!=l.startCell?r=r.concat(luckysheet.func_methods.getCellDataArr(l,"number",!0)):r.push(l);for(var a=[],s=0;s<r.length;s++){var n=r[s];if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;n=parseFloat(n),a.push(n)}if(3==arguments.length){var o=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(o))return o;if("boolean"!=luckysheet.getObjType(o))if("string"!=luckysheet.getObjType(o)||"true"!=o.toLowerCase()&&"false"!=o.toLowerCase()){if(!luckysheet.func_methods.isRealNum(o))return luckysheet.formula.error.v;o=0!=(o=parseFloat(o))}else"true"==o.toLowerCase()&&(o=!0),"false"==o.toLowerCase()&&(o=!1)}else o=!1;for(var c=o?function(e,t){return e-t}:function(e,t){return t-e},a=a.sort(c),u=0,e=0;e<a.length;e++)a[e]==t&&u++;return 1<u?(2*a.indexOf(t)+u+1)/2:a.indexOf(t)+1}catch(e){var i=e;return i=luckysheet.formula.errorInfo(i),[luckysheet.formula.error.v,i]}},PERCENTRANK_EXC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("array"==luckysheet.getObjType(t)){if("array"==luckysheet.getObjType(t[0])&&!luckysheet.func_methods.isDyadicArr(t))return luckysheet.formula.error.v;l=l.concat(luckysheet.func_methods.getDataArr(t,!0))}else"object"==luckysheet.getObjType(t)&&null!=t.startCell?l=l.concat(luckysheet.func_methods.getCellDataArr(t,"number",!0)):l.push(t);for(var r=[],a=0;a<l.length;a++){var s=l[a];if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseFloat(s),r.push(s)}var n=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(n))return n;if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;if(n=parseFloat(n),3==arguments.length){var o=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(o))return o;if(!luckysheet.func_methods.isRealNum(o))return luckysheet.formula.error.v;o=parseInt(o)}else o=3;if(0==r.length)return luckysheet.formula.error.nm;if(o<1)return luckysheet.formula.error.nm;if(1==r.length&&r[0]==n)return 1;r=r.sort(function(e,t){return e-t});for(var c=window.luckysheet_function.UNIQUE.f(r)[0],u=r.length,i=c.length,h=Math.pow(10,o),d=0,y=!1,e=0;!y&&e<i;)n===c[e]?(d=(r.indexOf(c[e])+1)/(u+1),y=!0):n>=c[e]&&(n<c[e+1]||e===i-1)&&(d=(r.lastIndexOf(c[e])+1+(n-c[e])/(c[e+1]-c[e]))/(u+1),y=!0),e++;return isNaN(d)?luckysheet.formula.error.na:Math.floor(d*h)/h}catch(e){var f=e;return f=luckysheet.formula.errorInfo(f),[luckysheet.formula.error.v,f]}},PERCENTRANK_INC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("array"==luckysheet.getObjType(t)){if("array"==luckysheet.getObjType(t[0])&&!luckysheet.func_methods.isDyadicArr(t))return luckysheet.formula.error.v;l=l.concat(luckysheet.func_methods.getDataArr(t,!0))}else"object"==luckysheet.getObjType(t)&&null!=t.startCell?l=l.concat(luckysheet.func_methods.getCellDataArr(t,"number",!0)):l.push(t);for(var r=[],a=0;a<l.length;a++){var s=l[a];if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseFloat(s),r.push(s)}var n=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(n))return n;if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;if(n=parseFloat(n),3==arguments.length){var o=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(o))return o;if(!luckysheet.func_methods.isRealNum(o))return luckysheet.formula.error.v;o=parseInt(o)}else o=3;if(0==r.length)return luckysheet.formula.error.nm;if(o<1)return luckysheet.formula.error.nm;if(1==r.length&&r[0]==n)return 1;r=r.sort(function(e,t){return e-t});for(var c=window.luckysheet_function.UNIQUE.f(r)[0],u=r.length,i=c.length,h=Math.pow(10,o),d=0,y=!1,e=0;!y&&e<i;)n===c[e]?(d=r.indexOf(c[e])/(u-1),y=!0):n>=c[e]&&(n<c[e+1]||e===i-1)&&(d=(r.lastIndexOf(c[e])+(n-c[e])/(c[e+1]-c[e]))/(u-1),y=!0),e++;return isNaN(d)?luckysheet.formula.error.na:Math.floor(d*h)/h}catch(e){var f=e;return f=luckysheet.formula.errorInfo(f),[luckysheet.formula.error.v,f]}},FORECAST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=arguments[1],r=[];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;r=r.concat(luckysheet.func_methods.getDataArr(l,!1))}else"object"==luckysheet.getObjType(l)&&null!=l.startCell?r=r.concat(luckysheet.func_methods.getCellDataArr(l,"text",!1)):r.push(l);var a=arguments[2],s=[];if("array"==luckysheet.getObjType(a)){if("array"==luckysheet.getObjType(a[0])&&!luckysheet.func_methods.isDyadicArr(a))return luckysheet.formula.error.v;s=s.concat(luckysheet.func_methods.getDataArr(a,!1))}else"object"==luckysheet.getObjType(a)&&null!=a.startCell?s=s.concat(luckysheet.func_methods.getCellDataArr(a,"text",!1)):s.push(a);if(r.length!=s.length)return luckysheet.formula.error.na;for(var n=[],o=[],e=0;e<r.length;e++){var c=r[e],u=s[e];luckysheet.func_methods.isRealNum(c)&&luckysheet.func_methods.isRealNum(u)&&(n.push(parseFloat(c)),o.push(parseFloat(u)))}if(0==luckysheet.func_methods.variance_s(o))return luckysheet.formula.error.d;for(var i=jStat.mean(o),h=jStat.mean(n),d=o.length,y=0,f=0,e=0;e<d;e++)y+=(o[e]-i)*(n[e]-h),f+=Math.pow(o[e]-i,2);var m=y/f;return h-m*i+m*t}catch(e){var k=e;return k=luckysheet.formula.errorInfo(k),[luckysheet.formula.error.v,k]}},FISHERINV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=Math.exp(2*t);return(l-1)/(l+1)}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},FISHER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseFloat(t))<=-1||1<=t?luckysheet.formula.error.nm:Math.log((1+t)/(1-t))/2:luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},MODE_SNGL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!0))}else if("object"==luckysheet.getObjType(l)&&null!=l.startCell)t=t.concat(luckysheet.func_methods.getCellDataArr(l,"number",!0));else{if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;t.push(l)}}for(var r=[],e=0;e<t.length;e++){var a=t[e];luckysheet.func_methods.isRealNum(a)&&r.push(parseFloat(a))}for(var s,n={},o=[],c=0,e=0;e<r.length;e++)n[s=r[e]]=n[s]?n[s]+1:1,n[s]>c&&(c=n[s],o=[]),n[s]==c&&(o[o.length]=s);if(c<=1)return luckysheet.formula.error.na;for(var u=r.indexOf(o[0]),i=0;i<o.length;i++){var h=r.indexOf(o[i]);h<u&&(u=h)}return r[u]}catch(e){var d=e;return d=luckysheet.formula.errorInfo(d),[luckysheet.formula.error.v,d]}},WEIBULL_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseFloat(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=luckysheet.func_methods.getCellBoolen(arguments[3]);return luckysheet.func_methods.valueIsError(a)?a:t<0||l<=0||r<=0?luckysheet.formula.error.nm:a?1-Math.exp(-Math.pow(t/r,l)):Math.pow(t,l-1)*Math.exp(-Math.pow(t/r,l))*l/Math.pow(r,l)}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},AVEDEV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!0))}else if("object"==luckysheet.getObjType(l)&&null!=l.startCell)t=t.concat(luckysheet.func_methods.getCellDataArr(l,"number",!0));else{if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;t.push(l)}}for(var r=[],e=0;e<t.length;e++){var a=t[e];luckysheet.func_methods.isRealNum(a)&&r.push(parseFloat(a))}return 0==r.length?luckysheet.formula.error.nm:jStat.sum(jStat(r).subtract(jStat.mean(r)).abs()[0])/r.length}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},AVERAGEA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!1))}else if("object"==luckysheet.getObjType(l)&&null!=l.startCell)t=t.concat(luckysheet.func_methods.getCellDataArr(l,"number",!0));else if("true"==s.toString.toLowerCase())t.push(1);else if("false"==s.toString.toLowerCase())t.push(0);else{if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;t.push(l)}}for(var r=0,a=0,e=0;e<t.length;e++){var s=t[e];luckysheet.func_methods.isRealNum(s)?r+=parseFloat(s):"true"==s.toString().toLowerCase()?r+=1:r+=0,a++}return 0==a?luckysheet.formula.error.d:r/a}catch(e){var n=e;return n=luckysheet.formula.errorInfo(n),[luckysheet.formula.error.v,n]}},BINOM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseInt(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=luckysheet.func_methods.getCellBoolen(arguments[3]);return luckysheet.func_methods.valueIsError(a)?a:t<0||l<t||r<0||1<r?luckysheet.formula.error.nm:a?jStat.binomial.cdf(t,l,r):jStat.binomial.pdf(t,l,r)}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},BINOM_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseInt(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseFloat(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;if(r=parseFloat(r),t<0)return luckysheet.formula.error.nm;if(l<0||1<l)return luckysheet.formula.error.nm;if(r<0||1<r)return luckysheet.formula.error.nm;for(var a=0;a<=t;){if(jStat.binomial.cdf(a,t,l)>=r)return a;a++}}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},CONFIDENCE_NORM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseFloat(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);return luckysheet.func_methods.valueIsError(r)?r:luckysheet.func_methods.isRealNum(r)?(r=parseInt(r),t<=0||1<=t||l<=0||r<1?luckysheet.formula.error.nm:jStat.normalci(1,t,l,r)[1]-1):luckysheet.formula.error.v}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},CORREL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("array"==luckysheet.getObjType(t)){if("array"==luckysheet.getObjType(t[0])&&!luckysheet.func_methods.isDyadicArr(t))return luckysheet.formula.error.v;l=l.concat(luckysheet.func_methods.getDataArr(t,!1))}else"object"==luckysheet.getObjType(t)&&null!=t.startCell?l=l.concat(luckysheet.func_methods.getCellDataArr(t,"text",!1)):l.push(t);var r=arguments[1],a=[];if("array"==luckysheet.getObjType(r)){if("array"==luckysheet.getObjType(r[0])&&!luckysheet.func_methods.isDyadicArr(r))return luckysheet.formula.error.v;a=a.concat(luckysheet.func_methods.getDataArr(r,!1))}else"object"==luckysheet.getObjType(r)&&null!=r.startCell?a=a.concat(luckysheet.func_methods.getCellDataArr(r,"text",!1)):a.push(r);if(l.length!=a.length)return luckysheet.formula.error.na;for(var s=[],n=[],e=0;e<l.length;e++){var o=l[e],c=a[e];luckysheet.func_methods.isRealNum(o)&&luckysheet.func_methods.isRealNum(c)&&(s.push(parseFloat(o)),n.push(parseFloat(c)))}return 0==s.length||0==n.length||0==luckysheet.func_methods.standardDeviation(s)||0==luckysheet.func_methods.standardDeviation(n)?luckysheet.formula.error.d:jStat.corrcoeff(s,n)}catch(e){var u=e;return u=luckysheet.formula.errorInfo(u),[luckysheet.formula.error.v,u]}},COVARIANCE_P:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("array"==luckysheet.getObjType(t)){if("array"==luckysheet.getObjType(t[0])&&!luckysheet.func_methods.isDyadicArr(t))return luckysheet.formula.error.v;l=l.concat(luckysheet.func_methods.getDataArr(t,!1))}else"object"==luckysheet.getObjType(t)&&null!=t.startCell?l=l.concat(luckysheet.func_methods.getCellDataArr(t,"text",!1)):l.push(t);var r=arguments[1],a=[];if("array"==luckysheet.getObjType(r)){if("array"==luckysheet.getObjType(r[0])&&!luckysheet.func_methods.isDyadicArr(r))return luckysheet.formula.error.v;a=a.concat(luckysheet.func_methods.getDataArr(r,!1))}else"object"==luckysheet.getObjType(r)&&null!=r.startCell?a=a.concat(luckysheet.func_methods.getCellDataArr(r,"text",!1)):a.push(r);if(l.length!=a.length)return luckysheet.formula.error.na;for(var s=[],n=[],e=0;e<l.length;e++){var o=l[e],c=a[e];luckysheet.func_methods.isRealNum(o)&&luckysheet.func_methods.isRealNum(c)&&(s.push(parseFloat(o)),n.push(parseFloat(c)))}if(0==s.length||0==n.length)return luckysheet.formula.error.d;for(var u=jStat.mean(s),i=jStat.mean(n),h=0,e=0;e<s.length;e++)h+=(s[e]-u)*(n[e]-i);return h/=s.length}catch(e){var d=e;return d=luckysheet.formula.errorInfo(d),[luckysheet.formula.error.v,d]}},COVARIANCE_S:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("array"==luckysheet.getObjType(t)){if("array"==luckysheet.getObjType(t[0])&&!luckysheet.func_methods.isDyadicArr(t))return luckysheet.formula.error.v;l=l.concat(luckysheet.func_methods.getDataArr(t,!1))}else"object"==luckysheet.getObjType(t)&&null!=t.startCell?l=l.concat(luckysheet.func_methods.getCellDataArr(t,"text",!1)):l.push(t);var r=arguments[1],a=[];if("array"==luckysheet.getObjType(r)){if("array"==luckysheet.getObjType(r[0])&&!luckysheet.func_methods.isDyadicArr(r))return luckysheet.formula.error.v;a=a.concat(luckysheet.func_methods.getDataArr(r,!1))}else"object"==luckysheet.getObjType(r)&&null!=r.startCell?a=a.concat(luckysheet.func_methods.getCellDataArr(r,"text",!1)):a.push(r);if(l.length!=a.length)return luckysheet.formula.error.na;for(var s=[],n=[],e=0;e<l.length;e++){var o=l[e],c=a[e];luckysheet.func_methods.isRealNum(o)&&luckysheet.func_methods.isRealNum(c)&&(s.push(parseFloat(o)),n.push(parseFloat(c)))}return 0==s.length||0==n.length?luckysheet.formula.error.d:jStat.covariance(s,n)}catch(e){var u=e;return u=luckysheet.formula.errorInfo(u),[luckysheet.formula.error.v,u]}},DEVSQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!0))}else if("object"==luckysheet.getObjType(l)&&null!=l.startCell)t=t.concat(luckysheet.func_methods.getCellDataArr(l,"number",!0));else if(luckysheet.func_methods.isRealNum(l))t.push(l);else{if("boolean"!=luckysheet.getObjType(l))return luckysheet.formula.error.v;"true"==l.toString().toLowerCase()?t.push(1):"false"==l.toString().toLowerCase()&&t.push(0)}}for(var r=[],e=0;e<t.length;e++){var a=t[e];luckysheet.func_methods.isRealNum(a)&&r.push(parseFloat(a))}for(var s=jStat.mean(r),n=0,e=0;e<r.length;e++)n+=Math.pow(r[e]-s,2);return n}catch(e){var o=e;return o=luckysheet.formula.errorInfo(o),[luckysheet.formula.error.v,o]}},EXPON_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseFloat(l);var r=luckysheet.func_methods.getCellBoolen(arguments[2]);return luckysheet.func_methods.valueIsError(r)?r:t<0||l<0?luckysheet.formula.error.nm:r?jStat.exponential.cdf(t,l):jStat.exponential.pdf(t,l)}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},AVERAGEIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t,l,r,a,s,n,o,c,u=0,i=0,h=arguments[0].data,d=arguments[0].rowl,y=arguments[0].coll,f=luckysheet_parseData(arguments[1]),m=[];arguments[2]&&(t=arguments[2].startCell,l=arguments[2].rowl,r=arguments[2].coll,a=arguments[2].sheetName,m=d==l&&y==r?arguments[2].data:(n=[],0,(s=[])[0]=parseInt(t.replace(/[^0-9]/g,""))-1,n[0]=luckysheet.luckysheetABCatNum(t.replace(/[^A-Za-z]/g,"")),s[1]=s[0]+d-1,n[1]=n[0]+y-1,o=luckysheet.luckysheetchatatABC(n[1]),c=s[1]+1,luckysheet_getcelldata(a+"!"+t+":"+(o+c)).data),m=luckysheet.formula.getRangeArray(m)[0]),h=luckysheet.formula.getRangeArray(h)[0];for(e=0;e<h.length;e++){var k=h[e];if(k&&luckysheet.formula.acompareb(k,f)){var p=m[e]||k;if(!luckysheet.func_methods.isRealNum(p))continue;u+=parseFloat(p),i++}}return 0==u||0==i?luckysheet.formula.error.d:luckysheet.numFormat(u/i)}catch(e){var g=e;return g=luckysheet.formula.errorInfo(g),[luckysheet.formula.error.v,g]}},AVERAGEIFS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=0,l=0,r=arguments;luckysheet_getValue(r);for(var a=luckysheet.formula.getRangeArray(r[0])[0],s=new Array(a.length),e=0;e<s.length;e++)s[e]=!0;for(e=1;e<r.length;e+=2)for(var n=luckysheet.formula.getRangeArray(r[e])[0],o=r[e+1],c=0;c<n.length;c++){var u=n[c];s[c]=s[c]&&!!u&&luckysheet.formula.acompareb(u,o)}for(e=0;e<a.length;e++)s[e]&&luckysheet.func_methods.isRealNum(a[e])&&(t+=parseFloat(a[e]),l++);return 0==t||0==l?luckysheet.formula.error.d:luckysheet.numFormat(t/l)}catch(e){var i=e;return i=luckysheet.formula.errorInfo(i),[luckysheet.formula.error.v,i]}},PERMUT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseInt(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:luckysheet.func_methods.isRealNum(l)?(l=parseInt(l),t<=0||l<0||t<l?luckysheet.formula.error.nm:luckysheet.func_methods.factorial(t)/luckysheet.func_methods.factorial(t-l)):luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},TRIMMEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e,t,l,r,a=0;a<arguments.length;a++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[a],a)[0])return luckysheet.formula.error.v}try{var s=arguments[0],n=[];if("array"==luckysheet.getObjType(s)){if("array"==luckysheet.getObjType(s[0])&&!luckysheet.func_methods.isDyadicArr(s))return luckysheet.formula.error.v;n=n.concat(luckysheet.func_methods.getDataArr(s,!1))}else"object"==luckysheet.getObjType(s)&&null!=s.startCell?n=n.concat(luckysheet.func_methods.getCellDataArr(s,"number",!1)):n.push(s);for(var o=[],a=0;a<n.length;a++){var c=n[a];luckysheet.func_methods.isRealNum(c)&&o.push(parseFloat(c))}var u=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(u))return u;if(!luckysheet.func_methods.isRealNum(u))return luckysheet.formula.error.v;if(u=parseFloat(u),0==o.length)return luckysheet.formula.error.nm;if(u<0||1<u)return luckysheet.formula.error.nm;o.sort(function(e,t){return e-t});var i=window.luckysheet_function.FLOOR.f(o.length*u,2)/2,h=(r=(r=i)||1,(l=o)&&"function"==typeof l.slice?l.slice(r):l);return t=(t=i)||1,h=(e=h)&&"function"==typeof e.slice?e.slice(0,e.length-t):e,h=jStat.mean(h)}catch(e){var d=e;return d=luckysheet.formula.errorInfo(d),[luckysheet.formula.error.v,d]}},PERCENTILE_EXC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("array"==luckysheet.getObjType(t)){if("array"==luckysheet.getObjType(t[0])&&!luckysheet.func_methods.isDyadicArr(t))return luckysheet.formula.error.v;l=l.concat(luckysheet.func_methods.getDataArr(t,!1))}else"object"==luckysheet.getObjType(t)&&null!=t.startCell?l=l.concat(luckysheet.func_methods.getCellDataArr(t,"number",!1)):l.push(t);for(var r=[],e=0;e<l.length;e++){var a=l[e];luckysheet.func_methods.isRealNum(a)&&r.push(parseFloat(a))}var s=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;if(s=parseFloat(s),0==r.length)return luckysheet.formula.error.nm;if(s<=0||1<=s)return luckysheet.formula.error.nm;var n=(r=r.sort(function(e,t){return e-t})).length;if(s<1/(n+1)||1-1/(n+1)<s)return luckysheet.formula.error.nm;var o=s*(n+1)-1,c=Math.floor(o);return o===c?r[o]:r[c]+(o-c)*(r[c+1]-r[c])}catch(e){var u=e;return u=luckysheet.formula.errorInfo(u),[luckysheet.formula.error.v,u]}},PERCENTILE_INC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("array"==luckysheet.getObjType(t)){if("array"==luckysheet.getObjType(t[0])&&!luckysheet.func_methods.isDyadicArr(t))return luckysheet.formula.error.v;l=l.concat(luckysheet.func_methods.getDataArr(t,!1))}else"object"==luckysheet.getObjType(t)&&null!=t.startCell?l=l.concat(luckysheet.func_methods.getCellDataArr(t,"number",!1)):l.push(t);for(var r=[],e=0;e<l.length;e++){var a=l[e];luckysheet.func_methods.isRealNum(a)&&r.push(parseFloat(a))}var s=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;if(s=parseFloat(s),0==r.length)return luckysheet.formula.error.nm;if(s<0||1<s)return luckysheet.formula.error.nm;var n=s*((r=r.sort(function(e,t){return e-t})).length-1),o=Math.floor(n);return n===o?r[n]:r[o]+(n-o)*(r[o+1]-r[o])}catch(e){var c=e;return c=luckysheet.formula.errorInfo(c),[luckysheet.formula.error.v,c]}},PEARSON:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("array"==luckysheet.getObjType(t)){if("array"==luckysheet.getObjType(t[0])&&!luckysheet.func_methods.isDyadicArr(t))return luckysheet.formula.error.v;l=l.concat(luckysheet.func_methods.getDataArr(t,!1))}else"object"==luckysheet.getObjType(t)&&null!=t.startCell?l=l.concat(luckysheet.func_methods.getCellDataArr(t,"text",!1)):l.push(t);var r=arguments[1],a=[];if("array"==luckysheet.getObjType(r)){if("array"==luckysheet.getObjType(r[0])&&!luckysheet.func_methods.isDyadicArr(r))return luckysheet.formula.error.v;a=a.concat(luckysheet.func_methods.getDataArr(r,!1))}else"object"==luckysheet.getObjType(r)&&null!=r.startCell?a=a.concat(luckysheet.func_methods.getCellDataArr(r,"text",!1)):a.push(r);if(l.length!=a.length)return luckysheet.formula.error.na;for(var s=[],n=[],e=0;e<l.length;e++){var o=l[e],c=a[e];luckysheet.func_methods.isRealNum(o)&&luckysheet.func_methods.isRealNum(c)&&(s.push(parseFloat(o)),n.push(parseFloat(c)))}if(0==n.length||0==s.length)return luckysheet.formula.error.d;for(var u=jStat.mean(s),i=jStat.mean(n),h=s.length,d=0,y=0,f=0,e=0;e<h;e++)d+=(s[e]-u)*(n[e]-i),y+=Math.pow(s[e]-u,2),f+=Math.pow(n[e]-i,2);return d/Math.sqrt(y*f)}catch(e){var m=e;return m=luckysheet.formula.errorInfo(m),[luckysheet.formula.error.v,m]}},NORM_S_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseFloat(t))<=0||1<=t?luckysheet.formula.error.nm:jStat.normal.inv(t,0,1):luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},NORM_S_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getCellBoolen(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:l?jStat.normal.cdf(t,0,1):jStat.normal.pdf(t,0,1)}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},NORM_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t)){if("boolean"!=luckysheet.getObjType(t))return luckysheet.formula.error.v;"true"==t.toString().toLowerCase()?t=1:"false"==t.toString().toLowerCase()&&(t=0)}t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l)){if("boolean"!=luckysheet.getObjType(l))return luckysheet.formula.error.v;"true"==l.toString().toLowerCase()?l=1:"false"==l.toString().toLowerCase()&&(l=0)}l=parseFloat(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r)){if("boolean"!=luckysheet.getObjType(r))return luckysheet.formula.error.v;"true"==r.toString().toLowerCase()?r=1:"false"==r.toString().toLowerCase()&&(r=0)}return r=parseFloat(r),t<=0||1<=t||r<=0?luckysheet.formula.error.nm:jStat.normal.inv(t,l,r)}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},NORM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t)){if("boolean"!=luckysheet.getObjType(t))return luckysheet.formula.error.v;"true"==t.toString().toLowerCase()?t=1:"false"==t.toString().toLowerCase()&&(t=0)}t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseFloat(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=luckysheet.func_methods.getCellBoolen(arguments[3]);return luckysheet.func_methods.valueIsError(a)?a:r<=0?luckysheet.formula.error.nm:a?jStat.normal.cdf(t,l,r):jStat.normal.pdf(t,l,r)}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},NEGBINOM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseInt(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=luckysheet.func_methods.getCellBoolen(arguments[3]);return luckysheet.func_methods.valueIsError(a)?a:r<0||1<r||t<0||l<1?luckysheet.formula.error.nm:a?jStat.negbin.cdf(t,l,r):jStat.negbin.pdf(t,l,r)}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},MINA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!1))}else if("object"==luckysheet.getObjType(l)&&null!=l.startCell)t=t.concat(luckysheet.func_methods.getCellDataArr(l,"number",!0));else if("true"==a.toString.toLowerCase())t.push(1);else if("false"==a.toString.toLowerCase())t.push(0);else{if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;t.push(l)}}for(var r=[],e=0;e<t.length;e++){var a=t[e];luckysheet.func_methods.isRealNum(a)?r.push(parseFloat(a)):"true"==a.toString().toLowerCase()?r.push(1):r.push(0)}return 0===r.length?0:Math.min.apply(Math,r)}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},MEDIAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!0))}else if("object"==luckysheet.getObjType(l)&&null!=l.startCell)t=t.concat(luckysheet.func_methods.getCellDataArr(l,"number",!0));else{if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;t.push(l)}}for(var r=[],e=0;e<t.length;e++){var a=t[e];luckysheet.func_methods.isRealNum(a)&&r.push(parseFloat(a))}return jStat.median(r)}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},MAXA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!1))}else if("object"==luckysheet.getObjType(l)&&null!=l.startCell)t=t.concat(luckysheet.func_methods.getCellDataArr(l,"number",!0));else if("true"==a.toString.toLowerCase())t.push(1);else if("false"==a.toString.toLowerCase())t.push(0);else{if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;t.push(l)}}for(var r=[],e=0;e<t.length;e++){var a=t[e];luckysheet.func_methods.isRealNum(a)?r.push(parseFloat(a)):"true"==a.toString().toLowerCase()?r.push(1):r.push(0)}return 0===r.length?0:Math.max.apply(Math,r)}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},LOGNORM_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseFloat(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);return luckysheet.func_methods.valueIsError(r)?r:luckysheet.func_methods.isRealNum(r)?(r=parseFloat(r),t<=0||1<=t||r<=0?luckysheet.formula.error.nm:jStat.lognormal.inv(t,l,r)):luckysheet.formula.error.v}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},LOGNORM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseFloat(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=luckysheet.func_methods.getCellBoolen(arguments[3]);return luckysheet.func_methods.valueIsError(a)?a:t<=0||r<=0?luckysheet.formula.error.nm:a?jStat.lognormal.cdf(t,l,r):jStat.lognormal.pdf(t,l,r)}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},Z_TEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=[];if("array"==luckysheet.getObjType(arguments[0])){if("array"==luckysheet.getObjType(arguments[0][0])&&!luckysheet.func_methods.isDyadicArr(arguments[0]))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(arguments[0],!0))}else"object"==luckysheet.getObjType(arguments[0])&&null!=arguments[0].startCell?t=t.concat(luckysheet.func_methods.getCellDataArr(arguments[0],"text",!0)):t.push(arguments[0]);for(var l=[],r=0;r<t.length;r++){var a=t[r];luckysheet.func_methods.isRealNum(a)&&l.push(parseFloat(a))}var s=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;if(s=parseFloat(s),0==l.length)return luckysheet.formula.error.na;var n=luckysheet.func_methods.standardDeviation_s(l);if(3==arguments.length){if(n=luckysheet.func_methods.getFirstValue(arguments[2]),luckysheet.func_methods.valueIsError(n))return n;if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;n=parseFloat(n)}var o=l.length,c=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,l);return 1-window.luckysheet_function.NORM_S_DIST.f((c-s)/(n/Math.sqrt(o)),"true")}catch(e){var u=e;return u=luckysheet.formula.errorInfo(u),[luckysheet.formula.error.v,u]}},PROB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=[];if("array"==luckysheet.getObjType(arguments[0])){if("array"==luckysheet.getObjType(arguments[0][0])&&!luckysheet.func_methods.isDyadicArr(arguments[0]))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(arguments[0],!1))}else"object"==luckysheet.getObjType(arguments[0])&&null!=arguments[0].startCell?t=t.concat(luckysheet.func_methods.getCellDataArr(arguments[0],"text",!1)):t.push(arguments[0]);var l=[];if("array"==luckysheet.getObjType(arguments[1])){if("array"==luckysheet.getObjType(arguments[1][0])&&!luckysheet.func_methods.isDyadicArr(arguments[1]))return luckysheet.formula.error.v;l=l.concat(luckysheet.func_methods.getDataArr(arguments[1],!1))}else"object"==luckysheet.getObjType(arguments[1])&&null!=arguments[1].startCell?l=l.concat(luckysheet.func_methods.getCellDataArr(arguments[1],"text",!1)):l.push(arguments[1]);if(t.length!=l.length)return luckysheet.formula.error.na;for(var r=[],a=[],s=0,e=0;e<t.length;e++){var n=t[e],o=l[e];if(luckysheet.func_methods.isRealNum(n)&&luckysheet.func_methods.isRealNum(o)&&(r.push(parseFloat(n)),a.push(parseFloat(o)),s+=parseFloat(o),parseFloat(o)<=0||1<parseFloat(o)))return luckysheet.formula.error.nm}if(1!=s)return luckysheet.formula.error.nm;var c=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(c))return c;if(!luckysheet.func_methods.isRealNum(c))return luckysheet.formula.error.v;var u=c=parseFloat(c);if(4==arguments.length){if(u=luckysheet.func_methods.getFirstValue(arguments[3]),luckysheet.func_methods.valueIsError(u))return u;if(!luckysheet.func_methods.isRealNum(u))return luckysheet.formula.error.v;u=parseFloat(u)}for(var i=0,e=0;e<r.length;e++)r[e]>=c&&r[e]<=u&&(i+=a[e]);return i}catch(e){var h=e;return h=luckysheet.formula.errorInfo(h),[luckysheet.formula.error.v,h]}},QUARTILE_EXC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=[];if("array"==luckysheet.getObjType(arguments[0])){if("array"==luckysheet.getObjType(arguments[0][0])&&!luckysheet.func_methods.isDyadicArr(arguments[0]))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(arguments[0],!0))}else if("object"==luckysheet.getObjType(arguments[0])&&null!=arguments[0].startCell)t=t.concat(luckysheet.func_methods.getCellDataArr(arguments[0],"text",!0));else{if(!luckysheet.func_methods.isRealNum(arguments[0]))return luckysheet.formula.error.v;t.push(arguments[0])}for(var l=[],e=0;e<t.length;e++){var r=t[e];luckysheet.func_methods.isRealNum(r)&&l.push(parseFloat(r))}var a=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;if(a=parseInt(a),0==l.length)return luckysheet.formula.error.nm;if(a<=0||4<=a)return luckysheet.formula.error.nm;switch(a){case 1:return window.luckysheet_function.PERCENTILE_EXC.f(l,.25);case 2:return window.luckysheet_function.PERCENTILE_EXC.f(l,.5);case 3:return window.luckysheet_function.PERCENTILE_EXC.f(l,.75)}}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},QUARTILE_INC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=[];if("array"==luckysheet.getObjType(arguments[0])){if("array"==luckysheet.getObjType(arguments[0][0])&&!luckysheet.func_methods.isDyadicArr(arguments[0]))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(arguments[0],!0))}else if("object"==luckysheet.getObjType(arguments[0])&&null!=arguments[0].startCell)t=t.concat(luckysheet.func_methods.getCellDataArr(arguments[0],"text",!0));else{if(!luckysheet.func_methods.isRealNum(arguments[0]))return luckysheet.formula.error.v;t.push(arguments[0])}for(var l=[],e=0;e<t.length;e++){var r=t[e];luckysheet.func_methods.isRealNum(r)&&l.push(parseFloat(r))}var a=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;if(a=parseInt(a),0==l.length)return luckysheet.formula.error.nm;if(a<0||4<a)return luckysheet.formula.error.nm;switch(a){case 0:return Math.min.apply(Math,l);case 1:return window.luckysheet_function.PERCENTILE_INC.f(l,.25);case 2:return window.luckysheet_function.PERCENTILE_INC.f(l,.5);case 3:return window.luckysheet_function.PERCENTILE_INC.f(l,.75);case 4:return Math.max.apply(Math,l)}}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},POISSON_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseInt(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseFloat(l);var r=luckysheet.func_methods.getCellBoolen(arguments[2]);return luckysheet.func_methods.valueIsError(r)?r:t<0||l<0?luckysheet.formula.error.nm:r?jStat.poisson.cdf(t,l):jStat.poisson.pdf(t,l)}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},RSQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("array"==luckysheet.getObjType(t)){if("array"==luckysheet.getObjType(t[0])&&!luckysheet.func_methods.isDyadicArr(t))return luckysheet.formula.error.v;l=l.concat(luckysheet.func_methods.getDataArr(t,!1))}else if("object"==luckysheet.getObjType(t)&&null!=t.startCell)l=l.concat(luckysheet.func_methods.getCellDataArr(t,"text",!1));else{if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;l.push(t)}var r=arguments[1],a=[];if("array"==luckysheet.getObjType(r)){if("array"==luckysheet.getObjType(r[0])&&!luckysheet.func_methods.isDyadicArr(r))return luckysheet.formula.error.v;a=a.concat(luckysheet.func_methods.getDataArr(r,!1))}else if("object"==luckysheet.getObjType(r)&&null!=r.startCell)a=a.concat(luckysheet.func_methods.getCellDataArr(r,"text",!1));else{if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;a.push(r)}if(l.length!=a.length)return luckysheet.formula.error.na;for(var s=[],n=[],e=0;e<l.length;e++){var o=l[e],c=a[e];luckysheet.func_methods.isRealNum(o)&&luckysheet.func_methods.isRealNum(c)&&(s.push(parseFloat(o)),n.push(parseFloat(c)))}return 0==s.length||0==n.length?luckysheet.formula.error.d:Math.pow(window.luckysheet_function.PEARSON.f(s,n),2)}catch(e){var u=e;return u=luckysheet.formula.errorInfo(u),[luckysheet.formula.error.v,u]}},T_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l);var r=luckysheet.func_methods.getCellBoolen(arguments[2]);return luckysheet.func_methods.valueIsError(r)?r:l<1?luckysheet.formula.error.nm:r?jStat.studentt.cdf(t,l):jStat.studentt.pdf(t,l)}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},T_DIST_2T:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:luckysheet.func_methods.isRealNum(l)?(l=parseInt(l),t<0||l<1?luckysheet.formula.error.nm:2*(1-jStat.studentt.cdf(t,l))):luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},T_DIST_RT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:luckysheet.func_methods.isRealNum(l)?(l=parseInt(l))<1?luckysheet.formula.error.nm:1-jStat.studentt.cdf(t,l):luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},T_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:luckysheet.func_methods.isRealNum(l)?(l=parseInt(l),t<=0||1<t||l<1?luckysheet.formula.error.nm:jStat.studentt.inv(t,l)):luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},T_INV_2T:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:luckysheet.func_methods.isRealNum(l)?(l=parseInt(l),t<=0||1<t||l<1?luckysheet.formula.error.nm:Math.abs(jStat.studentt.inv(t/2,l))):luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},T_TEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=[];if("array"==luckysheet.getObjType(arguments[0])){if("array"==luckysheet.getObjType(arguments[0][0])&&!luckysheet.func_methods.isDyadicArr(arguments[0]))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(arguments[0],!1))}else if("object"==luckysheet.getObjType(arguments[0])&&null!=arguments[0].startCell)t=t.concat(luckysheet.func_methods.getCellDataArr(arguments[0],"text",!1));else{if(!luckysheet.func_methods.isRealNum(arguments[0]))return luckysheet.formula.error.v;t.push(arguments[0])}var l=t,r=[];if("array"==luckysheet.getObjType(arguments[1])){if("array"==luckysheet.getObjType(arguments[1][0])&&!luckysheet.func_methods.isDyadicArr(arguments[1]))return luckysheet.formula.error.v;r=r.concat(luckysheet.func_methods.getDataArr(arguments[1],!1))}else if("object"==luckysheet.getObjType(arguments[1])&&null!=arguments[1].startCell)r=r.concat(luckysheet.func_methods.getCellDataArr(arguments[1],"text",!1));else{if(!luckysheet.func_methods.isRealNum(arguments[1]))return luckysheet.formula.error.v;r.push(arguments[1])}var a=r,s=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseInt(s);var n=luckysheet.func_methods.getFirstValue(arguments[3]);if(luckysheet.func_methods.valueIsError(n))return n;if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;if(n=parseInt(n),-1==[1,2].indexOf(s))return luckysheet.formula.error.nm;if(-1==[1,2,3].indexOf(n))return luckysheet.formula.error.nm;var o,c=null,u=null;if(1==n){for(var i=[],e=0;e<l.length;e++)i.push(l[e]-a[e]);c=Math.abs(jStat.mean(i))/(luckysheet.func_methods.standardDeviation_s(i)/Math.sqrt(l.length)),u=l.length-1}else{var h=jStat.mean(l),d=jStat.mean(a),y=luckysheet.func_methods.variance_s(l),f=luckysheet.func_methods.variance_s(a);switch(c=Math.abs(h-d)/Math.sqrt(y/l.length+f/a.length),n){case 2:u=l.length+a.length-2;break;case 3:u=Math.pow(y/l.length+f/a.length,2)/(Math.pow(y/l.length,2)/(l.length-1)+Math.pow(f/a.length,2)/(a.length-1))}}return 1==s?o=window.luckysheet_function.T_DIST_RT.f(c,u):2==s&&(o=window.luckysheet_function.T_DIST_2T.f(c,u)),o}catch(e){var m=e;return m=luckysheet.formula.errorInfo(m),[luckysheet.formula.error.v,m]}},F_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseInt(r);var a=luckysheet.func_methods.getCellBoolen(arguments[3]);return luckysheet.func_methods.valueIsError(a)?a:t<0||l<1||r<1?luckysheet.formula.error.nm:a?jStat.centralF.cdf(t,l,r):jStat.centralF.pdf(t,l,r)}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},F_DIST_RT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);return luckysheet.func_methods.valueIsError(r)?r:luckysheet.func_methods.isRealNum(r)?(r=parseInt(r),t<0||l<1||r<1?luckysheet.formula.error.nm:1-jStat.centralF.cdf(t,l,r)):luckysheet.formula.error.v}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},VAR_P:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!0))}else if("object"==luckysheet.getObjType(l)&&null!=l.startCell)t=t.concat(luckysheet.func_methods.getCellDataArr(l,"number",!0));else{if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;t.push(l)}}for(var r=[],e=0;e<t.length;e++){var a=t[e];luckysheet.func_methods.isRealNum(a)&&r.push(parseFloat(a))}if(0==r.length)return luckysheet.formula.error.d;for(var s=r.length,n=0,o=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,r),e=0;e<s;e++)n+=Math.pow(r[e]-o,2);return n/s}catch(e){var c=e;return c=luckysheet.formula.errorInfo(c),[luckysheet.formula.error.v,c]}},VAR_S:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!0))}else if("object"==luckysheet.getObjType(l)&&null!=l.startCell)t=t.concat(luckysheet.func_methods.getCellDataArr(l,"number",!0));else{if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;t.push(l)}}for(var r=[],e=0;e<t.length;e++){var a=t[e];luckysheet.func_methods.isRealNum(a)&&r.push(parseFloat(a))}if(0==r.length)return luckysheet.formula.error.d;for(var s=r.length,n=0,o=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,r),e=0;e<s;e++)n+=Math.pow(r[e]-o,2);return n/(s-1)}catch(e){var c=e;return c=luckysheet.formula.errorInfo(c),[luckysheet.formula.error.v,c]}},VARA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!1))}else if("object"==luckysheet.getObjType(l)&&null!=l.startCell)t=t.concat(luckysheet.func_methods.getCellDataArr(l,"number",!0));else if("true"==a.toString.toLowerCase())t.push(1);else if("false"==a.toString.toLowerCase())t.push(0);else{if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;t.push(l)}}for(var r=[],e=0;e<t.length;e++){var a=t[e];luckysheet.func_methods.isRealNum(a)?r.push(parseFloat(a)):"true"==a.toString().toLowerCase()?r.push(1):r.push(0)}for(var s=r.length,n=0,o=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,r),e=0;e<s;e++)n+=Math.pow(r[e]-o,2);return n/(s-1)}catch(e){var c=e;return c=luckysheet.formula.errorInfo(c),[luckysheet.formula.error.v,c]}},VARPA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!1))}else if("object"==luckysheet.getObjType(l)&&null!=l.startCell)t=t.concat(luckysheet.func_methods.getCellDataArr(l,"number",!0));else if("true"==a.toString.toLowerCase())t.push(1);else if("false"==a.toString.toLowerCase())t.push(0);else{if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;t.push(l)}}for(var r=[],e=0;e<t.length;e++){var a=t[e];luckysheet.func_methods.isRealNum(a)?r.push(parseFloat(a)):"true"==a.toString().toLowerCase()?r.push(1):r.push(0)}for(var s=r.length,n=0,o=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,r),e=0;e<s;e++)n+=Math.pow(r[e]-o,2);return n/s}catch(e){var c=e;return c=luckysheet.formula.errorInfo(c),[luckysheet.formula.error.v,c]}},STEYX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=[];if("array"==luckysheet.getObjType(arguments[0])){if("array"==luckysheet.getObjType(arguments[0][0])&&!luckysheet.func_methods.isDyadicArr(arguments[0]))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(arguments[0],!1))}else if("object"==luckysheet.getObjType(arguments[0])&&null!=arguments[0].startCell)t=t.concat(luckysheet.func_methods.getCellDataArr(arguments[0],"text",!1));else{if(!luckysheet.func_methods.isRealNum(arguments[0]))return luckysheet.formula.error.v;t.push(arguments[0])}var l=[];if("array"==luckysheet.getObjType(arguments[1])){if("array"==luckysheet.getObjType(arguments[1][0])&&!luckysheet.func_methods.isDyadicArr(arguments[1]))return luckysheet.formula.error.v;l=l.concat(luckysheet.func_methods.getDataArr(arguments[1],!1))}else if("object"==luckysheet.getObjType(arguments[1])&&null!=arguments[1].startCell)l=l.concat(luckysheet.func_methods.getCellDataArr(arguments[1],"text",!1));else{if(!luckysheet.func_methods.isRealNum(arguments[1]))return luckysheet.formula.error.v;l.push(arguments[1])}if(t.length!=l.length)return luckysheet.formula.error.na;for(var r=[],a=[],e=0;e<t.length;e++){var s=t[e],n=l[e];luckysheet.func_methods.isRealNum(s)&&luckysheet.func_methods.isRealNum(n)&&(r.push(parseFloat(s)),a.push(parseFloat(n)))}if(r.length<3||a.length<3)return luckysheet.formula.error.d;for(var o=jStat.mean(a),c=jStat.mean(r),u=a.length,i=0,h=0,d=0,e=0;e<u;e++)i+=Math.pow(r[e]-c,2),h+=(a[e]-o)*(r[e]-c),d+=Math.pow(a[e]-o,2);return Math.sqrt((i-h*h/d)/(u-2))}catch(e){var y=e;return y=luckysheet.formula.errorInfo(y),[luckysheet.formula.error.v,y]}},STANDARDIZE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseFloat(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);return luckysheet.func_methods.valueIsError(r)?r:luckysheet.func_methods.isRealNum(r)?(r=parseFloat(r))<=0?luckysheet.formula.error.nm:(t-l)/r:luckysheet.formula.error.v}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},SMALL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=[];if("array"==luckysheet.getObjType(arguments[0])){if("array"==luckysheet.getObjType(arguments[0][0])&&!luckysheet.func_methods.isDyadicArr(arguments[0]))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(arguments[0],!0))}else if("object"==luckysheet.getObjType(arguments[0])&&null!=arguments[0].startCell)t=t.concat(luckysheet.func_methods.getCellDataArr(arguments[0],"number",!0));else{if(!luckysheet.func_methods.isRealNum(arguments[0]))return luckysheet.formula.error.v;t.push(arguments[0])}for(var l=[],e=0;e<t.length;e++){var r=t[e];luckysheet.func_methods.isRealNum(r)&&l.push(parseFloat(r))}var a=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(a)?a:luckysheet.func_methods.isRealNum(a)?(a=parseInt(a),0==l.length||a<=0||a>l.length?luckysheet.formula.error.nm:l.sort(function(e,t){return e-t})[a-1]):luckysheet.formula.error.v}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},SLOPE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=[];if("array"==luckysheet.getObjType(arguments[0])){if("array"==luckysheet.getObjType(arguments[0][0])&&!luckysheet.func_methods.isDyadicArr(arguments[0]))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(arguments[0],!1))}else if("object"==luckysheet.getObjType(arguments[0])&&null!=arguments[0].startCell)t=t.concat(luckysheet.func_methods.getCellDataArr(arguments[0],"text",!1));else{if(!luckysheet.func_methods.isRealNum(arguments[0]))return luckysheet.formula.error.v;t.push(arguments[0])}var l=[];if("array"==luckysheet.getObjType(arguments[1])){if("array"==luckysheet.getObjType(arguments[1][0])&&!luckysheet.func_methods.isDyadicArr(arguments[1]))return luckysheet.formula.error.v;l=l.concat(luckysheet.func_methods.getDataArr(arguments[1],!1))}else if("object"==luckysheet.getObjType(arguments[1])&&null!=arguments[1].startCell)l=l.concat(luckysheet.func_methods.getCellDataArr(arguments[1],"text",!1));else{if(!luckysheet.func_methods.isRealNum(arguments[1]))return luckysheet.formula.error.v;l.push(arguments[1])}if(t.length!=l.length)return luckysheet.formula.error.na;for(var r=[],a=[],e=0;e<t.length;e++){var s=t[e],n=l[e];luckysheet.func_methods.isRealNum(s)&&luckysheet.func_methods.isRealNum(n)&&(r.push(parseFloat(s)),a.push(parseFloat(n)))}if(r.length<3||a.length<3)return luckysheet.formula.error.d;for(var o=jStat.mean(a),c=jStat.mean(r),u=a.length,i=0,h=0,e=0;e<u;e++)i+=(a[e]-o)*(r[e]-c),h+=Math.pow(a[e]-o,2);return i/h}catch(e){var d=e;return d=luckysheet.formula.errorInfo(d),[luckysheet.formula.error.v,d]}},SKEW:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!0))}else if("object"==luckysheet.getObjType(l)&&null!=l.startCell)t=t.concat(luckysheet.func_methods.getCellDataArr(l,"number",!0));else{if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;t.push(l)}}for(var r=[],e=0;e<t.length;e++){var a=t[e];luckysheet.func_methods.isRealNum(a)&&r.push(parseFloat(a))}if(r.length<3||0==luckysheet.func_methods.standardDeviation_s(r))return luckysheet.formula.error.d;for(var s=jStat.mean(r),n=r.length,o=0,e=0;e<n;e++)o+=Math.pow(r[e]-s,3);return n*o/((n-1)*(n-2)*Math.pow(jStat.stdev(r,!0),3))}catch(e){var c=e;return c=luckysheet.formula.errorInfo(c),[luckysheet.formula.error.v,c]}},SKEW_P:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=t.concat(luckysheet.func_methods.getDataArr(l,!0))}else if("object"==luckysheet.getObjType(l)&&null!=l.startCell)t=t.concat(luckysheet.func_methods.getCellDataArr(l,"number",!0));else{if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;t.push(l)}}for(var r=[],e=0;e<t.length;e++){var a=t[e];luckysheet.func_methods.isRealNum(a)&&r.push(parseFloat(a))}if(r.length<3||0==luckysheet.func_methods.standardDeviation_s(r))return luckysheet.formula.error.d;for(var s=jStat.mean(r),n=r.length,o=0,c=0,e=0;e<n;e++)c+=Math.pow(r[e]-s,3),o+=Math.pow(r[e]-s,2);return o/=n,(c/=n)/Math.pow(o,1.5)}catch(e){var u=e;return u=luckysheet.formula.errorInfo(u),[luckysheet.formula.error.v,u]}},ADDRESS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseInt(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l);var r=1;if(3<=arguments.length){if(r=luckysheet.func_methods.getFirstValue(arguments[2]),luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseInt(r)}var a,s=!0;if(4<=arguments.length&&(s=luckysheet.func_methods.getCellBoolen(arguments[3]),luckysheet.func_methods.valueIsError(s)))return s;if(t<=0||l<=0)return luckysheet.formula.error.v;if(-1==[1,2,3,4].indexOf(r))return luckysheet.formula.error.v;if(s)switch(l=luckysheet.luckysheetchatatABC(l-1),r){case 1:a="$"+l+"$"+t;break;case 2:a=l+"$"+t;break;case 3:a="$"+l+t;break;case 4:a=l+t}else switch(r){case 1:a="R"+t+"C"+l;break;case 2:a="R"+t+"C["+l+"]";break;case 3:a="R["+t+"]C"+l;break;case 4:a="R["+t+"]C["+l+"]"}if(5!=arguments.length)return a;var n=luckysheet.func_methods.getFirstValue(arguments[4]);return luckysheet.func_methods.valueIsError(n)?n:n+"!"+a}catch(e){var o=e;return o=luckysheet.formula.errorInfo(o),[luckysheet.formula.error.v,o]}},INDIRECT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");if(luckysheet.func_methods.valueIsError(t))return t;var l=!0;if(2==arguments.length&&(l=luckysheet.func_methods.getCellBoolen(arguments[1]),luckysheet.func_methods.valueIsError(l)))return l;if(l){if(/^(([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+))$/g.test(t)){var r=parseInt(t.replace(/[^0-9]/g,""))-1,a=luckysheet.luckysheetABCatNum(t.replace(/[^A-Za-z]/g,""));return r<0||r>=luckysheet.flowdata.length||a<0||a>=luckysheet.flowdata[0].length?luckysheet.formula.error.r:null==luckysheet.flowdata[r][a]||luckysheet.func_methods.isRealNull(luckysheet.flowdata[r][a].v)?0:luckysheet.flowdata[r][a].v}return luckysheet.formula.error.r}if(/^[R][0-9]+[C][0-9]+$/g.test(t)){r=parseInt(t.split("R")[1].split("C")[0]),a=parseInt(t.split("R")[1].split("C")[1]);return r<0||r>=luckysheet.flowdata.length||a<0||a>=luckysheet.flowdata[0].length?luckysheet.formula.error.r:null==luckysheet.flowdata[r][a]||luckysheet.func_methods.isRealNull(luckysheet.flowdata[r][a].v)?0:luckysheet.flowdata[r][a].v}return luckysheet.formula.error.r}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},ROW:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e,t=0;t<arguments.length;t++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[t],t)[0])return luckysheet.formula.error.v}try{return 1!=arguments.length?window.luckysheetCurrentRow+1:"array"==luckysheet.getObjType(arguments[0])?luckysheet.formula.error.v:(e="object"==luckysheet.getObjType(arguments[0])&&null!=arguments[0].startCell?arguments[0].startCell:arguments[0],luckysheet.formula.iscelldata(e)?luckysheet.formula.getcellrange(e).row[0]+1:luckysheet.formula.error.v)}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},ROWS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{return"array"==luckysheet.getObjType(arguments[0])?"array"==luckysheet.getObjType(arguments[0][0])?arguments[0].length:1:"object"==luckysheet.getObjType(arguments[0])&&null!=arguments[0].startCell?arguments[0].rowl:1}catch(e){var t=e;return t=luckysheet.formula.errorInfo(t),[luckysheet.formula.error.v,t]}},COLUMN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e,t=0;t<arguments.length;t++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[t],t)[0])return luckysheet.formula.error.v}try{return 1!=arguments.length?window.luckysheetCurrentColumn+1:"array"==luckysheet.getObjType(arguments[0])?luckysheet.formula.error.v:(e="object"==luckysheet.getObjType(arguments[0])&&null!=arguments[0].startCell?arguments[0].startCell:arguments[0],luckysheet.formula.iscelldata(e)?luckysheet.formula.getcellrange(e).column[0]+1:luckysheet.formula.error.v)}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},COLUMNS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{return"array"==luckysheet.getObjType(arguments[0])?"array"==luckysheet.getObjType(arguments[0][0])?arguments[0][0].length:arguments[0].length:"object"==luckysheet.getObjType(arguments[0])&&null!=arguments[0].startCell?arguments[0].coll:1}catch(e){var t=e;return t=luckysheet.formula.errorInfo(t),[luckysheet.formula.error.v,t]}},OFFSET:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{if("object"!=luckysheet.getObjType(arguments[0])||null==arguments[0].startCell)return luckysheet.formula.error.v;var t=arguments[0].startCell,l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseInt(r);var a=arguments[0].rowl;if(4<=arguments.length){if(a=luckysheet.func_methods.getFirstValue(arguments[3]),luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseInt(a)}var s=arguments[0].coll;if(5==arguments.length){if(s=luckysheet.func_methods.getFirstValue(arguments[4]),luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseInt(s)}if(a<1||s<1)return luckysheet.formula.error.r;var n=luckysheet.formula.getcellrange(t),o=n.row[0],c=n.column[0],u=(o+=l)+a-1,i=(c+=r)+s-1;if(o<0||u>=luckysheet.flowdata.length||c<0||i>=luckysheet.flowdata[0].length)return luckysheet.formula.error.r;for(var h=[],d=o;d<=u;d++){for(var y=[],f=c;f<=i;f++)null==luckysheet.flowdata[d][f]||luckysheet.func_methods.isRealNull(luckysheet.flowdata[d][f].v)?y.push(0):y.push(luckysheet.flowdata[d][f].v);h.push(y)}return h}catch(e){var m=e;return m=luckysheet.formula.errorInfo(m),[luckysheet.formula.error.v,m]}},MATCH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;var l=arguments[1],r=[];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0]))return luckysheet.func_methods.isDyadicArr(l)?luckysheet.formula.error.na:luckysheet.formula.error.v;for(e=0;e<l.length;e++)r.push(l[e])}else if("object"==luckysheet.getObjType(l)&&null!=l.startCell){if(1<l.rowl&&1<l.coll)return luckysheet.formula.error.na;if(null!=l.data)if("array"==luckysheet.getObjType(l.data))for(e=0;e<l.data.length;e++)for(var a=0;a<l.data[e].length;a++)null==l.data[e][a]||luckysheet.func_methods.isRealNull(l.data[e][a].v)||r.push(l.data[e][a].v);else r.push(l.data.v)}var s,n,o=1;if(3==arguments.length){if(o=luckysheet.func_methods.getFirstValue(arguments[2]),luckysheet.func_methods.valueIsError(o))return o;if(!luckysheet.func_methods.isRealNum(o))return luckysheet.formula.error.v;o=Math.ceil(parseFloat(o))}if(-1==[-1,0,1].indexOf(o))return luckysheet.formula.error.na;for(var c=0;c<r.length;c++)if(1===o){if(r[c]===t)return c+1;r[c]<t&&(!n||r[c]>n)&&(s=c+1,n=r[c])}else if(0===o){if("string"==typeof t){if(t=t.replace(/\?/g,"."),r[c].toLowerCase().match(t.toLowerCase()))return c+1}else if(r[c]===t)return c+1}else if(-1===o){if(r[c]===t)return c+1;r[c]>t&&(!n||r[c]<n)&&(s=c+1,n=r[c])}return s||luckysheet.formula.error.na}catch(e){var u=e;return u=luckysheet.formula.errorInfo(u),[luckysheet.formula.error.v,u]}},VLOOKUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");if(luckysheet.func_methods.valueIsError(t))return t;if(""==t.toString().replace(/\s/g,""))return luckysheet.formula.error.na;var l=arguments[1],r=[];if("array"==luckysheet.getObjType(l))if("array"==luckysheet.getObjType(l[0])){if(!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;for(e=0;e<l.length;e++){for(var a=[],s=0;s<l[e].length;s++)a.push(l[e][s]);r.push(a)}}else{for(a=[],e=0;e<l.length;e++)a.push(l[e]);r.push(a)}else{if("object"!=luckysheet.getObjType(l)||null==l.startCell)return luckysheet.formula.error.v;r=luckysheet.func_methods.getCellDataDyadicArr(l,"text")}var n=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(n))return n;if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;n=parseInt(n);var o=!0;if(4==arguments.length&&(o=luckysheet.func_methods.getCellBoolen(arguments[3]),luckysheet.func_methods.valueIsError(o)))return o;if(n<1)return luckysheet.formula.error.v;if(n>r[0].length)return luckysheet.formula.error.r;if(!o){for(var c=null,u=0;u<r.length;u++)if(t.toString()==r[u][0].toString()){c=u;break}return null==c?luckysheet.formula.error.na:r[c][n-1]}r=luckysheet.orderbydata(r,0,!0);for(var u=0;u<r.length;u++){var i,h=r[u][0];if(luckysheet.datecontroll.isdatetime(t)&&luckysheet.datecontroll.isdatetime(h)?i=luckysheet.datecontroll.diff(t,h):luckysheet.func_methods.isRealNum(t)&&luckysheet.func_methods.isRealNum(h)?i=numeral(t).value()-numeral(h).value():luckysheet.func_methods.isRealNum(t)||luckysheet.func_methods.isRealNum(h)?luckysheet.func_methods.isRealNum(t)?luckysheet.func_methods.isRealNum(h)||(i=-1):i=1:i=t.localeCompare(h,"zh"),i<0)return 0==u?luckysheet.formula.error.na:r[u-1][n-1];if(u==r.length-1)return r[u][n-1]}}catch(e){var d=e;return d=luckysheet.formula.errorInfo(d),[luckysheet.formula.error.v,d]}},HLOOKUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{window.luckysheetCurrentRow,window.luckysheetCurrentColumn;var t=arguments[0];"object"==typeof t&&(t=arguments[0].data,"array"==luckysheet.getObjType(t)?(t=t[r],"array"==luckysheet.getObjType(t)&&(t=t[o])):t=t.v);var l=arguments[1].data,a=arguments[2],s=3<arguments.length?!!arguments[3]:!1;if(a>l.rowl)return[luckysheet.formula.error.v,"索引超过了范围的长度，"+l[0].length];if(a<1)return[luckysheet.formula.error.v,"索引必须大于1"];for(var n=luckysheet.formula.error.na,o=0;o<l[0].length;o++){var c=luckysheet.getcellvalue(0,o,l),u=luckysheet.getcellvalue(a-1,o,l);if(s)-1<c.indexOf(t)&&(n=u);else if(luckysheet.formula.acompareb(c,t))return n=u}return n}catch(e){var i=e;return i=luckysheet.formula.errorInfo(i),[luckysheet.formula.error.v,i]}},LOOKUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{window.luckysheetCurrentRow,window.luckysheetCurrentColumn;var t=arguments[0];"object"==typeof t&&(t=arguments[0].data,"array"==luckysheet.getObjType(t)?(t=t[r],"array"==luckysheet.getObjType(t)&&(t=t[c])):t=t.v);var l,a=arguments[1].data,s=luckysheet.formula.error.na;if(a=luckysheet.formula.getRangeArray(a)[0],arguments[2]&&(l=arguments[2].data,l=luckysheet.formula.getRangeArray(l)[0]),"string"==typeof t)for(e=0;e<a.length;e++){var n=a[e];arguments[2]?(u=l[e],n==t&&(s=u)):luckysheet.formula.acompareb(n,t)&&(s=n)}else if("num"==luckysheet.isdatatype(t)){for(var o=[],e=0;e<a.length;e++){var u,n=a[e];if(arguments[2]){if(u=l[e],n==t)return s=u;n!=t&&"num"==luckysheet.isdatatype(n)&&o.push(n)}else{if(n==t)return s=n;n!=t&&"num"==luckysheet.isdatatype(n)&&o.push(n)}}if(0!=o.length){o.push(t),o.sort(function(e,t){return t-e});var i=o.indexOf(t);if(i==o.length-1)return[luckysheet.formula.error.na,"找不到对应参数"];var h=o[i+1];s=arguments[2]?l[e=a.indexOf(h)]:h}}return s}catch(e){var d=e;return d=luckysheet.formula.errorInfo(d),[luckysheet.formula.error.v,d]}},INDEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("array"==luckysheet.getObjType(t)){if("array"==luckysheet.getObjType(t[0])&&!luckysheet.func_methods.isDyadicArr(t))return luckysheet.formula.error.v;l=luckysheet.func_methods.getDataDyadicArr(t)}else"object"==luckysheet.getObjType(t)&&null!=t.startCell&&(l=luckysheet.func_methods.getCellDataDyadicArr(t,"number"));var r=l.length,a=l[0].length,s=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseInt(s);var n=luckysheet.func_methods.getFirstValue(arguments[2]);return luckysheet.func_methods.valueIsError(n)?n:luckysheet.func_methods.isRealNum(n)?(n=parseInt(n),s<=0||n<=0?luckysheet.formula.error.v:r<s||a<n?luckysheet.formula.error.r:l[s-1][n-1]):luckysheet.formula.error.v}catch(e){var o=e;return o=luckysheet.formula.errorInfo(o),[luckysheet.formula.error.v,o]}},GETPIVOTDATA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{return luckysheet.formula.error.v}catch(e){var t=e;return t=luckysheet.formula.errorInfo(t),[luckysheet.formula.error.v,t]}},CHOOSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;if((t=parseInt(t))<1||arguments.length-1<t)return luckysheet.formula.error.v;var l=arguments[t];return"array"==luckysheet.getObjType(l)?"array"!=luckysheet.getObjType(l[0])||luckysheet.func_methods.isDyadicArr(l)?l:luckysheet.formula.error.v:"object"!=luckysheet.getObjType(l)||null==l.startCell?l:null==l.data?0:"array"!=luckysheet.getObjType(l.data)?luckysheet.func_methods.isRealNull(l.data.v)?0:l.data.v:luckysheet.func_methods.getCellDataDyadicArr(l.data,"number")}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},HYPERLINK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{return luckysheet.formula.error.v}catch(e){var t=e;return t=luckysheet.formula.errorInfo(t),[luckysheet.formula.error.v,t]}},TIME:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseInt(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;if(r=parseInt(r),t<0||32767<t)return luckysheet.formula.error.nm;if(24<t&&(t%=24),l<0||32767<l)return luckysheet.formula.error.nm;if(r<0||32767<r)return luckysheet.formula.error.nm;var a=moment().set({hour:t,minute:l,second:r});return moment(a).format("h:mm:ss a")}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},TIMEVALUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:moment(t).isValid()?(3600*moment(t).get("hour")+60*moment(t).get("minute")+moment(t).get("second"))/86400:luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},EOMONTH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;if(l=parseInt(l),!moment(t).isValid())return luckysheet.formula.error.v;var r=moment(t).add(l+1,"months").set("date",1).subtract(1,"days");return luckysheet.mask.genarate(moment(r).format("YYYY-MM-DD H:mm:ss"))[2]}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},EDATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;if(l=parseInt(l),!moment(t).isValid())return luckysheet.formula.error.v;var r=moment(t).add(l,"months");return luckysheet.mask.genarate(moment(r).format("YYYY-MM-DD h:mm:ss"))[2]}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},SECOND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:moment(t).isValid()?moment(t).seconds():luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},MINUTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:moment(t).isValid()?moment(t).minutes():luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},HOUR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:moment(t).isValid()?moment(t).hours():luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},NOW:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{return moment().format("YYYY-M-D HH:mm")}catch(e){var t=e;return t=luckysheet.formula.errorInfo(t),[luckysheet.formula.error.v,t]}},NETWORKDAYS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{return 3==arguments.length?window.luckysheet_function.NETWORKDAYS_INTL.f(arguments[0],arguments[1],1,arguments[2]):window.luckysheet_function.NETWORKDAYS_INTL.f(arguments[0],arguments[1],1)}catch(e){var t=e;return t=luckysheet.formula.errorInfo(t),[luckysheet.formula.error.v,t]}},NETWORKDAYS_INTL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]],l=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(l))return l;if(!moment(l).isValid())return luckysheet.formula.error.v;var r=luckysheet.func_methods.getCellDate(arguments[1]);if(luckysheet.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return luckysheet.formula.error.v;var a=t[1];if(3<=arguments.length&&("string"!=typeof(a=arguments[2])||"7"!=a.length||!/^[0-1]{7}$/g.test(a))){if(a=luckysheet.func_methods.getFirstValue(arguments[2]),luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;if((a=parseInt(a))<1||7<a&&a<11||17<a)return luckysheet.formula.error.nm;a=t[a]}var s=[];if(4==arguments.length&&(s=luckysheet.func_methods.getCellrangeDate(arguments[3]),luckysheet.func_methods.valueIsError(s)))return s;for(e=0;e<s.length;e++)if(!moment(s[e]).isValid())return luckysheet.formula.error.v;var n=moment(r).diff(moment(l),"days")+1,o=n,c=moment(l);for(e=0;e<n;e++){var u=moment(c).weekday(),i=!1;"array"==luckysheet.getObjType(a)?u!==a[0]&&u!==a[1]||(i=!0):(0==u&&(u=7),"0"==a.charAt(u-1)&&(i=!0));for(var h=0;h<s.length;h++)if(0===moment(c).diff(moment(s[h]),"days")){i=!0;break}i&&o--,c=moment(c).add(1,"days")}return o}catch(e){var d=e;return d=luckysheet.formula.errorInfo(d),[luckysheet.formula.error.v,d]}},ISOWEEKNUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:moment(t).isValid()?moment(t).isoWeeks():luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},WEEKNUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=[void 0,7,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,7],l=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(l))return l;if(!moment(l).isValid())return luckysheet.formula.error.v;var r=1;if(2==arguments.length){if(r=luckysheet.func_methods.getFirstValue(arguments[1]),luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseInt(r)}if(21==r)return window.luckysheet_function.ISOWEEKNUM.f(arguments[0]);if(-1==[1,2,11,12,13,14,15,16,17].indexOf(r))return luckysheet.formula.error.nm;var a=t[r],s=moment(l).isoWeekday()>=a?1:0;return moment(l).isoWeeks()+s}catch(e){var n=e;return n=luckysheet.formula.errorInfo(n),[luckysheet.formula.error.v,n]}},WEEKDAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return luckysheet.formula.error.v;var l=1;if(2==arguments.length){if(l=luckysheet.func_methods.getFirstValue(arguments[1]),luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l)}return-1==[1,2,3,11,12,13,14,15,16,17].indexOf(l)?luckysheet.formula.error.nm:[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]][l][moment(t).day()]}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},DAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:moment(t).isValid()?moment(t).date():luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},DAYS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return luckysheet.formula.error.v;var l=luckysheet.func_methods.getCellDate(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:moment(l).isValid()?moment(t).diff(moment(l),"days"):luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},DAYS360:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return luckysheet.formula.error.v;var l=luckysheet.func_methods.getCellDate(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!moment(l).isValid())return luckysheet.formula.error.v;var r=!1;if(3==arguments.length&&(r=luckysheet.func_methods.getCellBoolen(arguments[2]),luckysheet.func_methods.valueIsError(r)))return r;var a,s,n,o,c=moment(t).month(),u=moment(l).month();return o=r?(n=31===moment(t).date()?30:moment(t).date(),31===moment(l).date()?30:moment(l).date()):(a=moment().set({year:moment(t).year(),month:c+1,date:0}).date(),s=moment().set({year:moment(l).year(),month:u+1,date:0}).date(),n=moment(t).date()===a?30:moment(t).date(),moment(l).date()===s?n<30?(u++,1):30:moment(l).date()),360*moment(l).diff(moment(t),"years")+30*(u-c)+(o-n)}catch(e){var i=e;return i=luckysheet.formula.errorInfo(i),[luckysheet.formula.error.v,i]}},DATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseInt(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;if(r=parseInt(r),t<0||1e4<=t)return luckysheet.formula.error.nm;0<=t&&t<=1899&&(t+=1900);var a=moment().set({year:t,month:l-1,date:r});return moment(a).year()<1900?luckysheet.formula.error.nm:moment(a).format("YYYY-MM-DD")}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},DATEVALUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:moment(t).isValid()?(t=moment(t).format("YYYY-MM-DD"),luckysheet.mask.genarate(t)[2]):luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},DATEDIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{luckysheet_getValue(arguments);for(e=0;e<arguments.length-1;e++)if(arguments[e]=moment.fromOADate(arguments[e]).format("l"),!luckysheet.datecontroll.isdatetime(arguments[e]))return luckysheet.formula.error.v;var t=moment(arguments[0]),l=moment(arguments[1]),r=arguments[2],a=luckysheet.formula.error.v;if(luckysheet_function.DAYS.f(l,t)<0)return luckysheet.formula.error.v;switch(r){case"Y":case"y":a=l.diff(t,"years",!1);break;case"M":case"m":a=l.diff(t,"months",!1);break;case"D":case"d":a=l.diff(t,"days",!1);break;case"MD":case"md":a=l.format("DD")-t.format("DD");break;case"YM":case"ym":var s,n,a=(s=parseInt(t.format("M")))<=(n=parseInt(l.format("M")))?n-s:n+12-s;break;case"YD":case"yd":a=(s=luckysheet.mask.genarate(t.format("MM-DD"))[2])<=(n=luckysheet.mask.genarate(l.format("MM-DD"))[2])?n-s:n+365-s;break;default:a=luckysheet.formula.error.v}return a}catch(e){var o=e;return o=luckysheet.formula.errorInfo(o),[luckysheet.formula.error.v,o]}},WORKDAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{return 3==arguments.length?window.luckysheet_function.WORKDAY_INTL.f(arguments[0],arguments[1],1,arguments[2]):window.luckysheet_function.WORKDAY_INTL.f(arguments[0],arguments[1],1)}catch(e){var t=e;return t=luckysheet.formula.errorInfo(t),[luckysheet.formula.error.v,t]}},WORKDAY_INTL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]],l=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(l))return l;if(!moment(l).isValid())return luckysheet.formula.error.v;var r=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseInt(r);var a=t[1];if(3<=arguments.length&&("string"!=typeof(a=arguments[2])||"7"!=a.length||!/^[0-1]{7}$/g.test(a))){if(a=luckysheet.func_methods.getFirstValue(arguments[2]),luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;if((a=parseInt(a))<1||7<a&&a<11||17<a)return luckysheet.formula.error.nm;a=t[a]}var s=[];if(4==arguments.length&&(s=luckysheet.func_methods.getCellrangeDate(arguments[3]),luckysheet.func_methods.valueIsError(s)))return s;for(e=0;e<s.length;e++)if(!moment(s[e]).isValid())return luckysheet.formula.error.v;for(var n=0;n<r;){l=moment(l).add(1,"days");var o=moment(l).weekday();if(luckysheet.getObjType(a)){if(o===a[0]||o===a[1])continue}else if(0==o&&(o=7),"0"==a.charAt(o-1))continue;for(var c=0;c<s.length;c++)if(0===moment(l).diff(moment(s[c]),"days")){n--;break}n++}return moment(l).format("YYYY-MM-DD")}catch(e){var u=e;return u=luckysheet.formula.errorInfo(u),[luckysheet.formula.error.v,u]}},YEAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:moment(t).isValid()?moment(t).year():luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},YEARFRAC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return luckysheet.formula.error.v;var l=luckysheet.func_methods.getCellDate(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!moment(l).isValid())return luckysheet.formula.error.v;var r=0;if(3==arguments.length){if(r=luckysheet.func_methods.getFirstValue(arguments[2]),luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseInt(r)}if(r<0||4<r)return luckysheet.formula.error.nm;var a=moment(t).date(),s=moment(t).month()+1,n=moment(t).year(),o=moment(l).date(),c=moment(l).month()+1,u=moment(l).year();switch(r){case 0:31===a&&31===o?o=a=30:31===a?a=30:30===a&&31===o&&(o=30),y=(o+30*c+360*u-(a+30*s+360*n))/360;break;case 1:var i=365;if(n===u||n+1===u&&(c<s||s===c&&o<=a))return(n===u&&luckysheet.func_methods.isLeapYear(n)||luckysheet.func_methods.feb29Between(t,l)||1===c&&29===o)&&(i=366),moment(l).diff(moment(t),"days")/i;var h=u-n+1,d=(moment().set({year:u+1,month:0,date:1})-moment().set({year:n,month:0,date:1}))/1e3/60/60/24/h,y=moment(l).diff(moment(t),"days")/d;break;case 2:y=moment(l).diff(moment(t),"days")/360;break;case 3:y=moment(l).diff(moment(t),"days")/365;break;case 4:y=(o+30*c+360*u-(a+30*s+360*n))/360}return y}catch(e){var f=e;return f=luckysheet.formula.errorInfo(f),[luckysheet.formula.error.v,f]}},TODAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{return moment().format("YYYY-MM-DD")}catch(e){var t=e;return t=luckysheet.formula.errorInfo(t),[luckysheet.formula.error.v,t]}},MONTH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:moment(t).isValid()?moment(t).month()+1:luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},EFFECT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:luckysheet.func_methods.isRealNum(l)?(l=parseInt(l),t<=0||l<1?luckysheet.formula.error.nm:Math.pow(1+t/l,l)-1):luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},DOLLAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=2;if(2==arguments.length){if(l=luckysheet.func_methods.getFirstValue(arguments[1]),luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l)}9<l&&(l=9);for(e=1;e<=l;e++)0;return(0<t?1:-1)*Math.floor(Math.abs(t)*Math.pow(10,l))/Math.pow(10,l)}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},DOLLARDE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;if((l=parseInt(l))<0)return luckysheet.formula.error.nm;if(0==l)return luckysheet.formula.error.d;var r=parseInt(t,10);r+=t%1*Math.pow(10,Math.ceil(Math.log(l)/Math.LN10))/l;var a=Math.pow(10,Math.ceil(Math.log(l)/Math.LN2)+1);return r=Math.round(r*a)/a}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},DOLLARFR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;if((l=parseInt(l))<0)return luckysheet.formula.error.nm;if(0==l)return luckysheet.formula.error.d;var r=parseInt(t,10);return r+=t%1*Math.pow(10,-Math.ceil(Math.log(l)/Math.LN10))*l}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},DB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseFloat(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=luckysheet.func_methods.getFirstValue(arguments[3]);if(luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseInt(a);var s=12;if(5==arguments.length){if(s=luckysheet.func_methods.getFirstValue(arguments[4]),luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseInt(s)}if(t<0||l<0||r<0||a<0)return luckysheet.formula.error.nm;if(s<1||12<s)return luckysheet.formula.error.nm;if(r<a)return luckysheet.formula.error.nm;if(t<=l)return 0;for(var n=(1-Math.pow(l/t,1/r)).toFixed(3),o=t*n*s/12,c=o,u=0,i=a===r?r-1:a,e=2;e<=i;e++)c+=u=(t-c)*n;return 1===a?o:a===r?(t-c)*n:u}catch(e){var h=e;return h=luckysheet.formula.errorInfo(h),[luckysheet.formula.error.v,h]}},DDB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseFloat(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=luckysheet.func_methods.getFirstValue(arguments[3]);if(luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseInt(a);var s=2;if(5==arguments.length){if(s=luckysheet.func_methods.getFirstValue(arguments[4]),luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseFloat(s)}if(t<0||l<0||r<0||a<0||s<=0)return luckysheet.formula.error.nm;if(r<a)return luckysheet.formula.error.nm;if(t<=l)return 0;for(var n=0,o=0,e=1;e<=a;e++)n+=o=Math.min(s/r*(t-n),t-l-n);return o}catch(e){var c=e;return c=luckysheet.formula.errorInfo(c),[luckysheet.formula.error.v,c]}},RATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseFloat(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=0;if(4<=arguments.length){if(a=luckysheet.func_methods.getFirstValue(arguments[3]),luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseFloat(a)}var s=0;if(5<=arguments.length){if(s=luckysheet.func_methods.getFirstValue(arguments[4]),luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseFloat(s)}var n=.1;if(6==arguments.length){if(n=luckysheet.func_methods.getFirstValue(arguments[5]),luckysheet.func_methods.valueIsError(n))return n;if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;n=parseFloat(n)}if(0!=s&&1!=s)return luckysheet.formula.error.nm;for(var o=0,c=!1,u=n;o<100&&!c;){var i=Math.pow(u+1,t),h=Math.pow(u+1,t-1),d=u-(a+i*r+l*(i-1)*(u*s+1)/u)/(t*h*r-l*(i-1)*(u*s+1)/Math.pow(u,2)+(t*l*h*(u*s+1)/u+l*(i-1)*s/u));Math.abs(d-u)<1e-6&&(c=!0),o++,u=d}return c?u:luckysheet.formula.error.nm}catch(e){var y=e;return y=luckysheet.formula.errorInfo(y),[luckysheet.formula.error.v,y]}},CUMPRINC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseFloat(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=luckysheet.func_methods.getFirstValue(arguments[3]);if(luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseInt(a);var s=luckysheet.func_methods.getFirstValue(arguments[4]);if(luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseInt(s);var n=luckysheet.func_methods.getFirstValue(arguments[5]);if(luckysheet.func_methods.valueIsError(n))return n;if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;if(n=parseFloat(n),t<=0||l<=0||r<=0)return luckysheet.formula.error.nm;if(a<1||s<1||s<a)return luckysheet.formula.error.nm;if(0!=n&&1!=n)return luckysheet.formula.error.nm;var o=window.luckysheet_function.PMT.f(t,l,r,0,n),c=0;1===a&&(c=0===n?o+r*t:o,a++);for(e=a;e<=s;e++)c+=0<n?o-(window.luckysheet_function.FV.f(t,e-2,o,r,1)-o)*t:o-window.luckysheet_function.FV.f(t,e-1,o,r,0)*t;return c}catch(e){var u=e;return u=luckysheet.formula.errorInfo(u),[luckysheet.formula.error.v,u]}},COUPNUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return luckysheet.formula.error.v;var l=luckysheet.func_methods.getCellDate(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!moment(l).isValid())return luckysheet.formula.error.v;var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseInt(r);var a=0;if(4==arguments.length){a=luckysheet.func_methods.getFirstValue(arguments[3]);if(luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseInt(a)}if(1!=r&&2!=r&&4!=r)return luckysheet.formula.error.nm;if(a<0||4<a)return luckysheet.formula.error.nm;if(0<=moment(t)-moment(l))return luckysheet.formula.error.nm;var s=moment(t).date(),n=moment(t).month()+1,o=moment(t).year(),c=moment(l).date(),u=moment(l).month()+1,i=moment(l).year();switch(a){case 0:31===s&&31===c?c=s=30:31===s?s=30:30===s&&31===c&&(c=30),f=(c+30*u+360*i-(s+30*n+360*o))/(360/r);break;case 1:var h=365;if(o===i||o+1===i&&(u<n||n===u&&c<=s))return(o===i&&luckysheet.func_methods.isLeapYear(o)||luckysheet.func_methods.feb29Between(t,l)||1===u&&29===c)&&(h=366),moment(l).diff(moment(t),"days")/(h/r);var d=i-o+1,y=(moment().set({year:i+1,month:0,date:1})-moment().set({year:o,month:0,date:1}))/1e3/60/60/24/d,f=moment(l).diff(moment(t),"days")/(y/r);break;case 2:f=moment(l).diff(moment(t),"days")/(360/r);break;case 3:f=moment(l).diff(moment(t),"days")/(365/r);break;case 4:f=(c+30*u+360*i-(s+30*n+360*o))/(360/r)}return Math.round(f)}catch(e){var m=e;return m=luckysheet.formula.errorInfo(m),[luckysheet.formula.error.v,m]}},SYD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseFloat(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=luckysheet.func_methods.getFirstValue(arguments[3]);return luckysheet.func_methods.valueIsError(a)?a:luckysheet.func_methods.isRealNum(a)?(a=parseInt(a),0==r||a<1||r<a?luckysheet.formula.error.nm:(t-l)*(r-a+1)*2/(r*(r+1))):luckysheet.formula.error.v}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},TBILLEQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return luckysheet.formula.error.v;var l=luckysheet.func_methods.getCellDate(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!moment(l).isValid())return luckysheet.formula.error.v;var r=luckysheet.func_methods.getFirstValue(arguments[2]);return luckysheet.func_methods.valueIsError(r)?r:luckysheet.func_methods.isRealNum(r)?(r=parseFloat(r))<=0||0<moment(t)-moment(l)||31536e6<moment(l)-moment(t)?luckysheet.formula.error.nm:365*r/(360-r*moment(l).diff(moment(t),"days")):luckysheet.formula.error.v}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},TBILLYIELD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return luckysheet.formula.error.v;var l=luckysheet.func_methods.getCellDate(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!moment(l).isValid())return luckysheet.formula.error.v;var r=luckysheet.func_methods.getFirstValue(arguments[2]);return luckysheet.func_methods.valueIsError(r)?r:luckysheet.func_methods.isRealNum(r)?(r=parseFloat(r))<=0||0<=moment(t)-moment(l)||31536e6<moment(l)-moment(t)?luckysheet.formula.error.nm:(100-r)/r*(360/moment(l).diff(moment(t),"days")):luckysheet.formula.error.v}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},TBILLPRICE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return luckysheet.formula.error.v;var l=luckysheet.func_methods.getCellDate(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!moment(l).isValid())return luckysheet.formula.error.v;var r=luckysheet.func_methods.getFirstValue(arguments[2]);return luckysheet.func_methods.valueIsError(r)?r:luckysheet.func_methods.isRealNum(r)?(r=parseFloat(r))<=0||0<moment(t)-moment(l)||31536e6<moment(l)-moment(t)?luckysheet.formula.error.nm:100*(1-r*moment(l).diff(moment(t),"days")/360):luckysheet.formula.error.v}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},PV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseFloat(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=0;if(4<=arguments.length){if(a=luckysheet.func_methods.getFirstValue(arguments[3]),luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseFloat(a)}var s=0;if(5<=arguments.length){if(s=luckysheet.func_methods.getFirstValue(arguments[4]),luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseFloat(s)}return 0!=s&&1!=s?luckysheet.formula.error.nm:0===t?-r*l-a:((1-Math.pow(1+t,l))/t*r*(1+t*s)-a)/Math.pow(1+t,l)}catch(e){var n=e;return n=luckysheet.formula.errorInfo(n),[luckysheet.formula.error.v,n]}},ACCRINT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return luckysheet.formula.error.v;var l=luckysheet.func_methods.getCellDate(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!moment(l).isValid())return luckysheet.formula.error.v;var r=luckysheet.func_methods.getCellDate(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return luckysheet.formula.error.v;var a=luckysheet.func_methods.getFirstValue(arguments[3]);if(luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseFloat(a);var s=luckysheet.func_methods.getFirstValue(arguments[4]);if(luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseFloat(s);var n=luckysheet.func_methods.getFirstValue(arguments[5]);if(luckysheet.func_methods.valueIsError(n))return n;if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;n=parseInt(n);var o=0;if(7<=arguments.length){if(o=luckysheet.func_methods.getFirstValue(arguments[6]),luckysheet.func_methods.valueIsError(o))return o;if(!luckysheet.func_methods.isRealNum(o))return luckysheet.formula.error.v;o=parseInt(o)}var c=!0;if(8==arguments.length&&(c=luckysheet.func_methods.getCellBoolen(arguments[7]),luckysheet.func_methods.valueIsError(c)))return c;if(a<=0||s<=0)return luckysheet.formula.error.nm;if(1!=n&&2!=n&&4!=n)return luckysheet.formula.error.nm;if(o<0||4<o)return luckysheet.formula.error.nm;if(0<=moment(t)-moment(r))return luckysheet.formula.error.nm;if(0<=moment(r)-moment(l)&&!c){var u=moment(l).date(),i=moment(l).month()+1,h=moment(l).year(),d=moment(r).date(),y=moment(r).month()+1,f=moment(r).year();switch(o){case 0:31===u&&31===d?d=u=30:31===u?u=30:30===u&&31===d&&(d=30),g=(d+30*y+360*f-(u+30*i+360*h))/360;break;case 1:var m=365;if(h===f||h+1===f&&(y<i||i===y&&d<=u))return(h===f&&luckysheet.func_methods.isLeapYear(h)||luckysheet.func_methods.feb29Between(l,r)||1===y&&29===d)&&(m=366),moment(r).diff(moment(l),"days")/m;var k=f-h+1,p=(moment().set({year:f+1,month:0,date:1})-moment().set({year:h,month:0,date:1}))/1e3/60/60/24/k,g=moment(r).diff(moment(l),"days")/p;break;case 2:g=moment(r).diff(moment(l),"days")/360;break;case 3:g=moment(r).diff(moment(l),"days")/365;break;case 4:g=(d+30*y+360*f-(u+30*i+360*h))/360}}else{u=moment(t).date(),i=moment(t).month()+1,h=moment(t).year(),d=moment(r).date(),y=moment(r).month()+1,f=moment(r).year();switch(o){case 0:31===u&&31===d?d=u=30:31===u?u=30:30===u&&31===d&&(d=30),g=(d+30*y+360*f-(u+30*i+360*h))/360;break;case 1:m=365;if(h===f||h+1===f&&(y<i||i===y&&d<=u))return(h===f&&luckysheet.func_methods.isLeapYear(h)||luckysheet.func_methods.feb29Between(t,r)||1===y&&29===d)&&(m=366),moment(r).diff(moment(t),"days")/m;k=f-h+1,p=(moment().set({year:f+1,month:0,date:1})-moment().set({year:h,month:0,date:1}))/1e3/60/60/24/k;g=moment(r).diff(moment(t),"days")/p;break;case 2:g=moment(r).diff(moment(t),"days")/360;break;case 3:g=moment(r).diff(moment(t),"days")/365;break;case 4:g=(d+30*y+360*f-(u+30*i+360*h))/360}}return s*a*g}catch(e){var v=e;return v=luckysheet.formula.errorInfo(v),[luckysheet.formula.error.v,v]}},ACCRINTM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return luckysheet.formula.error.v;var l=luckysheet.func_methods.getCellDate(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!moment(l).isValid())return luckysheet.formula.error.v;var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=luckysheet.func_methods.getFirstValue(arguments[3]);if(luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseFloat(a);var s=0;if(5==arguments.length){if(s=luckysheet.func_methods.getFirstValue(arguments[4]),luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseInt(s)}if(r<=0||a<=0)return luckysheet.formula.error.nm;if(s<0||4<s)return luckysheet.formula.error.nm;if(0<=moment(t)-moment(l))return luckysheet.formula.error.nm;var n=moment(t).date(),o=moment(t).month()+1,c=moment(t).year(),u=moment(l).date(),i=moment(l).month()+1,h=moment(l).year();switch(s){case 0:31===n&&31===u?u=n=30:31===n?n=30:30===n&&31===u&&(u=30),m=(u+30*i+360*h-(n+30*o+360*c))/360;break;case 1:var d=365;if(c===h||c+1===h&&(i<o||o===i&&u<=n))return(c===h&&luckysheet.func_methods.isLeapYear(c)||luckysheet.func_methods.feb29Between(t,l)||1===i&&29===u)&&(d=366),moment(l).diff(moment(t),"days")/d;var y=h-c+1,f=(moment().set({year:h+1,month:0,date:1})-moment().set({year:c,month:0,date:1}))/1e3/60/60/24/y,m=moment(l).diff(moment(t),"days")/f;break;case 2:m=moment(l).diff(moment(t),"days")/360;break;case 3:m=moment(l).diff(moment(t),"days")/365;break;case 4:m=(u+30*i+360*h-(n+30*o+360*c))/360}return a*r*m}catch(e){var k=e;return k=luckysheet.formula.errorInfo(k),[luckysheet.formula.error.v,k]}},COUPDAYBS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return luckysheet.formula.error.v;var l=luckysheet.func_methods.getCellDate(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!moment(l).isValid())return luckysheet.formula.error.v;var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseInt(r);var a,s=0;if(4==arguments.length){if(s=luckysheet.func_methods.getFirstValue(arguments[3]),luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseInt(s)}if(1!=r&&2!=r&&4!=r)return luckysheet.formula.error.nm;if(s<0||4<s)return luckysheet.formula.error.nm;if(0<=moment(t)-moment(l))return luckysheet.formula.error.nm;for(var n=Math.ceil(moment(l).diff(moment(t),"months")/(12/r))+1,e=1;e<=n;e++){var o=moment(l).subtract(12/r*e,"months");if(o<=moment(t)){a=o;break}}switch(s){case 0:var c=moment(a).date(),u=moment(a).month()+1,i=moment(a).year(),h=moment(t).date(),d=moment(t).month()+1,y=moment(t).year();31===c&&31===h?h=c=30:31===c?c=30:30===c&&31===h&&(h=30),f=h+30*d+360*y-(c+30*u+360*i);break;case 1:case 2:case 3:f=moment(t).diff(moment(a),"days");break;case 4:var c=moment(a).date(),u=moment(a).month()+1,i=moment(a).year(),f=(h=moment(t).date())+30*(d=moment(t).month()+1)+360*(y=moment(t).year())-(c+30*u+360*i)}return f}catch(e){var m=e;return m=luckysheet.formula.errorInfo(m),[luckysheet.formula.error.v,m]}},COUPDAYS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return luckysheet.formula.error.v;var l=luckysheet.func_methods.getCellDate(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!moment(l).isValid())return luckysheet.formula.error.v;var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseInt(r);var a=0;if(4==arguments.length){if(a=luckysheet.func_methods.getFirstValue(arguments[3]),luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseInt(a)}if(1!=r&&2!=r&&4!=r)return luckysheet.formula.error.nm;if(a<0||4<a)return luckysheet.formula.error.nm;if(0<=moment(t)-moment(l))return luckysheet.formula.error.nm;switch(a){case 0:c=360/r;break;case 1:for(var s=Math.ceil(moment(l).diff(moment(t),"months")/(12/r))+1,e=1;e<=s;e++){var n=moment(l).subtract(12/r*e,"months");if(n<=moment(t)){var o=moment(l).subtract(12/r*(e-1),"months"),c=moment(o).diff(moment(n),"days");break}}break;case 2:c=360/r;break;case 3:c=365/r;break;case 4:c=360/r}return c}catch(e){var u=e;return u=luckysheet.formula.errorInfo(u),[luckysheet.formula.error.v,u]}},COUPDAYSNC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return luckysheet.formula.error.v;var l=luckysheet.func_methods.getCellDate(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!moment(l).isValid())return luckysheet.formula.error.v;var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseInt(r);var a,s=0;if(4==arguments.length){if(s=luckysheet.func_methods.getFirstValue(arguments[3]),luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseInt(s)}if(1!=r&&2!=r&&4!=r)return luckysheet.formula.error.nm;if(s<0||4<s)return luckysheet.formula.error.nm;if(0<=moment(t)-moment(l))return luckysheet.formula.error.nm;for(var n=Math.ceil(moment(l).diff(moment(t),"months")/(12/r))+1,e=1;e<=n;e++){if(moment(l).subtract(12/r*e,"months")<=moment(t)){a=moment(l).subtract(12/r*(e-1),"months");break}}switch(s){case 0:var o=moment(t).date(),c=moment(t).month()+1,u=moment(t).year(),i=moment(a).date(),h=moment(a).month()+1,d=moment(a).year();31===o&&31===i?i=o=30:31===o?o=30:30===o&&31===i&&(i=30),y=i+30*h+360*d-(o+30*c+360*u);break;case 1:case 2:case 3:y=moment(a).diff(moment(t),"days");break;case 4:var o=moment(t).date(),c=moment(t).month()+1,u=moment(t).year(),y=(i=moment(a).date())+30*(h=moment(a).month()+1)+360*(d=moment(a).year())-(o+30*c+360*u)}return y}catch(e){var f=e;return f=luckysheet.formula.errorInfo(f),[luckysheet.formula.error.v,f]}},COUPNCD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return luckysheet.formula.error.v;var l=luckysheet.func_methods.getCellDate(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!moment(l).isValid())return luckysheet.formula.error.v;var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseInt(r);var a,s=0;if(4==arguments.length){if(s=luckysheet.func_methods.getFirstValue(arguments[3]),luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseInt(s)}if(1!=r&&2!=r&&4!=r)return luckysheet.formula.error.nm;if(s<0||4<s)return luckysheet.formula.error.nm;if(0<=moment(t)-moment(l))return luckysheet.formula.error.nm;for(var n=Math.ceil(moment(l).diff(moment(t),"months")/(12/r))+1,e=1;e<=n;e++){if(moment(l).subtract(12/r*e,"months")<=moment(t)){a=moment(l).subtract(12/r*(e-1),"months");break}}return moment(a).format("YYYY-MM-DD")}catch(e){var o=e;return o=luckysheet.formula.errorInfo(o),[luckysheet.formula.error.v,o]}},COUPPCD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return luckysheet.formula.error.v;var l=luckysheet.func_methods.getCellDate(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!moment(l).isValid())return luckysheet.formula.error.v;var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseInt(r);var a,s=0;if(4==arguments.length){if(s=luckysheet.func_methods.getFirstValue(arguments[3]),luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseInt(s)}if(1!=r&&2!=r&&4!=r)return luckysheet.formula.error.nm;if(s<0||4<s)return luckysheet.formula.error.nm;if(0<=moment(t)-moment(l))return luckysheet.formula.error.nm;for(var n=Math.ceil(moment(l).diff(moment(t),"months")/(12/r))+1,e=1;e<=n;e++){var o=moment(l).subtract(12/r*e,"months");if(o<=moment(t)){a=o;break}}return moment(a).format("YYYY-MM-DD")}catch(e){var c=e;return c=luckysheet.formula.errorInfo(c),[luckysheet.formula.error.v,c]}},FV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseFloat(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=0;if(4<=arguments.length){if(a=luckysheet.func_methods.getFirstValue(arguments[3]),luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseFloat(a)}var s,n=0;if(5<=arguments.length){if(n=luckysheet.func_methods.getFirstValue(arguments[4]),luckysheet.func_methods.valueIsError(n))return n;if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;n=parseFloat(n)}return 0!=n&&1!=n?luckysheet.formula.error.nm:-(0===t?a+r*l:(s=Math.pow(1+t,l),1===n?a*s+r*(1+t)*(s-1)/t:a*s+r*(s-1)/t))}catch(e){var o=e;return o=luckysheet.formula.errorInfo(o),[luckysheet.formula.error.v,o]}},FVSCHEDULE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=arguments[1],r=[];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;r=r.concat(luckysheet.func_methods.getDataArr(l,!1))}else"object"==luckysheet.getObjType(l)&&null!=l.startCell?r=r.concat(luckysheet.func_methods.getCellDataArr(l,"number",!1)):r.push(l);for(var a=[],e=0;e<r.length;e++){var s=r[e];if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;a.push(parseFloat(s))}for(var n=a.length,o=t,e=0;e<n;e++)o*=1+a[e];return o}catch(e){var c=e;return c=luckysheet.formula.errorInfo(c),[luckysheet.formula.error.v,c]}},YIELD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return luckysheet.formula.error.v;var l=luckysheet.func_methods.getCellDate(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!moment(l).isValid())return luckysheet.formula.error.v;var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=luckysheet.func_methods.getFirstValue(arguments[3]);if(luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseFloat(a);var s=luckysheet.func_methods.getFirstValue(arguments[4]);if(luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseFloat(s);var n=luckysheet.func_methods.getFirstValue(arguments[5]);if(luckysheet.func_methods.valueIsError(n))return n;if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;n=parseInt(n);var o=0;if(7==arguments.length){if(o=luckysheet.func_methods.getFirstValue(arguments[6]),luckysheet.func_methods.valueIsError(o))return o;if(!luckysheet.func_methods.isRealNum(o))return luckysheet.formula.error.v;o=parseInt(o)}if(r<0)return luckysheet.formula.error.nm;if(a<=0||s<=0)return luckysheet.formula.error.nm;if(1!=n&&2!=n&&4!=n)return luckysheet.formula.error.nm;if(o<0||4<o)return luckysheet.formula.error.nm;if(0<=moment(t)-moment(l))return luckysheet.formula.error.nm;if(1<window.luckysheet_function.COUPNUM.f(t,l,n,o)){for(var c=1,u=0,i=c,e=1;e<=100;e++){var h=window.luckysheet_function.PRICE.f(t,l,r,i,s,n,o);if(Math.abs(h-a)<1e-6)break;a<h?u=i:c=i,i=(c+u)/2}var d=i}else var y=window.luckysheet_function.COUPDAYSNC.f(t,l,n,o),f=window.luckysheet_function.COUPDAYS.f(t,l,n,o),m=a/100+window.luckysheet_function.COUPDAYBS.f(t,l,n,o)/f*(r/n),d=(s/100+r/n-m)/m*(n*f/y);return d}catch(e){var k=e;return k=luckysheet.formula.errorInfo(k),[luckysheet.formula.error.v,k]}},YIELDDISC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return luckysheet.formula.error.v;var l=luckysheet.func_methods.getCellDate(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!moment(l).isValid())return luckysheet.formula.error.v;var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=luckysheet.func_methods.getFirstValue(arguments[3]);if(luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseFloat(a);var s=0;if(5==arguments.length){if(s=luckysheet.func_methods.getFirstValue(arguments[4]),luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseInt(s)}return r<=0||a<=0?luckysheet.formula.error.nm:s<0||4<s||0<=moment(t)-moment(l)?luckysheet.formula.error.nm:(a/r-1)/window.luckysheet_function.YEARFRAC.f(t,l,s)}catch(e){var n=e;return n=luckysheet.formula.errorInfo(n),[luckysheet.formula.error.v,n]}},NOMINAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:luckysheet.func_methods.isRealNum(l)?(l=parseInt(l),t<=0||l<1?luckysheet.formula.error.nm:(Math.pow(t+1,1/l)-1)*l):luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},XIRR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("array"==luckysheet.getObjType(t)){if("array"==luckysheet.getObjType(t[0])&&!luckysheet.func_methods.isDyadicArr(t))return luckysheet.formula.error.v;l=l.concat(luckysheet.func_methods.getDataArr(t,!1))}else"object"==luckysheet.getObjType(t)&&null!=t.startCell?l=l.concat(luckysheet.func_methods.getCellDataArr(t,"number",!1)):l.push(t);for(var r=[],e=0;e<l.length;e++){var a=l[e];if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;r.push(parseFloat(a))}var s=luckysheet.func_methods.getCellrangeDate(arguments[1]);if(luckysheet.func_methods.valueIsError(s))return s;for(e=0;e<s.length;e++)if(!moment(s[e]).isValid())return luckysheet.formula.error.v;var n=.1;if(3==arguments.length){if(n=luckysheet.func_methods.getFirstValue(arguments[2]),luckysheet.func_methods.valueIsError(n))return n;if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;n=parseFloat(n)}for(var o=!1,c=!1,e=0;e<r.length&&(0<r[e]&&(o=!0),r[e]<0&&(c=!0),!o||!c);e++);if(!o||!c)return luckysheet.formula.error.nm;if(r.length!=s.length)return luckysheet.formula.error.nm;for(var u,i,h,d=n;u=d-(h=function(e,t,l){for(var r=l+1,a=e[0],s=1;s<e.length;s++)a+=e[s]/Math.pow(r,window.luckysheet_function.DAYS.f(t[s],t[0])/365);return a}(r,s,d))/function(e,t,l){for(var r=l+1,a=0,s=1;s<e.length;s++){var n=window.luckysheet_function.DAYS.f(t[s],t[0])/365;a-=n*e[s]/Math.pow(r,1+n)}return a}(r,s,d),i=Math.abs(u-d),d=u,1e-10<i&&1e-10<Math.abs(h););return d}catch(e){var y=e;return y=luckysheet.formula.errorInfo(y),[luckysheet.formula.error.v,y]}},MIRR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("array"==luckysheet.getObjType(t)){if("array"==luckysheet.getObjType(t[0])&&!luckysheet.func_methods.isDyadicArr(t))return luckysheet.formula.error.v;l=l.concat(luckysheet.func_methods.getDataArr(t,!1))}else"object"==luckysheet.getObjType(t)&&null!=t.startCell?l=l.concat(luckysheet.func_methods.getCellDataArr(t,"number",!1)):l.push(t);for(var r=[],e=0;e<l.length;e++){var a=l[e];if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;r.push(parseFloat(a))}var s=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseFloat(s);var n=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(n))return n;if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;n=parseFloat(n);for(var o=r.length,c=[],u=[],e=0;e<o;e++)r[e]<0?c.push(r[e]):u.push(r[e]);if(0==c.length||0==u.length)return luckysheet.formula.error.d;var i=-window.luckysheet_function.NPV.f(n,u)*Math.pow(1+n,o-1),h=window.luckysheet_function.NPV.f(s,c)*(1+s);return Math.pow(i/h,1/(o-1))-1}catch(e){var d=e;return d=luckysheet.formula.errorInfo(d),[luckysheet.formula.error.v,d]}},IRR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("array"==luckysheet.getObjType(t)){if("array"==luckysheet.getObjType(t[0])&&!luckysheet.func_methods.isDyadicArr(t))return luckysheet.formula.error.v;l=l.concat(luckysheet.func_methods.getDataArr(t,!1))}else"object"==luckysheet.getObjType(t)&&null!=t.startCell?l=l.concat(luckysheet.func_methods.getCellDataArr(t,"number",!1)):l.push(t);for(var r=[],e=0;e<l.length;e++){var a=l[e];if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;r.push(parseFloat(a))}var s=.1;if(2==arguments.length){if(s=luckysheet.func_methods.getFirstValue(arguments[1]),luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseFloat(s)}for(var n=[],o=!1,c=!1,e=0;e<l.length;e++)n[e]=0===e?0:n[e-1]+365,0<l[e]&&(o=!0),l[e]<0&&(c=!0);if(!o||!c)return luckysheet.formula.error.nm;for(var u,i,h,d=s;u=d-(h=function(e,t,l){for(var r=l+1,a=e[0],s=1;s<e.length;s++)a+=e[s]/Math.pow(r,(t[s]-t[0])/365);return a}(r,n,d))/function(e,t,l){for(var r=l+1,a=0,s=1;s<e.length;s++){var n=(t[s]-t[0])/365;a-=n*e[s]/Math.pow(r,1+n)}return a}(r,n,d),i=Math.abs(u-d),d=u,1e-10<i&&1e-10<Math.abs(h););return d}catch(e){var y=e;return y=luckysheet.formula.errorInfo(y),[luckysheet.formula.error.v,y]}},NPV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);for(var l=[],e=1;e<arguments.length;e++){var r=arguments[e];if("array"==luckysheet.getObjType(r)){if("array"==luckysheet.getObjType(r[0])&&!luckysheet.func_methods.isDyadicArr(r))return luckysheet.formula.error.v;l=l.concat(luckysheet.func_methods.getDataArr(r,!0))}else"object"==luckysheet.getObjType(r)&&null!=r.startCell?l=l.concat(luckysheet.func_methods.getCellDataArr(r,"number",!0)):l.push(r)}for(var a=[],e=0;e<l.length;e++){var s=l[e];luckysheet.func_methods.isRealNum(s)&&a.push(parseFloat(s))}var n=0;if(0<a.length)for(e=0;e<a.length;e++)n+=a[e]/Math.pow(1+t,e+1);return n}catch(e){var o=e;return o=luckysheet.formula.errorInfo(o),[luckysheet.formula.error.v,o]}},XNPV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=arguments[1],r=[];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;r=r.concat(luckysheet.func_methods.getDataArr(l,!1))}else"object"==luckysheet.getObjType(l)&&null!=l.startCell?r=r.concat(luckysheet.func_methods.getCellDataArr(l,"number",!1)):r.push(l);for(var a=[],e=0;e<r.length;e++){var s=r[e];if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;a.push(parseFloat(s))}var n=luckysheet.func_methods.getCellrangeDate(arguments[2]);if(luckysheet.func_methods.valueIsError(n))return n;for(e=0;e<n.length;e++)if(!moment(n[e]).isValid())return luckysheet.formula.error.v;if(a.length!=n.length)return luckysheet.formula.error.nm;for(var o=0,e=0;e<a.length;e++)o+=a[e]/Math.pow(1+t,window.luckysheet_function.DAYS.f(n[e],n[0])/365);return o}catch(e){var c=e;return c=luckysheet.formula.errorInfo(c),[luckysheet.formula.error.v,c]}},CUMIPMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseFloat(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=luckysheet.func_methods.getFirstValue(arguments[3]);if(luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseInt(a);var s=luckysheet.func_methods.getFirstValue(arguments[4]);if(luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseInt(s);var n=luckysheet.func_methods.getFirstValue(arguments[5]);if(luckysheet.func_methods.valueIsError(n))return n;if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;if(n=parseFloat(n),t<=0||l<=0||r<=0)return luckysheet.formula.error.nm;if(a<1||s<1||s<a)return luckysheet.formula.error.nm;if(0!=n&&1!=n)return luckysheet.formula.error.nm;var o=window.luckysheet_function.PMT.f(t,l,r,0,n),c=0;1===a&&0===n&&(c=-r,a++);for(e=a;e<=s;e++)c+=1===n?window.luckysheet_function.FV.f(t,e-2,o,r,1)-o:window.luckysheet_function.FV.f(t,e-1,o,r,0);return c*=t}catch(e){var u=e;return u=luckysheet.formula.errorInfo(u),[luckysheet.formula.error.v,u]}},PMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseFloat(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=0;if(4<=arguments.length){if(a=luckysheet.func_methods.getFirstValue(arguments[3]),luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseFloat(a)}var s,n=0;if(5==arguments.length){if(n=luckysheet.func_methods.getFirstValue(arguments[4]),luckysheet.func_methods.valueIsError(n))return n;if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;n=parseFloat(n)}return 0!=n&&1!=n?luckysheet.formula.error.nm:-(0===t?(r+a)/l:(s=Math.pow(1+t,l),1===n?(a*t/(s-1)+r*t/(1-1/s))/(1+t):a*t/(s-1)+r*t/(1-1/s)))}catch(e){var o=e;return o=luckysheet.formula.errorInfo(o),[luckysheet.formula.error.v,o]}},IPMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseFloat(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=luckysheet.func_methods.getFirstValue(arguments[3]);if(luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseFloat(a);var s=0;if(5<=arguments.length){if(s=luckysheet.func_methods.getFirstValue(arguments[4]),luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseFloat(s)}var n=0;if(6<=arguments.length){if(n=luckysheet.func_methods.getFirstValue(arguments[5]),luckysheet.func_methods.valueIsError(n))return n;if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;n=parseFloat(n)}if(l<1||r<l)return luckysheet.formula.error.nm;if(0!=n&&1!=n)return luckysheet.formula.error.nm;var o=window.luckysheet_function.PMT.f(t,r,a,s,n),c=1===l?1===n?0:-a:1===n?window.luckysheet_function.FV.f(t,l-2,o,a,1)-o:window.luckysheet_function.FV.f(t,l-1,o,a,0);return c*t}catch(e){var u=e;return u=luckysheet.formula.errorInfo(u),[luckysheet.formula.error.v,u]}},PPMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseFloat(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=luckysheet.func_methods.getFirstValue(arguments[3]);if(luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseFloat(a);var s=0;if(5<=arguments.length){if(s=luckysheet.func_methods.getFirstValue(arguments[4]),luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseFloat(s)}var n=0;if(6<=arguments.length){if(n=luckysheet.func_methods.getFirstValue(arguments[5]),luckysheet.func_methods.valueIsError(n))return n;if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;n=parseFloat(n)}return l<1||r<l?luckysheet.formula.error.nm:0!=n&&1!=n?luckysheet.formula.error.nm:window.luckysheet_function.PMT.f(t,r,a,s,n)-window.luckysheet_function.IPMT.f(t,l,r,a,s,n)}catch(e){var o=e;return o=luckysheet.formula.errorInfo(o),[luckysheet.formula.error.v,o]}},INTRATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return luckysheet.formula.error.v;var l=luckysheet.func_methods.getCellDate(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!moment(l).isValid())return luckysheet.formula.error.v;var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=luckysheet.func_methods.getFirstValue(arguments[3]);if(luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseFloat(a);var s=0;if(5==arguments.length){if(s=luckysheet.func_methods.getFirstValue(arguments[4]),luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseInt(s)}if(r<=0||a<=0)return luckysheet.formula.error.nm;if(s<0||4<s)return luckysheet.formula.error.nm;if(0<=moment(t)-moment(l))return luckysheet.formula.error.nm;var n=moment(t).date(),o=moment(t).month()+1,c=moment(t).year(),u=moment(l).date(),i=moment(l).month()+1,h=moment(l).year();switch(s){case 0:31===n&&31===u?u=n=30:31===n?n=30:30===n&&31===u&&(u=30),f=360/(u+30*i+360*h-(n+30*o+360*c));break;case 1:var d=365;if(c===h||c+1===h&&(i<o||o===i&&u<=n))return(c===h&&luckysheet.func_methods.isLeapYear(c)||luckysheet.func_methods.feb29Between(t,l)||1===i&&29===u)&&(d=366),f=d/moment(l).diff(moment(t),"days"),f*=(a-r)/r;var y=h-c+1,f=(moment().set({year:h+1,month:0,date:1})-moment().set({year:c,month:0,date:1}))/1e3/60/60/24/y/moment(l).diff(moment(t),"days");break;case 2:f=360/moment(l).diff(moment(t),"days");break;case 3:f=365/moment(l).diff(moment(t),"days");break;case 4:f=360/(u+30*i+360*h-(n+30*o+360*c))}return f*=(a-r)/r}catch(e){var m=e;return m=luckysheet.formula.errorInfo(m),[luckysheet.formula.error.v,m]}},PRICE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return luckysheet.formula.error.v;var l=luckysheet.func_methods.getCellDate(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!moment(l).isValid())return luckysheet.formula.error.v;var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=luckysheet.func_methods.getFirstValue(arguments[3]);if(luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseFloat(a);var s=luckysheet.func_methods.getFirstValue(arguments[4]);if(luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseFloat(s);var n=luckysheet.func_methods.getFirstValue(arguments[5]);if(luckysheet.func_methods.valueIsError(n))return n;if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;n=parseInt(n);var o=0;if(7==arguments.length){if(o=luckysheet.func_methods.getFirstValue(arguments[6]),luckysheet.func_methods.valueIsError(o))return o;if(!luckysheet.func_methods.isRealNum(o))return luckysheet.formula.error.v;o=parseInt(o)}if(r<0||a<0)return luckysheet.formula.error.nm;if(s<=0)return luckysheet.formula.error.nm;if(1!=n&&2!=n&&4!=n)return luckysheet.formula.error.nm;if(o<0||4<o)return luckysheet.formula.error.nm;if(0<=moment(t)-moment(l))return luckysheet.formula.error.nm;var c=window.luckysheet_function.COUPDAYSNC.f(t,l,n,o),u=window.luckysheet_function.COUPDAYS.f(t,l,n,o),i=window.luckysheet_function.COUPDAYBS.f(t,l,n,o),h=window.luckysheet_function.COUPNUM.f(t,l,n,o);if(1<h){for(var d=s/Math.pow(1+a/n,h-1+c/u),y=0,e=1;e<=h;e++)y+=100*r/n/Math.pow(1+a/n,e-1+c/u);var f=d+y-r/n*100*(i/u)}else f=(d=r/n*100+s)/(y=a/n*((u-i)/u)+1)-r/n*100*(i/u);return f}catch(e){var m=e;return m=luckysheet.formula.errorInfo(m),[luckysheet.formula.error.v,m]}},PRICEDISC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return luckysheet.formula.error.v;var l=luckysheet.func_methods.getCellDate(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!moment(l).isValid())return luckysheet.formula.error.v;var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=luckysheet.func_methods.getFirstValue(arguments[3]);if(luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseFloat(a);var s=0;if(5==arguments.length){if(s=luckysheet.func_methods.getFirstValue(arguments[4]),luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseInt(s)}if(r<=0||a<=0)return luckysheet.formula.error.nm;if(s<0||4<s)return luckysheet.formula.error.nm;if(0<=moment(t)-moment(l))return luckysheet.formula.error.nm;var n=moment(t).date(),o=moment(t).month()+1,c=moment(t).year(),u=moment(l).date(),i=moment(l).month()+1,h=moment(l).year();switch(s){case 0:31===n&&31===u?u=n=30:31===n?n=30:30===n&&31===u&&(u=30),m=(u+30*i+360*h-(n+30*o+360*c))/360;break;case 1:var d=365;if(c===h||c+1===h&&(i<o||o===i&&u<=n))return(c===h&&luckysheet.func_methods.isLeapYear(c)||luckysheet.func_methods.feb29Between(t,l)||1===i&&29===u)&&(d=366),m=a-r*a*(m=moment(l).diff(moment(t),"days")/d);var y=h-c+1,f=(moment().set({year:h+1,month:0,date:1})-moment().set({year:c,month:0,date:1}))/1e3/60/60/24/y,m=moment(l).diff(moment(t),"days")/f;break;case 2:m=moment(l).diff(moment(t),"days")/360;break;case 3:m=moment(l).diff(moment(t),"days")/365;break;case 4:m=(u+30*i+360*h-(n+30*o+360*c))/360}return m=a-r*a*m}catch(e){var k=e;return k=luckysheet.formula.errorInfo(k),[luckysheet.formula.error.v,k]}},PRICEMAT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return luckysheet.formula.error.v;var l=luckysheet.func_methods.getCellDate(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!moment(l).isValid())return luckysheet.formula.error.v;var r=luckysheet.func_methods.getCellDate(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return luckysheet.formula.error.v;var a=luckysheet.func_methods.getFirstValue(arguments[3]);if(luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseFloat(a);var s=luckysheet.func_methods.getFirstValue(arguments[4]);if(luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseFloat(s);var n=0;if(6==arguments.length){if(n=luckysheet.func_methods.getFirstValue(arguments[5]),luckysheet.func_methods.valueIsError(n))return n;if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;n=parseInt(n)}if(a<0||s<0)return luckysheet.formula.error.nm;if(n<0||4<n)return luckysheet.formula.error.nm;if(0<=moment(t)-moment(l))return luckysheet.formula.error.nm;var o=moment(t).date(),c=moment(t).month()+1,u=moment(t).year(),i=moment(l).date(),h=moment(l).month()+1,d=moment(l).year(),y=moment(r).date(),f=moment(r).month()+1,m=moment(r).year();switch(n){case 0:31==o&&(o=30),31==i&&(i=30),31==y&&(y=30);var k=360,p=i+30*h+360*d-(o+30*c+360*u),g=i+30*h+360*d-(y+30*f+360*m),v=o+30*c+360*u-(y+30*f+360*m);break;case 1:var b=365;if(u===d||u+1===d&&(h<c||c===h&&i<=o)){(u===d&&luckysheet.func_methods.isLeapYear(u)||luckysheet.func_methods.feb29Between(t,l)||1===h&&29===i)&&(b=366);k=b,p=moment(l).diff(moment(t),"days");return(100+(g=moment(t).diff(moment(r),"days"))/k*a*100)/(1+p/k*s)-(v=moment(l).diff(moment(r),"days"))/k*a*100}var _=d-u+1,k=(moment().set({year:d+1,month:0,date:1})-moment().set({year:u,month:0,date:1}))/1e3/60/60/24/_,p=moment(l).diff(moment(t),"days"),g=moment(t).diff(moment(r),"days"),v=moment(l).diff(moment(r),"days");break;case 2:k=360,p=moment(l).diff(moment(t),"days"),g=moment(t).diff(moment(r),"days"),v=moment(l).diff(moment(r),"days");break;case 3:k=365,p=moment(l).diff(moment(t),"days"),g=moment(t).diff(moment(r),"days"),v=moment(l).diff(moment(r),"days");break;case 4:k=360,p=i+30*h+360*d-(o+30*c+360*u),g=i+30*h+360*d-(y+30*f+360*m),v=o+30*c+360*u-(y+30*f+360*m)}return(100+g/k*a*100)/(1+p/k*s)-v/k*a*100}catch(e){var w=e;return w=luckysheet.formula.errorInfo(w),[luckysheet.formula.error.v,w]}},RECEIVED:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return luckysheet.formula.error.v;var l=luckysheet.func_methods.getCellDate(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!moment(l).isValid())return luckysheet.formula.error.v;var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=luckysheet.func_methods.getFirstValue(arguments[3]);if(luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseFloat(a);var s=0;if(5==arguments.length){if(s=luckysheet.func_methods.getFirstValue(arguments[4]),luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseFloat(s)}if(r<=0||a<=0)return luckysheet.formula.error.nm;if(s<0||4<s)return luckysheet.formula.error.nm;if(0<=moment(t)-moment(l))return luckysheet.formula.error.nm;var n=moment(t).date(),o=moment(t).month()+1,c=moment(t).year(),u=moment(l).date(),i=moment(l).month()+1,h=moment(l).year();switch(s){case 0:31==n&&(n=30),31==u&&(u=30);var d=360,y=u+30*i+360*h-(n+30*o+360*c);break;case 1:var f=365;if(c===h||c+1===h&&(i<o||o===i&&u<=n)){(c===h&&luckysheet.func_methods.isLeapYear(c)||luckysheet.func_methods.feb29Between(t,l)||1===i&&29===u)&&(f=366);d=f;return r/(1-a*(y=moment(l).diff(moment(t),"days"))/d)}var m=h-c+1,d=(moment().set({year:h+1,month:0,date:1})-moment().set({year:c,month:0,date:1}))/1e3/60/60/24/m,y=moment(l).diff(moment(t),"days");break;case 2:d=360,y=moment(l).diff(moment(t),"days");break;case 3:d=365,y=moment(l).diff(moment(t),"days");break;case 4:d=360,y=u+30*i+360*h-(n+30*o+360*c)}return r/(1-a*y/d)}catch(e){var k=e;return k=luckysheet.formula.errorInfo(k),[luckysheet.formula.error.v,k]}},DISC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return luckysheet.formula.error.v;var l=luckysheet.func_methods.getCellDate(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!moment(l).isValid())return luckysheet.formula.error.v;var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=luckysheet.func_methods.getFirstValue(arguments[3]);if(luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseFloat(a);var s=0;if(5==arguments.length){if(s=luckysheet.func_methods.getFirstValue(arguments[4]),luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseFloat(s)}if(r<=0||a<=0)return luckysheet.formula.error.nm;if(s<0||4<s)return luckysheet.formula.error.nm;if(0<=moment(t)-moment(l))return luckysheet.formula.error.nm;var n=moment(t).date(),o=moment(t).month()+1,c=moment(t).year(),u=moment(l).date(),i=moment(l).month()+1,h=moment(l).year();switch(s){case 0:31==n&&(n=30),31==u&&(u=30);var d=360,y=u+30*i+360*h-(n+30*o+360*c);break;case 1:var f=365;if(c===h||c+1===h&&(i<o||o===i&&u<=n))return(c===h&&luckysheet.func_methods.isLeapYear(c)||luckysheet.func_methods.feb29Between(t,l)||1===i&&29===u)&&(f=366),(a-r)/a*((d=f)/(y=moment(l).diff(moment(t),"days")));var m=h-c+1,d=(moment().set({year:h+1,month:0,date:1})-moment().set({year:c,month:0,date:1}))/1e3/60/60/24/m,y=moment(l).diff(moment(t),"days");break;case 2:d=360,y=moment(l).diff(moment(t),"days");break;case 3:d=365,y=moment(l).diff(moment(t),"days");break;case 4:d=360,y=u+30*i+360*h-(n+30*o+360*c)}return(a-r)/a*(d/y)}catch(e){var k=e;return k=luckysheet.formula.errorInfo(k),[luckysheet.formula.error.v,k]}},NPER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseFloat(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=0;if(4<=arguments.length){if(a=luckysheet.func_methods.getFirstValue(arguments[3]),luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseFloat(a)}var s=0;if(5<=arguments.length){if(s=luckysheet.func_methods.getFirstValue(arguments[4]),luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseFloat(s)}if(0!=s&&1!=s)return luckysheet.formula.error.nm;var n=l*(1+t*s)-a*t,o=r*t+l*(1+t*s);return Math.log(n/o)/Math.log(1+t)}catch(e){var c=e;return c=luckysheet.formula.errorInfo(c),[luckysheet.formula.error.v,c]}},SLN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseFloat(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);return luckysheet.func_methods.valueIsError(r)?r:luckysheet.func_methods.isRealNum(r)?0==(r=parseFloat(r))?luckysheet.formula.error.d:(t-l)/r:luckysheet.formula.error.v}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},DURATION:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return luckysheet.formula.error.v;var l=luckysheet.func_methods.getCellDate(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!moment(l).isValid())return luckysheet.formula.error.v;var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=luckysheet.func_methods.getFirstValue(arguments[3]);if(luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseFloat(a);var s=luckysheet.func_methods.getFirstValue(arguments[4]);if(luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseInt(s);var n=0;if(6==arguments.length){if(n=luckysheet.func_methods.getFirstValue(arguments[5]),luckysheet.func_methods.valueIsError(n))return n;if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;n=parseInt(n)}if(r<0||a<0)return luckysheet.formula.error.nm;if(1!=s&&2!=s&&4!=s)return luckysheet.formula.error.nm;if(n<0||4<n)return luckysheet.formula.error.nm;if(0<=moment(t)-moment(l))return luckysheet.formula.error.nm;for(var o=window.luckysheet_function.COUPNUM.f(t,l,s,n),c=0,u=0,e=1;e<=o;e++)c+=r/s*100*e/Math.pow(1+a/s,e),u+=r/s*100/Math.pow(1+a/s,e);var i=(c+100*o/Math.pow(1+a/s,o))/(u+100/Math.pow(1+a/s,o));return i/=s}catch(e){var h=e;return h=luckysheet.formula.errorInfo(h),[luckysheet.formula.error.v,h]}},MDURATION:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellDate(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return luckysheet.formula.error.v;var l=luckysheet.func_methods.getCellDate(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!moment(l).isValid())return luckysheet.formula.error.v;var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r);var a=luckysheet.func_methods.getFirstValue(arguments[3]);if(luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseFloat(a);var s=luckysheet.func_methods.getFirstValue(arguments[4]);if(luckysheet.func_methods.valueIsError(s))return s;if(!luckysheet.func_methods.isRealNum(s))return luckysheet.formula.error.v;s=parseInt(s);var n=0;if(6==arguments.length){if(n=luckysheet.func_methods.getFirstValue(arguments[5]),luckysheet.func_methods.valueIsError(n))return n;if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;n=parseInt(n)}return r<0||a<0?luckysheet.formula.error.nm:1!=s&&2!=s&&4!=s||n<0||4<n||0<=moment(t)-moment(l)?luckysheet.formula.error.nm:window.luckysheet_function.DURATION.f(t,l,r,a,s,n)/(1+a/s)}catch(e){var o=e;return o=luckysheet.formula.errorInfo(o),[luckysheet.formula.error.v,o]}},BIN2DEC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!/^[01]{1,10}$/g.test(t))return luckysheet.formula.error.nm;var l=parseInt(t,2),r=t.toString();return 10===r.length&&"1"===r.substring(0,1)?parseInt(r.substring(1),2)-512:l}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},BIN2HEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;var l=null;if(2==arguments.length){if(l=luckysheet.func_methods.getFirstValue(arguments[1]),luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l)}if(!/^[01]{1,10}$/g.test(t))return luckysheet.formula.error.nm;var r=parseInt(t,2).toString(16).toUpperCase();return null==l?r:l<0||l<r.length?luckysheet.formula.error.nm:new Array(l-r.length+1).join("0")+r}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},BIN2OCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;var l=null;if(2==arguments.length){if(l=luckysheet.func_methods.getFirstValue(arguments[1]),luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l)}if(!/^[01]{1,10}$/g.test(t))return luckysheet.formula.error.nm;var r=t.toString();if(10===r.length&&"1"===r.substring(0,1))return(1073741312+parseInt(r.substring(1),2)).toString(8);var a=parseInt(t,2).toString(8);return null==l?a:l<0||l<a.length?luckysheet.formula.error.nm:new Array(l-a.length+1).join("0")+a}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},DEC2BIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=null;if(2==arguments.length){if(l=luckysheet.func_methods.getFirstValue(arguments[1]),luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l)}if(!/^-?[0-9]{1,3}$/.test(t)||t<-512||511<t)return luckysheet.formula.error.nm;if(t<0)return"1"+new Array(9-(512+t).toString(2).length).join("0")+(512+t).toString(2);var r=parseInt(t,10).toString(2);return null==l?r:l<0||l<r.length?luckysheet.formula.error.nm:new Array(l-r.length+1).join("0")+r}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},DEC2HEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=null;if(2==arguments.length){if(l=luckysheet.func_methods.getFirstValue(arguments[1]),luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l)}if(!/^-?[0-9]{1,12}$/.test(t)||t<-549755813888||549755813887<t)return luckysheet.formula.error.nm;if(t<0)return(1099511627776+t).toString(16).toUpperCase();var r=parseInt(t,10).toString(16).toUpperCase();return null==l?r:l<0||l<r.length?luckysheet.formula.error.nm:new Array(l-r.length+1).join("0")+r}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},DEC2OCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=null;if(2==arguments.length){if(l=luckysheet.func_methods.getFirstValue(arguments[1]),luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l)}if(!/^-?[0-9]{1,9}$/.test(t)||t<-536870912||536870911<t)return luckysheet.formula.error.nm;if(t<0)return(1073741824+t).toString(8);var r=parseInt(t,10).toString(8);return null==l?r:l<0||l<r.length?luckysheet.formula.error.nm:new Array(l-r.length+1).join("0")+r}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},HEX2BIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;var l=null;if(2==arguments.length){if(l=luckysheet.func_methods.getFirstValue(arguments[1]),luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l)}if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return luckysheet.formula.error.nm;var r=10===t.length&&"f"===t.substring(0,1).toLowerCase(),a=r?parseInt(t,16)-1099511627776:parseInt(t,16);if(a<-512||511<a)return luckysheet.formula.error.nm;if(r)return"1"+new Array(9-(512+a).toString(2).length).join("0")+(512+a).toString(2);var s=a.toString(2);return null==l?s:l<0||l<s.length?luckysheet.formula.error.nm:new Array(l-s.length+1).join("0")+s}catch(e){var n=e;return n=luckysheet.formula.errorInfo(n),[luckysheet.formula.error.v,n]}},HEX2DEC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return luckysheet.formula.error.nm;var l=parseInt(t,16);return 549755813888<=l?l-1099511627776:l}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},HEX2OCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;var l=null;if(2==arguments.length){if(l=luckysheet.func_methods.getFirstValue(arguments[1]),luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l)}if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return luckysheet.formula.error.nm;var r=parseInt(t,16);if(536870911<r&&r<0xffe0000000)return luckysheet.formula.error.nm;if(0xffe0000000<=r)return(r-0xffc0000000).toString(8);var a=r.toString(8);return null==l?a:l<0||l<a.length?luckysheet.formula.error.nm:new Array(l-a.length+1).join("0")+a}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},OCT2BIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;var l=null;if(2==arguments.length){if(l=luckysheet.func_methods.getFirstValue(arguments[1]),luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l)}if(!/^[0-7]{1,10}$/.test(t))return luckysheet.formula.error.nm;var r=10===(t=t.toString()).length&&"7"===t.substring(0,1),a=r?parseInt(t,8)-1073741824:parseInt(t,8);if(a<-512||511<a)return error.num;if(r)return"1"+new Array(9-(512+a).toString(2).length).join("0")+(512+a).toString(2);var s=a.toString(2);return null==l?s:l<0||l<s.length?luckysheet.formula.error.nm:new Array(l-s.length+1).join("0")+s}catch(e){var n=e;return n=luckysheet.formula.errorInfo(n),[luckysheet.formula.error.v,n]}},OCT2DEC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!/^[0-7]{1,10}$/.test(t))return luckysheet.formula.error.nm;var l=parseInt(t,8);return 536870912<=l?l-1073741824:l}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},OCT2HEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;var l=null;if(2==arguments.length){if(l=luckysheet.func_methods.getFirstValue(arguments[1]),luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l)}if(!/^[0-7]{1,10}$/.test(t))return luckysheet.formula.error.nm;var r=parseInt(t,8);if(536870912<=r)return"FF"+(r+3221225472).toString(16).toUpperCase();var a=r.toString(16).toUpperCase();return null==l?a:l<0||l<a.length?luckysheet.formula.error.nm:new Array(l-a.length+1).join("0")+a}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},COMPLEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseFloat(l);var r="i";if(3==arguments.length&&(r=arguments[2].toString()),"i"!=r&&"j"!=r)return luckysheet.formula.error.v;if(0===t&&0===l)return 0;if(0===t)return 1===l?r:l.toString()+r;if(0===l)return t.toString();var a=0<l?"+":"";return t.toString()+a+(1===l?r:l.toString()+r)}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},IMREAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if("true"==(t=t.toString()).toLowerCase()||"false"==t.toLowerCase())return luckysheet.formula.error.v;if("0"==t)return 0;if(0<=["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(t))return 0;var l=t.indexOf("+"),r=t.indexOf("-");0===l&&(l=t.indexOf("+",1)),0===r&&(r=t.indexOf("-",1));var a=t.substring(t.length-1,t.length),s="i"===a||"j"===a;return 0<=l||0<=r?s?0<=l?isNaN(t.substring(0,l))||isNaN(t.substring(l+1,t.length-1))?luckysheet.formula.error.nm:Number(t.substring(0,l)):isNaN(t.substring(0,r))||isNaN(t.substring(r+1,t.length-1))?luckysheet.formula.error.nm:Number(t.substring(0,r)):luckysheet.formula.error.nm:s?isNaN(t.substring(0,t.length-1))?luckysheet.formula.error.nm:0:isNaN(t)?luckysheet.formula.error.nm:t}catch(e){var n=e;return n=luckysheet.formula.errorInfo(n),[luckysheet.formula.error.v,n]}},IMAGINARY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if("true"==(t=t.toString()).toLowerCase()||"false"==t.toLowerCase())return luckysheet.formula.error.v;if("0"==t)return 0;if(0<=["i","j"].indexOf(t))return 1;var l=(t=t.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),r=t.indexOf("-");0===l&&(l=t.indexOf("+",1)),0===r&&(r=t.indexOf("-",1));var a=t.substring(t.length-1,t.length),s="i"===a||"j"===a;return 0<=l||0<=r?s?0<=l?isNaN(t.substring(0,l))||isNaN(t.substring(l+1,t.length-1))?luckysheet.formula.error.nm:Number(t.substring(l+1,t.length-1)):isNaN(t.substring(0,r))||isNaN(t.substring(r+1,t.length-1))?luckysheet.formula.error.nm:-Number(t.substring(r+1,t.length-1)):luckysheet.formula.error.nm:s?isNaN(t.substring(0,t.length-1))?luckysheet.formula.error.nm:t.substring(0,t.length-1):isNaN(t)?luckysheet.formula.error.nm:0}catch(e){var n=e;return n=luckysheet.formula.errorInfo(n),[luckysheet.formula.error.v,n]}},IMCONJUGATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;t=t.toString();var l=window.luckysheet_function.IMREAL.f(t);if(luckysheet.func_methods.valueIsError(l))return l;var r=window.luckysheet_function.IMAGINARY.f(t);if(luckysheet.func_methods.valueIsError(r))return r;var a="i"===(a=t.substring(t.length-1))||"j"===a?a:"i";return 0!==r?window.luckysheet_function.COMPLEX.f(l,-r,a):t}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},IMABS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=window.luckysheet_function.IMREAL.f(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;var l=window.luckysheet_function.IMAGINARY.f(arguments[0]);return luckysheet.func_methods.valueIsError(l)?l:Math.sqrt(Math.pow(t,2)+Math.pow(l,2))}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},DELTA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=0;if(2==arguments.length){if(l=luckysheet.func_methods.getFirstValue(arguments[1]),luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseFloat(l)}return t===l?1:0}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},IMSUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=window.luckysheet_function.IMREAL.f(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;var l=window.luckysheet_function.IMAGINARY.f(arguments[0]);if(luckysheet.func_methods.valueIsError(l))return l;for(var r=arguments[0],e=1;e<arguments.length;e++){var a=window.luckysheet_function.IMREAL.f(r);if(luckysheet.func_methods.valueIsError(a))return a;var s=window.luckysheet_function.IMAGINARY.f(r);if(luckysheet.func_methods.valueIsError(s))return s;var n=window.luckysheet_function.IMREAL.f(arguments[e]);if(luckysheet.func_methods.valueIsError(n))return n;var o=window.luckysheet_function.IMAGINARY.f(arguments[e]);if(luckysheet.func_methods.valueIsError(o))return o;r=window.luckysheet_function.COMPLEX.f(a+n,s+o)}return r}catch(e){var c=e;return c=luckysheet.formula.errorInfo(c),[luckysheet.formula.error.v,c]}},IMSUB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if("true"==(t=t.toString()).toLowerCase()||"false"==t.toLowerCase())return luckysheet.formula.error.v;var l=window.luckysheet_function.IMREAL.f(t);if(luckysheet.func_methods.valueIsError(l))return l;var r=window.luckysheet_function.IMAGINARY.f(t);if(luckysheet.func_methods.valueIsError(r))return r;var a=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(a))return a;if("true"==(a=a.toString()).toLowerCase()||"false"==a.toLowerCase())return luckysheet.formula.error.v;var s=window.luckysheet_function.IMREAL.f(a);if(luckysheet.func_methods.valueIsError(s))return s;var n=window.luckysheet_function.IMAGINARY.f(a);if(luckysheet.func_methods.valueIsError(n))return n;var o=t.substring(t.length-1),c=a.substring(a.length-1),u="j"!==o&&"j"!==c?"i":"j";return window.luckysheet_function.COMPLEX.f(l-s,r-n,u)}catch(e){var i=e;return i=luckysheet.formula.errorInfo(i),[luckysheet.formula.error.v,i]}},IMPRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=window.luckysheet_function.IMREAL.f(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;var l=window.luckysheet_function.IMAGINARY.f(arguments[0]);if(luckysheet.func_methods.valueIsError(l))return l;for(var r=arguments[0],e=1;e<arguments.length;e++){var a=window.luckysheet_function.IMREAL.f(r);if(luckysheet.func_methods.valueIsError(a))return a;var s=window.luckysheet_function.IMAGINARY.f(r);if(luckysheet.func_methods.valueIsError(s))return s;var n=window.luckysheet_function.IMREAL.f(arguments[e]);if(luckysheet.func_methods.valueIsError(n))return n;var o=window.luckysheet_function.IMAGINARY.f(arguments[e]);if(luckysheet.func_methods.valueIsError(o))return o;r=window.luckysheet_function.COMPLEX.f(a*n-s*o,a*o+s*n)}return r}catch(e){var c=e;return c=luckysheet.formula.errorInfo(c),[luckysheet.formula.error.v,c]}},IMDIV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if("true"==(t=t.toString()).toLowerCase()||"false"==t.toLowerCase())return luckysheet.formula.error.v;var l=window.luckysheet_function.IMREAL.f(t);if(luckysheet.func_methods.valueIsError(l))return l;var r=window.luckysheet_function.IMAGINARY.f(t);if(luckysheet.func_methods.valueIsError(r))return r;var a=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(a))return a;if("true"==(a=a.toString()).toLowerCase()||"false"==a.toLowerCase())return luckysheet.formula.error.v;var s=window.luckysheet_function.IMREAL.f(a);if(luckysheet.func_methods.valueIsError(s))return s;var n=window.luckysheet_function.IMAGINARY.f(a);if(luckysheet.func_methods.valueIsError(n))return n;var o=t.substring(t.length-1),c=a.substring(a.length-1),u="j"===o||"j"===c?"j":"i";if(0===s&&0===n)return luckysheet.formula.error.nm;var i=s*s+n*n;return window.luckysheet_function.COMPLEX.f((l*s+r*n)/i,(r*s-l*n)/i,u)}catch(e){var h=e;return h=luckysheet.formula.errorInfo(h),[luckysheet.formula.error.v,h]}},NOT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellBoolen(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:!t}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},TRUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{return!0}catch(e){var t=e;return t=luckysheet.formula.errorInfo(t),[luckysheet.formula.error.v,t]}},FALSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{return!1}catch(e){var t=e;return t=luckysheet.formula.errorInfo(t),[luckysheet.formula.error.v,t]}},AND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=!0,e=0;e<arguments.length;e++){var l=luckysheet.func_methods.getCellBoolen(arguments[e]);if(luckysheet.func_methods.valueIsError(l))return l;if(!l){t=!1;break}}return t}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},IFERROR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[1],"text"),l=luckysheet.func_methods.getFirstValue(arguments[0],"text");return luckysheet.func_methods.valueIsError(l)?t:l}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},IF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getCellBoolen(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;var l=luckysheet.func_methods.getFirstValue(arguments[1],"text");if(luckysheet.func_methods.valueIsError(l))return l;var r="";return 3==arguments.length&&(r=luckysheet.func_methods.getFirstValue(arguments[2],"text"),luckysheet.func_methods.valueIsError(r))?r:t?l:r}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},OR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t=!1,e=0;e<arguments.length;e++){var l=luckysheet.func_methods.getCellBoolen(arguments[e]);if(luckysheet.func_methods.valueIsError(l))return l;if(l){t=!0;break}}return t}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},NE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:t!=l}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},EQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:t==l}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},GT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:luckysheet.func_methods.isRealNum(l)?(l=parseFloat(l))<t:luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},GTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:luckysheet.func_methods.isRealNum(l)?(l=parseFloat(l))<=t:luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},LT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:luckysheet.func_methods.isRealNum(l)?t<(l=parseFloat(l)):luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},LTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:luckysheet.func_methods.isRealNum(l)?t<=(l=parseFloat(l)):luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},ADD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:luckysheet.func_methods.isRealNum(l)?t+(l=parseFloat(l)):luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},MINUS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:luckysheet.func_methods.isRealNum(l)?t-(l=parseFloat(l)):luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},MULTIPLY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:luckysheet.func_methods.isRealNum(l)?t*(l=parseFloat(l)):luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},DIVIDE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:luckysheet.func_methods.isRealNum(l)?0==(l=parseFloat(l))?luckysheet.formula.error.d:t/l:luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},CONCAT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");if(luckysheet.func_methods.valueIsError(t))return t;var l=luckysheet.func_methods.getFirstValue(arguments[1],"text");return luckysheet.func_methods.valueIsError(l)?l:t+""+l}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},UNARY_PERCENT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;var l=(t=parseFloat(t))/100;return Math.round(100*l)/100}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},CONCATENATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{for(var t="",e=0;e<arguments.length;e++){var l=luckysheet.func_methods.getFirstValue(arguments[e],"text");if(luckysheet.func_methods.valueIsError(l))return l;t=t+""+l}return t}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},CODE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");return luckysheet.func_methods.valueIsError(t)?t:""==t?luckysheet.formula.error.v:t.charCodeAt(0)}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},CHAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:!luckysheet.func_methods.isRealNum(t)||(t=parseInt(t))<1||255<t?luckysheet.formula.error.v:String.fromCharCode(t)}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},ARABIC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");if(luckysheet.func_methods.valueIsError(t))return t;if(t=t.toString().toUpperCase(),!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(t))return luckysheet.formula.error.v;var l=0;return t.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(e){l+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]}),l}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},ROMAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e,t,l=0;l<arguments.length;l++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[l],l)[0])return luckysheet.formula.error.v}try{var r=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;if(0==(r=parseInt(r)))return"";if(r<1||3999<r)return luckysheet.formula.error.v;return e=r,(t=[["","I","II","III","IV","V","VI","VII","VIII","IX"],["","X","XX","XXX","XL","L","LX","LXX","LXXX","XC"],["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM"],["","M","MM","MMM"]])[3][Math.floor(e/1e3)]+t[2][Math.floor(e%1e3/100)]+t[1][Math.floor(e%100/10)]+t[0][e%10]}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},REGEXEXTRACT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");if(luckysheet.func_methods.valueIsError(t))return t;var l=luckysheet.func_methods.getFirstValue(arguments[1],"text");if(luckysheet.func_methods.valueIsError(l))return l;var r=t.match(new RegExp(l));return r?r[1<r.length?r.length-1:0]:null}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},REGEXMATCH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");if(luckysheet.func_methods.valueIsError(t))return t;var l=luckysheet.func_methods.getFirstValue(arguments[1],"text");return luckysheet.func_methods.valueIsError(l)?l:!!t.match(new RegExp(l))}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},REGEXREPLACE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");if(luckysheet.func_methods.valueIsError(t))return t;var l=luckysheet.func_methods.getFirstValue(arguments[1],"text");if(luckysheet.func_methods.valueIsError(l))return l;var r=luckysheet.func_methods.getFirstValue(arguments[2],"text");return luckysheet.func_methods.valueIsError(r)?r:t.replace(new RegExp(l),r)}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},T:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");return luckysheet.func_methods.valueIsError(t)?t:"string"==luckysheet.getObjType(t)?t:""}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},FIXED:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=2;if(2<=arguments.length){if(l=luckysheet.func_methods.getFirstValue(arguments[1]),luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l)}var r=!1;if(3==arguments.length&&(r=luckysheet.func_methods.getCellBoolen(arguments[2]),luckysheet.func_methods.valueIsError(r)))return r;if(127<l)return luckysheet.formula.error.v;var a=r?"0":"#,##0";return l<=0?t=Math.round(t*Math.pow(10,l))/Math.pow(10,l):0<l&&(a+="."+new Array(l+1).join("0")),luckysheet.mask.update(a,t)}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},FIND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");if(luckysheet.func_methods.valueIsError(t))return t;t=t.toString();var l=luckysheet.func_methods.getFirstValue(arguments[1],"text");if(luckysheet.func_methods.valueIsError(l))return l;l=l.toString();var r=1;if(3==arguments.length){if(r=luckysheet.func_methods.getFirstValue(arguments[2]),luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r)}return r<0||r>l.length?luckysheet.formula.error.v:""==t?r:-1==l.indexOf(t)?luckysheet.formula.error.v:l.indexOf(t,r-1)+1}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},FINDB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");if(luckysheet.func_methods.valueIsError(t))return t;t=t.toString();var l=luckysheet.func_methods.getFirstValue(arguments[1],"text");if(luckysheet.func_methods.valueIsError(l))return l;l=l.toString();var r=1;if(3==arguments.length){if(r=luckysheet.func_methods.getFirstValue(arguments[2]),luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r)}if(r<0||r>l.length)return luckysheet.formula.error.v;if(""==t)return r;if(-1==l.indexOf(t))return luckysheet.formula.error.v;for(var a=l.split(""),s=l.indexOf(t,r-1),n=0,e=0;e<s;e++)/[^\x00-\xff]/g.test(a[e])?n+=2:n+=1;return n}catch(e){var o=e;return o=luckysheet.formula.errorInfo(o),[luckysheet.formula.error.v,o]}},JOIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");if(luckysheet.func_methods.valueIsError(t))return t;for(var l=[],e=1;e<arguments.length;e++){var r=arguments[e];if("array"==luckysheet.getObjType(r)){if("array"==luckysheet.getObjType(r[0])&&!luckysheet.func_methods.isDyadicArr(r))return luckysheet.formula.error.v;l=l.concat(luckysheet.func_methods.getDataArr(r,!1))}else"object"==luckysheet.getObjType(r)&&null!=r.startCell?l=l.concat(luckysheet.func_methods.getCellDataArr(r,"text",!1)):l.push(r)}return l.join(t)}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},LEFT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");if(luckysheet.func_methods.valueIsError(t))return t;t=t.toString();var l=1;if(2==arguments.length){if(l=luckysheet.func_methods.getFirstValue(arguments[1]),luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l)}return l<0?luckysheet.formula.error.v:l>=t.length?t:0==l?"":t.substr(0,l)}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},RIGHT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");if(luckysheet.func_methods.valueIsError(t))return t;t=t.toString();var l=1;if(2==arguments.length){if(l=luckysheet.func_methods.getFirstValue(arguments[1]),luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l)}return l<0?luckysheet.formula.error.v:l>=t.length?t:0==l?"":t.substr(-l,l)}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},MID:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");if(luckysheet.func_methods.valueIsError(t))return t;t=t.toString();var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);return luckysheet.func_methods.valueIsError(r)?r:luckysheet.func_methods.isRealNum(r)?(r=parseInt(r),l<1||r<0?luckysheet.formula.error.v:l>t.length?"":l+r>t.length?t.substr(l-1,t.length-l+1):t.substr(l-1,r)):luckysheet.formula.error.v}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},LEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");return luckysheet.func_methods.valueIsError(t)?t:(t=t.toString()).length}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},LENB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");return luckysheet.func_methods.valueIsError(t)?t:(t=t.toString()).replace(/[^\x00-\xff]/g,"aa").length}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},LOWER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");return luckysheet.func_methods.valueIsError(t)?t:(t=t.toString())?t.toLowerCase():t}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},UPPER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");return luckysheet.func_methods.valueIsError(t)?t:(t=t.toString())?t.toUpperCase():t}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},EXACT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");if(luckysheet.func_methods.valueIsError(t))return t;t=t.toString();var l=luckysheet.func_methods.getFirstValue(arguments[1],"text");return luckysheet.func_methods.valueIsError(l)?l:t===(l=l.toString())}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},REPLACE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");if(luckysheet.func_methods.valueIsError(t))return t;t=t.toString();var l=luckysheet.func_methods.getFirstValue(arguments[1]);if(luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l);var r=luckysheet.func_methods.getFirstValue(arguments[2]);if(luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseInt(r);var a=luckysheet.func_methods.getFirstValue(arguments[3],"text");return luckysheet.func_methods.valueIsError(a)?a:(a=a.toString(),t.substr(0,l-1)+a+t.substr(l-1+r))}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},REPT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");if(luckysheet.func_methods.valueIsError(t))return t;t=t.toString();var l=luckysheet.func_methods.getFirstValue(arguments[1]);return luckysheet.func_methods.valueIsError(l)?l:!luckysheet.func_methods.isRealNum(l)||(l=parseInt(l))<0?luckysheet.formula.error.v:(100<l&&(l=100),new Array(l+1).join(t))}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},SEARCH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");if(luckysheet.func_methods.valueIsError(t))return t;t=t.toString();var l=luckysheet.func_methods.getFirstValue(arguments[1],"text");if(luckysheet.func_methods.valueIsError(l))return l;l=l.toString();var r=1;if(3==arguments.length){if(r=luckysheet.func_methods.getFirstValue(arguments[2]),luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseInt(r)}if(r<=0||r>l.length)return luckysheet.formula.error.v;var a=l.toLowerCase().indexOf(t.toLowerCase(),r-1)+1;return 0===a?luckysheet.formula.error.v:a}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},SUBSTITUTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");if(luckysheet.func_methods.valueIsError(t))return t;t=t.toString();var l=luckysheet.func_methods.getFirstValue(arguments[1],"text");if(luckysheet.func_methods.valueIsError(l))return l;l=l.toString();var r=luckysheet.func_methods.getFirstValue(arguments[2],"text");if(luckysheet.func_methods.valueIsError(r))return r;r=r.toString();var a=null;if(4==arguments.length){if(a=luckysheet.func_methods.getFirstValue(arguments[3]),luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseInt(a)}var s,n=new RegExp(l,"g");if(null==a)s=t.replace(n,r);else{if(a<=0)return luckysheet.formula.error.v;var o=t.match(n);if(null==o||a>o.length)return t;for(var c=l.length,u=0,e=1;e<=a;e++)u=t.indexOf(l,u)+1;s=t.substring(0,u-1)+r+t.substring(u-1+c)}return s}catch(e){var i=e;return i=luckysheet.formula.errorInfo(i),[luckysheet.formula.error.v,i]}},CLEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");if(luckysheet.func_methods.valueIsError(t))return t;t=t.toString();for(var l=[],e=0;e<t.length;e++){var r=t.charCodeAt(e);(/[\u4e00-\u9fa5]/g.test(t.charAt(e))||31<r&&r<127)&&l.push(t.charAt(e))}return l.join("")}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},TEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1],"text");return luckysheet.func_methods.valueIsError(l)?l:(l=l.toString(),luckysheet.mask.update(l,t))}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},TRIM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");return luckysheet.func_methods.valueIsError(t)?t:(t=t.toString()).replace(/ +/g," ").trim()}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},VALUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");return luckysheet.func_methods.valueIsError(t)?t:(t=t.toString(),luckysheet.mask.genarate(t)[2])}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},PROPER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");return luckysheet.func_methods.valueIsError(t)?t:(t=t.toString().toLowerCase()).replace(/[a-zA-Z]+/g,function(e){return e.substring(0,1).toUpperCase()+e.substring(1)})}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},CONVERT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseFloat(t);var l=luckysheet.func_methods.getFirstValue(arguments[1],"text");if(luckysheet.func_methods.valueIsError(l))return l;l=l.toString();var r=luckysheet.func_methods.getFirstValue(arguments[2],"text");if(luckysheet.func_methods.valueIsError(r))return r;r=r.toString();for(var a,s=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],n={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},o={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},c=null,u=null,i=l,h=r,d=1,y=1,e=0;e<s.length;e++)a=null===s[e][2]?[]:s[e][2],(s[e][1]===i||0<=a.indexOf(i))&&(c=s[e]),(s[e][1]===h||0<=a.indexOf(h))&&(u=s[e]);if(null===c){var f=n[l.substring(0,2)],m=o[l.substring(0,1)];"da"===l.substring(0,2)&&(m=["dekao",10,"da"]),f?(d=f[2],i=l.substring(2)):m&&(d=m[1],i=l.substring(m[2].length));for(var k=0;k<s.length;k++)a=null===s[k][2]?[]:s[k][2],(s[k][1]===i||0<=a.indexOf(i))&&(c=s[k])}if(null===u){var p=n[r.substring(0,2)],g=o[r.substring(0,1)];"da"===r.substring(0,2)&&(g=["dekao",10,"da"]),p?(y=p[2],h=r.substring(2)):g&&(y=g[1],h=r.substring(g[2].length));for(var v=0;v<s.length;v++)a=null===s[v][2]?[]:s[v][2],(s[v][1]===h||0<=a.indexOf(h))&&(u=s[v])}return null===c||null===u?luckysheet.formula.error.na:c[3]!==u[3]?luckysheet.formula.error.na:t*c[6]*d/(u[6]*y)}catch(e){var b=e;return b=luckysheet.formula.errorInfo(b),[luckysheet.formula.error.v,b]}},SUMX2MY2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("array"==luckysheet.getObjType(t)){if("array"==luckysheet.getObjType(t[0])&&!luckysheet.func_methods.isDyadicArr(t))return luckysheet.formula.error.v;l=l.concat(luckysheet.func_methods.getDataArr(t,!1))}else"object"==luckysheet.getObjType(t)&&null!=t.startCell?l=l.concat(luckysheet.func_methods.getCellDataArr(t,"text",!1)):l.push(t);var r=arguments[1],a=[];if("array"==luckysheet.getObjType(r)){if("array"==luckysheet.getObjType(r[0])&&!luckysheet.func_methods.isDyadicArr(r))return luckysheet.formula.error.v;a=a.concat(luckysheet.func_methods.getDataArr(r,!1))}else"object"==luckysheet.getObjType(r)&&null!=r.startCell?a=a.concat(luckysheet.func_methods.getCellDataArr(r,"text",!1)):a.push(r);if(l.length!=a.length)return luckysheet.formula.error.na;for(var s=[],n=[],e=0;e<l.length;e++){var o=l[e],c=a[e];luckysheet.func_methods.isRealNum(o)&&luckysheet.func_methods.isRealNum(c)&&(s.push(parseFloat(o)),n.push(parseFloat(c)))}for(var u=0,e=0;e<s.length;e++)u+=Math.pow(s[e],2)-Math.pow(n[e],2);return u}catch(e){var i=e;return i=luckysheet.formula.errorInfo(i),[luckysheet.formula.error.v,i]}},SUMX2PY2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("array"==luckysheet.getObjType(t)){if("array"==luckysheet.getObjType(t[0])&&!luckysheet.func_methods.isDyadicArr(t))return luckysheet.formula.error.v;l=l.concat(luckysheet.func_methods.getDataArr(t,!1))}else"object"==luckysheet.getObjType(t)&&null!=t.startCell?l=l.concat(luckysheet.func_methods.getCellDataArr(t,"text",!1)):l.push(t);var r=arguments[1],a=[];if("array"==luckysheet.getObjType(r)){if("array"==luckysheet.getObjType(r[0])&&!luckysheet.func_methods.isDyadicArr(r))return luckysheet.formula.error.v;a=a.concat(luckysheet.func_methods.getDataArr(r,!1))}else"object"==luckysheet.getObjType(r)&&null!=r.startCell?a=a.concat(luckysheet.func_methods.getCellDataArr(r,"text",!1)):a.push(r);if(l.length!=a.length)return luckysheet.formula.error.na;for(var s=[],n=[],e=0;e<l.length;e++){var o=l[e],c=a[e];luckysheet.func_methods.isRealNum(o)&&luckysheet.func_methods.isRealNum(c)&&(s.push(parseFloat(o)),n.push(parseFloat(c)))}for(var u=0,e=0;e<s.length;e++)u+=Math.pow(s[e],2)+Math.pow(n[e],2);return u}catch(e){var i=e;return i=luckysheet.formula.errorInfo(i),[luckysheet.formula.error.v,i]}},SUMXMY2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("array"==luckysheet.getObjType(t)){if("array"==luckysheet.getObjType(t[0])&&!luckysheet.func_methods.isDyadicArr(t))return luckysheet.formula.error.v;l=l.concat(luckysheet.func_methods.getDataArr(t,!1))}else"object"==luckysheet.getObjType(t)&&null!=t.startCell?l=l.concat(luckysheet.func_methods.getCellDataArr(t,"text",!1)):l.push(t);var r=arguments[1],a=[];if("array"==luckysheet.getObjType(r)){if("array"==luckysheet.getObjType(r[0])&&!luckysheet.func_methods.isDyadicArr(r))return luckysheet.formula.error.v;a=a.concat(luckysheet.func_methods.getDataArr(r,!1))}else"object"==luckysheet.getObjType(r)&&null!=r.startCell?a=a.concat(luckysheet.func_methods.getCellDataArr(r,"text",!1)):a.push(r);if(l.length!=a.length)return luckysheet.formula.error.na;for(var s=[],n=[],e=0;e<l.length;e++){var o=l[e],c=a[e];luckysheet.func_methods.isRealNum(o)&&luckysheet.func_methods.isRealNum(c)&&(s.push(parseFloat(o)),n.push(parseFloat(c)))}for(var u=0,e=0;e<s.length;e++)u+=Math.pow(s[e]-n[e],2);return u}catch(e){var i=e;return i=luckysheet.formula.errorInfo(i),[luckysheet.formula.error.v,i]}},TRANSPOSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("array"==luckysheet.getObjType(t)){if("array"==luckysheet.getObjType(t[0])&&!luckysheet.func_methods.isDyadicArr(t))return luckysheet.formula.error.v;l=luckysheet.func_methods.getDataDyadicArr(t)}else"object"==luckysheet.getObjType(t)&&null!=t.startCell&&(l=luckysheet.func_methods.getCellDataDyadicArr(t,"number"));return l=l[0].map(function(e,t){return l.map(function(e){return e[t]})})}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},TREND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("array"==luckysheet.getObjType(t)){if("array"==luckysheet.getObjType(t[0])&&!luckysheet.func_methods.isDyadicArr(t))return luckysheet.formula.error.v;l=luckysheet.func_methods.getDataDyadicArr(t)}else if("object"==luckysheet.getObjType(t)&&null!=t.startCell)l=luckysheet.func_methods.getCellDataDyadicArr(t,"text");else{if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;(d=[]).push(parseFloat(t)),l.push(d)}for(var r=l.length,a=l[0].length,e=0;e<r;e++)for(var s=0;s<a;s++){if(!luckysheet.func_methods.isRealNum(l[e][s]))return luckysheet.formula.error.v;l[e][s]=parseFloat(l[e][s])}for(var n=[],e=1;e<=r;e++)for(s=1;s<=a;s++){var o=(e-1)*a+s;n.push(o)}if(2<=arguments.length){var c=arguments[1],n=[];if("array"==luckysheet.getObjType(c)){if("array"==luckysheet.getObjType(c[0])&&!luckysheet.func_methods.isDyadicArr(c))return luckysheet.formula.error.v;n=luckysheet.func_methods.getDataDyadicArr(c)}else if("object"==luckysheet.getObjType(c)&&null!=c.startCell)n=luckysheet.func_methods.getCellDataDyadicArr(c,"text");else{if(!luckysheet.func_methods.isRealNum(c))return luckysheet.formula.error.v;(d=[]).push(parseFloat(c)),n.push(d)}for(e=0;e<n.length;e++)for(s=0;s<n[0].length;s++){if(!luckysheet.func_methods.isRealNum(n[e][s]))return luckysheet.formula.error.v;n[e][s]=parseFloat(n[e][s])}}var u=n.length,i=n[0].length,h=n;if(3<=arguments.length){var d,y=arguments[2],h=[];if("array"==luckysheet.getObjType(y)){if("array"==luckysheet.getObjType(y[0])&&!luckysheet.func_methods.isDyadicArr(y))return luckysheet.formula.error.v;h=luckysheet.func_methods.getDataDyadicArr(y)}else if("object"==luckysheet.getObjType(y)&&null!=y.startCell)h=luckysheet.func_methods.getCellDataDyadicArr(y,"text");else{if(!luckysheet.func_methods.isRealNum(y))return luckysheet.formula.error.v;(d=[]).push(parseFloat(y)),h.push(d)}for(e=0;e<h.length;e++)for(s=0;s<h[0].length;s++){if(!luckysheet.func_methods.isRealNum(h[e][s]))return luckysheet.formula.error.v;h[e][s]=parseFloat(h[e][s])}}var f=!0;if(4==arguments.length&&(f=luckysheet.func_methods.getCellBoolen(arguments[3]),luckysheet.func_methods.valueIsError(f)))return f;if(r!=u||a!=i)return luckysheet.formula.error.r;var m,k=function(e,t){for(var l=0,r=0,a=0,s=0,n=0;n<e.length;n++)for(var o=0;o<e[n].length;o++)l+=e[n][o],r+=t[n][o],a+=e[n][o]*t[n][o],s+=e[n][o]*e[n][o];var c=e.length*e[0].length,u=l/c,i=r/c,h=(a/c-u*i)/(s/c-u*u);return[h,i-h*u]}(n,l),p=k[0];m=f?k[1]:0;for(var g=[],e=0;e<h.length;e++)for(s=0;s<h[e].length;s++){var v=p*h[e][s]+m;g.push(Math.round(1e9*v)/1e9)}return g}catch(e){var b=e;return b=luckysheet.formula.errorInfo(b),[luckysheet.formula.error.v,b]}},FREQUENCY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("array"==luckysheet.getObjType(t)){if("array"==luckysheet.getObjType(t[0])&&!luckysheet.func_methods.isDyadicArr(t))return luckysheet.formula.error.v;l=l.concat(luckysheet.func_methods.getDataArr(t,!0))}else if("object"==luckysheet.getObjType(t)&&null!=t.startCell)l=l.concat(luckysheet.func_methods.getCellDataArr(t,"number",!0));else{if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;l.push(t)}for(var r=[],e=0;e<l.length;e++)luckysheet.func_methods.isRealNum(l[e])&&r.push(parseFloat(l[e]));var a=arguments[1],s=[];if("array"==luckysheet.getObjType(a)){if("array"==luckysheet.getObjType(a[0])&&!luckysheet.func_methods.isDyadicArr(a))return luckysheet.formula.error.v;s=s.concat(luckysheet.func_methods.getDataArr(a,!0))}else if("object"==luckysheet.getObjType(a)&&null!=a.startCell)s=s.concat(luckysheet.func_methods.getCellDataArr(a,"number",!0));else{if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;s.push(a)}for(var n=[],e=0;e<s.length;e++)luckysheet.func_methods.isRealNum(s[e])&&n.push(parseFloat(s[e]));if(0==r.length&&0==n.length)return[[0],[0]];if(0==r.length){for(var o=[[0]],e=0;e<n.length;e++)o.push([0]);return o}if(0==n.length)return[[0],[r.length]];n.sort(function(e,t){return e-t});for(o=[],e=0;e<n.length;e++)if(0==e){for(var c=0,u=0;u<r.length;u++)r[u]<=n[0]&&c++;o.push([c])}else if(e==n.length-1){for(var i=0,h=0,u=0;u<r.length;u++)r[u]<=n[e]&&r[u]>n[e-1]&&i++,r[u]>n[e]&&h++;o.push([i]),o.push([h])}else{for(c=0,u=0;u<r.length;u++)r[u]<=n[e]&&r[u]>n[e-1]&&c++;o.push([c])}return o}catch(e){var d=e;return d=luckysheet.formula.errorInfo(d),[luckysheet.formula.error.v,d]}},GROWTH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("array"==luckysheet.getObjType(t)){if("array"==luckysheet.getObjType(t[0])&&!luckysheet.func_methods.isDyadicArr(t))return luckysheet.formula.error.v;l=luckysheet.func_methods.getDataDyadicArr(t)}else if("object"==luckysheet.getObjType(t)&&null!=t.startCell)l=luckysheet.func_methods.getCellDataDyadicArr(t,"text");else{if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;(d=[]).push(parseFloat(t)),l.push(d)}for(var r=l.length,a=l[0].length,e=0;e<r;e++)for(var s=0;s<a;s++){if(!luckysheet.func_methods.isRealNum(l[e][s]))return luckysheet.formula.error.v;l[e][s]=parseFloat(l[e][s])}for(var n=[],e=1;e<=r;e++)for(s=1;s<=a;s++){var o=(e-1)*a+s;n.push(o)}if(2<=arguments.length){var c=arguments[1],n=[];if("array"==luckysheet.getObjType(c)){if("array"==luckysheet.getObjType(c[0])&&!luckysheet.func_methods.isDyadicArr(c))return luckysheet.formula.error.v;n=luckysheet.func_methods.getDataDyadicArr(c)}else if("object"==luckysheet.getObjType(c)&&null!=c.startCell)n=luckysheet.func_methods.getCellDataDyadicArr(c,"text");else{if(!luckysheet.func_methods.isRealNum(c))return luckysheet.formula.error.v;(d=[]).push(parseFloat(c)),n.push(d)}for(e=0;e<n.length;e++)for(s=0;s<n[0].length;s++){if(!luckysheet.func_methods.isRealNum(n[e][s]))return luckysheet.formula.error.v;n[e][s]=parseFloat(n[e][s])}}var u=n.length,i=n[0].length,h=n;if(3<=arguments.length){var d,y=arguments[2],h=[];if("array"==luckysheet.getObjType(y)){if("array"==luckysheet.getObjType(y[0])&&!luckysheet.func_methods.isDyadicArr(y))return luckysheet.formula.error.v;h=luckysheet.func_methods.getDataDyadicArr(y)}else if("object"==luckysheet.getObjType(y)&&null!=y.startCell)h=luckysheet.func_methods.getCellDataDyadicArr(y,"text");else{if(!luckysheet.func_methods.isRealNum(y))return luckysheet.formula.error.v;(d=[]).push(parseFloat(y)),h.push(d)}for(e=0;e<h.length;e++)for(s=0;s<h[0].length;s++){if(!luckysheet.func_methods.isRealNum(h[e][s]))return luckysheet.formula.error.v;h[e][s]=parseFloat(h[e][s])}}var f=!0;if(4==arguments.length&&(f=luckysheet.func_methods.getCellBoolen(arguments[3]),luckysheet.func_methods.valueIsError(f)))return f;if(r!=u||a!=i)return luckysheet.formula.error.r;var m,k=function(e,t){for(var l=0,r=0,a=0,s=0,n=0;n<e.length;n++)for(var o=0;o<e[n].length;o++)l+=e[n][o],r+=Math.log(t[n][o]),a+=e[n][o]*Math.log(t[n][o]),s+=e[n][o]*e[n][o];var c=e.length*e[0].length,u=l/c,i=r/c,h=(a/c-u*i)/(s/c-u*u),d=i-h*u;return[Math.exp(h),Math.exp(d)]}(n,l),p=k[0];m=f?k[1]:1;for(var g=[],e=0;e<h.length;e++)for(s=0;s<h[e].length;s++){var v=h[e][s],b=m*Math.pow(p,v);g.push(Math.round(1e9*b)/1e9)}return g}catch(e){var _=e;return _=luckysheet.formula.errorInfo(_),[luckysheet.formula.error.v,_]}},LINEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{return luckysheet.formula.error.v}catch(e){var t=e;return t=luckysheet.formula.errorInfo(t),[luckysheet.formula.error.v,t]}},LOGEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{return luckysheet.formula.error.v}catch(e){var t=e;return t=luckysheet.formula.errorInfo(t),[luckysheet.formula.error.v,t]}},MDETERM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t,l=arguments[0],r=[];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;r=luckysheet.func_methods.getDataDyadicArr(l)}else{"object"==luckysheet.getObjType(l)&&null!=l.startCell?r=luckysheet.func_methods.getCellDataDyadicArr(l,"text"):((t=[]).push(l),r.push(t))}for(e=0;e<r.length;e++)for(var a=0;a<r[e].length;a++){if(!luckysheet.func_methods.isRealNum(r[e][a]))return luckysheet.formula.error.v;r[e][a]=parseFloat(r[e][a])}if(r.length!=r[0].length)return luckysheet.formula.error.v;return function(e,t){var l,r=new Array;if(1==t)return l=e[0][0];if(2==t)return l=e[0][0]*e[1][1]-e[0][1]*e[1][0];if(3==t)return l=e[0][0]*e[1][1]*e[2][2]+e[1][0]*e[2][1]*e[0][2]+e[2][0]*e[0][1]*e[1][2]-e[2][0]*e[1][1]*e[0][2]-e[0][0]*e[2][1]*e[1][2]-e[1][0]*e[0][1]*e[2][2];l=0;for(var a=new Array,s=new Array,n=0;n<t;n++)r[n]=e[n][0]*Math.pow(-1,n+1+1);for(n=0;n<t;n++){s[n]=new Array;for(var o=0;o<t-1;o++)s[n][o]=e[n][o+1]}for(n=0;n<t;n++){for(o=0;o<t;o++){a[o]=new Array;for(var c=0;c<t-1;c++)o<n?a[o][c]=s[o][c]:n<o&&(a[o-1][c]=s[o][c])}l+=r[n]*arguments.callee(a,t-1)}return l}(r,r.length)}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},MINVERSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t,l=arguments[0],r=[];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;r=luckysheet.func_methods.getDataDyadicArr(l)}else{"object"==luckysheet.getObjType(l)&&null!=l.startCell?r=luckysheet.func_methods.getCellDataDyadicArr(l,"text"):((t=[]).push(l),r.push(t))}for(e=0;e<r.length;e++)for(var a=0;a<r[e].length;a++){if(!luckysheet.func_methods.isRealNum(r[e][a]))return luckysheet.formula.error.v;r[e][a]=parseFloat(r[e][a])}return r.length!=r[0].length?luckysheet.formula.error.v:luckysheet.matrix_methods.inverse(r)}catch(e){var s=e;return s=luckysheet.formula.errorInfo(s),[luckysheet.formula.error.v,s]}},MMULT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!(y=luckysheet.formula.errorParamCheck(this.p,arguments[e],e))[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("array"==luckysheet.getObjType(t)){if("array"==luckysheet.getObjType(t[0])&&!luckysheet.func_methods.isDyadicArr(t))return luckysheet.formula.error.v;l=luckysheet.func_methods.getDataDyadicArr(t)}else{"object"==luckysheet.getObjType(t)&&null!=t.startCell?l=luckysheet.func_methods.getCellDataDyadicArr(t,"text"):((i=[]).push(t),l.push(i))}for(e=0;e<l.length;e++)for(var r=0;r<l[e].length;r++){if(!luckysheet.func_methods.isRealNum(l[e][r]))return luckysheet.formula.error.v;l[e][r]=parseFloat(l[e][r])}var a=arguments[1],s=[];if("array"==luckysheet.getObjType(a)){if("array"==luckysheet.getObjType(a[0])&&!luckysheet.func_methods.isDyadicArr(a))return luckysheet.formula.error.v;s=luckysheet.func_methods.getDataDyadicArr(a)}else{"object"==luckysheet.getObjType(a)&&null!=a.startCell?s=luckysheet.func_methods.getCellDataDyadicArr(a,"text"):((i=[]).push(a),s.push(i))}for(e=0;e<s.length;e++)for(r=0;r<s[e].length;r++){if(!luckysheet.func_methods.isRealNum(s[e][r]))return luckysheet.formula.error.v;s[e][r]=parseFloat(s[e][r])}if(l[0].length!=s.length)return luckysheet.formula.error.v;for(var n=l.length,o=s[0].length,c=[],u=0;u<n;u++){for(var i=[],h=0;h<o;h++){for(var d=0,y=0;y<l[0].length;y++)d+=l[u][y]*s[y][h];i.push(d)}c.push(i)}return c}catch(e){var f=e;return f=luckysheet.formula.errorInfo(f),[luckysheet.formula.error.v,f]}},SUMPRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("array"==luckysheet.getObjType(t)){if("array"==luckysheet.getObjType(t[0])&&!luckysheet.func_methods.isDyadicArr(t))return luckysheet.formula.error.v;l=luckysheet.func_methods.getDataDyadicArr(t)}else{"object"==luckysheet.getObjType(t)&&null!=t.startCell?l=luckysheet.func_methods.getCellDataDyadicArr(t,"text"):((n=[]).push(t),l.push(n))}for(e=0;e<l.length;e++)for(var r=0;r<l[e].length;r++)luckysheet.func_methods.isRealNum(l[e][r])?l[e][r]=parseFloat(l[e][r]):l[e][r]=0;var a=l.length,s=l[0].length;if(2<=arguments.length)for(e=1;e<arguments.length;e++){var n,o=arguments[e],c=[];if("array"==luckysheet.getObjType(o)){if("array"==luckysheet.getObjType(o[0])&&!luckysheet.func_methods.isDyadicArr(o))return luckysheet.formula.error.v;c=luckysheet.func_methods.getDataDyadicArr(o)}else{"object"==luckysheet.getObjType(o)&&null!=o.startCell?c=luckysheet.func_methods.getCellDataDyadicArr(o,"text"):((n=[]).push(o),c.push(n))}if(c.length!=a||c[0].length!=s)return luckysheet.formula.error.v;for(var u=0;u<a;u++)for(var i=0;i<s;i++)luckysheet.func_methods.isRealNum(c[u][i])?l[u][i]=l[u][i]*parseFloat(c[u][i]):l[u][i]=0}for(var h=0,u=0;u<a;u++)for(i=0;i<s;i++)h+=l[u][i];return h}catch(e){var d=e;return d=luckysheet.formula.errorInfo(d),[luckysheet.formula.error.v,d]}},ISFORMULA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t,l=arguments[0];return"object"==luckysheet.getObjType(l)&&null!=l.startCell?null!=l.data&&(null!=(t="array"==luckysheet.getObjType(l.data)?l.data[0][0]:l.data)&&null!=t.f):luckysheet.formula.error.v}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},CELL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t,l=arguments[0];if("array"==luckysheet.getObjType(l))if("array"==luckysheet.getObjType(l[0])){if(!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=l[0][0]}else t=l[0];else if("object"==luckysheet.getObjType(l)&&null!=l.startCell){if(null==l.data)return luckysheet.formula.error.v;if("array"==luckysheet.getObjType(l.data))return luckysheet.formula.error.v;if(t=l.data.v,luckysheet.func_methods.isRealNull(t))return luckysheet.formula.error.v}else t=l;var r,a=arguments[1];if("object"!=luckysheet.getObjType(a)||null==a.startCell)return luckysheet.formula.error.v;if(r=a.startCell,-1==["address","col","color","contents","filename","format","parentheses","prefix","protect","row","type","width"].indexOf(t))return luckysheet.formula.error.v;var s=luckysheet.getluckysheetfile()[luckysheet.sheetmanage.getSheetIndex(luckysheet.currentSheetIndex)],n=luckysheet.formula.getcellrange(r),o=n.row[0],c=n.column[0];switch(t){case"address":return r;case"col":return c+1;case"color":return 0;case"contents":return null==luckysheet.flowdata[o][c]||null==luckysheet.flowdata[o][c].v||""==luckysheet.flowdata[o][c].v?0:luckysheet.flowdata[o][c].v;case"filename":return s.name;case"format":return null==luckysheet.flowdata[o][c]||null==luckysheet.flowdata[o][c].ct?"G":luckysheet.flowdata[o][c].ct.fa;case"parentheses":return null==luckysheet.flowdata[o][c]||null==luckysheet.flowdata[o][c].v||""==luckysheet.flowdata[o][c].v?0:0<luckysheet.flowdata[o][c].v?1:0;case"prefix":return null==luckysheet.flowdata[o][c]||null==luckysheet.flowdata[o][c].ht||null==luckysheet.flowdata[o][c].v||""==luckysheet.flowdata[o][c].v?"":0==luckysheet.flowdata[o][c].ht?"^":1==luckysheet.flowdata[o][c].ht?"'":2==luckysheet.flowdata[o][c].ht?'"':"";case"protect":return 0;case"row":return o+1;case"type":return null==luckysheet.flowdata[o][c]||null==luckysheet.flowdata[o][c].v||""==luckysheet.flowdata[o][c].v?"b":"l";case"width":var u=s.config;return null!=u.columlen&&c in u.columlen?u.columlen[c]:luckysheet.defaultcollen}}catch(e){var i=e;return i=luckysheet.formula.errorInfo(i),[luckysheet.formula.error.v,i]}},NA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{return luckysheet.formula.error.na}catch(e){var t=e;return t=luckysheet.formula.errorInfo(t),[luckysheet.formula.error.v,t]}},ERROR_TYPE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t,l=arguments[0];if("array"==luckysheet.getObjType(l))if("array"==luckysheet.getObjType(l[0])){if(!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=l[0][0]}else t=l[0];else if("object"==luckysheet.getObjType(l)&&null!=l.startCell){if(null==l.data)return luckysheet.formula.error.na;if("array"==luckysheet.getObjType(l.data)){if(null==(t=l.data[0][0])||luckysheet.func_methods.isRealNull(t.v))return luckysheet.formula.error.na;t=t.v}else{if(luckysheet.func_methods.isRealNull(l.data.v))return luckysheet.formula.error.na;t=l.data.v}}else t=l;var r={"#NULL!":1,"#DIV/0!":2,"#VALUE!":3,"#REF!":4,"#NAME?":5,"#NUM!":6,"#N/A":7,"#GETTING_DATA":8};return t in r?r[t]:luckysheet.formula.error.na}catch(e){var a=e;return a=luckysheet.formula.errorInfo(a),[luckysheet.formula.error.v,a]}},ISBLANK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0];return"object"==luckysheet.getObjType(t)&&null!=t.startCell&&null==t.data}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},ISERR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t,l=arguments[0];if("array"==luckysheet.getObjType(l))if("array"==luckysheet.getObjType(l[0])){if(!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=l[0][0]}else t=l[0];else if("object"==luckysheet.getObjType(l)&&null!=l.startCell){if("array"==luckysheet.getObjType(l.data))return!0;if(null==l.data||luckysheet.func_methods.isRealNull(l.data.v))return!1;t=l.data.v}else t=l;return-1<["#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(t)}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},ISERROR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t,l=arguments[0];if("array"==luckysheet.getObjType(l))if("array"==luckysheet.getObjType(l[0])){if(!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=l[0][0]}else t=l[0];else if("object"==luckysheet.getObjType(l)&&null!=l.startCell){if("array"==luckysheet.getObjType(l.data))return!0;if(null==l.data||luckysheet.func_methods.isRealNull(l.data.v))return!1;t=l.data.v}else t=l;return-1<["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(t)}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},ISLOGICAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t,l=arguments[0];if("array"==luckysheet.getObjType(l))if("array"==luckysheet.getObjType(l[0])){if(!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=l[0][0]}else t=l[0];else if("object"==luckysheet.getObjType(l)&&null!=l.startCell){if("array"==luckysheet.getObjType(l.data))return!1;if(null==l.data||luckysheet.func_methods.isRealNull(l.data.v))return!1;t=l.data.v}else t=l;return"true"==t.toString().toLowerCase()||"false"==t.toString().toLowerCase()}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},ISNA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t,l=arguments[0];if("array"==luckysheet.getObjType(l))if("array"==luckysheet.getObjType(l[0])){if(!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=l[0][0]}else t=l[0];else if("object"==luckysheet.getObjType(l)&&null!=l.startCell){if("array"==luckysheet.getObjType(l.data))return!1;if(null==l.data||luckysheet.func_methods.isRealNull(l.data.v))return!1;t=l.data.v}else t=l;return"#N/A"==t.toString()}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},ISNONTEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t,l=arguments[0];if("array"==luckysheet.getObjType(l))if("array"==luckysheet.getObjType(l[0])){if(!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=l[0][0]}else t=l[0];else if("object"==luckysheet.getObjType(l)&&null!=l.startCell){if("array"==luckysheet.getObjType(l.data))return!0;if(null==l.data||luckysheet.func_methods.isRealNull(l.data.v))return!0;t=l.data.v}else t=l;return-1<["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(t)||("true"==t.toString().toLowerCase()||"false"==t.toString().toLowerCase()||!!luckysheet.func_methods.isRealNum(t))}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},ISNUMBER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t,l=arguments[0];if("array"==luckysheet.getObjType(l))if("array"==luckysheet.getObjType(l[0])){if(!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=l[0][0]}else t=l[0];else if("object"==luckysheet.getObjType(l)&&null!=l.startCell){if("array"==luckysheet.getObjType(l.data))return!1;if(null==l.data||luckysheet.func_methods.isRealNull(l.data.v))return!1;t=l.data.v}else t=l;return!!luckysheet.func_methods.isRealNum(t)}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},ISREF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{return"object"==luckysheet.getObjType(arguments[0])&&null!=arguments[0].startCell}catch(e){var t=e;return t=luckysheet.formula.errorInfo(t),[luckysheet.formula.error.v,t]}},ISTEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t,l=arguments[0];if("array"==luckysheet.getObjType(l))if("array"==luckysheet.getObjType(l[0])){if(!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=l[0][0]}else t=l[0];else if("object"==luckysheet.getObjType(l)&&null!=l.startCell){if("array"==luckysheet.getObjType(l.data))return!1;if(null==l.data||luckysheet.func_methods.isRealNull(l.data.v))return!1;t=l.data.v}else t=l;return!(-1<["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(t))&&("true"!=t.toString().toLowerCase()&&"false"!=t.toString().toLowerCase()&&!luckysheet.func_methods.isRealNum(t))}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},TYPE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t,l=arguments[0];if("array"==luckysheet.getObjType(l))return 64;if("object"==luckysheet.getObjType(l)&&null!=l.startCell){if("array"==luckysheet.getObjType(l.data))return 16;if(null==l.data||luckysheet.func_methods.isRealNull(l.data.v))return 1;t=l.data.v}else t=l;return-1<["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(t)?16:"true"==t.toString().toLowerCase()||"false"==t.toString().toLowerCase()?4:luckysheet.func_methods.isRealNum(t)?1:2}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},N:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t,l=arguments[0];if("array"==luckysheet.getObjType(l))if("array"==luckysheet.getObjType(l[0])){if(!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;t=l[0][0]}else t=l[0];else if("object"==luckysheet.getObjType(l)&&null!=l.startCell)if("array"==luckysheet.getObjType(l.data)){if(null==(t=l.data[0][0])||luckysheet.func_methods.isRealNull(t.v))return 0;t=t.v}else{if(null==l.data||luckysheet.func_methods.isRealNull(l.data.v))return 0;t=l.data.v}else t=l;return-1<["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(t)?t:"true"==t.toString().toLowerCase()||"false"==t.toString().toLowerCase()?"true"==t.toString().toLowerCase()?1:0:luckysheet.func_methods.isRealNum(t)?parseFloat(t):0}catch(e){var r=e;return r=luckysheet.formula.errorInfo(r),[luckysheet.formula.error.v,r]}},TO_DATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseFloat(t),luckysheet.mask.update("yyyy-mm-dd",t)):luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},TO_PURE_NUMBER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");return luckysheet.func_methods.valueIsError(t)?t:moment(t).isValid()?luckysheet.mask.genarate(t)[2]:null==numeral(t).value()?t:numeral(t).value()}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},TO_TEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0],"text");return luckysheet.func_methods.valueIsError(t)?t:luckysheet.mask.update("@",t)}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},TO_DOLLARS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseFloat(t),luckysheet.mask.update("$ 0.00",t)):luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},TO_PERCENT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);return luckysheet.func_methods.valueIsError(t)?t:luckysheet.func_methods.isRealNum(t)?(t=parseFloat(t),luckysheet.mask.update("0%",t)):luckysheet.formula.error.v}catch(e){var l=e;return l=luckysheet.formula.errorInfo(l),[luckysheet.formula.error.v,l]}},DGET:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("object"!=luckysheet.getObjType(t)||null==t.startCell)return luckysheet.formula.error.v;if(null==t.data)return luckysheet.formula.error.v;l=luckysheet.func_methods.getCellDataDyadicArr(t,"text");var r=luckysheet.func_methods.getFirstValue(arguments[1],"text");if(luckysheet.func_methods.valueIsError(r))return r;if(luckysheet.func_methods.isRealNull(r))return luckysheet.formula.error.v;var a=arguments[2],s=[];if("object"!=luckysheet.getObjType(a)||null==a.startCell)return luckysheet.formula.error.v;if(null==a.data)return luckysheet.formula.error.v;if(s=luckysheet.func_methods.getCellDataDyadicArr(a,"text"),!luckysheet.func_methods.isRealNum(r)&&"string"!==luckysheet.getObjType(r))return luckysheet.formula.error.v;var n,o=luckysheet.func_methods.findResultIndex(l,s),c=[];return c="string"===luckysheet.getObjType(r)?(n=luckysheet.func_methods.findField(l,r),luckysheet.func_methods.rest(l[n])):luckysheet.func_methods.rest(l[r]),0===o.length?luckysheet.formula.error.v:1<o.length?luckysheet.formula.error.nm:c[o[0]]}catch(e){var u=e;return u=luckysheet.formula.errorInfo(u),[luckysheet.formula.error.v,u]}},DMAX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("object"!=luckysheet.getObjType(t)||null==t.startCell)return luckysheet.formula.error.v;if(null==t.data)return luckysheet.formula.error.v;l=luckysheet.func_methods.getCellDataDyadicArr(t,"text");var r=luckysheet.func_methods.getFirstValue(arguments[1],"text");if(luckysheet.func_methods.valueIsError(r))return r;if(luckysheet.func_methods.isRealNull(r))return luckysheet.formula.error.v;var a=arguments[2],s=[];if("object"!=luckysheet.getObjType(a)||null==a.startCell)return luckysheet.formula.error.v;if(null==a.data)return luckysheet.formula.error.v;if(s=luckysheet.func_methods.getCellDataDyadicArr(a,"text"),!luckysheet.func_methods.isRealNum(r)&&"string"!==luckysheet.getObjType(r))return luckysheet.formula.error.v;for(var n,o=luckysheet.func_methods.findResultIndex(l,s),c=[],u=(c="string"===luckysheet.getObjType(r)?(n=luckysheet.func_methods.findField(l,r),luckysheet.func_methods.rest(l[n])):luckysheet.func_methods.rest(l[r]))[o[0]],e=1;e<o.length;e++)u<c[o[e]]&&(u=c[o[e]]);return u}catch(e){var i=e;return i=luckysheet.formula.errorInfo(i),[luckysheet.formula.error.v,i]}},DMIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("object"!=luckysheet.getObjType(t)||null==t.startCell)return luckysheet.formula.error.v;if(null==t.data)return luckysheet.formula.error.v;l=luckysheet.func_methods.getCellDataDyadicArr(t,"text");var r=luckysheet.func_methods.getFirstValue(arguments[1],"text");if(luckysheet.func_methods.valueIsError(r))return r;if(luckysheet.func_methods.isRealNull(r))return luckysheet.formula.error.v;var a=arguments[2],s=[];if("object"!=luckysheet.getObjType(a)||null==a.startCell)return luckysheet.formula.error.v;if(null==a.data)return luckysheet.formula.error.v;if(s=luckysheet.func_methods.getCellDataDyadicArr(a,"text"),!luckysheet.func_methods.isRealNum(r)&&"string"!==luckysheet.getObjType(r))return luckysheet.formula.error.v;for(var n,o=findResultIndex(l,s),c=[],u=(c="string"===luckysheet.getObjType(r)?(n=findField(l,r),rest(l[n])):rest(l[r]))[o[0]],e=1;e<o.length;e++)u>c[o[e]]&&(u=c[o[e]]);return u}catch(e){var i=e;return i=luckysheet.formula.errorInfo(i),[luckysheet.formula.error.v,i]}},DAVERAGE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("object"!=luckysheet.getObjType(t)||null==t.startCell)return luckysheet.formula.error.v;if(null==t.data)return luckysheet.formula.error.v;l=luckysheet.func_methods.getCellDataDyadicArr(t,"text");var r=luckysheet.func_methods.getFirstValue(arguments[1],"text");if(luckysheet.func_methods.valueIsError(r))return r;if(luckysheet.func_methods.isRealNull(r))return luckysheet.formula.error.v;var a=arguments[2],s=[];if("object"!=luckysheet.getObjType(a)||null==a.startCell)return luckysheet.formula.error.v;if(null==a.data)return luckysheet.formula.error.v;if(s=luckysheet.func_methods.getCellDataDyadicArr(a,"text"),!luckysheet.func_methods.isRealNum(r)&&"string"!==luckysheet.getObjType(r))return luckysheet.formula.error.v;var n,o=luckysheet.func_methods.findResultIndex(l,s),c=[];c="string"===luckysheet.getObjType(r)?(n=luckysheet.func_methods.findField(l,r),luckysheet.func_methods.rest(l[n])):luckysheet.func_methods.rest(l[r]);for(var u=0,e=0;e<o.length;e++)u+=c[o[e]];return 0===o.length?luckysheet.formula.error.d:u/o.length}catch(e){var i=e;return i=luckysheet.formula.errorInfo(i),[luckysheet.formula.error.v,i]}},DCOUNT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("object"!=luckysheet.getObjType(t)||null==t.startCell)return luckysheet.formula.error.v;if(null==t.data)return luckysheet.formula.error.v;l=luckysheet.func_methods.getCellDataDyadicArr(t,"text");var r=luckysheet.func_methods.getFirstValue(arguments[1],"text");if(luckysheet.func_methods.valueIsError(r))return r;if(luckysheet.func_methods.isRealNull(r))return luckysheet.formula.error.v;var a=arguments[2],s=[];if("object"!=luckysheet.getObjType(a)||null==a.startCell)return luckysheet.formula.error.v;if(null==a.data)return luckysheet.formula.error.v;if(s=luckysheet.func_methods.getCellDataDyadicArr(a,"text"),!luckysheet.func_methods.isRealNum(r)&&"string"!==luckysheet.getObjType(r))return luckysheet.formula.error.v;var n,o=luckysheet.func_methods.findResultIndex(l,s),c=[];c="string"===luckysheet.getObjType(r)?(n=luckysheet.func_methods.findField(l,r),luckysheet.func_methods.rest(l[n])):luckysheet.func_methods.rest(l[r]);for(var u=[],e=0;e<o.length;e++)u[e]=c[o[e]];return window.luckysheet_function.COUNT.f.apply(window.luckysheet_function.COUNT,u)}catch(e){var i=e;return i=luckysheet.formula.errorInfo(i),[luckysheet.formula.error.v,i]}},DCOUNTA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("object"!=luckysheet.getObjType(t)||null==t.startCell)return luckysheet.formula.error.v;if(null==t.data)return luckysheet.formula.error.v;l=luckysheet.func_methods.getCellDataDyadicArr(t,"text");var r=luckysheet.func_methods.getFirstValue(arguments[1],"text");if(luckysheet.func_methods.valueIsError(r))return r;if(luckysheet.func_methods.isRealNull(r))return luckysheet.formula.error.v;var a=arguments[2],s=[];if("object"!=luckysheet.getObjType(a)||null==a.startCell)return luckysheet.formula.error.v;if(null==a.data)return luckysheet.formula.error.v;if(s=luckysheet.func_methods.getCellDataDyadicArr(a,"text"),!luckysheet.func_methods.isRealNum(r)&&"string"!==luckysheet.getObjType(r))return luckysheet.formula.error.v;var n,o=luckysheet.func_methods.findResultIndex(l,s),c=[];c="string"===luckysheet.getObjType(r)?(n=luckysheet.func_methods.findField(l,r),luckysheet.func_methods.rest(l[n])):luckysheet.func_methods.rest(l[r]);for(var u=[],e=0;e<o.length;e++)u[e]=c[o[e]];return window.luckysheet_function.COUNTA.f.apply(window.luckysheet_function.COUNTA,u)}catch(e){var i=e;return i=luckysheet.formula.errorInfo(i),[luckysheet.formula.error.v,i]}},DPRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("object"!=luckysheet.getObjType(t)||null==t.startCell)return luckysheet.formula.error.v;if(null==t.data)return luckysheet.formula.error.v;l=luckysheet.func_methods.getCellDataDyadicArr(t,"text");var r=luckysheet.func_methods.getFirstValue(arguments[1],"text");if(luckysheet.func_methods.valueIsError(r))return r;if(luckysheet.func_methods.isRealNull(r))return luckysheet.formula.error.v;var a=arguments[2],s=[];if("object"!=luckysheet.getObjType(a)||null==a.startCell)return luckysheet.formula.error.v;if(null==a.data)return luckysheet.formula.error.v;if(s=luckysheet.func_methods.getCellDataDyadicArr(a,"text"),!luckysheet.func_methods.isRealNum(r)&&"string"!==luckysheet.getObjType(r))return luckysheet.formula.error.v;var n,o=luckysheet.func_methods.findResultIndex(l,s),c=[];c="string"===luckysheet.getObjType(r)?(n=luckysheet.func_methods.findField(l,r),luckysheet.func_methods.rest(l[n])):luckysheet.func_methods.rest(l[r]);for(var u=[],e=0;e<o.length;e++)u[e]=c[o[e]];u=luckysheet.func_methods.compact(u);var i=1;for(e=0;e<u.length;e++)i*=u[e];return i}catch(e){var h=e;return h=luckysheet.formula.errorInfo(h),[luckysheet.formula.error.v,h]}},DSTDEV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("object"!=luckysheet.getObjType(t)||null==t.startCell)return luckysheet.formula.error.v;if(null==t.data)return luckysheet.formula.error.v;l=luckysheet.func_methods.getCellDataDyadicArr(t,"text");var r=luckysheet.func_methods.getFirstValue(arguments[1],"text");if(luckysheet.func_methods.valueIsError(r))return r;if(luckysheet.func_methods.isRealNull(r))return luckysheet.formula.error.v;var a=arguments[2],s=[];if("object"!=luckysheet.getObjType(a)||null==a.startCell)return luckysheet.formula.error.v;if(null==a.data)return luckysheet.formula.error.v;if(s=luckysheet.func_methods.getCellDataDyadicArr(a,"text"),!luckysheet.func_methods.isRealNum(r)&&"string"!==luckysheet.getObjType(r))return luckysheet.formula.error.v;var n,o=luckysheet.func_methods.findResultIndex(l,s),c=[];c="string"===luckysheet.getObjType(r)?(n=luckysheet.func_methods.findField(l,r),luckysheet.func_methods.rest(l[n])):luckysheet.func_methods.rest(l[r]);for(var u=[],e=0;e<o.length;e++)u[e]=c[o[e]];return u=luckysheet.func_methods.compact(u),window.luckysheet_function.STDEVA.f.apply(window.luckysheet_function.STDEVA,u)}catch(e){var i=e;return i=luckysheet.formula.errorInfo(i),[luckysheet.formula.error.v,i]}},DSTDEVP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("object"!=luckysheet.getObjType(t)||null==t.startCell)return luckysheet.formula.error.v;if(null==t.data)return luckysheet.formula.error.v;l=luckysheet.func_methods.getCellDataDyadicArr(t,"text");var r=luckysheet.func_methods.getFirstValue(arguments[1],"text");if(luckysheet.func_methods.valueIsError(r))return r;if(luckysheet.func_methods.isRealNull(r))return luckysheet.formula.error.v;var a=arguments[2],s=[];if("object"!=luckysheet.getObjType(a)||null==a.startCell)return luckysheet.formula.error.v;if(null==a.data)return luckysheet.formula.error.v;if(s=luckysheet.func_methods.getCellDataDyadicArr(a,"text"),!luckysheet.func_methods.isRealNum(r)&&"string"!==luckysheet.getObjType(r))return luckysheet.formula.error.v;var n,o=luckysheet.func_methods.findResultIndex(l,s),c=[];c="string"===luckysheet.getObjType(r)?(n=luckysheet.func_methods.findField(l,r),luckysheet.func_methods.rest(l[n])):luckysheet.func_methods.rest(l[r]);for(var u=[],e=0;e<o.length;e++)u[e]=c[o[e]];return u=luckysheet.func_methods.compact(u),window.luckysheet_function.STDEVP.f.apply(window.luckysheet_function.STDEVP,u)}catch(e){var i=e;return i=luckysheet.formula.errorInfo(i),[luckysheet.formula.error.v,i]}},DSUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("object"!=luckysheet.getObjType(t)||null==t.startCell)return luckysheet.formula.error.v;if(null==t.data)return luckysheet.formula.error.v;l=luckysheet.func_methods.getCellDataDyadicArr(t,"text");var r=luckysheet.func_methods.getFirstValue(arguments[1],"text");if(luckysheet.func_methods.valueIsError(r))return r;if(luckysheet.func_methods.isRealNull(r))return luckysheet.formula.error.v;var a=arguments[2],s=[];if("object"!=luckysheet.getObjType(a)||null==a.startCell)return luckysheet.formula.error.v;if(null==a.data)return luckysheet.formula.error.v;if(s=luckysheet.func_methods.getCellDataDyadicArr(a,"text"),!luckysheet.func_methods.isRealNum(r)&&"string"!==luckysheet.getObjType(r))return luckysheet.formula.error.v;var n,o=luckysheet.func_methods.findResultIndex(l,s),c=[];c="string"===luckysheet.getObjType(r)?(n=luckysheet.func_methods.findField(l,r),luckysheet.func_methods.rest(l[n])):luckysheet.func_methods.rest(l[r]);for(var u=[],e=0;e<o.length;e++)u[e]=c[o[e]];u=luckysheet.func_methods.compact(u);var i=0;for(e=0;e<u.length;e++)i+=u[e];return i}catch(e){var h=e;return h=luckysheet.formula.errorInfo(h),[luckysheet.formula.error.v,h]}},DVAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("object"!=luckysheet.getObjType(t)||null==t.startCell)return luckysheet.formula.error.v;if(null==t.data)return luckysheet.formula.error.v;l=luckysheet.func_methods.getCellDataDyadicArr(t,"text");var r=luckysheet.func_methods.getFirstValue(arguments[1],"text");if(luckysheet.func_methods.valueIsError(r))return r;if(luckysheet.func_methods.isRealNull(r))return luckysheet.formula.error.v;var a=arguments[2],s=[];if("object"!=luckysheet.getObjType(a)||null==a.startCell)return luckysheet.formula.error.v;if(null==a.data)return luckysheet.formula.error.v;if(s=luckysheet.func_methods.getCellDataDyadicArr(a,"text"),!luckysheet.func_methods.isRealNum(r)&&"string"!==luckysheet.getObjType(r))return luckysheet.formula.error.v;var n,o=luckysheet.func_methods.findResultIndex(l,s),c=[];c="string"===luckysheet.getObjType(r)?(n=luckysheet.func_methods.findField(l,r),luckysheet.func_methods.rest(l[n])):luckysheet.func_methods.rest(l[r]);for(var u=[],e=0;e<o.length;e++)u[e]=c[o[e]];return u=luckysheet.func_methods.compact(u),window.luckysheet_function.VAR_S.f.apply(window.luckysheet_function.VAR_S,u)}catch(e){var i=e;return i=luckysheet.formula.errorInfo(i),[luckysheet.formula.error.v,i]}},DVARP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("object"!=luckysheet.getObjType(t)||null==t.startCell)return luckysheet.formula.error.v;if(null==t.data)return luckysheet.formula.error.v;l=luckysheet.func_methods.getCellDataDyadicArr(t,"text");var r=luckysheet.func_methods.getFirstValue(arguments[1],"text");if(luckysheet.func_methods.valueIsError(r))return r;if(luckysheet.func_methods.isRealNull(r))return luckysheet.formula.error.v;var a=arguments[2],s=[];if("object"!=luckysheet.getObjType(a)||null==a.startCell)return luckysheet.formula.error.v;if(null==a.data)return luckysheet.formula.error.v;if(s=luckysheet.func_methods.getCellDataDyadicArr(a,"text"),!luckysheet.func_methods.isRealNum(r)&&"string"!==luckysheet.getObjType(r))return luckysheet.formula.error.v;var n,o=luckysheet.func_methods.findResultIndex(l,s),c=[];c="string"===luckysheet.getObjType(r)?(n=luckysheet.func_methods.findField(l,r),luckysheet.func_methods.rest(l[n])):luckysheet.func_methods.rest(l[r]);for(var u=[],e=0;e<o.length;e++)u[e]=c[o[e]];return u=luckysheet.func_methods.compact(u),window.luckysheet_function.VAR_P.f.apply(window.luckysheet_function.VAR_P,u)}catch(e){var i=e;return i=luckysheet.formula.errorInfo(i),[luckysheet.formula.error.v,i]}},LINESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,r=(window.luckysheetCurrentFunction,luckysheet.formula.colorList),a=arguments[0],s=arguments[1],n=arguments[2],o=arguments[3],c=arguments[4],u=arguments[5],i=arguments[6],h=arguments[7],d=luckysheet.formula.readCellDataToOneArray(a),y=luckysheet.menuButton.getCellRealSize(luckysheet.flowdata,t,l),f=y[0],m=y[1],k={};null==n&&(n=1),k.lineWidth=n,k.offsetY=n+1,k.height=m-(n+1),k.width=f;function p(e,t){t&&("number"==typeof t&&(19<t&&(t%=20),t=r[t]),k[e]=t)}var g;return null==s&&(s="#2ec7c9"),p("lineColor",s),k.fillColor=0,o&&("string"==typeof o?(o=o.toLowerCase(),g=null,"min"==o?g=window.luckysheet_function.MIN.f({data:d}):"max"==o?g=window.luckysheet_function.MAX.f({data:d}):"avg"==o||"mean"==o?g=window.luckysheet_function.AVERAGE.f({data:d}):"median"==o&&(g=window.luckysheet_function.MEDIAN.f({data:d})),g&&(k.normalRangeMin=g,k.normalRangeMax=g)):(k.normalRangeMin=o,k.normalRangeMax=o)),null==c&&(c="#000"),p("normalRangeColor",c),p("maxSpotColor",u),p("minSpotColor",i),null==h&&(h="1.5"),k.spotRadius=h,luckysheet.sparkline.init(d,k)}catch(e){var v=e;return v=luckysheet.formula.errorInfo(v),[luckysheet.formula.error.v,v]}},AREASPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,r=(window.luckysheetCurrentFunction,luckysheet.formula.colorList),a=arguments[0],s=arguments[1],n=arguments[2],o=arguments[3],c=arguments[4],u=arguments[5],i=luckysheet.formula.readCellDataToOneArray(a),h=luckysheet.menuButton.getCellRealSize(luckysheet.flowdata,t,l),d=h[0],y=h[1],f={};null==o&&(o=1),f.lineWidth=o,f.offsetY=o+1,f.height=y-(o+1),f.width=d;function m(e,t){t&&("number"==typeof t&&(19<t&&(t%=20),t=r[t]),f[e]=t)}var k;return null==s&&(s="#2ec7c9"),m("lineColor",s),m("fillColor",n),null==o&&(o="1"),f.lineWidth=o,c&&("string"==typeof c?(c=c.toLowerCase(),k=null,"min"==c?k=window.luckysheet_function.MIN.f({data:i}):"max"==c?k=window.luckysheet_function.MAX.f({data:i}):"avg"==c||"mean"==c?k=window.luckysheet_function.AVERAGE.f({data:i}):"median"==c&&(k=window.luckysheet_function.MEDIAN.f({data:i})),k&&(f.normalRangeMin=k,f.normalRangeMax=k)):(f.normalRangeMin=c,f.normalRangeMax=c)),null==u&&(u="#000"),m("normalRangeColor",u),luckysheet.sparkline.init(i,f)}catch(e){var p=e;return p=luckysheet.formula.errorInfo(p),[luckysheet.formula.error.v,p]}},COLUMNSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,r=(window.luckysheetCurrentFunction,luckysheet.formula.colorList),a=arguments[0],s=luckysheet.formula.readCellDataToOneArray(a),n=luckysheet.menuButton.getCellRealSize(luckysheet.flowdata,t,l),o=n[0],c=n[1],u={};u.height=c,u.width=o;function i(e,t){t&&("number"==typeof t&&(19<t&&(t%=20),t=r[t]),u[e]=t)}var h=arguments[1],d=arguments[2],y=arguments[3],f=arguments[4];u.type="column",null==h&&(h="1"),u.barSpacing=h,null==d&&(d="#fc5c5c"),i("barColor",d),null==y&&(y="#97b552"),i("negBarColor",y),u.chartRangeMax=null==f||!1===f||"number"!=typeof f?void 0:f;var m=luckysheet.formula.sparklinesColorMap(arguments);return m&&(u.colorMap=m),luckysheet.sparkline.init(s,u)}catch(e){var k=e;return k=luckysheet.formula.errorInfo(k),[luckysheet.formula.error.v,k]}},STACKCOLUMNSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var i=0;i<arguments.length;i++){var p=luckysheet.formula.errorParamCheck(this.p,arguments[i],i);if(!p[0])return luckysheet.formula.error.v}try{var cell_r=window.luckysheetCurrentRow,cell_c=window.luckysheetCurrentColumn,cell_fp=window.luckysheetCurrentFunction,colorList=luckysheet.formula.colorList,rangeValue=arguments[0],dataformat=[],data=[];if(null!=rangeValue&&null!=rangeValue.data&&(data=rangeValue.data),"array"==luckysheet.getObjType(data))data=luckysheet.formula.getPureValueByData(data);else{if("object"==luckysheet.getObjType(data))return data=data.v,[data];/\{.*?\}/.test(data)&&(data=data.replace(/\{/g,"[").replace(/\}/g,"]")),data=eval("("+data+")")}var stackconfig=arguments[1],offsetY=data.length;if(null==stackconfig||stackconfig)for(var c=0;c<data[0].length;c++){for(var colstr="",r=0;r<data.length;r++)colstr+=data[r][c]+":";colstr=colstr.substr(0,colstr.length-1),dataformat.push(colstr)}else{for(var r=0;r<data.length;r++){for(var rowstr="",c=0;c<data[0].length;c++)rowstr+=data[r][c]+":";rowstr=rowstr.substr(0,rowstr.length-1),dataformat.push(rowstr)}var offsetY=data[0].length}var cellSize=luckysheet.menuButton.getCellRealSize(luckysheet.flowdata,cell_r,cell_c),width=cellSize[0],height=cellSize[1],sparksetting={};sparksetting.height=height,sparksetting.width=width;var sparkColorSetting=function(e,t){t&&("number"==typeof t&&(19<t&&(t%=20),t=colorList[t]),sparksetting[e]=t)},barSpacing=arguments[2],chartRangeMax=arguments[3];sparksetting.type="column",null==barSpacing&&(barSpacing="1"),sparksetting.barSpacing=barSpacing,sparksetting.chartRangeMax=null==chartRangeMax||!1===chartRangeMax||"number"!=typeof chartRangeMax?void 0:chartRangeMax;var colorLists=luckysheet.formula.sparklinesColorMap(arguments,4);colorLists&&(sparksetting.colorMap=colorLists);var temp1=luckysheet.sparkline.init(dataformat,sparksetting);return temp1}catch(e){var err=e;return err=luckysheet.formula.errorInfo(err),[luckysheet.formula.error.v,err]}},BARSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,r=(window.luckysheetCurrentFunction,luckysheet.formula.colorList),a=arguments[0],s=luckysheet.formula.readCellDataToOneArray(a),n=luckysheet.menuButton.getCellRealSize(luckysheet.flowdata,t,l),o=n[0],c=n[1],u={};u.height=c,u.width=o;function i(e,t){t&&("number"==typeof t&&(19<t&&(t%=20),t=r[t]),u[e]=t)}var h=arguments[1],d=arguments[2],y=arguments[3],f=arguments[4];u.type="bar",null==h&&(h="1"),u.barSpacing=h,null==d&&(d="#fc5c5c"),i("barColor",d),null==y&&(y="#97b552"),i("negBarColor",y),u.chartRangeMax=null==f||!1===f||"number"!=typeof f?void 0:f;var m=luckysheet.formula.sparklinesColorMap(arguments);return m&&(u.colorMap=m),luckysheet.sparkline.init(s,u)}catch(e){var k=e;return k=luckysheet.formula.errorInfo(k),[luckysheet.formula.error.v,k]}},STACKBARSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var i=0;i<arguments.length;i++){var p=luckysheet.formula.errorParamCheck(this.p,arguments[i],i);if(!p[0])return luckysheet.formula.error.v}try{var cell_r=window.luckysheetCurrentRow,cell_c=window.luckysheetCurrentColumn,cell_fp=window.luckysheetCurrentFunction,colorList=luckysheet.formula.colorList,rangeValue=arguments[0],dataformat=[],data=[];if(null!=rangeValue&&null!=rangeValue.data&&(data=rangeValue.data),"array"==luckysheet.getObjType(data))data=luckysheet.formula.getPureValueByData(data);else{if("object"==luckysheet.getObjType(data))return data=data.v,[data];/\{.*?\}/.test(data)&&(data=data.replace(/\{/g,"[").replace(/\}/g,"]")),data=eval("("+data+")")}var stackconfig=arguments[1],offsetY=data.length;if(null==stackconfig||stackconfig)for(var c=0;c<data[0].length;c++){for(var colstr="",r=0;r<data.length;r++)colstr+=data[r][c]+":";colstr=colstr.substr(0,colstr.length-1),dataformat.push(colstr)}else{for(var r=0;r<data.length;r++){for(var rowstr="",c=0;c<data[0].length;c++)rowstr+=data[r][c]+":";rowstr=rowstr.substr(0,rowstr.length-1),dataformat.push(rowstr)}var offsetY=data[0].length}var cellSize=luckysheet.menuButton.getCellRealSize(luckysheet.flowdata,cell_r,cell_c),width=cellSize[0],height=cellSize[1],sparksetting={};sparksetting.height=height,sparksetting.width=width;var sparkColorSetting=function(e,t){t&&("number"==typeof t&&(19<t&&(t%=20),t=colorList[t]),sparksetting[e]=t)},barSpacing=arguments[2],chartRangeMax=arguments[3];sparksetting.type="bar",null==barSpacing&&(barSpacing="1"),sparksetting.barSpacing=barSpacing,sparksetting.chartRangeMax=null==chartRangeMax||!1===chartRangeMax||"number"!=typeof chartRangeMax?void 0:chartRangeMax;var colorLists=luckysheet.formula.sparklinesColorMap(arguments,4);colorLists&&(sparksetting.colorMap=colorLists);var temp1=luckysheet.sparkline.init(dataformat,sparksetting);return temp1}catch(e){var err=e;return err=luckysheet.formula.errorInfo(err),[luckysheet.formula.error.v,err]}},DISCRETESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,r=(window.luckysheetCurrentFunction,luckysheet.formula.colorList),a=arguments[0],s=luckysheet.formula.readCellDataToOneArray(a),n=luckysheet.menuButton.getCellRealSize(luckysheet.flowdata,t,l),o=n[0],c=n[1],u={};u.height=c,u.width=o;function i(e,t){t&&("number"==typeof t&&(19<t&&(t%=20),t=r[t]),u[e]=t)}var h=arguments[1],d=arguments[2],y=arguments[3];return u.type="discrete",null==h&&(h=0),u.thresholdValue=h,null==d&&(d="#2ec7c9"),i("lineColor",d),null==y&&(y="#fc5c5c"),i("thresholdColor",y),luckysheet.sparkline.init(s,u)}catch(e){var f=e;return f=luckysheet.formula.errorInfo(f),[luckysheet.formula.error.v,f]}},TRISTATESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,r=(window.luckysheetCurrentFunction,luckysheet.formula.colorList),a=arguments[0],s=luckysheet.formula.readCellDataToOneArray(a),n=luckysheet.menuButton.getCellRealSize(luckysheet.flowdata,t,l),o=n[0],c=n[1],u={};u.height=c,u.width=o;function i(e,t){t&&("number"==typeof t&&(19<t&&(t%=20),t=r[t]),u[e]=t)}var h=arguments[1],d=arguments[2],y=arguments[3],f=arguments[4];u.type="tristate",null==h&&(h="1"),u.barSpacing=h,null==d&&(d="#fc5c5c"),i("barColor",d),null==y&&(y="#97b552"),i("negBarColor",y),null==f&&(f="#999"),i("zeroBarColor",f);var m=luckysheet.formula.sparklinesColorMap(arguments);return m&&(u.colorMap=m),luckysheet.sparkline.init(s,u)}catch(e){var k=e;return k=luckysheet.formula.errorInfo(k),[luckysheet.formula.error.v,k]}},PIESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,r=(window.luckysheetCurrentFunction,luckysheet.formula.colorList),a=arguments[0],s=luckysheet.formula.readCellDataToOneArray(a),n=luckysheet.menuButton.getCellRealSize(luckysheet.flowdata,t,l),o=n[0],c=n[1],u={};u.height=c,u.width=o;function i(e,t){t&&("number"==typeof t&&(19<t&&(t%=20),t=r[t]),u[e]=t)}var h=arguments[1],d=arguments[2],y=arguments[3];u.type="pie",null==h&&(h=0),u.offset=h,null==d&&(d=0),i("borderWidth",d),null==y&&(y="#97b552"),i("borderColor",y);var f=luckysheet.formula.sparklinesColorMap(arguments,4);return f&&(u.colorMap=f),luckysheet.sparkline.init(s,u)}catch(e){var m=e;return m=luckysheet.formula.errorInfo(m),[luckysheet.formula.error.v,m]}},BOXSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,r=(window.luckysheetCurrentFunction,luckysheet.formula.colorList),a=arguments[0],s=luckysheet.formula.readCellDataToOneArray(a),n=luckysheet.menuButton.getCellRealSize(luckysheet.flowdata,t,l),o=n[0],c=n[1],u={};u.height=c,u.width=o;function i(e,t){t&&("number"==typeof t&&(19<t&&(t%=20),t=r[t]),u[e]=t)}var h=arguments[1],d=arguments[2],y=arguments[3];return u.type="box",null==h&&(h=1.5),u.outlierIQR=h,null==d?d=0:i("target",d),null==y&&(y=1.5),i("spotRadius",y),luckysheet.sparkline.init(s,u)}catch(e){var f=e;return f=luckysheet.formula.errorInfo(f),[luckysheet.formula.error.v,f]}},BULLETSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,r=(window.luckysheetCurrentFunction,luckysheet.formula.colorList,luckysheet.menuButton.getCellRealSize(luckysheet.flowdata,t,l)),a=r[0],s=r[1],n={};n.height=s,n.width=a;var o=[];luckysheet_getValue(arguments);var c=luckysheet.formula.getValueByFuncData(arguments[0]),u=luckysheet.formula.getValueByFuncData(arguments[1]);o.push(c),o.push(u);for(e=2;e<arguments.length;e++)o.push(luckysheet.formula.getValueByFuncData(arguments[e]));return n.type="bullet",luckysheet.sparkline.init(o,n)}catch(e){var i=e;return i=luckysheet.formula.errorInfo(i),[luckysheet.formula.error.v,i]}},SORT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[],r=1,a=1;if("array"==luckysheet.getObjType(t))if("array"==luckysheet.getObjType(t[0])){if(!luckysheet.func_methods.isDyadicArr(t))return luckysheet.formula.error.v;for(e=0;e<t.length;e++){for(var s=[],n=0;n<t[e].length;n++){var o=t[e][n];s.push(o)}l.push(s)}r=l.length,a=l[0].length}else{for(e=0;e<t.length;e++){o=t[e];l.push(o)}r=l.length}else if("object"==luckysheet.getObjType(t)&&null!=t.startCell)if(null!=t.data)if("array"==luckysheet.getObjType(t.data)){for(e=0;e<t.data.length;e++){for(s=[],n=0;n<t.data[e].length;n++){null!=t.data[e][n]?(o=t.data[e][n].v,luckysheet.func_methods.isRealNull(o)&&(o=0),s.push(o)):s.push(0)}l.push(s)}r=l.length,a=l[0].length}else{o=t.data.v;luckysheet.func_methods.isRealNull(o)&&(o=0),l.push(o)}else l.push(0);else{o=t;l.push(o)}var c=1;if(2<=arguments.length){if(c=luckysheet.func_methods.getFirstValue(arguments[1]),luckysheet.func_methods.valueIsError(c))return c;if(!luckysheet.func_methods.isRealNum(c))return luckysheet.formula.error.v;c=parseInt(c)}var u=1;if(3<=arguments.length){if(u=luckysheet.func_methods.getFirstValue(arguments[2]),luckysheet.func_methods.valueIsError(u))return u;if(!luckysheet.func_methods.isRealNum(u))return luckysheet.formula.error.v;u=Math.floor(parseFloat(u))}var i=!1;if(4==arguments.length&&(i=luckysheet.func_methods.getCellBoolen(arguments[3]),luckysheet.func_methods.valueIsError(i)))return i;if(i){if(c<1||r<c)return luckysheet.formula.error.v}else if(c<1||a<c)return luckysheet.formula.error.v;if(1!=u&&-1!=u)return luckysheet.formula.error.v;function h(e,t){return"array"==luckysheet.getObjType(e)&&(e=e[c-1]),"array"==luckysheet.getObjType(t)&&(t=t[c-1]),isNaN(e)||isNaN(t)?isNaN(e)?!isNaN(t)||t<e?1:e<t?-1:void 0:-1:e-t}function d(e,t){return"array"==luckysheet.getObjType(e)&&(e=e[c-1]),"array"==luckysheet.getObjType(t)&&(t=t[c-1]),isNaN(e)||isNaN(t)?isNaN(e)?!isNaN(t)||t<e?-1:e<t?1:void 0:1:t-e}return i?(l=l[0].map(function(e,t){return l.map(function(e){return e[t]})}),1==u&&l.sort(h),-1==u&&l.sort(d),l=l[0].map(function(e,t){return l.map(function(e){return e[t]})})):(1==u&&l.sort(h),-1==u&&l.sort(d)),l}catch(e){var y=e;return y=luckysheet.formula.errorInfo(y),[luckysheet.formula.error.v,y]}},FILTER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=arguments[0],l=[];if("array"==luckysheet.getObjType(t)){if("array"==luckysheet.getObjType(t[0])&&!luckysheet.func_methods.isDyadicArr(t))return luckysheet.formula.error.v;l=luckysheet.func_methods.getDataDyadicArr(t)}else{"object"==luckysheet.getObjType(t)&&null!=t.startCell?l=luckysheet.func_methods.getCellDataDyadicArr(t,"number"):((u=[]).push(parseFloat(t)),l.push(u))}l.length,l[0].length;var r=arguments[1],a=[],s="row";if("array"==luckysheet.getObjType(r))if("array"==luckysheet.getObjType(r[0])){if(!luckysheet.func_methods.isDyadicArr(r))return luckysheet.formula.error.v;if(1<r.length&&1<r[0].length)return luckysheet.formula.error.v;if(1<r.length){if(r.length!=l.length)return luckysheet.formula.error.v;s="row";for(e=0;e<r.length;e++){var n=r[e][0];if("boolean"!=luckysheet.getObjType(n))if("string"!=luckysheet.getObjType(n)||"true"!=n.toLowerCase()&&"false"!=n.toLowerCase()){if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;n=0!=(n=parseFloat(n))}else"true"==n.toLowerCase()?n=!0:"false"==n.toLowerCase()&&(n=!1);a.push(n)}}if(1<r[0].length){if(r[0].length!=l[0].length)return luckysheet.formula.error.v;s="col";for(e=0;e<r[0].length;e++){n=r[0][e];if("boolean"!=luckysheet.getObjType(n))if("string"!=luckysheet.getObjType(n)||"true"!=n.toLowerCase()&&"false"!=n.toLowerCase()){if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;n=0!=(n=parseFloat(n))}else"true"==n.toLowerCase()?n=!0:"false"==n.toLowerCase()&&(n=!1);a.push(n)}}}else{if(r.length!=l[0].length)return luckysheet.formula.error.v;s="col";for(e=0;e<r.length;e++){n=r[e];if("boolean"!=luckysheet.getObjType(n))if("string"!=luckysheet.getObjType(n)||"true"!=n.toLowerCase()&&"false"!=n.toLowerCase()){if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;n=0!=(n=parseFloat(n))}else"true"==n.toLowerCase()?n=!0:"false"==n.toLowerCase()&&(n=!1);a.push(n)}}else{if("object"!=luckysheet.getObjType(r)||null==r.data||"array"!=luckysheet.getObjType(r.data))return luckysheet.formula.error.v;if(1<r.data.length&&1<r.data[0].length)return luckysheet.formula.error.v;if(1<r.data.length){if(r.data.length!=l.length)return luckysheet.formula.error.v;s="row";for(e=0;e<r.data.length;e++){n=r.data[e][0].v;if(luckysheet.func_methods.isRealNull(n)&&(n=0),"boolean"!=luckysheet.getObjType(n))if("string"!=luckysheet.getObjType(n)||"true"!=n.toLowerCase()&&"false"!=n.toLowerCase()){if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;n=0!=(n=parseFloat(n))}else"true"==n.toLowerCase()?n=!0:"false"==n.toLowerCase()&&(n=!1);a.push(n)}}if(1<r.data[0].length){if(r.data[0].length!=l[0].length)return luckysheet.formula.error.v;s="col";for(e=0;e<r.data[0].length;e++){n=r.data[0][e].v;if(luckysheet.func_methods.isRealNull(n)&&(n=0),"boolean"!=luckysheet.getObjType(n))if("string"!=luckysheet.getObjType(n)||"true"!=n.toLowerCase()&&"false"!=n.toLowerCase()){if(!luckysheet.func_methods.isRealNum(n))return luckysheet.formula.error.v;n=0!=(n=parseFloat(n))}else"true"==n.toLowerCase()?n=!0:"false"==n.toLowerCase()&&(n=!1);a.push(n)}}}var o="";if(3==arguments.length&&(o=luckysheet.func_methods.getFirstValue(arguments[2],"text"),luckysheet.func_methods.valueIsError(o)))return o;var c=[];if("row"==s)for(e=0;e<l.length;e++)a[e]&&c.push(l[e]);else for(e=0;e<l.length;e++){for(var u=[],i=0;i<l[0].length;i++)a[i]&&u.push(l[e][i]);0<u.length&&c.push(u)}return 0==c.length?o:c}catch(e){var h=e;return h=luckysheet.formula.errorInfo(h),[luckysheet.formula.error.v,h]}},UNIQUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t,l=arguments[0],r=[];if("array"==luckysheet.getObjType(l)){if("array"==luckysheet.getObjType(l[0])&&!luckysheet.func_methods.isDyadicArr(l))return luckysheet.formula.error.v;r=luckysheet.func_methods.getDataDyadicArr(l)}else{"object"==luckysheet.getObjType(l)&&null!=l.startCell?r=luckysheet.func_methods.getCellDataDyadicArr(l,"number"):((t=[]).push(parseFloat(l)),r.push(t))}var a=!1;if(2<=arguments.length&&(a=luckysheet.func_methods.getCellBoolen(arguments[1]),luckysheet.func_methods.valueIsError(a)))return a;var s=!1;if(3==arguments.length&&(s=luckysheet.func_methods.getCellBoolen(arguments[2]),luckysheet.func_methods.valueIsError(s)))return s;if(a){r=r[0].map(function(e,t){return r.map(function(e){return e[t]})});for(var n={},o=[],c=[],e=0;e<r.length;e++){for(var u="",i=0;i<r[e].length;i++)u+=r[e][i].toString()+"|||";o.push(u),u in n||(n[u]=0,c.push(r[e]))}if(s){for(var h=[],e=0;e<o.length;e++)o.indexOf(o[e])==o.lastIndexOf(o[e])&&h.push(r[e]);return h=h[0].map(function(e,t){return h.map(function(e){return e[t]})})}return c=c[0].map(function(e,t){return c.map(function(e){return e[t]})})}for(n={},o=[],c=[],e=0;e<r.length;e++){for(u="",i=0;i<r[e].length;i++)u+=r[e][i].toString()+"|||";o.push(u),u in n||(n[u]=0,c.push(r[e]))}if(s){for(h=[],e=0;e<o.length;e++)o.indexOf(o[e])==o.lastIndexOf(o[e])&&h.push(r[e]);return h}return c}catch(e){var d=e;return d=luckysheet.formula.errorInfo(d),[luckysheet.formula.error.v,d]}},RANDARRAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=1;if(1<=arguments.length){if(t=luckysheet.func_methods.getFirstValue(arguments[0]),luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseInt(t)}var l=1;if(2==arguments.length){if(l=luckysheet.func_methods.getFirstValue(arguments[1]),luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l)}if(t<=0||l<=0)return luckysheet.formula.error.v;for(var r=[],e=0;e<t;e++){for(var a=[],s=0;s<l;s++)a.push(Math.random().toFixed(9));r.push(a)}return r}catch(e){var n=e;return n=luckysheet.formula.errorInfo(n),[luckysheet.formula.error.v,n]}},SEQUENCE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return luckysheet.formula.error.na;for(var e=0;e<arguments.length;e++){if(!luckysheet.formula.errorParamCheck(this.p,arguments[e],e)[0])return luckysheet.formula.error.v}try{var t=luckysheet.func_methods.getFirstValue(arguments[0]);if(luckysheet.func_methods.valueIsError(t))return t;if(!luckysheet.func_methods.isRealNum(t))return luckysheet.formula.error.v;t=parseInt(t);var l=1;if(2<=arguments.length){if(l=luckysheet.func_methods.getFirstValue(arguments[1]),luckysheet.func_methods.valueIsError(l))return l;if(!luckysheet.func_methods.isRealNum(l))return luckysheet.formula.error.v;l=parseInt(l)}var r=1;if(3<=arguments.length){if(r=luckysheet.func_methods.getFirstValue(arguments[2]),luckysheet.func_methods.valueIsError(r))return r;if(!luckysheet.func_methods.isRealNum(r))return luckysheet.formula.error.v;r=parseFloat(r)}var a=1;if(4==arguments.length){if(a=luckysheet.func_methods.getFirstValue(arguments[3]),luckysheet.func_methods.valueIsError(a))return a;if(!luckysheet.func_methods.isRealNum(a))return luckysheet.formula.error.v;a=parseFloat(a)}if(t<=0||l<=0)return luckysheet.formula.error.v;for(var s=[],e=0;e<t;e++){for(var n=[],o=0;o<l;o++){var c=r+a*(o+l*e);n.push(c)}s.push(n)}return s}catch(e){var u=e;return u=luckysheet.formula.errorInfo(u),[luckysheet.formula.error.v,u]}}};for(var i=0,dvc;i<luckysheet.functionlist.length;i++){var func=luckysheet.functionlist[i];func.f=luckysheet.functionImplementation[func.n]}luckysheet.matrix_methods=(dvc={},function(e){function h(){}h.precision=1e-6,h.create=function(e){return(new h).setElements(e)},h.I=function(e){for(var t,l=[],r=e;r--;)for(t=e,l[r]=[];t--;)l[r][t]=r===t?1:0;return h.create(l)},h.prototype={e:function(e,t){return e<1||e>this.elements.length||t<1||t>this.elements[0].length?null:this.elements[e-1][t-1]},dimensions:function(){var e=0===this.elements.length?0:this.elements[0].length;return{rows:this.elements.length,cols:e}},rows:function(){return this.elements.length},cols:function(){return 0===this.elements.length?0:this.elements[0].length},eql:function(e){var t=e.elements||e;if(t[0]&&void 0!==t[0][0]||(t=h.create(t).elements),0===this.elements.length||0===t.length)return this.elements.length===t.length;if(this.elements.length!==t.length)return!1;if(this.elements[0].length!==t[0].length)return!1;for(var l,r=this.elements.length,a=this.elements[0].length;r--;)for(l=a;l--;)if(Math.abs(this.elements[r][l]-t[r][l])>h.precision)return!1;return!0},dup:function(){return h.create(this.elements)},map:function(e,t){if(0===this.elements.length)return h.create([]);for(var l,r=[],a=this.elements.length,s=this.elements[0].length;a--;)for(l=s,r[a]=[];l--;)r[a][l]=e.call(t,this.elements[a][l],a+1,l+1);return h.create(r)},isSameSizeAs:function(e){var t=e.elements||e;return void 0===t[0][0]&&(t=h.create(t).elements),0===this.elements.length?0===t.length:this.elements.length===t.length&&this.elements[0].length===t[0].length},add:function(e){if(0===this.elements.length)return this.map(function(e){return e});var r=e.elements||e;return void 0===r[0][0]&&(r=h.create(r).elements),this.isSameSizeAs(r)?this.map(function(e,t,l){return e+r[t-1][l-1]}):null},subtract:function(e){if(0===this.elements.length)return this.map(function(e){return e});var r=e.elements||e;return void 0===r[0][0]&&(r=h.create(r).elements),this.isSameSizeAs(r)?this.map(function(e,t,l){return e-r[t-1][l-1]}):null},canMultiplyFromLeft:function(e){if(0===this.elements.length)return!1;var t=e.elements||e;return void 0===t[0][0]&&(t=h.create(t).elements),this.elements[0].length===t.length},multiply:function(t){if(0===this.elements.length)return null;if(!t.elements)return this.map(function(e){return e*t});var e=!!t.modulus;if(void 0===(u=t.elements||t)[0][0]&&(u=h.create(u).elements),!this.canMultiplyFromLeft(u))return null;for(var l,r,a,s=this.elements.length,n=u[0].length,o=this.elements[0].length,c=[];s--;)for(l=n,c[s]=[];l--;){for(r=o,a=0;r--;)a+=this.elements[s][r]*u[r][l];c[s][l]=a}var u=h.create(c);return e?u.col(1):u},minor:function(e,t,l,r){if(0===this.elements.length)return null;for(var a,s,n,o=[],c=l,u=this.elements.length,i=this.elements[0].length;c--;)for(o[a=l-c-1]=[],s=r;s--;)n=r-s-1,o[a][n]=this.elements[(e+a-1)%u][(t+n-1)%i];return h.create(o)},transpose:function(){if(0===this.elements.length)return h.create([]);for(var e,t=this.elements.length,l=[],r=this.elements[0].length;r--;)for(e=t,l[r]=[];e--;)l[r][e]=this.elements[e][r];return h.create(l)},isSquare:function(){var e=0===this.elements.length?0:this.elements[0].length;return this.elements.length===e},max:function(){if(0===this.elements.length)return null;for(var e,t=0,l=this.elements.length,r=this.elements[0].length;l--;)for(e=r;e--;)Math.abs(this.elements[l][e])>Math.abs(t)&&(t=this.elements[l][e]);return t},indexOf:function(e){if(0===this.elements.length)return null;for(var t,l=this.elements.length,r=this.elements[0].length,a=0;a<l;a++)for(t=0;t<r;t++)if(this.elements[a][t]===e)return{i:a+1,j:t+1};return null},diagonal:function(){if(!this.isSquare)return null;for(var e=[],t=this.elements.length,l=0;l<t;l++)e.push(this.elements[l][l]);return h.create(e)},toRightTriangular:function(){if(0===this.elements.length)return h.create([]);for(var e,t=this.dup(),l=this.elements.length,r=this.elements[0].length,a=0;a<l;a++){if(0===t.elements[a][a])for(e=a+1;e<l;e++)if(0!==t.elements[e][a]){for(n=[],o=0;o<r;o++)n.push(t.elements[a][o]+t.elements[e][o]);t.elements[a]=n;break}if(0!==t.elements[a][a])for(e=a+1;e<l;e++){for(var s=t.elements[e][a]/t.elements[a][a],n=[],o=0;o<r;o++)n.push(o<=a?0:t.elements[e][o]-t.elements[a][o]*s);t.elements[e]=n}}return t},determinant:function(){if(0===this.elements.length)return 1;if(!this.isSquare())return null;for(var e=this.toRightTriangular(),t=e.elements[0][0],l=e.elements.length,r=1;r<l;r++)t*=e.elements[r][r];return t},isSingular:function(){return this.isSquare()&&0===this.determinant()},trace:function(){if(0===this.elements.length)return 0;if(!this.isSquare())return null;for(var e=this.elements[0][0],t=this.elements.length,l=1;l<t;l++)e+=this.elements[l][l];return e},rank:function(){if(0===this.elements.length)return 0;for(var e,t=this.toRightTriangular(),l=0,r=this.elements.length,a=this.elements[0].length;r--;)for(e=a;e--;)if(Math.abs(t.elements[r][e])>h.precision){l++;break}return l},augment:function(e){if(0===this.elements.length)return this.dup();var t=e.elements||e;void 0===t[0][0]&&(t=h.create(t).elements);var l,r=this.dup(),a=r.elements[0].length,s=r.elements.length,n=t[0].length;if(s!==t.length)return null;for(;s--;)for(l=n;l--;)r.elements[s][a+l]=t[s][l];return r},inverse:function(){if(0===this.elements.length)return null;if(!this.isSquare()||this.isSingular())return null;for(var e,t,l,r,a,s=this.elements.length,n=s,o=this.augment(h.I(s)).toRightTriangular(),c=o.elements[0].length,u=[];n--;){for(l=[],u[n]=[],r=o.elements[n][n],t=0;t<c;t++)a=o.elements[n][t]/r,l.push(a),s<=t&&u[n].push(a);for(o.elements[n]=l,e=n;e--;){for(l=[],t=0;t<c;t++)l.push(o.elements[e][t]-o.elements[n][t]*o.elements[e][n]);o.elements[e]=l}}return h.create(u)},round:function(){return this.map(function(e){return Math.round(e)})},snapTo:function(t){return this.map(function(e){return Math.abs(e-t)<=h.precision?t:e})},setElements:function(e){var t,l,r=e.elements||e;if(r[0]&&void 0!==r[0][0]){for(t=r.length,this.elements=[];t--;)for(l=r[t].length,this.elements[t]=[];l--;)this.elements[t][l]=r[t][l];return this}var a=r.length;for(this.elements=[],t=0;t<a;t++)this.elements.push([r[t]]);return this}},e.sylvester_matrix=h}(dvc),{inverse:function(e){return dvc.sylvester_matrix.create(e).inverse().elements}})}(luckysheet),luckysheet.chartparam={luckysheet_chart_point_config:null,luckysheetCurrentChartMove:!1,luckysheetCurrentChartMoveTimeout:null,luckysheetCurrentChartResize:null,luckysheet_chart_rangefocus_timeout:null,luckysheet_chart_rangefocus:!1,luckysheet_chart_data_select_state:!1,luckysheetCurrentChartMoveObj:null,luckysheetCurrentChartMoveXy:[],luckysheetCurrentChartMoveWinH:null,luckysheetCurrentChartMoveWinW:null,luckysheetInsertChartTosheetChange:!0,jgridCurrentChartSelection:null,luckysheetCurrentChartResizeObj:null,luckysheetCurrentChartResizeXy:null,luckysheetCurrentChartResizeWinH:null,luckysheetCurrentChartResizeWinW:null,luckysheet_chartIns_index:-1,luckysheetCurrentChartActive:!1,jgridCurrentChartData:null,luckysheetcurrentChart:null,luckysheet_chart_redo_click:!1,jgridCurrentChartType:null,luckysheetCurrentChartStyle:null,luckysheetCurrentChartCurrentType:null,luckysheetPreviousChart:""},luckysheet.chartInitial=function(){$("#luckysheetdatavisual").click(function(){if(window.generateChart){generator.ini(chartMixConfig),setTimeout(function(){generator.showChartSettingComponent("notRefresh")},0),store.state.chartSetting.isqk&&setTimeout(function(){luckysheet.luckysheetsizeauto()},0);var e=luckysheet.getluckysheet_select_save();1==e.length&&e[0].row[0]==e[0].row[1]&&e[0].column[0]==e[0].column[1]&&(luckysheet.luckysheetMoveHighlightRange2("right","rangeOfSelect"),luckysheet.luckysheetMoveHighlightRange2("down","rangeOfSelect"),e=luckysheet.getluckysheet_select_save());for(var t=-1,l=e[0].row[1]-e[0].row[0],r=e[0].row[0];r<=e[0].row[1];r++){for(var a=e[0].column[0];a<=e[0].column[1];a++){if(null!=(o=luckysheet.getcellvalue(r,a,luckysheet.flowdata))&&0<o.toString().length){t=r;break}}if(-1!==t)break}-1==t&&(t=0),e[0].row=[t,t],luckysheet.setluckysheet_select_save(e),luckysheet.luckysheet_shiftpositon=$.extend(!0,{},e[0]),luckysheet.luckysheetMoveEndCell("down","range",!1,l);for(var s=-1,n=(e=luckysheet.getluckysheet_select_save())[0].column[1]-e[0].column[0],a=e[0].column[0];a<=e[0].column[1];a++){for(var o,r=e[0].row[0];r<=e[0].row[1];r++){if(null!=(o=luckysheet.getcellvalue(r,a,luckysheet.flowdata))&&0<o.toString().length){s=a;break}}if(-1!==s)break}-1==s&&(s=0),e[0].column=[s,s],luckysheet.setluckysheet_select_save(e),luckysheet.luckysheet_shiftpositon=$.extend(!0,{},e[0]),luckysheet.luckysheetMoveEndCell("right","range",!1,n),e=luckysheet.getluckysheet_select_save();var c=luckysheet.currentSheetIndex,u=$.extend(!0,[],e),i=luckysheet.getdatabyselection(e[0],c);generator.chartData=i;var h=luckysheet.sheetmanage.getRangetxt(c,u[0],c),d=$(window).width(),y=$(window).height(),f=$("#luckysheet-cell-main"),m=f.scrollLeft(),k=f.scrollTop(),p=.3*d,g=.3*d*.618,v=(d-p)/3+m+Math.round(10*Math.random()),b=(y-g)/4+k+Math.round(10*Math.random());generator.insertNewChart("echarts|line|default",i,c,u,h,"default",luckysheet.currentSheetIndex,g,p,v,b)}else luckysheet.tooltip.info('<i class="fa fa-exclamation-triangle"></i>提示',"图表插件暂未加入")})},luckysheet.chart_selection={create:function(e){var t,l,r,a,s,n,o=store.state.chartSetting.chartList[e];function c(e,t,l,r,a){var s,n=luckysheet.getvisibledatarow(),o=luckysheet.getvisibledatacolumn(),c=n[l],u=t-1==-1?0:n[t-1],i=o[a],h=r-1==-1?0:o[r-1];return"rowtitle"==e&&(s="#C65151"),"coltitle"==e&&(s="#9667C0"),"content"==e&&(s="#4970D1"),'<div id="luckysheet-chart-rangeShow-'+e+'" style="left: '+h+"px;width: "+(i-h-1)+"px;top: "+u+"px;height: "+(c-u-1)+'px;border: none;margin: 0;position: absolute;z-index: 14;"><div class="luckysheet-chart-rangeShow-move" data-type="top" style="height: 2px;border-top: 2px solid #fff;border-bottom: 2px solid #fff;background: '+s+';position: absolute;left: 0;right: 0;top: -2px;z-index: 18;opacity: 0.9;cursor: move;"></div><div class="luckysheet-chart-rangeShow-move" data-type="right" style="width: 2px;border-left: 2px solid #fff;border-right: 2px solid #fff;background: '+s+';position: absolute;top: 0;bottom: 0;right: -2px;z-index: 18;opacity: 0.9;cursor: move;"></div><div class="luckysheet-chart-rangeShow-move" data-type="bottom" style="height: 2px;border-top: 2px solid #fff;border-bottom: 2px solid #fff;background: '+s+';position: absolute;left: 0;right: 0;bottom: -2px;z-index: 18;opacity: 0.9;cursor: move;"></div><div class="luckysheet-chart-rangeShow-move" data-type="left" style="width: 2px;border-left: 2px solid #fff;border-right: 2px solid #fff;background: '+s+';position: absolute;top: 0;bottom: 0;left: -2px;z-index: 18;opacity: 0.9;cursor: move;"></div><div style="border: 2px solid #FC6666;background: '+s+';position: absolute;top: 0;right: 0;bottom: 0;left: 0;z-index: 15;opacity: 0.1;"></div><div class="luckysheet-chart-rangeShow-resize" data-type="lt" style="width: 6px;height: 6px;border: 1px solid #fff;background: '+s+';position: absolute;left: -3px;top: -3px;z-index: 19;cursor: se-resize;"></div><div class="luckysheet-chart-rangeShow-resize" data-type="rt" style="width: 6px;height: 6px;border: 1px solid #fff;background: '+s+';position: absolute;right: -3px;top: -3px;z-index: 19;cursor: ne-resize;"></div><div class="luckysheet-chart-rangeShow-resize" data-type="lb" style="width: 6px;height: 6px;border: 1px solid #fff;background: '+s+';position: absolute;left: -3px;bottom: -3px;z-index: 19;cursor: ne-resize;"></div><div class="luckysheet-chart-rangeShow-resize" data-type="rb" style="width: 6px;height: 6px;border: 1px solid #fff;background: '+s+';position: absolute;right: -3px;bottom: -3px;z-index: 19;cursor: se-resize;"></div></div>'}1<o.rangeArray.length||($("#luckysheet-chart-rangeShow").empty(),$("#luckysheet-cell-selected-boxs").hide(),$("#luckysheet-cell-selected-focus").hide(),$("#luckysheet-rows-h-selected").hide(),$("#luckysheet-cols-h-selected").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide(),t=o.rangeArray[0].row[0],l=o.rangeArray[0].column[0],r=o.rangeSplitArray,a=o.rangeRowCheck.exits?c("rowtitle",r.rowtitle.row[0]+t,r.rowtitle.row[1]+t,r.rowtitle.column[0]+l,r.rowtitle.column[1]+l):"",s=o.rangeColCheck.exits?c("coltitle",r.coltitle.row[0]+t,r.coltitle.row[1]+t,r.coltitle.column[0]+l,r.coltitle.column[1]+l):"",n=c("content",r.content.row[0]+t,r.content.row[1]+t,r.content.column[0]+l,r.content.column[1]+l),$("#luckysheet-chart-rangeShow").append(a+s+n))},rangeMove:!1,rangeMovexy:null,rangeMoveIndex:null,rangeMoveObj:null,rangeMoveDraging:function(e,t,l){var r,a,s,n,o=$.extend(!0,{},store.state.chartSetting.chartList[store.state.chartSetting.chartCurrent]),c=o.rangeArray[0].row[0],u=o.rangeArray[0].column[0],i=o.rangeRowCheck,h=o.rangeColCheck,d=o.rangeSplitArray,y=luckysheet.mouseposition(e.pageX,e.pageY),f=$("#luckysheet-cell-main").scrollLeft(),m=$("#luckysheet-cell-main").scrollTop(),k=y[0]+f,p=y[1]+m,g=$(window).height()+m-t-l,v=$(window).width()+f,b=luckysheet.rowLocation(p)[2],_=luckysheet.colLocation(k)[2],w=luckysheet.getvisibledatarow(),x=luckysheet.getvisibledatacolumn(),C=luckysheet.chart_selection.rangeMoveObj.attr("id");"luckysheet-chart-rangeShow-content"==C?(s=luckysheet.chart_selection.rangeMoveIndex[0]-luckysheet.chart_selection.rangeMovexy[0]+b,i.exits?(s<c+i.range[1]+1||p<0)&&(s=c+i.range[1]+1):(s<0||p<0)&&(s=0),((n=d.content.row[1]-d.content.row[0]+s)>=w.length-1||g<p)&&(s=w.length-1-d.content.row[1]+d.content.row[0],n=w.length-1),r=luckysheet.chart_selection.rangeMoveIndex[1]-luckysheet.chart_selection.rangeMovexy[1]+_,h.exits?(r<u+h.range[1]+1||k<0)&&(r=u+h.range[1]+1):(r<0||k<0)&&(r=0),((a=d.content.column[1]-d.content.column[0]+r)>=x.length-1||v<k)&&(r=x.length-1-d.content.column[1]+d.content.column[0],a=x.length-1),i.exits&&h.exits?(o.rangeArray=[{row:[c,n],column:[u,a]}],o.rangeSplitArray.range={row:[c,n],column:[u,a]},o.rangeSplitArray.content={row:[s-c,n-c],column:[r-u,a-u]},o.rangeSplitArray.rowtitle={row:o.rangeSplitArray.rowtitle.row,column:[r-u,a-u]},o.rangeSplitArray.coltitle={row:[s-c,n-c],column:o.rangeSplitArray.coltitle.column}):i.exits?(o.rangeArray=[{row:[c,n],column:[r,a]}],o.rangeSplitArray.range={row:[c,n],column:[r,a]},o.rangeSplitArray.content={row:[s-c,n-c],column:o.rangeSplitArray.content.column}):h.exits?(o.rangeArray=[{row:[s,n],column:[u,a]}],o.rangeSplitArray.range={row:[s,n],column:[u,a]},o.rangeSplitArray.content={row:o.rangeSplitArray.content.row,column:[r-u,a-u]}):(o.rangeArray=[{row:[s,n],column:[r,a]}],o.rangeSplitArray.range={row:[s,n],column:[r,a]})):"luckysheet-chart-rangeShow-rowtitle"==C?(r=luckysheet.chart_selection.rangeMoveIndex[1]-luckysheet.chart_selection.rangeMovexy[1]+_,h.exits?(r<u+h.range[1]+1||k<0)&&(r=u+h.range[1]+1):(r<0||k<0)&&(r=0),((a=d.rowtitle.column[1]-d.rowtitle.column[0]+r)>=x.length-1||v<k)&&(r=x.length-1-d.rowtitle.column[1]+d.rowtitle.column[0],a=x.length-1),h.exits?(o.rangeArray=[{row:o.rangeArray[0].row,column:[u,a]}],o.rangeSplitArray.range={row:o.rangeArray[0].row,column:[u,a]},o.rangeSplitArray.rowtitle={row:o.rangeSplitArray.rowtitle.row,column:[r-u,a-u]},o.rangeSplitArray.content={row:o.rangeSplitArray.content.row,column:[r-u,a-u]}):(o.rangeArray=[{row:o.rangeArray[0].row,column:[r,a]}],o.rangeSplitArray.range={row:o.rangeArray[0].row,column:[r,a]})):"luckysheet-chart-rangeShow-coltitle"==C&&(s=luckysheet.chart_selection.rangeMoveIndex[0]-luckysheet.chart_selection.rangeMovexy[0]+b,i.exits?(s<c+i.range[1]+1||p<0)&&(s=c+i.range[1]+1):(s<0||p<0)&&(s=0),((n=d.coltitle.row[1]-d.coltitle.row[0]+s)>=w.length-1||g<p)&&(s=w.length-1-d.coltitle.row[1]+d.coltitle.row[0],n=w.length-1),i.exits?(o.rangeArray=[{row:[c,n],column:o.rangeArray[0].column}],o.rangeSplitArray.range={row:[c,n],column:o.rangeArray[0].column},o.rangeSplitArray.coltitle={row:[s-c,n-c],column:o.rangeSplitArray.coltitle.column},o.rangeSplitArray.content={row:[s-c,n-c],column:o.rangeSplitArray.content.column}):(o.rangeArray=[{row:[s,n],column:o.rangeArray[0].column}],o.rangeSplitArray.range={row:[s,n],column:o.rangeArray[0].column})),store.commit({type:"updateChartItem",key:"rangeArray",value:o.rangeArray,chartId:o.chart_id}),store.commit({type:"updateChartItem",key:"rangeSplitArray",value:o.rangeSplitArray,chartId:o.chart_id}),luckysheet.chart_selection.create(store.state.chartSetting.chartCurrent)},rangeMoveDragged:function(){luckysheet.chart_selection.rangeMove=!1;var e=$.extend(!0,{},store.state.chartSetting.chartList[store.state.chartSetting.chartCurrent]),t={};t.chart_id=store.state.chartSetting.chartCurrent,t.rangeTxt=luckysheet.sheetmanage.getRangetxt(luckysheet.currentSheetIndex,e.rangeArray[0],luckysheet.currentSheetIndex),t.chartData=luckysheet.getdatabyselection(e.rangeArray[0],luckysheet.currentSheetIndex),"luckysheet-chart-rangeShow-content"!=luckysheet.chart_selection.rangeMoveObj.attr("id")||e.rangeRowCheck.exits||e.rangeColCheck.exits?t.rangeSplitArray=e.rangeSplitArray:t.rangeSplitArray=generator.getRangeSplitArray(t.chartData,e.rangeArray,e.rangeColCheck,e.rangeRowCheck);var l=e.chartAllType.split("|"),r=l[0],a=l[1],s=l[2];t.chartDataCache=generator.getChartDataCache(t.chartData,t.rangeSplitArray,r,a,s),t.chartDataSeriesOrder=generator.getChartDataSeriesOrder(t.chartDataCache.series[0].length),generator.drag=!0,generator.addPoint=!1,generator.addLine=!1,generator.addArea=!1,t.defaultOption="funnel"==a||"gauge"==a?generator.addDataToOption1(e.defaultOption,t.chartDataCache,t.chartDataSeriesOrder,r,a,s):generator.addDataToOption(e.defaultOption,t.chartDataCache,t.chartDataSeriesOrder,r,a,s),generator.patchVueSet(t),generator.generateChart(t.defaultOption,e.chartTheme,e.chartAllType,$("#"+t.chart_id).get(0))},rangeResize:!1,rangeResizexy:null,rangeResizeIndex:null,rangeResizeObj:null,rangeResizeDraging:function(e,t,l){var r,a,s,n,o,c,u,i,h,d,y=$.extend(!0,{},store.state.chartSetting.chartList[store.state.chartSetting.chartCurrent]),f=y.rangeArray[0].row[0],m=y.rangeArray[0].column[0],k=y.rangeRowCheck,p=y.rangeColCheck,g=(y.rangeSplitArray,luckysheet.mouseposition(e.pageX,e.pageY)),v=$("#luckysheet-cell-main").scrollLeft(),b=$("#luckysheet-cell-main").scrollTop(),_=g[0]+v,w=g[1]+b,x=$(window).height()+b-t-l,C=$(window).width()+v,T=luckysheet.rowLocation(w)[2],I=luckysheet.colLocation(_)[2],R=luckysheet.getvisibledatarow(),S=luckysheet.getvisibledatacolumn(),A=luckysheet.chart_selection.rangeResizeObj.attr("id");"luckysheet-chart-rangeShow-content"==A?("lt"==luckysheet.chart_selection.rangeResize?(c=luckysheet.chart_selection.rangeResizeIndex.row[0],r=luckysheet.chart_selection.rangeResizeIndex.column[0],u=luckysheet.chart_selection.rangeResizeIndex.row[1],a=luckysheet.chart_selection.rangeResizeIndex.column[1]):"lb"==luckysheet.chart_selection.rangeResize?(c=luckysheet.chart_selection.rangeResizeIndex.row[1],r=luckysheet.chart_selection.rangeResizeIndex.column[0],u=luckysheet.chart_selection.rangeResizeIndex.row[0],a=luckysheet.chart_selection.rangeResizeIndex.column[1]):"rt"==luckysheet.chart_selection.rangeResize?(c=luckysheet.chart_selection.rangeResizeIndex.row[0],r=luckysheet.chart_selection.rangeResizeIndex.column[1],u=luckysheet.chart_selection.rangeResizeIndex.row[1],a=luckysheet.chart_selection.rangeResizeIndex.column[0]):"rb"==luckysheet.chart_selection.rangeResize&&(c=luckysheet.chart_selection.rangeResizeIndex.row[1],r=luckysheet.chart_selection.rangeResizeIndex.column[1],u=luckysheet.chart_selection.rangeResizeIndex.row[0],a=luckysheet.chart_selection.rangeResizeIndex.column[0]),k.exits?(i=c-luckysheet.chart_selection.rangeResizexy[0]+T)<f+k.range[1]+1||w<0?i=f+k.range[1]+1:(i>=R.length-1||x<w)&&(i=R.length-1):(i=f-luckysheet.chart_selection.rangeResizexy[0]+T)<0||w<0?i=0:(i>=R.length-1||x<w)&&(i=R.length-1),p.exits?(s=r-luckysheet.chart_selection.rangeResizexy[1]+I)<m+p.range[1]+1||_<0?s=m+p.range[1]+1:(s>=S.length-1||C<_)&&(s=S.length-1):(s=m-luckysheet.chart_selection.rangeResizexy[1]+I)<0||_<0?s=0:(s>=S.length-1||C<_)&&(s=S.length-1),d=u<i?(h=u,i):(h=i,u),o=a<s?(n=a,s):(n=s,a),k.exits||p.exits?(y.rangeArray=[{row:[f,d],column:[m,o]}],y.rangeSplitArray.range={row:[f,d],column:[m,o]},y.rangeSplitArray.content={row:[h-f,d-f],column:[n-m,o-m]},k.exits&&(y.rangeSplitArray.rowtitle={row:y.rangeSplitArray.rowtitle.row,column:[n-m,o-m]}),p.exits&&(y.rangeSplitArray.coltitle={row:[h-f,d-f],column:y.rangeSplitArray.coltitle.column})):(y.rangeArray=[{row:[h,d],column:[n,o]}],y.rangeSplitArray.range={row:[h,d],column:[n,o]})):"luckysheet-chart-rangeShow-rowtitle"==A?("lt"==luckysheet.chart_selection.rangeResize||"lb"==luckysheet.chart_selection.rangeResize?(r=luckysheet.chart_selection.rangeResizeIndex.column[0],a=luckysheet.chart_selection.rangeResizeIndex.column[1]):"rt"!=luckysheet.chart_selection.rangeResize&&"rb"!=luckysheet.chart_selection.rangeResize||(r=luckysheet.chart_selection.rangeResizeIndex.column[1],a=luckysheet.chart_selection.rangeResizeIndex.column[0]),p.exits?(s=r-luckysheet.chart_selection.rangeResizexy[1]+I)<m+p.range[1]+1||_<0?s=m+p.range[1]+1:(s>=S.length-1||C<_)&&(s=S.length-1):(s=m-luckysheet.chart_selection.rangeResizexy[1]+I)<0||_<0?s=0:(s>=S.length-1||C<_)&&(s=S.length-1),o=a<s?(n=a,s):(n=s,a),p.exits?(y.rangeArray=[{row:y.rangeArray[0].row,column:[m,o]}],y.rangeSplitArray.range={row:y.rangeArray[0].row,column:[m,o]},y.rangeSplitArray.rowtitle={row:y.rangeSplitArray.rowtitle.row,column:[n-m,o-m]},y.rangeSplitArray.content={row:y.rangeSplitArray.content.row,column:[n-m,o-m]}):(y.rangeArray=[{row:y.rangeArray[0].row,column:[n,o]}],y.rangeSplitArray.range={row:y.rangeArray[0].row,column:[n,o]})):"luckysheet-chart-rangeShow-coltitle"==A&&("lt"==luckysheet.chart_selection.rangeResize||"rt"==luckysheet.chart_selection.rangeResize?(c=luckysheet.chart_selection.rangeResizeIndex.row[0],u=luckysheet.chart_selection.rangeResizeIndex.row[1]):"lb"!=luckysheet.chart_selection.rangeResize&&"rb"!=luckysheet.chart_selection.rangeResize||(c=luckysheet.chart_selection.rangeResizeIndex.row[1],u=luckysheet.chart_selection.rangeResizeIndex.row[0]),k.exits?(i=c-luckysheet.chart_selection.rangeResizexy[0]+T)<f+k.range[1]+1||w<0?i=f+k.range[1]+1:(i>=R.length-1||x<w)&&(i=R.length-1):(i=f-luckysheet.chart_selection.rangeResizexy[0]+T)<0||w<0?i=0:(i>=R.length-1||x<w)&&(i=R.length-1),d=u<i?(h=u,i):(h=i,u),k.exits?(y.rangeArray=[{row:[f,d],column:y.rangeArray[0].column}],y.rangeSplitArray.range={row:[f,d],column:y.rangeArray[0].column},y.rangeSplitArray.coltitle={row:[h-f,d-f],column:y.rangeSplitArray.coltitle.column},y.rangeSplitArray.content={row:[h-f,d-f],column:y.rangeSplitArray.content.column}):(y.rangeArray=[{row:[h,d],column:y.rangeArray[0].column}],y.rangeSplitArray.range={row:[h,d],column:y.rangeArray[0].column})),store.commit({type:"updateChartItem",key:"rangeArray",value:y.rangeArray,chartId:y.chart_id}),store.commit({type:"updateChartItem",key:"rangeSplitArray",value:y.rangeSplitArray,chartId:y.chart_id}),luckysheet.chart_selection.create(store.state.chartSetting.chartCurrent)},rangeResizeDragged:function(){luckysheet.chart_selection.rangeResize=null;var e=$.extend(!0,{},store.state.chartSetting.chartList[store.state.chartSetting.chartCurrent]),t={};t.chart_id=store.state.chartSetting.chartCurrent,t.rangeTxt=luckysheet.sheetmanage.getRangetxt(luckysheet.currentSheetIndex,e.rangeArray[0],luckysheet.currentSheetIndex),t.chartData=luckysheet.getdatabyselection(e.rangeArray[0],luckysheet.currentSheetIndex),"luckysheet-chart-rangeShow-content"!=luckysheet.chart_selection.rangeResizeObj.attr("id")||e.rangeRowCheck.exits||e.rangeColCheck.exits?t.rangeSplitArray=e.rangeSplitArray:t.rangeSplitArray=generator.getRangeSplitArray(t.chartData,e.rangeArray,e.rangeColCheck,e.rangeRowCheck);var l=e.chartAllType.split("|"),r=l[0],a=l[1],s=l[2];t.chartDataCache=generator.getChartDataCache(t.chartData,t.rangeSplitArray,r,a,s),t.chartDataSeriesOrder=generator.getChartDataSeriesOrder(t.chartDataCache.series[0].length),t.defaultOption="funnel"==a||"gauge"==a?generator.addDataToOption1(e.defaultOption,t.chartDataCache,t.chartDataSeriesOrder,r,a,s):generator.addDataToOption(e.defaultOption,t.chartDataCache,t.chartDataSeriesOrder,r,a,s),generator.patchVueSet(t),generator.generateChart(t.defaultOption,e.chartTheme,e.chartAllType,$("#"+t.chart_id).get(0))}};